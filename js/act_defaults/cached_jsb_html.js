anonymousFunc = function () {
window.cachedFileNames["jsb_html"] = "jsb_html"
if (!window.cached_jsb_html) window.cached_jsb_html = {}
var z="* Not really an accordion but a collaspable div\xFE";
 z+="*\xFE";
 z+="* Print @Accordion('Header #1', 'this is an example', false) : @Accordion('Header #2', 'Center Vertically', true)\xFE";
 z+="*\xFE";
 z+="FUNCTION Accordion(byval txtHeader As StRiNg, byval Content As StRiNg, optional byval startOpen As Boolean, optional byval footerPanel As String) As String\xFE";
 z+="    * $options async-\xFE";
 z+="    \xFE";
 z+="    Dim ISEXPANDED As String\xFE";
 z+="    Dim UNIQUEID As String\xFE";
 z+="\xFE";
 z+="    if startOpen then isExpanded = \" in\" else isExpanded = \"\"\xFE";
 z+="    if footerPanel then footerPanel = `<div class=\"panel-footer\">`:Chr(29):footerPanel:Chr(28):`</div>`\xFE";
 z+="    \xFE";
 z+="    uniqueID = NewGuid()\xFE";
 z+="    return Chr(28):`<div class=\"panel-group\">\xFE";
 z+="      <div class=\"panel panel-default\">\xFE";
 z+="        <div class=\"panel-heading\">\xFE";
 z+="          <h4 class=\"panel-title\">\xFE";
 z+="            <a class=\"accordian\" data-toggle=\"collapse\" href=\"#`:uniqueID:`\">`:Chr(29):txtHeader:Chr(28):`</a>\xFE";
 z+="          </h4>\xFE";
 z+="        </div>\xFE";
 z+="        <div id=\"`:uniqueID:`\" class=\"panel-collapse collapse`:isExpanded:`\">\xFE";
 z+="          <div class=\"panel-body\">`:Chr(29):Content:Chr(28):`</div>\xFE";
 z+="          `:footerPanel:`\xFE";
 z+="        </div>\xFE";
 z+="      </div>\xFE";
 z+="    </div>`:Chr(29)"
window.cached_jsb_html["accordion"]=z;
var z="*\xFE";
 z+="* Get the lastest build from: https://github.com/ajaxorg/ace-builds/\xFE";
 z+="*\xFE";
 z+="Function AceEditor(ByVal ID As String, ByVal DefaultValue As String, Optional Byval startOnLineNo As Integer) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If !startOnLineNo Then startOnLineNo = 1\xFE";
 z+="\xFE";
 z+="    Dim needLoad As Boolean = true\xFE";
 z+="    if system(1) = \"js\" then\xFE";
 z+="        if window.ace then needload = false\xFE";
 z+="    end if\xFE";
 z+="    if needload then\xFE";
 z+="        Html =  @Head(@JSLink(@jsbroot:\"js/aceeditor/ace.js\"))\xFE";
 z+="        Html := @Head(@JSLink(@jsbroot:\"js/aceeditor/theme-chrome.js\"))\xFE";
 z+="        Html := @Head(@JSLink(@jsbroot:\"js/aceeditor/ext-language_tools.js\"))\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Html := Chr(28):`\xFE";
 z+="      <input id=\"`:ID:`_lineNo\" name=\"`:ID:`_lineNo\" type=\"hidden\" />\xFE";
 z+="      <textarea id=\"`:ID:`\" name=\"`:ID:`\" style=\"display: none\" autocomplete=\"offItGoes\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"></textarea> \xFE";
 z+="      <div id=\"ace_`:ID:`\" class=\"aces\" style=\"display: none\">`:DefaultValue:`</div> \xFE";
 z+="      <style type=\"text/css\" media=\"screen\"> \xFE";
 z+="         .aces { position: absolute; left: 0; right: 0; top: 0; bottom: 0; } \xFE";
 z+="      </style> \xFE";
 z+="      <script type=\"text/javascript\"> \xFE";
 z+="        $(document).ready(function () {\xFE";
 z+="            setupAce(\"`:ID:`\", `:startOnLineNo:`)\xFE";
 z+="        });\xFE";
 z+="      </script>\xFE";
 z+="   `:chr(29) \xFE";
 z+="    Return Html\xFE";
 z+="  \xFE";
 z+="/*\xFE";
 z+="    Window.`:ID:`.setTheme(\"ace/theme/xxxxx.\");\xFE";
 z+="    Chrome,Clouds,Clouds Midnight,Cobalt,Crimson Editor,Dawn,Eclipse,Idle Fingers,Kr Theme,Merbivore,Merbivore Soft,\xFE";
 z+="    Mono Industrial,Monokai,Pastel On Dark,Solarized Dark,Solarized Light,TextMate,Tomorrow,Tomorrow Night,\xFE";
 z+="    Tomorrow Night Blue,Tomorrow Night Bright,Tomorrow Night Eighties,Twilight,Vibrant Ink\xFE";
 z+="*/\xFE";
 z+="End Function"
window.cached_jsb_html["aceeditor"]=z;
var z="function addAutoTextBoxCascadingEvent(ByVal ID As String, byval ChangeOn_ParentID As StRiNg, byval QuotedUrl As StRiNg, byval minLength As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim A As String\xFE";
 z+="    Dim S As String\xFE";
 z+="    \xFE";
 z+="    S = `\xFE";
 z+="        function `:ID:`_`:ChangeOn_ParentID:`_OnChange(pObj, newid, txtbox) {\xFE";
 z+="            var parentObj = pObj;\xFE";
 z+="            var autoTextBox = txtbox;\xFE";
 z+="            \xFE";
 z+="            if (!autoTextBox) autoTextBox = findMyCompanion(parentObj, '`:ID:`')\xFE";
 z+="            if (!autoTextBox) return alert('Unable to find matching companion of `:ID:`');\xFE";
 z+="         \xFE";
 z+="            // Check if already loaded \xFE";
 z+="            var lastFetch = CStr($(parentObj).data('lastFetch_`:ID:`'));\xFE";
 z+="            if (lastFetch == \"..pending..\") return\xFE";
 z+="            \xFE";
 z+="            if (lastFetch && lastFetch == CStr(newid)) {\xFE";
 z+="                var a = $(parentObj).data('lastFetchData_`:ID:`');\xFE";
 z+="                if (a) autoCompleteTextBox(autoTextBox, a, `:Val(minLength):`)\xFE";
 z+="                return\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            if (formVar(pObj) != newid) window._isDirty = true;\xFE";
 z+="            \xFE";
 z+="            var Url = `:QuotedUrl:`;\xFE";
 z+="            var NewID = newid;\xFE";
 z+="            Url = urlCtlSubstitutions(Url, { id: newid, `:ChangeOn_ParentID:`: newid })\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', \"..pending..\");\xFE";
 z+="         `\xFE";
 z+="         * OnSuccess for AJax\xFE";
 z+="         A = `\xFE";
 z+="            $(parentObj).data('lastFetchData_`:ID:`', []);\xFE";
 z+="            for(var key in json) { \xFE";
 z+="               var a = json[key];\xFE";
 z+="               if (isArray(a)) { \xFE";
 z+="                   $(parentObj).data('lastFetchData_`:ID:`', a);\xFE";
 z+="                   break;\xFE";
 z+="                }\xFE";
 z+="            }\xFE";
 z+="            autoCompleteTextBox(autoTextBox, a, `:Val(minLength):`, null, true) // txtBox, choiceArray, minLength, CompanionID, restrictToList\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', NewID);\xFE";
 z+="            \xFE";
 z+="         `\xFE";
 z+="         S = S:@jsb_bf.Ajax('Url', A):`\xFE";
 z+="      }\xFE";
 z+="    `\xFE";
 z+="    Return @jsb_html.Script(S)"
window.cached_jsb_html["addautotextboxcascadingevent"]=z;
var z="* ============================= HTML =============================\xFE";
 z+="function addComboBoxCascadingEvent(ByVal ID As String, byval ChangeOn_ParentID As String, byval QuotedUrl As String, byval addBlank As Integer, byval DescriptionField As String, byval ValueField As String, byval AdditionalAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="\xFE";
 z+="    Dim S As String = `\xFE";
 z+="        function `:ID:`_`:ChangeOn_ParentID:`_OnChange(pObj, newid, cbobox, firstLoad) {\xFE";
 z+="            var parentObj = pObj;\xFE";
 z+="            var ComboBox = cbobox;\xFE";
 z+="            \xFE";
 z+="            if (!ComboBox) ComboBox = findMyCompanion(parentObj, '`:ID:`')\xFE";
 z+="            if (!ComboBox) return alert('unable to find matching companion for `:ID:`');\xFE";
 z+="            \xFE";
 z+="            // Check if already loaded \xFE";
 z+="            var lastFetch = CStr($(parentObj).data('lastFetch_`:ID:`'));\xFE";
 z+="            if (lastFetch == \"..pending..\") return\xFE";
 z+="\xFE";
 z+="            if (lastFetch && lastFetch == CStr(newid)) {\xFE";
 z+="                var a = $(parentObj).data('lastFetchData_`:ID:`');\xFE";
 z+="                //                 Ctl,      a,    ValueField,       DesciptionField,        addBlank,       dft,  subDel\xFE";
 z+="                if (a) loadOptions(ComboBox, a, '`:ValueField:`', '`:DescriptionField:`', '`:addBlank+0:`',  null, '', !firstLoad);\xFE";
 z+="                return\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            if (formVar(pObj) != newid && !firstLoad) window._isDirty = true;\xFE";
 z+="            \xFE";
 z+="            var Url = `:QuotedUrl:`;\xFE";
 z+="            var NewID = newid;\xFE";
 z+="            Url = urlCtlSubstitutions(Url, { id: newid, `:ChangeOn_ParentID:`: newid })\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', \"..pending..\");\xFE";
 z+="        `\xFE";
 z+="        * OnSuccess for AJax\xFE";
 z+="        Dim A As String = `\xFE";
 z+="            $(parentObj).data('lastFetchData_`:ID:`', []);\xFE";
 z+="            \xFE";
 z+="            for(var key in json) { \xFE";
 z+="                var a = json[key];\xFE";
 z+="                if (isArray(a)) { \xFE";
 z+="                    $(parentObj).data('lastFetchData_`:ID:`', a);\xFE";
 z+="                    break;\xFE";
 z+="                }\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            //          Ctl,      a,    ValueField,       DesciptionField,        addBlank,       dft,  subDel\xFE";
 z+="            loadOptions(ComboBox, a, '`:ValueField:`', '`:DescriptionField:`', '`:addBlank+0:`',  null, '', !firstLoad);\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', NewID);\xFE";
 z+="        `\xFE";
 z+="        \xFE";
 z+="        // QuotedUrl, jsSuccess, jsFailure, PostPayLoad, infoMsg, HeaderJSON, Ok2Cache)\xFE";
 z+="        S = S:@jsb_bf.Ajax('Url', A, Nothing, Nothing, Nothing, Nothing, true):`\xFE";
 z+="        }\xFE";
 z+="    `\xFE";
 z+="    Return @jsb_html.Script(S)"
window.cached_jsb_html["addcomboboxcascadingevent"]=z;
var z="function addDropDownCascadingEvent(byval ID As String, byval ChangeOn_ParentID As String, byval QuotedUrl As String, byval addBlank As Integer, byval DesciptionField As String, byval ValueField As String) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim S As String\xFE";
 z+="    Dim A As String\xFE";
 z+="\xFE";
 z+="    if ValueField = \"\" Then ValueField = DesciptionField\xFE";
 z+="    if DesciptionField = \"\" Then DesciptionField = ValueField\xFE";
 z+="    \xFE";
 z+="    S = `\xFE";
 z+="      function `:ID:`_`:ChangeOn_ParentID:`_OnChange(pObj, newid, ddbox) {\xFE";
 z+="            var parentObj = pObj;\xFE";
 z+="            var dropDownBox = ddbox;\xFE";
 z+="            \xFE";
 z+="            if (!dropDownBox) dropDownBox = findMyCompanion(parentObj, '`:ID:`')\xFE";
 z+="            if (!dropDownBox) return alert('unable to find matching companion for `:ID:`');\xFE";
 z+="            \xFE";
 z+="            var lastFetch = $(parentObj).data('lastFetch_`:ID:`');\xFE";
 z+="            if (CStr(lastFetch) == CStr(newid)) {\xFE";
 z+="                var a = $(parentObj).data('lastFetchData_`:ID:`');\xFE";
 z+="                //                    Ctl,      a,    ValueField,       DesciptionField,       addBlank,      dft,  subDel\xFE";
 z+="                if (a) loadOptions(dropDownBox, a, '`:ValueField:`', '`:DesciptionField:`', '`:addBlank+0:`', null, '', true);\xFE";
 z+="                return\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            if (formVar(pObj) != newid) window._isDirty = true;\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', newid);\xFE";
 z+="            \xFE";
 z+="            var Url = `:QuotedUrl:`;\xFE";
 z+="            Url = urlCtlSubstitutions(Url, { id: newid, `:ChangeOn_ParentID:`: newid })\xFE";
 z+="        `\xFE";
 z+="        \xFE";
 z+="        * OnSuccess for AJax\xFE";
 z+="        A = `\xFE";
 z+="            for(var key in json) { \xFE";
 z+="               var a = json[key];\xFE";
 z+="                if (isArray(a)) { \xFE";
 z+="                    $(parentObj).data('lastFetchData_`:ID:`', a);\xFE";
 z+="                    //             Ctl,      a,    ValueField,       DesciptionField,       addBlank,      dft,  subDel\xFE";
 z+="                    loadOptions(dropDownBox, a, '`:ValueField:`', '`:DesciptionField:`', '`:addBlank+0:`', null, '', true);\xFE";
 z+="                    break;\xFE";
 z+="                }\xFE";
 z+="            }\xFE";
 z+="         `\xFE";
 z+="         // QuotedUrl, jsSuccess, jsFailure, PostPayLoad, infoMsg, HeaderJSON, Ok2Cache)\xFE";
 z+="         S = S:@jsb_bf.Ajax('Url', A, Nothing, Nothing, Nothing, Nothing, true):`\xFE";
 z+="      }`\xFE";
 z+="\xFE";
 z+="    Return @jsb_html.Script(S:cascadingAttach2Parent(ID, ChangeOn_ParentID))"
window.cached_jsb_html["adddropdowncascadingevent"]=z;
var z="* addPick(ctlHtml, ctlID, popupTitle, popupWidth, popupHeight, popupUrl, onCloseSubmit)\xFE";
 z+="*\xFE";
 z+="*   popupUrl: will call popupUrl ? fromUrl=xxx & fromValue=yyy\xFE";
 z+="*\xFE";
 z+="*     - use @paramVar(\"fromValue\")\xFE";
 z+="*     - and close with @response.redirect(\"close_html?ans=\" & UrlEncode(newValue))\xFE";
 z+="*\xFE";
 z+="* or use\xFE";
 z+="*    Pick Function(fromUrl, fromValue)\xFE";
 z+="*    Return NewValue\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="function addPick(byVal ctlHtml As String, byVal putResultInID As String, byVal popupTitle As String, byVal popupWidth As String, byVal popupHeight As String, byVal popupUrl As String, byVal onCloseSubmit As String) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As Array\xFE";
 z+="    Dim FI As Integer\xFE";
 z+="    Dim CLOSESUBMIT As String\xFE";
 z+="    Dim UNIQUEID As String\xFE";
 z+="    Dim C2 As String\xFE";
 z+="\xFE";
 z+="    if !popupHeight Then popupHeight = \"auto\"\xFE";
 z+="    if !popupWidth Then popupWidth = \"auto\"\xFE";
 z+="\xFE";
 z+="    if Val(popupHeight) <> popupHeight Then popupHeight = '\"':popupHeight:'\"'\xFE";
 z+="    if Val(popupWidth) <> popUpWidth Then popupWidth = '\"':popupWidth:'\"'\xFE";
 z+="    if onCloseSubmit Then CloseSubmit = \"true\" else CloseSubmit = \"false\"\xFE";
 z+="\xFE";
 z+="    If putResultInID Then \xFE";
 z+="        uniqueID = putResultInID:\"_pick\"\xFE";
 z+="        putResultInID =  \"'\":putResultInID:\"'\" \xFE";
 z+="    else \xFE";
 z+="        putResultInID = `$(btn).parent().next().find('input')`\xFE";
 z+="        uniqueID = \"pickBtn_\":NewGuid()\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Html = []\xFE";
 z+="\xFE";
 z+="    C2 = @jsb_html.Button(uniqueID, '...', [`onclick='popup4_`:uniqueID:`(this)'`, `style=' min-height: 1.8em; padding: 0; min-width:24px !important'`])\xFE";
 z+="\xFE";
 z+="    Fi = InStr(ctlHtml, `<div class='fieldSetBtnsDiv'`) \xFE";
 z+="    If FI Then\xFE";
 z+="        FI = InStr(FI, ctlHtml, \"</div>\")\xFE";
 z+="        C2 = Left(ctlHtml, FI-1):Chr(29):C2:Chr(28):Mid(ctlHtml, FI)\xFE";
 z+="    Else\xFE";
 z+="        C2 = @jsb_html.Cols2(\"%\", ctlHtml, \"26px\", C2, \"\", \"\", \"overflow-x: hidden\")\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Html[-1] = C2\xFE";
 z+="    Html[-1] = Chr(28):`<script type=\"text/javascript\">`\xFE";
 z+="    Html[-1] = `   function popup4_`:uniqueID:`(btn) {`\xFE";
 z+="    Html[-1] = `       var url = `:jsEscapeString(popupUrl)\xFE";
 z+="    Html[-1] = `       var toTxtBox = findMyCompanion(btn, `:putResultInID:`)`\xFE";
 z+="    Html[-1] = `       setTimeout(function() { `\xFE";
 z+="    Html[-1] = `          if (InStr(url, '?') == -1) url += \"?\"; else url += \"&\"`\xFE";
 z+="    Html[-1] = `          url += \"fromUrl=\" + urlEncode(window.location)`\xFE";
 z+="    Html[-1] = `          url += \"&fromValue=\" + urlEncode(formVar(toTxtBox));`\xFE";
 z+="    Html[-1] = `          new popoutWindow(`:@jsEscapeString(popupTitle):`, url, `:popupWidth:`, `:popupHeight:`, `:CloseSubmit:`, toTxtBox)`\xFE";
 z+="    Html[-1] = `       }, 100);`\xFE";
 z+="    Html[-1] = `   }`\xFE";
 z+="    Html[-1] = `</script>`:Chr(29)\xFE";
 z+="\xFE";
 z+="    Return Join(Html, CRLF())\xFE";
 z+="end function"
window.cached_jsb_html["addpick"]=z;
window.cached_jsb_html["addpostbackpick"]="function addPostbackPick(byVal ctlHtml As String, ByVal btnName As String, ByVal btnValue As String, byVal functionName As String) As String\xFE    $options async-\xFE    \xFE    Dim Html As String = @jsb_html.SubmitBtn(btnName, btnValue, '...', [`style='width: 24px; height: 1.8em; padding: 0; min-width:24px !important'`])\xFE\xFE    Dim FI As Integer = InStr(ctlHtml, `<div class='fieldSetBtnsDiv'`) \xFE    If FI Then\xFE        FI = InStr(FI, ctlHtml, \"</div>\")\xFE        Html = Left(ctlHtml, FI-1):Chr(29):Html:Chr(28):Mid(ctlHtml, FI)\xFE    Else\xFE        Html = @jsb_html.Cols2(\"%\", ctlHtml, \"26px\", Html, \"\", \"\", \"overflow-x: hidden\")\xFE    end if\xFE\xFE    return Html\xFEend function";
var z="*\xFE";
 z+="* print addToCalendar('some title', '1 jan 2019', '3 jan 2019', 'some address', 'some description')\xFE";
 z+="*\xFE";
 z+="function addToCalendar(byval Title As String, byval startDate As StRiNg, byval DurationMinutesOrEndDate As String, byval Address As String, byval Description As String) As StRiNg\xFE";
 z+="    $options aspxc-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim DURATION As String\xFE";
 z+="    Dim STOPDATE As String\xFE";
 z+="    \xFE";
 z+="    Html =  @Head(@JSLink(@Jsbroot:\"js/ouical.js\"))\xFE";
 z+="    Html := @Head(@CSSLink(@Jsbroot:\"css/ouical.css\"))\xFE";
 z+="    \xFE";
 z+="    Duration = \"null\"\xFE";
 z+="    stopDate = \"null\"\xFE";
 z+="    If Instr(DurationMinutesOrEndDate, ' ') Then stopDate = `new Date('`:DurationMinutesOrEndDate:`')` Else Duration = DurationMinutesOrEndDate\xFE";
 z+="    \xFE";
 z+="    Html := @Html(`<div class=\"new-cal\"></div>`)\xFE";
 z+="    \xFE";
 z+="    Html := @Script(`\xFE";
 z+="     debugger\xFE";
 z+="      var myCalendar = createCalendar({\xFE";
 z+="        options: {\xFE";
 z+="          class: 'my-class',\xFE";
 z+="          id: 'my-id'                               // You need to pass an ID. If you don't, one will be generated for you.\xFE";
 z+="        },\xFE";
 z+="        data: {\xFE";
 z+="          title: '`:HtmlEncode(title):`',     // Event title\xFE";
 z+="          start: new Date('`:startDate:`'),   // Event start date\xFE";
 z+="          duration: `:duration:`,                            // Event duration (IN MINUTES)\xFE";
 z+="          end: `:stopDate:`,     // You can also choose to set an end time.\xFE";
 z+="                                                    // If an end time is set, this will take precedence over duration\xFE";
 z+="          address: '`:HtmlEncode(address):`',\xFE";
 z+="          description: '`:HtmlEncode(description):`'\xFE";
 z+="        }\xFE";
 z+="      });\xFE";
 z+="\xFE";
 z+="      $('.new-cal').append(myCalendar);\xFE";
 z+="    `)\xFE";
 z+="    \xFE";
 z+="    Return Html\xFE";
 z+="End function"
window.cached_jsb_html["addtocalendar"]=z;
var z="// PRINT Anchor(\"http://www.google.com\", \"Open google in new tab\", { target: \"_blank\" } )\xFE";
 z+="// PRINT Anchor(jsbRootExecuteTclCmd(\"tcl command\"), \"Open google in new tab\", { target: \"_blank\" } )\xFE";
 z+="// AdditionalAttributes = { target: \"_blank\" }\xFE";
 z+="\xFE";
 z+="function Anchor(Byval IdOrURL As String, Optional Byval Url As String, Optional Byval Caption As Object, Optional Byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="*$options async-\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If isMissing(Url) Then\xFE";
 z+="        Url = IdOrURL\xFE";
 z+="        Caption = Url\xFE";
 z+="        IdOrURL = Null\xFE";
 z+="        \xFE";
 z+="    ElseIf isMissing(Caption) Then\xFE";
 z+="        Caption = Url\xFE";
 z+="        Url = IdOrURL\xFE";
 z+="        IdOrURL = Null\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If IsJson(Caption) Or IsArray(Caption) Then\xFE";
 z+="        AdditionalAttributes = Caption\xFE";
 z+="        If Instr(IdOrURL, \"/\") Or Instr(IdOrURL, `\\`) Then\xFE";
 z+="            Caption = Url\xFE";
 z+="            Url = IdOrURL\xFE";
 z+="            IdOrURL = ''\xFE";
 z+="        Else\xFE";
 z+="            Caption = Url\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html = Chr(28):`<a`\xFE";
 z+="    If IdOrURL Then Html := \" id='\":IdOrURL:\"' name='\":IdOrURL:\"'\"\xFE";
 z+="    Html := \" \":Join(@MergeAttribute(\"class\", \"Anchor\", \" \", AdditionalAttributes), \" \") ;* Removed Form-Control Because Of Width 100%\xFE";
 z+="\xFE";
 z+="    If Instr(Html, \"target=\") = 0 Then\xFE";
 z+="        If LCase(Left(Url, 4)) = \"http\" Or Left(Url, 1) = \"/\" Then Html := ` target=\"_top\"` Else Html := ` target=\"_parent\"`\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html := ` href=`:jsEscapeHREF(Url):`>`:Chr(29):Caption:Chr(28):`</a>`:Chr(29)\xFE";
 z+="    Return Html\xFE";
 z+="End function"
window.cached_jsb_html["anchor"]=z;
var z="* * HTML: AutoTextBox (3 versions, load by Values, Load by AJAX, and load by Include URL)\xFE";
 z+="*\xFE";
 z+="* Values is a ForEach Array.  Each Value can be \"Display,Value\"\xFE";
 z+="* print @AutoTextBox('id', ['Alpha', 'Brovo', 'Charle'], 'Brovo')\xFE";
 z+="*\xFE";
 z+="* ============================= Load by Values array Version =============================\xFE";
 z+="Function AutoTextBox(ByVal ID As String, byval VALUES As Object, ByVal DEFAULT As String, optional byval minLength As Integer, optional byval AdditionalAttributes As Object, optional byval multiValuedData As StRiNg, optional byval restrictToList As Integer, optional ByVal labelName As String, optional ByVal valueName As String) As StRiNg ;* 7 Parameters\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim VS As Array\xFE";
 z+="    Dim SUBDELIMITER As String\xFE";
 z+="    Dim V As String\xFE";
 z+="    Dim DISPLAY As String\xFE";
 z+="    Dim KEYPADTYPE As String\xFE";
 z+="    Dim ONFOCUS As String\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim AA As String\xFE";
 z+="    Dim IOPTS As Array\xFE";
 z+="\xFE";
 z+="    AA  = @MergeAttribute(\"class\", \"clearable\", \" \", AdditionalAttributes)\xFE";
 z+="    AA  = @MergeAttribute(\"class\", \"AutoTextBox\", \" \", AA)\xFE";
 z+="    AA  = Join(@MergeAttribute(\"class\", \"form-control\", \" \", AA), \" \")\xFE";
 z+="    if InStr(AA, `type=`) = 0 Then AA = AA:` type='text'`\xFE";
 z+="    if isMissing(restrictToList) then restrictToList = True\xFE";
 z+="\xFE";
 z+="    iOpts = []\xFE";
 z+="    \xFE";
 z+="    VS = makeArray(Values); SubDelimiter = @NI\xFE";
 z+="    V = Vs[LBound(VS)]\xFE";
 z+="    If !InStr(V, SubDelimiter) Then SubDelimiter = \"\"\xFE";
 z+="\xFE";
 z+="    if (SubDelimiter And multiValuedData) Or (SubDelimiter >= Chr(252)) Then\xFE";
 z+="        * Build list\xFE";
 z+="        V = Vs[1]\xFE";
 z+="        For Each V In Vs\xFE";
 z+="            If InStr(V, SubDelimiter) Then\xFE";
 z+="                Display = FIeld(V, SubDelimiter, 1)\xFE";
 z+="                V = Field(V, SubDelimiter, 2)\xFE";
 z+="            Else\xFE";
 z+="                Display = V\xFE";
 z+="            End If\xFE";
 z+="            iOpts[-1] = {label:Display,value:V}\xFE";
 z+="        Next\xFE";
 z+="    Else\xFE";
 z+="        iOpts = VS\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    if !minLength Then minLength = 1\xFE";
 z+="\xFE";
 z+="    If Len(DEFAULT) Then DEFAULT = ' value=\"':@jsb_bf.HtmlEncode(DEFAULT):'\"'\xFE";
 z+="    \xFE";
 z+="    KeyPadType = hasAttribute('mobilepad', AdditionalAttributes)\xFE";
 z+="    if InStr(`'\"`, left(keypadType,1)) and left(keypadType,1) = Right(keypadType,1) then keypadType = mid(keypadType, 2, len(keypadType) - 2)\xFE";
 z+="\xFE";
 z+="    if KeyPadType then\xFE";
 z+="        if left(KeyPadType,1) <> '[' Then KeyPadType = '\"':lcase(KeyPadType):'\"'\xFE";
 z+="        if KeyPadType = '\"full\"' then \xFE";
 z+="            onFocus = ` onfocus=`:@jsEscapeAttr(`if (isMobile() && !$(this).attr(\"readonly\") && $(window).width() > 700) $(this).keypad({layout: `:KeyPadType:` })`)\xFE";
 z+="        else\xFE";
 z+="            onFocus = ` onfocus=`:@jsEscapeAttr(`if (!$(this).attr(\"readonly\") && $(window).width() > 300) $(this).keypad({layout: `:KeyPadType:` })`)\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if ID then \xFE";
 z+="        HTML = CHR(28):`<input id='`:ID:`' name='`:ID:`' `:AA:' ':DEFAULT:onFocus:' />':CHR(29)\xFE";
 z+="        Html := @Script(`autoCompleteTextBox(\"#`:ID:`\" , `:json2string(iOpts):`, `:minLength:`, null, `:restrictToList+0:`, '`:labelName:`', '`:valueName:`');`)\xFE";
 z+="    Else\xFE";
 z+="        // knockout will supply ID and Name and do autoCompleteTextBox\xFE";
 z+="        iOpts = @HtmlEncode(json2string(iOpts))\xFE";
 z+="        HTML = CHR(28):`<input `:AA:onFocus:` `:DEFAULT:` myOpts='`:iOpts:`' minLength=`:minLength+0:` restrictToList=`:restrictToList+0:` labelName='`:labelName:`' valueName='`:valueName:`' />`:CHR(29)\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    RETURN HTML\xFE";
 z+="End Function"
window.cached_jsb_html["autotextbox"]=z;
var z="* ============================= AJAX Version =============================\xFE";
 z+="*\xFE";
 z+="* AJAX Load: Values/URL is Url is @jsbRootExecute(`aJaxCallName&_p1=randy`)\xFE";
 z+="*\xFE";
 z+="*    create a restful Function:\xFE";
 z+="*\xFE";
 z+="*       restful Function aJaxCallName(arg1)\xFE";
 z+="*          return ['this', 'is', 'a', 'load']\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="Function AutoTextBoxAJax(byval ID As String, byval URL As Object, optional byval DEFAULT As Object, optional byval minLength As Object, optional byval AdditionalAttributes As Object, optional byval restrictToList As Object, optional ByVal labelName As String, optional ByVal valueName As String) As String ;* 6 parameters\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim ONSUCCESS As String\xFE";
 z+="    Dim ONFAILURE As String\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If isArray(URL) Then Return @JSB_HTML.AutoTextBox(ID, URL, DEFAULT, minLength, [], true, restrictToList)\xFE";
 z+="    \xFE";
 z+="    if !minLength Then minLength = 1\xFE";
 z+="\xFE";
 z+="    OnSuccess = `\xFE";
 z+="          for(var key in json) { \xFE";
 z+="              autoCompleteTextBox( \"*#`:ID:`\", json[key], `:minLength:`, null, `:restrictToList+0:`, '`:labelName:`', '`:valueName:`');\xFE";
 z+="              break;\xFE";
 z+="           }`\xFE";
 z+="\xFE";
 z+="    OnFailure = `alert('failed AutoTextBox ajax call to `:URL:`; error: ' + textStatus)`\xFE";
 z+="\xFE";
 z+="    Html := @jsb_html.TextBox(ID, DEFAULT, false, AdditionalAttributes, null)\xFE";
 z+="\xFE";
 z+="    // QuotedUrl, jsSuccess, jsFailure, PostPayLoad, infoMsg, HeaderJSON, Ok2Cache)\xFE";
 z+="    Return Html:@Script(@jsb_bf.Ajax(jsEscapeHREF(URL), OnSuccess, OnFailure, Nothing, Nothing, Nothing, true))\xFE";
 z+="End Function"
window.cached_jsb_html["autotextboxajax"]=z;
var z="* ============================= HTML =============================\xFE";
 z+="*\xFE";
 z+="* Use Script Include to load AutoTextBox\xFE";
 z+="*\xFE";
 z+="* Print AutoTextBoxIncludeURL('id', \"https://jsonbasic.azurewebsites.net/js/fish.js\", \"loadedspecies\", \"\", 1)\xFE";
 z+="*\xFE";
 z+="* fish.js is:\xFE";
 z+="*    var loadedspecies = [\xFE";
 z+="*    {\"nid\": 16293, \"label\": \"American Shad (Alosa sapidissima)\"},\xFE";
 z+="*    {\"nid\": 19610, \"label\": \"Arctic Grayling (Thymallus arcticus)\"},\xFE";
 z+="*    {\"nid\": 17770, \"label\": \"Bear Lake Whitefish (Prosopium abyssicola)\"}, ...]\xFE";
 z+="*\xFE";
 z+="Function AutoTextBoxIncludeURL(byval ID As String, byval SrcUrl As String, byval ArrayID As String, optional byval DEFAULT As Object, optional byval minLength As Integer, optional byval AdditionalAttributes As Object, optional byval multiValuedData As Object, optional byval restrictToList As Integer, optional ByVal labelName As String, optional ByVal valueName As String) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim S As String\xFE";
 z+="\xFE";
 z+="    HTML = @Head(@JSLink(SrcUrl))\xFE";
 z+="    Html := @jsb_html.TextBox(ID, DEFAULT, false, AdditionalAttributes)\xFE";
 z+="    if !minLength Then minLength = 1\xFE";
 z+="\xFE";
 z+="    If ID Then\xFE";
 z+="        s = `autoCompleteTextBox(\"#`:ID:`\" , `:ArrayID:`, `:minLength:`, null, `:restrictToList+0:`, '`:labelName:`', '`:valueName:`');`\xFE";
 z+="        if system(1) = \"gae\" OR system(1) = \"aspx\" then S = `$( document ).ready( function () { `:S:` });`\xFE";
 z+="        Html := @Script(S)\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Return Html\xFE";
 z+="End Function"
window.cached_jsb_html["autotextboxincludeurl"]=z;
window.cached_jsb_html["backgroundcolor"]="function backgroundcolor(byval BackColor As String, byval Text As String) As String\xFE    $options async-\xFE    return Font(\"\", \"\", \"\", BackColor, Text)\xFEend function";
window.cached_jsb_html["bold"]="function bold(byval text As StRiNg) As String\xFE    $options async-\xFE    return Chr(28):\"<b>\":Chr(29):text:Chr(28):\"</b>\":Chr(29)";
window.cached_jsb_html["boldface"]="* see also h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEfunction boldface(byval text As StRiNg) As String\xFE    $options async-\xFE    return Chr(28):\"<b>\":Chr(29):text:Chr(28):\"</b>\":Chr(29)";
window.cached_jsb_html["br"]="function br() As String\xFE*$options async-\xFEreturn chr(28):\"<br />\":chr(29)";
var z="*\xFE";
 z+="* Print @jsb_html.Button('id', 'Click Me', { onclick: 'alert(\"OK\");', ondblclick: 'doJsbSubmit();' })\xFE";
 z+="*\xFE";
 z+="* Print @jsb_html.Button('id', 'Click Me', {}, false, \"danger\", \"large\") \xFE";
 z+="*\xFE";
 z+="* See also submitBtn (does postback), and saveBtn (does parsley check, and postback), and submitAnchor (a submit button that looks like an anchor)\xFE";
 z+="*\xFE";
 z+="* btnType: primary, secondary, success, warning, danger, link\xFE";
 z+="* btnSize: lg, sm\xFE";
 z+="function Button(byval ID As String, optional byval DisplayText As String, optional byval AdditionalAttributes As Object, optional byval bParsleyCheck As Boolean, optional byval btnType As String, optional byval btnSize As String) As String\xFE";
 z+="* $options async-\xFE";
 z+="  \xFE";
 z+="    if isMissing(AdditionalAttributes) Then\xFE";
 z+="        if isArray(DisplayText) Or isJson(DisplayText) Then\xFE";
 z+="            AdditionalAttributes = DisplayText\xFE";
 z+="            DisplayText = ID\xFE";
 z+="            ID = ''\xFE";
 z+="        End if\xFE";
 z+="    End If\xFE";
 z+="    if IsMissing(DisplayText) Then DisplayText = ID\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String = CHR(28):\"<button\"\xFE";
 z+="    Dim PC As String\xFE";
 z+="    IF ID THEN Html := \" id='\":ID:\"' name='\":ID:\"'\"\xFE";
 z+="\xFE";
 z+="    if bParsleyCheck Then PC = `if (!parsleyIsValid(true)) return false;` Else PC = `parsleyDestroy();`\xFE";
 z+="    Dim AA As Array = @MergeAttribute(\"onclick\", PC, \";\", AdditionalAttributes)\xFE";
 z+="\xFE";
 z+="    if hasAttribute(\"onclick\", AA) Or hasAttribute(\"data-bind\", AA) Then \xFE";
 z+="        Html := ` type='button'`\xFE";
 z+="    Else\xFE";
 z+="        Html := ` type='submit'`\xFE";
 z+="        PC := `assignBtn(this, `:@jsEscapeString(DisplayText, \"onclick\"):`); jsbClose(this); `\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    AA = @MergeAttribute(\"class\", \"Button\", \" \", AA)\xFE";
 z+="    if !btnType then btnType = \"default\"\xFE";
 z+="    if left(btnType, 4) <> \"btn-\" then btnType = \"btn-\":btnType\xFE";
 z+="    if Not(InStr(AA, \"btn-\")) Then AA = @MergeAttribute(\"class\", \"btn \":btnType, \" \", AA)\xFE";
 z+="\xFE";
 z+="    if btnSize Then\xFE";
 z+="        if left(btnSize, 4) <> \"btn-\" then btnSize = \"btn-\":btnSize\xFE";
 z+="        AA = @MergeAttribute(\"class\", btnSize, \" \", AA)\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Html := JoinAttributes(AA)\xFE";
 z+="    Html := \">\":Chr(29):@jsb_bf.Language(DisplayText):Chr(28):\"</button>&nbsp;\":CHR(29)\xFE";
 z+="\xFE";
 z+="    RETURN HTML\xFE";
 z+="end function"
window.cached_jsb_html["button"]=z;
var z="/*\xFE";
 z+="    Events = []\xFE";
 z+="    Events[-1] = \"2012-04-1\" : Vm() : \"Red\" : Vm() : \"Flag Day\"\xFE";
 z+="    Events[-1] = \"2012-04-10\" : Vm() : \"Yellow\" : Vm() : \"Flower Day\"\xFE";
 z+="    Events[-1] = \"2012-04-10\" : Vm() : \"Blue\" : Vm() : Anchor(\"http://www.google.com\", \"Open google in new tab\", { Target : \"_blank\", Title:\"New Tab\" })\xFE";
 z+="    \xFE";
 z+="    Print Calendar(2012, 4, Events, \"\", \"table-layout: fixed; width:100%; height: 300px\")\xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="Function Calendar(byval Year As String, byval Month As String, byval Events As Array, byval tableClass As String, byval tableStyle As String) As String\xFE";
 z+="    $options aspxc-\xFE";
 z+="\xFE";
 z+="    Dim ADDITIONALATTRIBUTES As Array\xFE";
 z+="    Dim DAY As Integer\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim CELLS As Array\xFE";
 z+="    \xFE";
 z+="    // Get 1st of the month\xFE";
 z+="    Dim DT As String = Year : \"-\" : Month : \"-1\"  // YYYY-MM-1\xFE";
 z+="    Dim OFFSET As Integer = Date(Dt) Mod 7\xFE";
 z+="*\xFE";
 z+="* Plug in the days\xFE";
 z+="*\xFE";
 z+="    CELLS = []\xFE";
 z+="    For Day = 1 To 32\xFE";
 z+="        Dim NEWDATE As String = Year : \"-\" : Month : \"-\" : Day\xFE";
 z+="        If Day>28 Then\xFE";
 z+="            Dim MONTHCHECK As String = Date(NewDate)\xFE";
 z+="            MonthCheck = Date(MonthCheck)\xFE";
 z+="            MonthCHeck = Field(MonthCheck, \"-\", 2)\xFE";
 z+="            If MonthCheck <> Month Then Break\xFE";
 z+="        End If\xFE";
 z+="        Cells[Day + Offset] = Day\xFE";
 z+="    Next\xFE";
 z+="*\xFE";
 z+="* Plug in the Events\xFE";
 z+="*\xFE";
 z+="    For each EVENT As String In Events\xFE";
 z+="        Dim EVENTDAY As String = Field(Event, Vm(), 1)\xFE";
 z+="        \xFE";
 z+="        If Field(EventDay, \"-\", 2) = Month And Field(EventDay, \"-\", 1) = Year Then\xFE";
 z+="            Day = Field(EventDay, \"-\", 3)\xFE";
 z+="            Dim COLOR As String = Field(Event, Vm(), 2)\xFE";
 z+="            Dim DESC As String = Field(Event, Vm(), 3)\xFE";
 z+="            \xFE";
 z+="            If Instr(Desc, Chr(28)) Then\xFE";
 z+="                Cells[Day + Offset]<-1> = Desc\xFE";
 z+="            Else\xFE";
 z+="                Cells[Day + Offset]<-1> = @jsb_html.SPAN('', Desc, Nothing, { Title : Desc, Style : \"color: \" : Color })\xFE";
 z+="            End If\xFE";
 z+="        End\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    Dim HEADER As String = @CalendarColumns(\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\")\xFE";
 z+="    Dim ROW2 As String = @CalendarColumns(Cells[1], Cells[2], Cells[3], Cells[4], Cells[5], Cells[6], Cells[7])\xFE";
 z+="    Dim ROW3 As String = @CalendarColumns(Cells[8], Cells[9], Cells[10], Cells[11], Cells[12], Cells[13], Cells[14])\xFE";
 z+="    Dim ROW4 As String = @CalendarColumns(Cells[15], Cells[16], Cells[17], Cells[18], Cells[19], Cells[20], Cells[21])\xFE";
 z+="    Dim ROW5 As String = @CalendarColumns(Cells[22], Cells[23], Cells[24], Cells[25], Cells[26], Cells[27], Cells[28])\xFE";
 z+="    Dim ROW6 As String = @CalendarColumns(Cells[29], Cells[30], Cells[31], Cells[32], Cells[33], Cells[34], Cells[35])\xFE";
 z+="    Dim ROW7 As String = \"\"\xFE";
 z+="    If Cells[36] Then\xFE";
 z+="        Row7 = @CalendarColumns(Cells[36], Cells[37], Cells[38], Cells[39], Cells[40], Cells[41], Cells[42])\xFE";
 z+="    End\xFE";
 z+="    \xFE";
 z+="    Html = @CalendarRows(Header, Row2, Row3, Row4, Row5, Row6, Row7)\xFE";
 z+="   \xFE";
 z+="    AdditionalAttributes = []\xFE";
 z+="    If tableClass Then AdditionalAttributes[-1] = \"class='\" : tableClass : \"'\"\xFE";
 z+="    If tableStyle Then AdditionalAttributes[-1] = \"style='\" : tableStyle : \"'\"\xFE";
 z+="    AdditionalAttributes[-1] = \"border='1'\"\xFE";
 z+="    Html = @jsb_html.TABLE(\"\", Html, AdditionalAttributes)\xFE";
 z+="\xFE";
 z+="    Return Html\xFE";
 z+="End Function"
window.cached_jsb_html["calendar"]=z;
window.cached_jsb_html["calendarcolumns"]="Function CalendarColumns(byval C1Content As StRiNg, byval C2Content As StRiNg, byval C3Content As StRiNg, byval C4Content As StRiNg, byval C5Content As StRiNg, byval C6Content As StRiNg, byval C7Content As StRiNg) As StRiNg\xFE    $options aspxc-\xFE    \xFE    Dim HTML As String\xFE\xFE    Html = calendarTD(C2Content)\xFE    Html := calendarTD(C2Content)\xFE    Html := calendarTD(C3Content)\xFE    Html := calendarTD(C4Content)\xFE    Html := calendarTD(C5Content)\xFE    Html := calendarTD(C6Content)\xFE    Html := calendarTD(C7Content)\xFE   \xFE    Return Html\xFEEnd Function";
var z="Function CalendarRows(byval HeaderRow As String, byval R2Content As String, byval R3Content As String, byval R4Content As String, byval R5Content As String, byval R6Content As String, byval R7Content As String) As String\xFE";
 z+="    $options aspxc-\xFE";
 z+="    \xFE";
 z+="    Dim ADDITIONALATTRIBUTES As Array\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    AdditionalAttributes = []\xFE";
 z+="\xFE";
 z+="    Html = @jsb_html.TR(HeaderRow, \"class='calendarRow calendarRowHeader'\")\xFE";
 z+="    \xFE";
 z+="    Html := @jsb_html.TR(R2Content, \"class='calendarRow'\")\xFE";
 z+="    Html := @jsb_html.TR(R3Content, \"class='calendarRow'\")\xFE";
 z+="    Html := @jsb_html.TR(R4Content, \"class='calendarRow'\")\xFE";
 z+="    Html := @jsb_html.TR(R5Content, \"class='calendarRow'\")\xFE";
 z+="    Html := @jsb_html.TR(R6Content, \"class='calendarRow'\")\xFE";
 z+="    Html := @jsb_html.TR(R7Content, \"class='calendarRow'\")\xFE";
 z+="\xFE";
 z+="    Return Html\xFE";
 z+="End Function"
window.cached_jsb_html["calendarrows"]=z;
window.cached_jsb_html["calendartd"]="Function calendarTD(byval CalCell As String, optional byval isHeader As StRiNg) As StRiNg\xFE    $options aspxc-\xFE    \xFE    Dim ADDITIONALATTRIBUTES As Array\xFE    Dim L As Integer\xFE    Dim CONTENT As String\xFE    Dim CLASSNAME As String\xFE    Dim THEDAY As String\xFE    Dim CELL As String\xFE\xFE    theDay = CalCell<1>\xFE    Cell = @Bold(theDay)\xFE    For L = 2 To Dcount(CalCell, AM())\xFE        Content = CalCell<L>\xFE        If !Content Then Content = @Html('&nbsp;')\xFE        Cell := @Br : Content\xFE    Next\xFE    if isHeader then className = \"calendarHD\" else className = \"calendarTD\"  \xFE    AdditionalAttributes = [\"valign='top'\", \"class='\":className:\"'\"]\xFE    Return @jsb_html.TD(Cell, AdditionalAttributes)\xFEEnd Function";
var z="* ============================= HTML =============================\xFE";
 z+="*\xFE";
 z+="* Pass the parent ID of a ComboBox, or something with a change event.\xFE";
 z+="*\xFE";
 z+="* Example:\xFE";
 z+="*\xFE";
 z+="*   Print @(-1):\"Select your state: \":@jsb_html.DropDownBox('ParentID', ['California', 'Alaska', 'New York', 'New Jersey'])\xFE";
 z+="*   QuotedUrl = `'`:@jsbRootExecute(`cities?arg={id}'`)\xFE";
 z+="*   Print @jsb_html.cascadingDropDownBox(\"childID\", \"ParentID\", QuotedUrl, false, \"\")\xFE";
 z+="*\xFE";
 z+="*    restful function cities(arg)\xFE";
 z+="*       a = []\xFE";
 z+="*       a[-1] = { Description:\"\", InspectorLevelID: 0 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-boise\", InspectorLevelID: 1 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-slc\", InspectorLevelID: 2 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-la\", InspectorLevelID: 3 }\xFE";
 z+="*       b = {}\xFE";
 z+="*       b.cities = a\xFE";
 z+="*       return b\xFE";
 z+="*   end function\xFE";
 z+="*\xFE";
 z+="* ============================= HTML =============================\xFE";
 z+="function cascadingAJaxDropDownBox(byval ID As String, byval ChangeOn_ParentID As String, byval QuotedUrl As String, optional byval addBlank As Boolean, optional byval Default As Object, optional byval AdditionalAttributes As Object, optional byval DesciptionField As String, optional byval ValueField As String) As String\xFE";
 z+="   $options async-\xFE";
 z+="   \xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim S As String\xFE";
 z+="    Dim A As String\xFE";
 z+="\xFE";
 z+="    if ValueField = \"\" Then ValueField = DesciptionField\xFE";
 z+="    if DesciptionField = \"\" Then DesciptionField = ValueField\xFE";
 z+="    \xFE";
 z+="    Html = @DropDownBox(ID, [], DEFAULT, ADDBLANK, false, AdditionalAttributes, false)\xFE";
 z+="    \xFE";
 z+="    If !ID Then Return Html // knockout will supply ID and Name and do cascadingDDBox($element)\xFE";
 z+="\xFE";
 z+="    S = `\xFE";
 z+="       ajaxLoadOptions(Ctl, Url, AutoPostBack, AddIfNotInList, AddBlank, DesciptionField, ValueField, isKnockOut)\xFE";
 z+="       \xFE";
 z+="      function `:ID:`_`:ChangeOn_ParentID:`_OnChange(pObj, newid, ddbox) {\xFE";
 z+="            var parentObj = pObj;\xFE";
 z+="            var dropDownBox = ddbox;\xFE";
 z+="            \xFE";
 z+="            if (!dropDownBox) dropDownBox = findMyCompanion(parentObj, '`:ID:`')\xFE";
 z+="            if (!dropDownBox) return alert('unable to find matching companion for `:ID:`');\xFE";
 z+="            \xFE";
 z+="            // Check if already loaded \xFE";
 z+="            var lastFetch = CStr($(parentObj).data('lastFetch_`:ID:`'));\xFE";
 z+="            if (lastFetch == \"..pending..\") return\xFE";
 z+="            \xFE";
 z+="            if (lastFetch && lastFetch == CStr(newid)) {\xFE";
 z+="                var a = $(parentObj).data('lastFetchData_`:ID:`');\xFE";
 z+="                //                    Ctl,      a,    ValueField,       DesciptionField,       addBlank,      dft,  subDel\xFE";
 z+="                if (a) loadOptions(dropDownBox, a, '`:ValueField:`', '`:DesciptionField:`', '`:addBlank+0:`', null, '', true);\xFE";
 z+="                return\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            if (formVar(pObj) != newid) window._isDirty = true;\xFE";
 z+="            \xFE";
 z+="            var Url = `:QuotedUrl:`;\xFE";
 z+="            var NewID = newid;\xFE";
 z+="            Url = urlCtlSubstitutions(Url, { id: newid, `:ChangeOn_ParentID:`: newid })\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', \"..pending..\");\xFE";
 z+="        `\xFE";
 z+="        \xFE";
 z+="        * OnSuccess for AJax\xFE";
 z+="        A = `\xFE";
 z+="            $(parentObj).data('lastFetchData_`:ID:`', []);\xFE";
 z+="            for(var key in json) { \xFE";
 z+="               var a = json[key];\xFE";
 z+="                if (isArray(a)) { \xFE";
 z+="                    $(parentObj).data('lastFetchData_`:ID:`', a);\xFE";
 z+="                    break;\xFE";
 z+="                }\xFE";
 z+="            }\xFE";
 z+="            //             Ctl,      a,    ValueField,       DesciptionField,       addBlank,      dft,  subDel\xFE";
 z+="            loadOptions(dropDownBox, a, '`:ValueField:`', '`:DesciptionField:`', '`:addBlank+0:`', null, '', true);\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', NewID);\xFE";
 z+="         `\xFE";
 z+="         \xFE";
 z+="         // QuotedUrl, jsSuccess, jsFailure, PostPayLoad, infoMsg, HeaderJSON, Ok2Cache)\xFE";
 z+="         S = S:@jsb_bf.Ajax('Url', A, Nothing, Nothing, Nothing, Nothing, true):`\xFE";
 z+="      }`\xFE";
 z+="\xFE";
 z+="      \xFE";
 z+="    Html :=  @jsb_html.Script(S:cascadingAttach2Parent(ID, ChangeOn_ParentID))\xFE";
 z+="    \xFE";
 z+="    Return Html\xFE";
 z+="end function"
window.cached_jsb_html["cascadingajaxdropdownbox"]=z;
var z="// You must create a javascript routine to handle the change\xFE";
 z+="// it should be named: childID:`_`:parentID:`_OnChange(parentCtl, newValue, childCtl, eventIsOnChange)\xFE";
 z+="\xFE";
 z+="function cascadingAttach2Parent(ByVal childID As String, byval parentID As String, optional byval forKnockOut As Boolean) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    Dim S As String\xFE";
 z+="    Dim P As String \xFE";
 z+="    \xFE";
 z+="    if forKnockOut Then\xFE";
 z+="        P = `element, data, index, extra`\xFE";
 z+="        S = `function `:childID:`_`:parentID:`_check(`:P:`) {\xFE";
 z+="            var parentID = 'KO_`:parentID:`_' + index();\xFE";
 z+="            var childID = '`:childID:`_' + index();\xFE";
 z+="        `\xFE";
 z+="    else\xFE";
 z+="        S = `function `:childID:`_`:parentID:`_check() { \xFE";
 z+="              var parentID = '`:parentID:`';\xFE";
 z+="              var childID = '`:childID:`';\xFE";
 z+="        `\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    S := `\xFE";
 z+="          // find the parent\xFE";
 z+="          var parentCtl = $(\"[id=\" + parentID + \"]\")\xFE";
 z+="          var childCtl = $(\"[id=\" + childID + \"]\")\xFE";
 z+="          \xFE";
 z+="          if (!$(parentCtl).length || !$(childCtl).length) return setTimeout(function () { `:childID:`_`:parentID:`_check(`:P:`) }, 100);\xFE";
 z+="    \xFE";
 z+="          // Get future notificaion for all parents (*#)\xFE";
 z+="          if ($(parentCtl).hasClass('ms-ctn')) {\xFE";
 z+="            ms = parentCtl.magicSuggest()\xFE";
 z+="\xFE";
 z+="            $(ms).on('selectionchange', function() {\xFE";
 z+="                var msData = ms.getSelection();\xFE";
 z+="                if (msData.length) msData = msData[0].name; else msData = null;\xFE";
 z+="                `:childID:`_`:parentID:`_OnChange(parentCtl, msData, childCtl, false)\xFE";
 z+="            })\xFE";
 z+="            \xFE";
 z+="          } else {\xFE";
 z+="              $(parentCtl).on('autocompletechange', function (e,u) { `:childID:`_`:parentID:`_OnChange(parentCtl, $(this).val(), childCtl, false) } ); \xFE";
 z+="              $(parentCtl).on('autocompleteselect', function (e,u) { `:childID:`_`:parentID:`_OnChange(parentCtl, u.item.value, childCtl, false) } );\xFE";
 z+="              $(parentCtl).on('change',             function (e,u) { `:childID:`_`:parentID:`_OnChange(parentCtl, $(this).val(), childCtl, false) });\xFE";
 z+="          }\xFE";
 z+="          \xFE";
 z+="          // Force one change now\xFE";
 z+="          `:childID:`_`:parentID:`_OnChange(parentCtl, formVar('`:parentID:`'), childCtl, true) \xFE";
 z+="    }`\xFE";
 z+="      \xFE";
 z+="      \xFE";
 z+="    if (!forKnockOut) then\xFE";
 z+="        S := ` \xFE";
 z+="          $( document ).ready(function() {\xFE";
 z+="              // We need inline scripts to run before firing AJAX calls. (MagicSelect Controls needs to run first)\xFE";
 z+="              setTimeout(window.`:childID:`_`:parentID:`_check, 100);\xFE";
 z+="          });\xFE";
 z+="        `\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    return S\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+=""
window.cached_jsb_html["cascadingattach2parent"]=z;
var z="* ============================= HTML =============================\xFE";
 z+="*\xFE";
 z+="* Pass the parent ID of a ComboBox, or something with a change event.\xFE";
 z+="*\xFE";
 z+="* Example:\xFE";
 z+="*\xFE";
 z+="*   Print @(-1):\"Select your state: \":@jsb_html.DropDownBox('ParentID', ['California', 'Alaska', 'New York', 'New Jersey'])\xFE";
 z+="*   QuotedUrl = @jsbRootExecute(`?cities&arg={id}`, True)\xFE";
 z+="*   Print @jsb_html.CascadingAutoTextBox(\"childID\", \"ParentID\", QuotedUrl)\xFE";
 z+="*\xFE";
 z+="*    restful function cities(arg)\xFE";
 z+="*       a = []\xFE";
 z+="*       a[-1] = { Description:\"\", InspectorLevelID: 0 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-boise\", InspectorLevelID: 1 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-slc\", InspectorLevelID: 2 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-la\", InspectorLevelID: 3 }\xFE";
 z+="*       b = {}\xFE";
 z+="*       b.cities = a\xFE";
 z+="*       return b\xFE";
 z+="*   end function\xFE";
 z+="*\xFE";
 z+="function CascadingAutoTextBox(byval ID As String, byval ChangeOn_ParentID As String, byval QuotedUrl As String, optional byval DEFAULT As Object, optional byval minLength As Object, optional byval AdditionalAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if IsMissing(minLength) Then minLength = 1\xFE";
 z+="    HTML = @AutoTextBox(ID, [], DEFAULT, minLength, AdditionalAttributes)\xFE";
 z+="    If !ID Then Return Html // knockout will supply ID and Name and do cascadingDDBox($element)\xFE";
 z+="    \xFE";
 z+="    Dim jsRoutine As String = `autoCompleteTextBox(childCtl, a, `:Val(minLength):`, null / CompanionID */, true /* restrictToList */)`\xFE";
 z+="    Html := @reloadDataListFromUrl_OnParent_Change(ID, ChangeOn_ParentID, QuotedUrl, jsRoutine)\xFE";
 z+="\xFE";
 z+="    Return Html:@jsb_html.Script(cascadingAttach2Parent(ID, ChangeOn_ParentID))\xFE";
 z+="end function"
window.cached_jsb_html["cascadingautotextbox"]=z;
var z="* ============================= HTML =============================\xFE";
 z+="*\xFE";
 z+="* Pass the parent ID of a ComboBox, or something with a change event.\xFE";
 z+="*\xFE";
 z+="* Example:\xFE";
 z+="*\xFE";
 z+="*   Print @(-1):\"Select your state: \":@jsb_html.DropDownBox('ParentID', ['California', 'Alaska', 'New York', 'New Jersey'])\xFE";
 z+="*   QuotedUrl = @jsbRootExecute(`?cities&arg={id}`, True)\xFE";
 z+="*   Print @jsb_html.CascadingComboBox(\"childID\", \"ParentID\", QuotedUrl, \"\", 1, \"Description\", \"InspectorLevelID\", [])\xFE";
 z+="*\xFE";
 z+="*    restful function cities(arg)\xFE";
 z+="*       a = []\xFE";
 z+="*       a[-1] = { Description:\"\", InspectorLevelID: 0 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-boise\", InspectorLevelID: 1 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-slc\", InspectorLevelID: 2 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-la\", InspectorLevelID: 3 }\xFE";
 z+="*       b = {}\xFE";
 z+="*       b.cities = a\xFE";
 z+="*       return b\xFE";
 z+="*   end function\xFE";
 z+="*\xFE";
 z+="* ============================= HTML =============================\xFE";
 z+="FUNCTION CascadingComboBox(byval ID As String, byval ChangeOn_ParentID As String, byval QuotedUrl As String, byval DEFAULT As Object, byval addBlank As Boolean, byval DescriptionField As String, byval ValueField As String, optional byval AdditionalAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    HTML = @ComboBox(ID, [], DEFAULT, addBlank, DescriptionField, ValueField, AdditionalAttributes)\xFE";
 z+="    If !ID Then Return Html // knockout will supply ID and Name and do cascadingDDBox($element)\xFE";
 z+="    \xFE";
 z+="    Html := @addComboBoxCascadingEvent(ID, ChangeOn_ParentID, QuotedUrl, addBlank, DescriptionField, ValueField, AdditionalAttributes)\xFE";
 z+="    Return Html:@jsb_html.Script(cascadingAttach2Parent(ID, ChangeOn_ParentID))\xFE";
 z+="end function"
window.cached_jsb_html["cascadingcombobox"]=z;
var z="* ============================= HTML =============================\xFE";
 z+="*\xFE";
 z+="* Pass the parent ID of a ComboBox, or something with a change event.\xFE";
 z+="*\xFE";
 z+="* Example:\xFE";
 z+="*\xFE";
 z+="*   Print @(-1):\"Select your state: \":@jsb_html.DropDownBox('ParentID', ['California', 'Alaska', 'New York', 'New Jersey'])\xFE";
 z+="*   QuotedUrl = `'`:@jsbRootExecute(`cities?arg={id}'`)\xFE";
 z+="*   Print @jsb_html.cascadingDropDownBox(\"childID\", \"ParentID\", QuotedUrl, false, \"\")\xFE";
 z+="*\xFE";
 z+="*    restful function cities(arg)\xFE";
 z+="*       a = []\xFE";
 z+="*       a[-1] = { Description:\"\", InspectorLevelID: 0 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-boise\", InspectorLevelID: 1 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-slc\", InspectorLevelID: 2 }\xFE";
 z+="*       a[-1] = { Description: arg:\"-la\", InspectorLevelID: 3 }\xFE";
 z+="*       b = {}\xFE";
 z+="*       b.cities = a\xFE";
 z+="*       return b\xFE";
 z+="*   end function\xFE";
 z+="*\xFE";
 z+="* ============================= HTML =============================\xFE";
 z+="function cascadingDropDownBox(byval ID As String, byval ChangeOn_ParentID As String, byval QuotedUrl As String, optional byval addBlank As Boolean, optional byval Default As Object, optional byval AdditionalAttributes As Object, optional byval DesciptionField As String, optional byval ValueField As String) As String\xFE";
 z+="   $options async-\xFE";
 z+="   \xFE";
 z+="   Dim HTML As String = @DropDownBox(ID, [], DEFAULT, ADDBLANK, false, AdditionalAttributes, false)\xFE";
 z+="   If !ID Then Return Html // knockout will supply ID and Name and do cascadingDDBox($element)\xFE";
 z+="   \xFE";
 z+="   Html := @addDropDownCascadingEvent(ID, ChangeOn_ParentID, QuotedUrl, addBlank, DesciptionField, ValueField)\xFE";
 z+="   Return Html\xFE";
 z+="end function"
window.cached_jsb_html["cascadingdropdownbox"]=z;
window.cached_jsb_html["center"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFE* Print @Center(\"I'm in the middle\")\xFE\xFEFUNCTION Center(ByVal Content As StRiNg, optional byval AdditionalAttributes As Object) As StRiNg\xFE* $options async-\xFE    Dim HTML As String\xFE\xFE    AdditionalAttributes = MergeAttribute('style', 'width: 100%; text-align:center', ';', AdditionalAttributes)\xFE    HTML = CHR(28):\"<div\":joinAttributes(AdditionalAttributes):\">\":CHR(29):CONTENT:CHR(28):\"</div>\":CHR(29)\xFERETURN HTML";
var z="// Example1:\xFE";
 z+="//    mydata = [\xFE";
 z+="//      { Year: 2004, Sales: 100, Expenses: 100 },\xFE";
 z+="//      { Year: 2005, Sales: 150, Expenses: 200 },\xFE";
 z+="//      { Year: 2006, Sales: 580, Expenses: 300 }]\xFE";
 z+="//\xFE";
 z+="//    Print @Chart(\"myID\", mydata)\xFE";
 z+="//\xFE";
 z+="//    *Print @(-1):@Chart(\"myID\", \"ScatterChart\", \"Revenue\", \"Dollars\", \"Years\", [{ Year: '2004', Sales: 100, Expenses: 100 }, { Year: '2005', Sales: 150, Expenses: 200 }, { Year: '2006', Sales: 180, Expenses: 300 }])\xFE";
 z+="//\xFE";
 z+="// ChartTypes:\xFE";
 z+="//     ColumnChart or BarChart (horizontal)\xFE";
 z+="//     LineChart\xFE";
 z+="//     AreaChart\xFE";
 z+="//     PieChart\xFE";
 z+="//\xFE";
 z+="function Chart(Byval chartID As String, Byval RestNameOrArray As Object, Optional Byval ChartType As String, Optional Byval Title As StRiNg, Optional Byval vTitle As StRiNg, Optional Byval hTitle As StRiNg) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim S As String\xFE";
 z+="\xFE";
 z+="    if !ChartType Then ChartType = \"ColumnChart\"\xFE";
 z+="    If !chartID Then chartID = \"chart_\":Rnd(99999)\xFE";
 z+="\xFE";
 z+="    HTML = @Head(@JSLink(\"//www.google.com/jsapi\"))\xFE";
 z+="    \xFE";
 z+="    Html := Chr(28):`<div id='`:chartID:`' style=\"position: relative; overflow: hidden; background-color: transparent;\" ></div>`:Crlf():Chr(29)\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    S = `\xFE";
 z+="      google.load('visualization', '1.0', {'packages':['corechart'], 'callback': 'drawChart_`:chartID:`()'});\xFE";
 z+="\xFE";
 z+="      function drawChart_`:chartID:`() {`\xFE";
 z+="    \xFE";
 z+="    If TypeOf(RestNameOrArray) = \"Array\" Then\xFE";
 z+="        S = S:`\xFE";
 z+="         window.refreshData = function () {  }\xFE";
 z+="         var jsonData = [`:Join(@chartDefaultModel(RestNameOrArray), \",\"):`];\xFE";
 z+="         var data = new google.visualization.arrayToDataTable(jsonData);\xFE";
 z+="      `\xFE";
 z+="    Else\xFE";
 z+="        S = S:`\xFE";
 z+="         window.refreshData = function () { }\xFE";
 z+="\xFE";
 z+="         var jsonData =$(\"#`:chartID:`\").ajax({\xFE";
 z+="             url:`:jsEscapeString(RestNameOrArray):`,\xFE";
 z+="             datatype: \"json\",\xFE";
 z+="               async: false\xFE";
 z+="         }).responseText;\xFE";
 z+="      `\xFE";
 z+="    End If\xFE";
 z+="    S = S:`\xFE";
 z+="\xFE";
 z+="          var options = {\xFE";
 z+="            title: '`:Title:`',\xFE";
 z+="            hAxis: {title: '`:hTitle:`' },\xFE";
 z+="            vAxis: {title: '`:vTitle:`' }\xFE";
 z+="\xFE";
 z+="          };\xFE";
 z+="\xFE";
 z+="         // Instantiate and draw our chart, passing in some options.\xFE";
 z+="         var chart = new google.visualization.`:ChartType:`(document.getElementById('`:chartID:`'));\xFE";
 z+="         chart.draw(data, options);\xFE";
 z+="\xFE";
 z+="      }\xFE";
 z+="   `\xFE";
 z+="\xFE";
 z+="    Return Html:@Jsb_html.Script(S)\xFE";
 z+="End function"
window.cached_jsb_html["chart"]=z;
window.cached_jsb_html["chartdefaultmodel"]="function chartDefaultModel(byval Rows As Array) As Array\xFE    $options async-\xFE    \xFE    Dim COLS As Array\xFE    Dim DROWS As Array\xFE    Dim A As Array\xFE    Dim ROW As Json\xFE    Dim TN As StRiNg\xFE    Dim TE As StRiNg\xFE    Dim V As StRiNg\xFE\xFE    Cols = []\xFE\xFE    If Len(Rows) Then\xFE        For Each Tn In Rows[1]\xFE            Cols[-1] = Tn\xFE        Next\xFE    End If\xFE\xFE    DRows = []\xFE    DRows[-1] = \"['\":Join(Cols, \"','\"):\"']\"\xFE    For Each Row In Rows\xFE        A = []\xFE        For Each Te In Cols\xFE            V = Row[Te]\xFE            If TypeOf(V) = \"String\" Then A[-1] = \"'\":Row[Te]:\"'\" Else A[-1] = Row[Te]\xFE        Next\xFE        DRows[-1] = \"[\":Join(A, \",\"):\"]\"\xFE    Next\xFE\xFE    Return DRows\xFEEnd function";
var z="function CHECKBOX(ByVal ID As String, Byval Value As String, Optional Byval Description As Object, Optional Byval Checked As Object, Optional Byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim READONLY As Boolean\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If isJson(Description) Or IsArray(Description) Then\xFE";
 z+="        AdditionalAttributes = Description\xFE";
 z+="        Description = ''\xFE";
 z+="        \xFE";
 z+="    ElseIf isJson(Checked) Or IsArray(Checked) Then\xFE";
 z+="        AdditionalAttributes = Checked\xFE";
 z+="        Checked = False\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    readOnly = hasattribute('readonly', AdditionalAttributes) Or hasattribute('disabled', AdditionalAttributes)\xFE";
 z+="    \xFE";
 z+="    if readOnly then\xFE";
 z+="        AdditionalAttributes = @MergeAttribute(\"class\", \"form-control CheckBoxSpan_readonly\", \" \", AdditionalAttributes)\xFE";
 z+="    else\xFE";
 z+="        AdditionalAttributes = @MergeAttribute(\"class\", \"form-control CheckBoxSpan\", \" \", AdditionalAttributes)\xFE";
 z+="    end if\xFE";
 z+="   \xFE";
 z+="    Html = Chr(28):`<span `:@uiAdditionalAttributes(AdditionalAttributes):`>`\xFE";
 z+="    Html := `<input type='checkbox' id='`:Id:`' name='`:Id:`' value='`:@HtmlEncode(Value):`' class='CheckBox' `:@dataAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    If Checked Then Html := ' checked'\xFE";
 z+="    if readOnly and !hasattribute('disabled', AdditionalAttributes) Then Html := ` disabled='disabled'`\xFE";
 z+="    Html := `/>`\xFE";
 z+="    If Description Then Html := `<label class=\"CheckBoxLabel\" for='`:Id:`'>`:Chr(29):Description:Chr(28):`</label>`\xFE";
 z+="    Html := `</span>`:Chr(29)\xFE";
 z+="    Return Html"
window.cached_jsb_html["checkbox"]=z;
var z="*  Print @circle(200, 150, 50, 'red')\xFE";
 z+="function circle(byval X As StRiNg, byval Y As StRiNg, byval Radias As StRiNg, byval BackColor As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    *\xFE";
 z+="    * BackColor is like \"#RRGGBB\"\xFE";
 z+="    * Radius in Pixels\xFE";
 z+="    *\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    Html := Chr(28):`\xFE";
 z+="      <script type=\"text/javascript\">\xFE";
 z+="            canvas = document.getElementsByTagName('canvas')[0]\xFE";
 z+="            if (!canvas) {\xFE";
 z+="               $('<canvas style=\"left: 0px; top: 0px; margin: 0px; position: absolute; border: none;\"></canvas>').appendTo(\"#jsb\")\xFE";
 z+="               canvas = document.getElementsByTagName('canvas')[0]\xFE";
 z+="            }\xFE";
 z+="            ctx = canvas.getContext(\"2d\");\xFE";
 z+="            ctx.fillStyle = \"`:BackColor:`\"\xFE";
 z+="            ctx.beginPath();\xFE";
 z+="            ctx.arc(`:X:`, `:Y:`, `:Radias:`, 0, Math.PI*2, true); \xFE";
 z+="            ctx.closePath();\xFE";
 z+="            ctx.fill();\xFE";
 z+="      </script>`:chr(29)\xFE";
 z+="\xFE";
 z+="  return html"
window.cached_jsb_html["circle"]=z;
var z="* Sample:\xFE";
 z+="*\xFE";
 z+="*   PRINT @JSB_HTML.ckeditor('id', '<p>hello there</p>', '20px')\xFE";
 z+="*   PRINT @JSB_HTML.SUBMITBTN('btn', 'Submit')\xFE";
 z+="*   @Server.Pause\xFE";
 z+="*   IF @jsb_bf.FormVar('btn') = 'Submit' Then Item = @jsb_bf.FormVar('id')\xFE";
 z+="*\xFE";
 z+="FUNCTION CKEDITOR(ByVal ID As String, optional ByVal DefaultValue As String, optional byval Height As String, optional byval OnContextMenu As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim S As String\xFE";
 z+="\xFE";
 z+="    if IsMissing(Height) then Height = \"600px\"\xFE";
 z+="    \xFE";
 z+="    HTML = @Head(@JSLink(\"//cdnjs.cloudflare.com/ajax/libs/ckeditor/4.2/ckeditor.js\"))\xFE";
 z+="    HTML := @Head(@JSLink(\"//a.cksource.com/c/1/misc/jquery.tooltip.pack.js\"))\xFE";
 z+="    \xFE";
 z+="    S = \"\"\xFE";
 z+="    if OnContextMenu Then\xFE";
 z+="        Html := Chr(28):`<div id=\"`:ID:`\" name=\"`:ID:`\">`:DefaultValue:`</div>`:crlf():Chr(29)\xFE";
 z+="        Html := @jsb_bf.AttachToEvent(\"#\":ID, \"contextmenu\", `function (e) { return `:ID:`_cMenu(e) }`)\xFE";
 z+="        S<-1> = `\xFE";
 z+="         function `:ID:`_cMenu(e) {                 \xFE";
 z+="            var cMenu = $(\"<ul id='contextMenu' />\");                 \xFE";
 z+="            $(cMenu).append('<li onClick=\"`:ID:`_ckChange()\">Edit</li>');                 \xFE";
 z+="            return jsbContentMenu(e, cMenu)                 \xFE";
 z+="         }                 \xFE";
 z+="                          \xFE";
 z+="         function `:ID:`_ckChange() {                 \xFE";
 z+="            $(\"#`:ID:`\").replaceWith($('<textarea id=\"`:ID:`\" name=\"`:ID:`\">').attr({ value: $('#`:ID:`').html() }));                 \xFE";
 z+="            $('#jsb').append(\"<input id='Btn' name='Btn' type='submit' value='Save' />&nbsp;<input id='Btn' name='Btn' type='submit' value='Cancel' />\");                 \xFE";
 z+="            CKEDITOR.config.toolbar = [\xFE";
 z+="               { name: 'document', items: ['Source', '-', 'NewPage', 'Preview', '-', 'Templates' ] },\xFE";
 z+="               { name: 'clipboard', items: [ 'Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo' ] },\xFE";
 z+="               { name: 'basicstyles', items: [ 'Bold', 'Italic' ] }\xFE";
 z+="            ];\xFE";
 z+="            `\xFE";
 z+="    End Else\xFE";
 z+="        Html := Chr(28):`<textarea id=\"`:ID:`\" name=\"`:ID:`\" >`:DefaultValue:`</textarea>`:crlf():Chr(29)\xFE";
 z+="        S<-1> = `\xFE";
 z+="         CKEDITOR.config.toolbar = [ \xFE";
 z+="            [ 'Save', 'Bold', 'Italic', 'Underline', 'Font', 'FontSize', 'Styles', 'BGColor', \xFE";
 z+="              '-', 'SelectAll', 'Cut', 'Copy', 'Paste', \xFE";
 z+="              '-', 'Find', 'Replace', \xFE";
 z+="              '-', 'Undo', 'Redo', \xFE";
 z+="              '-', 'JustifyLeft', 'JustifyCenter', \xFE";
 z+="              '-', 'SpellChecker', 'Smiley',\xFE";
 z+="              '-', 'NumberedList','BulletedList', \xFE";
 z+="              '-', 'Outdent','Indent',\xFE";
 z+="              '-', 'Link', 'Unlink', 'Maximize'\xFE";
 z+="            ] \xFE";
 z+="         ];\xFE";
 z+="         `\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    S<-1> = `\xFE";
 z+="      CKEDITOR.config.enterMode = CKEDITOR.ENTER_BR;\xFE";
 z+="      CKEDITOR.config.height = '`:Height:`';\xFE";
 z+="      CKEDITOR.replace( '`:ID:`' );\xFE";
 z+="      CKEDITOR.plugins.registered['save']=\xFE";
 z+="         {\xFE";
 z+="               init : function( editor )\xFE";
 z+="               {\xFE";
 z+="                  var command = editor.addCommand( 'save', \xFE";
 z+="                     {\xFE";
 z+="                        modes : { wysiwyg:1, source:1 },\xFE";
 z+="                        exec : function( editor ) {\xFE";
 z+="                           var fo=editor.element.$.form;\xFE";
 z+="                           editor.updateElement();\xFE";
 z+="                           if ($('#btn').length == 0) { $('#jsb').append(\"<input id='btn' name='btn' type='hidden' />\") }\xFE";
 z+="                           $('#btn').val('Save');\xFE";
 z+="                           doJsbSubmit();\xFE";
 z+="                        }\xFE";
 z+="                     }\xFE";
 z+="                  );\xFE";
 z+="                  editor.ui.addButton( 'Save',{label : 'My Save',command : 'save'});\xFE";
 z+="               }\xFE";
 z+="         }\xFE";
 z+="\xFE";
 z+="    $(\"#jsb\").submit(function( event ) {\xFE";
 z+="        $('textarea.ckeditor').each(function () {\xFE";
 z+="            var $textarea = $(this);\xFE";
 z+="            $textarea.val(CKEDITOR.instances[$textarea.attr('name')].getData());\xFE";
 z+="        });\xFE";
 z+="    });`\xFE";
 z+="\xFE";
 z+="    if OnContextMenu Then S<-1> = `}`\xFE";
 z+="    Html := @JSB_HTML.script(s)\xFE";
 z+="    Return Html"
window.cached_jsb_html["ckeditor"]=z;
var z="function classOrAtttributes(Byval classNameOrAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    If isJSON(classNameOrAttributes) Or isArray(classNameOrAttributes) Then\xFE";
 z+="        Return ` `:Join(@MergeAttribute(\"\", \"\", \" \", classNameOrAttributes), ' ')\xFE";
 z+="    Else If Left(classNameOrAttributes, 6) = \"class=\" Then\xFE";
 z+="        Return ` `:classNameOrAttributes\xFE";
 z+="    Else If Len(classNameOrAttributes) Then\xFE";
 z+="        Return ` class=`:jsEscapeAttr(classNameOrAttributes)\xFE";
 z+="    End If\xFE";
 z+="    Return \"\"\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function classOrAtttributes(byval classNameOrAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    If IsJson(classNameOrAttributes) Or IsArray(classNameOrAttributes) Then\xFE";
 z+="        return ` `:Join(@MergeAttribute(\"\", \"\", \" \", classNameOrAttributes), ' ')\xFE";
 z+="    Else If Left(classNameOrAttributes, 6) = \"class=\" Then\xFE";
 z+="        return ` `:classNameOrAttributes\xFE";
 z+="    Else If Len(classNameOrAttributes) Then\xFE";
 z+="        return ` class='\":classname:\"'`\xFE";
 z+="    end if\xFE";
 z+="    return \"\"\xFE";
 z+="end function"
window.cached_jsb_html["classoratttributes"]=z;
window.cached_jsb_html["closewindow"]="function CloseWindow() As String\xFE    $options async-\xFE    Return Chr(28):` new windowOpen(jsbRoot() + 'close_html', '_self').close();`:Chr(29)\xFEend function";
window.cached_jsb_html["code"]="function Code(byval text As StRiNg) As String\xFE    $options async-\xFE    return Chr(28):\"<code>\":Chr(29):text:Chr(28):\"</code>\":Chr(29)";
var z="function Codemirror(ByVal Id As String, ByVal DefaultValue As String) As String\xFE";
 z+="    $options async-\xFE";
 z+="\xFE";
 z+="    Dim HTML As String = CssLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/codemirror.min.css\")\xFE";
 z+="    Html := JSLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/codemirror.min.js\")\xFE";
 z+="\xFE";
 z+="    Html := JSLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/mode/javascript/javascript.min.js\")\xFE";
 z+="    Html := JSLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/mode/xml/xml.min.js\")\xFE";
 z+="\xFE";
 z+="    Html := JSLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/addon/dialog/dialog.min.js\")\xFE";
 z+="    Html := CssLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/addon/dialog/dialog.css\")\xFE";
 z+="\xFE";
 z+="    Html := JSLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/addon/search/search.min.js\")\xFE";
 z+="    Html := JSLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/addon/search/searchcursor.min.js\")\xFE";
 z+="\xFE";
 z+="    Html := CssLink(\"//cdnjs.cloudflare.com/ajax/libs/codemirror/3.16.0/theme/elegant.min.css\")\xFE";
 z+="\xFE";
 z+="    Html = @Head(Html)\xFE";
 z+="\xFE";
 z+="    Html := Chr(28):`\xFE";
 z+="      <textarea id=\"`:ID:`\" name=\"`:ID:`\">`:DefaultValue:`</textarea>\xFE";
 z+="      <style>\xFE";
 z+="         .CodeMirror {\xFE";
 z+="           border: 1px solid #eee;\xFE";
 z+="           height: 99%;\xFE";
 z+="           overflow: hidden;\xFE";
 z+="           left: 0;\xFE";
 z+="           right: 0;\xFE";
 z+="\xFE";
 z+="         }\xFE";
 z+="         .CodeMirror-scroll {\xFE";
 z+="           overflow-y: hidden;\xFE";
 z+="           overflow-x: auto;\xFE";
 z+="         }\xFE";
 z+="         .CodeMirror-stepline {\xFE";
 z+="           background-color: lime;\xFE";
 z+="         }\xFE";
 z+="         .CodeMirror-errline {\xFE";
 z+="           background-color: red;\xFE";
 z+="         }\xFE";
 z+="         .CodeMirror-wrnline {\xFE";
 z+="           background-color: yellow;\xFE";
 z+="         }\xFE";
 z+="      </style>\xFE";
 z+="      <script type=\"text/javascript\">\xFE";
 z+="         \xFE";
 z+="         window.`:ID:` = CodeMirror.fromTextArea(document.getElementById(\"`:ID:`\"), {\xFE";
 z+="           lineNumbers: true,\xFE";
 z+="           matchBrackets: true,\xFE";
 z+="           continueComments: \"Enter\",\xFE";
 z+="           theme: \"elegant\",\xFE";
 z+="           indentUnit: 3,\xFE";
 z+="           tabSize: 3,\xFE";
 z+="           indentWithTabs: false,\xFE";
 z+="\xFE";
 z+="           extraKeys: {\xFE";
 z+="              \"Ctrl-Y\": function (cm) {\xFE";
 z+="                 var lineno = cm.getCursor().line;\xFE";
 z+="                 var cline = cm.doc.getLine(lineno)\xFE";
 z+="                 var textarea = document.createElement('textarea');\xFE";
 z+="                 textarea.value = \"randy\"\xFE";
 z+="                 var Range = textarea.createTextRange()\xFE";
 z+="                 Range.execCommand(\"Copy\");\xFE";
 z+="                 cm.doc.removeLine(lineno)\xFE";
 z+="              },\xFE";
 z+="              \"Tab\": function(cm) {\xFE";
 z+="                var spaces = Array(cm.getOption(\"indentUnit\") + 1).join(\" \");\xFE";
 z+="                cm.replaceSelection(spaces, \"end\", \"+input\");\xFE";
 z+="              }\xFE";
 z+="            }\xFE";
 z+="         });\xFE";
 z+="   `\xFE";
 z+="\xFE";
 z+="    If System(1) = \"gae\" Or System(1) = \"aspx\" Then\xFE";
 z+="        Html := `$('form').submit(function() { window.TA.save(); });`\xFE";
 z+="    End If\xFE";
 z+="    Html := `\xFE";
 z+="      </script>\xFE";
 z+="   `:chr(29)\xFE";
 z+="\xFE";
 z+="    Return Html"
window.cached_jsb_html["codemirror"]=z;
window.cached_jsb_html["color"]="function color(byval Color As String, byval Text As String) As String\xFE    $options async-\xFE    return Font(\"\", \"\", Color, \"\", Text)\xFEend function";
var z="* print @ColorPicker('id')\xFE";
 z+="\xFE";
 z+="function Colorpicker(ByVal ID As String, optional ByVal DefaultValue As String, optional ByVal ReadOnly As Boolean, optional byval doKOBinding As StRiNg, optional byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    Html = JSLink(@Jsbroot:\"js/spectrum.js\")\xFE";
 z+="    Html := CssLink(@Jsbroot:\"css/spectrum.css\")\xFE";
 z+="    Html = @Head(Html)\xFE";
 z+="\xFE";
 z+="    If ReadOnly Then\xFE";
 z+="        Html := Chr(28):\"<input tabindex='-1' class='COLORPICKER_ReadOnly basic' readonly\"\xFE";
 z+="    Else\xFE";
 z+="        Html := Chr(28):\"<input class='COLORPICKER basic'\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If doKOBinding Then\xFE";
 z+="        Html := JoinAttributes(@Jsb_bf.MergeAttribute('data-bind', 'colorpicker: {}', ',', AdditionalAttributes)):' />':Chr(29)\xFE";
 z+="        Html := @Jsb_html.SCRIPT(`\xFE";
 z+="        ko.bindingHandlers.colorpicker = {\xFE";
 z+="            update: function(element, options) {\xFE";
 z+="               $(element).spectrum({\xFE";
 z+="                   showInput: true,\xFE";
 z+="                   clickoutFiresChange: true,\xFE";
 z+="                   hideAfterPaletteSelect: true,\xFE";
 z+="                   allowEmpty:true,\xFE";
 z+="                   showAlpha: true,\xFE";
 z+="                   showPalette: true,\xFE";
 z+="                   preferredFormat: \"hex6\",\xFE";
 z+="                   showSelectionPalette: true,\xFE";
 z+="                   palette: [ ],\xFE";
 z+="                   localStorageKey: \"jsb.colorpicks\"\xFE";
 z+="               })\xFE";
 z+="            }\xFE";
 z+="        }`)\xFE";
 z+="    Else\xFE";
 z+="        Html := \" id='\":Id:\"' name='\":Id:\"'\"\xFE";
 z+="        If AdditionalAttributes Then Html := JoinAttributes(AdditionalAttributes)\xFE";
 z+="        If Len(Defaultvalue) Then Html := ' type=\"text\" value=\"':@HtmlEncode(Defaultvalue)\xFE";
 z+="        Html := '\" />':Chr(29):@Jsb_html.SCRIPT(`\xFE";
 z+="         $(\"#`:ID:`\").spectrum({\xFE";
 z+="            showInput: true,\xFE";
 z+="            clickoutFiresChange: true,\xFE";
 z+="            hideAfterPaletteSelect: true,\xFE";
 z+="            allowEmpty:true,\xFE";
 z+="            showAlpha: true,\xFE";
 z+="            showPalette: true,\xFE";
 z+="            preferredFormat: \"hex6\",\xFE";
 z+="            showSelectionPalette: true,\xFE";
 z+="            palette: [ ],\xFE";
 z+="            localStorageKey: \"jsb.colorpicks\"\xFE";
 z+="         })\xFE";
 z+="      `)\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Return Html"
window.cached_jsb_html["colorpicker"]=z;
var z="*\xFE";
 z+="* The problem with postion: absolute, is that the parent's must also be absolutes\xFE";
 z+="* -  This is a bigger problem for Rows2, as we might want a continues flow of lines\xFE";
 z+="*\xFE";
 z+="function Cols2(Byval C1Width As String, Byval C1Content As String, Optional Byval C2Width As String, Optional Byval C2Content As String, Optional Byval Height As String, Optional Byval C1Style As String, Optional Byval C2Style As String) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim H As String\xFE";
 z+="    Dim C1H As String\xFE";
 z+="    Dim C2H As String\xFE";
 z+="    Dim R1STYLE As String\xFE";
 z+="    Dim R2STYLE As String\xFE";
 z+="\xFE";
 z+="    If IsMissing(C2Width) Then\xFE";
 z+="        C2Content = C1Content\xFE";
 z+="        C1Content = C1Width\xFE";
 z+="        C1Width = \"50%\"\xFE";
 z+="        C2Width = \"50%\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    If !IsMissing(C1Style) And IsMissing(C2Style) Then\xFE";
 z+="        // Drop Height\xFE";
 z+="        C2Style = C1Style\xFE";
 z+="        C1Style = Height\xFE";
 z+="        Height = '100%'\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If isJSON(R1Style) Then R1Style = MergeAttribute(\"style\", \"\", \";\", R1Style)\xFE";
 z+="    If isJSON(R2Style) Then R2Style = MergeAttribute(\"style\", \"\", \";\", R2Style)\xFE";
 z+="    \xFE";
 z+="    If !Height Then H = \"top: 0; bottom: 0;\" Else H = \"height: \":Height:\"; \"\xFE";
 z+="\xFE";
 z+="    If Instr(C1Width, \"px\") And Instr(C2Width, \"%\") Then\xFE";
 z+="        * Fixed Left, Open Right from http://jsfiddle.net/bWuQB/5/  leftcss = \"float loeft; width: xpx;\" rightcss = \"margin-left: xpx;\"\xFE";
 z+="        // <div class='twocolumns_fixed_Variable' style=' position: absolute; width: 100%; left: 0; `:h:`' >\xFE";
 z+="        Return Chr(28):`\xFE";
 z+="            <div class='twocolumns_fixed_Variable' style='position: absolute; width: 100%; left: 0; `:h:`' >\xFE";
 z+="            <div class='fixedLeft' style=\"float: left; position: absolute; `:h:` width: `:C1Width:`; `:C1Style:`\">\xFE";
 z+="            `:Chr(29):C1Content:Chr(28):`\xFE";
 z+="            </div>\xFE";
 z+="            <div class='variableRight' style=\"position: absolute; left: `:C1Width:`; right: 0; `:h:` `:C2Style:`\">\xFE";
 z+="            `:Chr(29):C2Content:Chr(28):`\xFE";
 z+="            </div>\xFE";
 z+="         </div>\xFE";
 z+="      `:Chr(29)\xFE";
 z+="        \xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Instr(C1Width, \"%\") And Instr(C2Width, \"px\") Then\xFE";
 z+="\xFE";
 z+="        * Open Left, Fixed Right\xFE";
 z+="        Return Chr(28):`\xFE";
 z+="         <div class='twocolumns_Variable_fixed' style='position: relative; width: 100%;  `:h:`' >\xFE";
 z+="            <div class='fixedRight' style='float: right; `:h:` width: `:Val(C2Width):`px; `:C2Style:`'>\xFE";
 z+="            `:Chr(29):C2Content:Chr(28):`\xFE";
 z+="            </div>\xFE";
 z+="            <div class='variableLeft' style=\" `:h:` padding-right: `:Val(C2Width):`px; `:C1Style:`\">\xFE";
 z+="            `:Chr(29):C1Content:Chr(28):`\xFE";
 z+="            </div>\xFE";
 z+="         </div>\xFE";
 z+="      `:Chr(29)\xFE";
 z+="\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    * Percent both or fixed both\xFE";
 z+="    If C1Width Then C1h = \"width: \":C1Width:\";\"\xFE";
 z+="    If C2Width Then C2h = \"width: \":C2Width:\"; left: \":C1Width:\";\"\xFE";
 z+="    Return Chr(28):`\xFE";
 z+="      <div style=\"position: relative; float: left; width: `:C1Width:`; `:h:C1Style:`\">`:Chr(29):C1Content:Chr(28):`</div>\xFE";
 z+="      <div style=\"position: relative; float: left; width: `:C2Width:`; `:h:C2Style:`\">`:Chr(29):C2Content:Chr(28):`</div>\xFE";
 z+="   `:Chr(29)\xFE";
 z+="End function"
window.cached_jsb_html["cols2"]=z;
window.cached_jsb_html["cols3"]="FUNCTION COLS3(byval C1Width As String, byval C1Content As Object, byval C2Width As String, byval C2Content As String, byval C3Width As String, byval C3Content As String) As String\xFE*$options async-\xFE*\xFE* This is better done with Bootstrap grid columns\xFE*\xFE    Dim HTML As String\xFE\xFE   HTML =      @JSB_HTML.DIV(\"\", C1Content, [\"style='position: relative; float:left; width:\":C1Width:\"'\"])\xFE   Html := @JSB_HTML.DIV(\"\", C2Content, [\"style='position: relative; float:left; width:\":C2Width:\"'\"])\xFE   Html := @JSB_HTML.DIV(\"\", C3Content, [\"style='position: relative; float:left; width:\":C3Width:\"'\"])\xFE   RETURN @JSB_HTML.DIV(\"\", HTML, [\"position:relative; width:100%\"])";
var z="*\xFE";
 z+="* URLorARRAY can be an array of string, an array of json. Each Value can be \"Display,Value\"\xFE";
 z+="*\xFE";
 z+="* Print @ComboBox('id', ['yellow', 'red', 'green', 'blue'], 'red', true, '', '', { 'data-parsley-type': \"integer\", title:'enter a phone number', pattern:\"^\\\\d{4}-\\\\d{3}-\\\\d{4}$\", required:true, mobilepad: 'real' })\xFE";
 z+="*\xFE";
 z+="* See http://nicolasbize.com/magicsuggest/doc.html\xFE";
 z+="*\xFE";
 z+="* ============================= HTML =============================\xFE";
 z+="*\xFE";
 z+="* To load via AJAX:\xFE";
 z+="*    create a restful function:\xFE";
 z+="*\xFE";
 z+="*       restful function aJaxCallName(arg1)\xFE";
 z+="*          return ['this', 'is', 'a', 'load']\xFE";
 z+="*\xFE";
 z+="* Url is @jsbRootExecute(`aJaxCallName?arg1=randy`)\xFE";
 z+="*\xFE";
 z+="* See http://nicolasbize.com/magicsuggest/doc.html\xFE";
 z+="*\xFE";
 z+="function ComboBox(ByVal ID As String, byval URLorARRAY As Object, optional byval Default As Object, optional byval addBlank As Object, optional byval DescriptionField As Object, optional byval ValueField As Object, optional byval AdditionalAttributes As Object, optional byval multiValuedData As StRiNg, optional byval maxSelected As Integer) As String ;* 9\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As Array\xFE";
 z+="    Dim SCRIPTS As Array\xFE";
 z+="    Dim ISURL As Boolean\xFE";
 z+="    Dim TYPE As String\xFE";
 z+="    Dim KEYPADTYPE As String\xFE";
 z+="    Dim ONFOCUS As String\xFE";
 z+="    Dim ONSUCCESS As String\xFE";
 z+="    Dim ONFAILURE As String\xFE";
 z+="    Dim VALS As String\xFE";
 z+="    Dim IOPTS As String\xFE";
 z+="\xFE";
 z+="    HTML = []\xFE";
 z+="    Scripts = []\xFE";
 z+="    \xFE";
 z+="    if IsMissing(multiValuedData) Then multiValuedData = true\xFE";
 z+="    if (!maxSelected) Then maxSelected = 1\xFE";
 z+="    \xFE";
 z+="     if isMissing(addBlank) Then\xFE";
 z+="        if isJson(Default) Or IsArray(Default) Then\xFE";
 z+="            AdditionalAttributes = Default\xFE";
 z+="            Default = ''\xFE";
 z+="        end if\xFE";
 z+="    else if isMissing(DescriptionField) Then\xFE";
 z+="        if isJson(addBlank) Or IsArray(addBlank) Then\xFE";
 z+="            AdditionalAttributes = addBlank\xFE";
 z+="            addBlank = false\xFE";
 z+="        end if\xFE";
 z+="    else if isMissing(ValueField) Then\xFE";
 z+="        if isJson(DescriptionField) Or IsArray(DescriptionField) Then\xFE";
 z+="            AdditionalAttributes = DescriptionField\xFE";
 z+="            DescriptionField = ''\xFE";
 z+="        end if\xFE";
 z+="    else if isMissing(AdditionalAttributes) Then\xFE";
 z+="        if isJson(ValueField) Or IsArray(ValueField) Then\xFE";
 z+="            AdditionalAttributes = ValueField\xFE";
 z+="            ValueField = ''\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="        \xFE";
 z+="    if system(1) = \"aspx\" then \xFE";
 z+="        Html[-1] =      @Head(@JSLink(@jsbroot:\"js/magicsuggest.js\"))\xFE";
 z+="        Html[-1] = Html:@Head(@CssLink(@jsbroot:\"css/magicsuggest.css\"))\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    type = hasAttribute('type', AdditionalAttributes)\xFE";
 z+="    if InStr(`'\"`, left(type,1)) and left(type,1) = Right(type,1) then type = mid(type, 2, len(type) - 2)\xFE";
 z+="    \xFE";
 z+="    KeyPadType = hasAttribute('mobilepad', AdditionalAttributes)\xFE";
 z+="    if InStr(`'\"`, left(keypadType,1)) and left(keypadType,1) = Right(keypadType,1) then keypadType = mid(keypadType, 2, len(keypadType) - 2)\xFE";
 z+="    \xFE";
 z+="    if type = 'number' and !KeyPadType then KeyPadType = 'real'\xFE";
 z+="\xFE";
 z+="    if KeyPadType then\xFE";
 z+="        if left(KeyPadType,1) <> '[' Then KeyPadType = '\"':lcase(KeyPadType):'\"'\xFE";
 z+="        if KeyPadType = '\"full\"' then \xFE";
 z+="            onFocus = ` onfocus=`:jsEscapeAttr(`if (isMobile() && !$(this).attr(\"readonly\") && $(window).width() > 700) $(this).keypad({layout: `:KeyPadType:` })`)\xFE";
 z+="        else\xFE";
 z+="            onFocus = ` onfocus=`:jsEscapeAttr(`if (!$(this).attr(\"readonly\") && $(window).width() > 300) $(this).keypad({layout: `:KeyPadType:` })`)\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    AdditionalAttributes  = @MergeAttribute(\"class\", \"magicSelect form-control\", \" \", AdditionalAttributes)\xFE";
 z+="\xFE";
 z+="    if isString(URLorARRAY) Then \xFE";
 z+="        isUrl = Left(URLorARRAY, 4) = \"http\" or Left(URLorARRAY, 2) = \"//\"\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Default = Replace(DEFAULT, `'`, `\\'`)\xFE";
 z+="    ValueField = Replace(ValueField, `'`, `\\'`)\xFE";
 z+="    DescriptionField = Replace(DescriptionField, `'`, `\\'`)\xFE";
 z+="    \xFE";
 z+="    If ID Then\xFE";
 z+="        Html[-1] = CHR(28):`<input id='`:ID:`' name='`:ID:`'`:JoinAttributes(AdditionalAttributes, ' '):onFocus:` onchange=\"if ($(this).parsley && $(this).parsley().reset) $(this).parsley().reset()\" /> `:Chr(29)\xFE";
 z+="        \xFE";
 z+="        if isUrl Then\xFE";
 z+="            OnSuccess = `\xFE";
 z+="              $('#dd_`:ID:`').empty();\xFE";
 z+="              \xFE";
 z+="              for(var key in json) { \xFE";
 z+="                  comboBoxLoad($('#`:id:`'), json[key], '`:Default:`', `:addBlank+0:`, '`:ValueField:`', '`:DescriptionField:`', `:Val(multiValuedData):`, `:Val(maxSelected):`)\xFE";
 z+="                  break;\xFE";
 z+="               }\xFE";
 z+="            `\xFE";
 z+="    \xFE";
 z+="            OnFailure = `alert('failed combobox ajax call to ' + `:jsEscapeString(URLorARRAY):` + '; error: ' + textStatus)`\xFE";
 z+="            \xFE";
 z+="            // QuotedUrl, jsSuccess, jsFailure, PostPayLoad, infoMsg, HeaderJSON, Ok2Cache)\xFE";
 z+="            Scripts[-1] = @jsb_bf.Ajax(jsEscapeString(URLorARRAY), OnSuccess, OnFailure, Nothing, Nothing, Nothing, true)\xFE";
 z+="\xFE";
 z+="        Else\xFE";
 z+="            if isString(URLorARRAY) Then Vals = json2string(MakeArray(URLorARRAY)) Else Vals = json2string(URLorARRAY)\xFE";
 z+="            Scripts[-1] = `comboBoxLoad($('#`:id:`'), `:Vals:`, '`:Default:`', `:addBlank+0:`, '`:ValueField:`', '`:DescriptionField:`', `:Val(multiValuedData):`, `:Val(maxSelected):`)`\xFE";
 z+="        End If\xFE";
 z+="    Else\xFE";
 z+="        // knockout will supply load\xFE";
 z+="        iOpts = HtmlEncode(URLorARRAY)\xFE";
 z+="        HTML[-1] = CHR(28):`<input`:joinAttributes(additionalAttributes, ' '):onFocus:` myOpts='`:iOpts:`' onchange=\"if ($(this).parsley && $(this).parsley().reset) $(this).parsley().reset()\" />`:CHR(29)\xFE";
 z+="    End If  \xFE";
 z+="    \xFE";
 z+="    HTML[-1] = @Script(Join(Scripts, Crlf()))\xFE";
 z+="    \xFE";
 z+="    RETURN Join(HTML, '')\xFE";
 z+="end function"
window.cached_jsb_html["combobox"]=z;
window.cached_jsb_html["comboboxajax"]="function ComboBoxAJAX(byval ID As Object, byval URLorARRAY As Object, optional byval Default As Object, optional byval addBlank As Object, optional byval DescriptionField As Object, optional byval ValueField As Object, optional byval AdditionalAttributes As Object, optional byval multiValuedData As Object, optional byval maxSelected As Object) As StRiNg ;* 9\xFE    $options async-\xFE    return ComboBox(ID, URLorARRAY, Default, addBlank, DescriptionField, ValueField, AdditionalAttributes, multiValuedData, maxSelected)\xFEend function ";
var z="* ============================= LOAD by INCLUDE and ArrayID =============================\xFE";
 z+="FUNCTION ComboBoxIncludeURL(ByVal ID As String, byval SrcUrl As Object, byval ArrayID As String, optional byval Default As String, optional byval addBlank As Boolean, optional byval DescriptionField As String, optional byval ValueField As String, optional byval AdditionalAttributes As Object, optional byval multiValuedData As Boolean, optional byval maxSelected As Integer) As String  ;* 10\xFE";
 z+="    $options async-\xFE";
 z+="\xFE";
 z+="    Dim HTML As Array = []\xFE";
 z+="    Dim Scripts As Array = []\xFE";
 z+="    if (!maxSelected) Then maxSelected = 1\xFE";
 z+="    \xFE";
 z+="    HTML[-1] = @Head(@JSLink(SrcUrl))\xFE";
 z+="    \xFE";
 z+="    if system(1) <> \"js\" then\xFE";
 z+="        Html[-1] = @Head(@JSLink(@jsbroot:\"js/magicsuggest.js\"))\xFE";
 z+="        Html[-1] = @Head(@CssLink(@jsbroot:\"css/magicsuggest.css\"))\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    AdditionalAttributes = @MergeAttribute(\"class\", \"magicSelect form-control\", \" \", AdditionalAttributes)\xFE";
 z+="    \xFE";
 z+="    Default = Replace(DEFAULT, `'`, `\\'`)\xFE";
 z+="    ValueField = Replace(ValueField, `'`, `\\'`)\xFE";
 z+="    DescriptionField = Replace(DescriptionField, `'`, `\\'`)\xFE";
 z+="    \xFE";
 z+="    If ID Then\xFE";
 z+="        Html[-1] = CHR(28):`<input id='`:ID:`' name='`:ID:`'`:joinAttributes(additionalAttributes, ' '):` onchange=\"if ($(this).parsley && $(this).parsley().reset) $(this).parsley().reset()\" /> `:Chr(29)\xFE";
 z+="    Else\xFE";
 z+="        Html[-1] = CHR(28):`<input`:joinAttributes(additionalAttributes, ' '):` onchange=\"if ($(this).parsley && $(this).parsley().reset) $(this).parsley().reset()\" valuefield='`:ValueField:`' descriptionfield='`:DescriptionField:`' /> `:Chr(29)\xFE";
 z+="    End If\xFE";
 z+="  \xFE";
 z+="    // if no ID, then this will be setup by knockout onload\xFE";
 z+="    If ID Then Html := @Script(`\xFE";
 z+="        $( document ).ready( \xFE";
 z+="            function () { \xFE";
 z+="                comboBoxLoad($('#`:ID:`'), `:ArrayID:`, '`:Default:`', `:Val(addBlank):`, '`:ValueField:`', '`:DescriptionField:`', `:Val(multiValuedData):`, `:Val(maxSelected):`)\xFE";
 z+="            } \xFE";
 z+="        )\xFE";
 z+="    `)\xFE";
 z+="\xFE";
 z+="    Return Join(Html, crlf())"
window.cached_jsb_html["comboboxincludeurl"]=z;
var z="/*  Add a contextmenu\xFE";
 z+="*\xFE";
 z+="*  Setup you labels as:\xFE";
 z+="*\xFE";
 z+="    MenuList = { \xFE";
 z+="        File:   { cmd: 'isCmdFile',   \xFE";
 z+="                  val: 'isValueFile' }, // Since no onclick is defined, this will do a postback\xFE";
 z+="        Spacer1: \"\", \xFE";
 z+="        jsOnly: { cmd: 'isCmdjsOnly', \xFE";
 z+="                  val: 'isValuejsOnly', \xFE";
 z+="                  onclick: 'alert(\"You chose context menu: \" + $(this).text() + \" [cmd: \" + Cmd + \", val: \" + Val + \"] on target: \" + $(contextMenuTarget).attr(\"id\"))' \xFE";
 z+="                }, \xFE";
 z+="        Edit:   { cmd: 'isEdit',      \xFE";
 z+="                  val: 'isValueEdit'} \xFE";
 z+="    } \xFE";
 z+="\xFE";
 z+="    Print @TextBox('id1'):@ContextMenu('id1', MenuList)\xFE";
 z+="    @Server.Pause\xFE";
 z+="   \xFE";
 z+="    // hidden vars are setup for: contextMenuCtlText, contextMenuCtlCmd, contextMenuVal, and the contextMenuCtlID\xFE";
 z+="    Print \"You chose context menu \":@formvar(\"contextMenuCmd\"):\"; text \":@formvar(\"contextMenuText\"):\";  Val: \":@formvar(\"contextMenuVal\")\xFE";
 z+="    Print \"on control \":@formvar(\"contextMenuCtlID\"):\" which has text \":@formvar(\"contextMenuCtlText\")\xFE";
 z+="\xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="*\xFE";
 z+="* jqSelector: may not yet exist\xFE";
 z+="*\xFE";
 z+="* {\xFE";
 z+="*    menuItem: { id: xxx, cmd: xxx, val: xxx, onclick: xxx },\xFE";
 z+="*    spacer1: \"\"\xFE";
 z+="*     ...\xFE";
 z+="*  }\xFE";
 z+="function ContextMenu(byval jqSelector As String, byval MenuList As JSON, optional byval noScriptTags As Boolean, optional byval cMenuID As String) As String\xFE";
 z+="* $options async-\xFE";
 z+="\xFE";
 z+="    Dim MENUITEMS As Array\xFE";
 z+="    Dim MENUITEM As Object\xFE";
 z+="    Dim TXT As StRiNg\xFE";
 z+="    Dim ONCLICK As String\xFE";
 z+="    Dim STYLE As String\xFE";
 z+="    Dim S As String\xFE";
 z+="\xFE";
 z+="    if !cMenuID Then cMenuID = 'cm_':NiceName(@NewGuid):'_contextMenu' Else cMenuID = NiceName(cMenuID)\xFE";
 z+="\xFE";
 z+="    MenuItems = []\xFE";
 z+="    for each Txt in MenuList\xFE";
 z+="        MenuItem = MenuList[Txt]\xFE";
 z+="        if isJson(MenuItem) Then\xFE";
 z+="            if MenuItem.caption Then Txt = MenuItem.caption\xFE";
 z+="            if MenuItem.onclick then\xFE";
 z+="                onclick = `var cmd =`:jsEscapeString(menuItem.cmd:menuItem.Cmd):`; \xFE";
 z+="                           var val=`:jsEscapeString(menuItem.val:menuItem.Val):`; \xFE";
 z+="                           var Cmd=cmd; var Val=val; \xFE";
 z+="                           contextMenuClose(); \xFE";
 z+="                           `:MenuItem.onclick\xFE";
 z+="            else\xFE";
 z+="                onclick = `contextMenu_Submit(this, `:jsEscapeString(menuItem.cmd:menuItem.Cmd):`, `:jsEscapeString(menuItem.val:menuItem.Val):`)`\xFE";
 z+="            end if\xFE";
 z+="            MenuItems[-1] =`$(cMenu).append(`:jsEscapeString(`<li class='contextMenu' onclick=`:jsEscapeAttr(onclick):`>`:Txt:`</li>`):`);`\xFE";
 z+="        ElseIf !MenuItem Then\xFE";
 z+="            Style = ` style=`:jsEscapeAttr(`height: 6px; background-color:gray; width: auto;`)\xFE";
 z+="            MenuItems[-1] =`$(cMenu).append(`:jsEscapeString(`<li class='contextMenu' `:Style:`></li>`):`);`\xFE";
 z+="        Else\xFE";
 z+="            MenuItems[-1] =`$(cMenu).append(`:jsEscapeString(`<li class='contextMenu'>`:MenuItem:`</li>`):`);`\xFE";
 z+="        end if\xFE";
 z+="    next\xFE";
 z+="     \xFE";
 z+="    S = `   \xFE";
 z+="         $(document).on(\"contextmenu\", \"`:JQSelector:`\", function (e) { return `:cMenuID:`(e, this) });\xFE";
 z+="         \xFE";
 z+="         function `:cMenuID:`(e, c) {\xFE";
 z+="             // Create context menu\xFE";
 z+="             var cMenu = $(\"<ul id='contextMenu' />\");\xFE";
 z+="             `:Join(MenuItems, crlf()):`\xFE";
 z+="             return jsbContentMenu(e, cMenu)\xFE";
 z+="         }`\xFE";
 z+="         \xFE";
 z+="    if noScriptTags Then S = @Html(S) Else S = @Script(S)\xFE";
 z+="    Return S\xFE";
 z+="End Function"
window.cached_jsb_html["contextmenu"]=z;
window.cached_jsb_html["css"]="function Css(byval s As String) As String\xFE    $options async-\xFE    \xFE    Dim CRLF As String\xFE\xFE    CRLF = Crlf()\xFE    Return CHR(28):`<style>`:CRLF:Replace(s, Chr(254), CRLF):CRLF:'</style>':CRLF:CHR(29)";
window.cached_jsb_html["csslink"]="Function CssLink(byval Url As String) As String\xFE    $options ijs\xFE    if !instr(Url, `/`) And !instr(Url, `\\`) then Url = @jsbRoot:`css/`:Url\xFE    Return Chr(28):`<link type='text/css' rel=\"stylesheet\" href=`:jsEscapeHREF(Url):` />`:crlf():Chr(29)\xFEend Function";
var z="***************** HTML *****************************\xFE";
 z+="FUNCTION DATEBOX(ByVal ID As String, optional byval DEFAULTVALUE As Object, optional byval ReadOnly As Object, optional byval AdditionalAttributes As Object, optional byval yearRange As String) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim D As String\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if isJson(DEFAULTVALUE) Or IsArray(DEFAULTVALUE) Then\xFE";
 z+="         AdditionalAttributes = DEFAULTVALUE\xFE";
 z+="         DEFAULTVALUE = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if isJson(ReadOnly) Or IsArray(ReadOnly) Then\xFE";
 z+="         AdditionalAttributes = ReadOnly\xFE";
 z+="         ReadOnly = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if !yearRange then yearRange = theYear()-100:\":\":theYear()\xFE";
 z+="    If Len(DEFAULTVALUE) Then\xFE";
 z+="        If InStr(DefaultValue, \"-\") Or InStr(DefaultValue, \"/\") Then \xFE";
 z+="            D = Date(date(DEFAULTVALUE))\xFE";
 z+="        Else\xFE";
 z+="            D = Date(DEFAULTVALUE)\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    HTML = CHR(28):\"<input\"\xFE";
 z+="    IF ID THEN HTML := \" id='\":ID:\"' name='\":ID:\"'\"\xFE";
 z+="    HTML := \" \":Join(@MergeAttribute(\"class\", \"DateBox form-control\", \" \", AdditionalAttributes), \" \"):' value=\"':D:'\"'\xFE";
 z+="    \xFE";
 z+="    If ReadOnly Then \xFE";
 z+="        HTML := \" readonly tabindex='-1' />\":CHR(29)\xFE";
 z+="    Else\xFE";
 z+="        HTML := \" />\":CHR(29)\xFE";
 z+="        \xFE";
 z+="        If ID Then\xFE";
 z+="        * Use jQuery datepicker\xFE";
 z+="            Html := @jsb_html.SCRIPT(`\xFE";
 z+="                if ($( \"#`:ID:`\" ).datepicker) {\xFE";
 z+="                   $( \"#`:ID:`\" ).datepicker({ \xFE";
 z+="                       dateFormat: \"yy-mm-dd\", \xFE";
 z+="                       showButtonPanel: true, \xFE";
 z+="                       changeMonth: true, \xFE";
 z+="                       changeYear: true, \xFE";
 z+="                       yearRange: '`:yearRange:`',\xFE";
 z+="                       onChangeMonthYear: function(year, month, datePicker) {\xFE";
 z+="                            // Prevent forbidden dates, like 2/31/2012:\xFE";
 z+="                            var $t = $(this);\xFE";
 z+="                            var day = $t.data('preferred-day') || new Date().getDate();\xFE";
 z+="                            var newDate = new Date(month + '/' + day + '/' + year);\xFE";
 z+="                            while (day > 28) {\xFE";
 z+="                              if (newDate.getDate() == day && newDate.getMonth() + 1 == month && newDate.getFullYear() == year) {\xFE";
 z+="                                break;\xFE";
 z+="                              } else {\xFE";
 z+="                                day -= 1;\xFE";
 z+="                                newDate = new Date(month + '/' + day + '/' + year);\xFE";
 z+="                              }\xFE";
 z+="                            }   \xFE";
 z+="                            $t.datepicker('setDate', newDate);\xFE";
 z+="                       },  \xFE";
 z+="                        \xFE";
 z+="                       beforeShow: function(dateText, datePicker) {\xFE";
 z+="                            // Record the starting date so that\xFE";
 z+="                            // if the user changes months from Jan->Feb->Mar\xFE";
 z+="                            // and the original date was 1/31,\xFE";
 z+="                            // then we go 1/31->2/28->3/31.\xFE";
 z+="                            $(this).data('preferred-day', ($(this).datepicker('getDate') || new Date()).getDate());\xFE";
 z+="                            hideKeyboard();\xFE";
 z+="                       }\xFE";
 z+="                    }); \xFE";
 z+="                } else if ($( \"#`:ID:`\" ).date) {\xFE";
 z+="                   $( \"#`:ID:`\" ).date({ dateFormat: \"yy-mm-dd\", showButtonPanel: true }); \xFE";
 z+="                } else {\xFE";
 z+="                   $( \"#`:ID:`\" ).attr('type', 'date');\xFE";
 z+="                }\xFE";
 z+="           `)\xFE";
 z+="        Else\xFE";
 z+="            // Html := @jsb_html.SCRIPT(`$('.DateBox').datepicker();`)\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    RETURN HTML"
window.cached_jsb_html["datebox"]=z;
var z="FUNCTION DECIMALBOX(ByVal ID As String, optional byval DEFAULTVALUE As Object, optional byval ReadOnly As Object, optional byval AdditionalAttributes As Object, optional byval minValue As StRiNg, optional byval maxValue As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if isJson(DEFAULTVALUE) Or IsArray(DEFAULTVALUE) Then\xFE";
 z+="        AdditionalAttributes = DEFAULTVALUE\xFE";
 z+="        DEFAULTVALUE = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if isJson(ReadOnly) Or IsArray(ReadOnly) Then\xFE";
 z+="        AdditionalAttributes = ReadOnly\xFE";
 z+="        ReadOnly = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    If ReadOnly Then \xFE";
 z+="         HTML = CHR(28):\"<input id='\":ID:\"' name='\":ID:\"' readonly tabindex='-1' \":Join(@MergeAttribute(\"class\", \"DecimalBox_ReadOnly form-control\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="    Else\xFE";
 z+="         // HTML = CHR(28):\"<input id='\":ID:\"' name='\":ID:\"' type='number' step='any' \":Join(@MergeAttribute(\"class\", \"DecimalBox form-control\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="         HTML = CHR(28):\"<input id='\":ID:\"' name='\":ID:\"' \":Join(@MergeAttribute(\"class\", \"DecimalBox form-control\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="         IF Len(minValue) THEN HTML := \" min='\":minValue:\"'\"\xFE";
 z+="         IF Len(maxValue) THEN HTML := \" max='\":maxValue:\"'\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If Len(DEFAULTVALUE) Then HTML := ' value=\"':@jsb_bf.HtmlEncode(DEFAULTVALUE):'\"'\xFE";
 z+="\xFE";
 z+="    HTML := ` onfocus='if (isMobile() && !$(this).attr(\"readonly\")) $(this).keypad({ layout: \"real\" })' />`:CHR(29)\xFE";
 z+="    \xFE";
 z+="    RETURN HTML"
window.cached_jsb_html["decimalbox"]=z;
var z="/*\xFE";
 z+=" \xFE";
 z+="    userSettings = {}\xFE";
 z+="    // userSettings.databaseName = ...\xFE";
 z+="    // userSettings.devXGridLayout = ...\xFE";
 z+="    // userSettings.serverURL = ...\xFE";
 z+="    // userSettings.primaryKeyField \xFE";
 z+="    \xFE";
 z+="    // userSettings.latColumnName\xFE";
 z+="    // userSettings.lngColumnName\xFE";
 z+="    // userSettings.hideExportBtns\xFE";
 z+="    // userSettings.additionalButtons = [@Submitbtn(\"BtnReset\", \"Reset Layout\"), ...]\xFE";
 z+="    // userSettigs.columnAutoWidth = true / false\xFE";
 z+="    \xFE";
 z+="    // userSettings.latColumnName\xFE";
 z+="    Html = @devXGrid('devXGrid', tableName, userSettings)\xFE";
 z+="    \xFE";
 z+="    // On aspxGrid page now\xFE";
 z+="    print @devxGrid_additionalSettings()\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    Print Html:\xFE";
 z+="    \xFE";
 z+="    @Server.Pause\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="*/\xFE";
 z+="    \xFE";
 z+="function devXGrid(ByVal gridID As String, ByVal tableName As String, ByVal userSettings As JSON) As String\xFE";
 z+="    Dim serverURL As String = userSettings.serverURL\xFE";
 z+="    if !serverURL Then serverURL = @JSBRootAct\xFE";
 z+="    \xFE";
 z+="    if !tableName Then @Errors = \"Mising TableName\"; return NULL\xFE";
 z+="    \xFE";
 z+="    if !userSettings.gridDefs Or !userSettings.primaryKeyField Then\xFE";
 z+="        Dim gridDefinition As JSON = getDevXGridMeta(serverURL, userSettings.databaseName, tableName)\xFE";
 z+="        if !gridDefinition then return NULL\xFE";
 z+="        userSettings.primaryKeyField = gridDefinition.primaryKey\xFE";
 z+="        userSettings.gridDefs = gridDefinition.gridDefs\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    Dim Html As String = @jsLink(\"https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.10.1/polyfill.min.js\")\xFE";
 z+="    Html := @jsLink(\"https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.1.1/exceljs.min.js\")\xFE";
 z+="    Html := @jsLink(\"https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js\")\xFE";
 z+="    Html := @cssLink(\"https://cdn3.devexpress.com/jslib/21.2.5/css/dx.light.css\")\xFE";
 z+="    Html := @jsLink(\"https://cdn3.devexpress.com/jslib/21.2.5/js/dx.all.js\")\xFE";
 z+="    \xFE";
 z+="    // See https://js.devexpress.com/Documentation/ApiReference/UI_Components/dxDataGrid/Configuration/\xFE";
 z+="    Html := @style(`\xFE";
 z+="        .dx-datagrid .dx-data-row > td.bullet {\xFE";
 z+="          padding-top: 0;\xFE";
 z+="          padding-bottom: 0;\xFE";
 z+="        }\xFE";
 z+="    `)\xFE";
 z+="    \xFE";
 z+="   Html := @html(`\xFE";
 z+="        <div class=\"dx-viewport\" style=\"position: absolute\">\xFE";
 z+="            <div class=\"demo-container\">\xFE";
 z+="              <div id=\"`:gridID:`\"></div>\xFE";
 z+="            </div>\xFE";
 z+="        </div>\xFE";
 z+="    `)\xFE";
 z+="\xFE";
 z+="   xHtml := @html(`\xFE";
 z+="        <div class=\"dx-viewport\" style=\"position: absolute\">\xFE";
 z+="          <div id=\"`:gridID:`\"></div>\xFE";
 z+="        </div>\xFE";
 z+="    `)\xFE";
 z+="    \xFE";
 z+="    Dim scriptsetupGrid As String = \"[\":Join(userSettings.gridDefs, \",\":crlf()):\"]\"\xFE";
 z+="    \xFE";
 z+="    Dim S As String = \"\"\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    if userSettings.databaseName then\xFE";
 z+="        S := `\xFE";
 z+="            // setup a custom datastore\xFE";
 z+="            $(() => {\xFE";
 z+="                    \xFE";
 z+="                function isNotEmpty(value) {\xFE";
 z+="                    return value !== undefined && value !== null && value !== '';\xFE";
 z+="                }\xFE";
 z+="                \xFE";
 z+="                window.`:gridID:`_customDataStore = new DevExpress.data.CustomStore({\xFE";
 z+="                    key: '`:userSettings.primaryKeyField:`',\xFE";
 z+="                    load(loadOptions) {\xFE";
 z+="                      const deferred = $.Deferred();\xFE";
 z+="                      const args = { databaseName: '`:userSettings.databaseName:`', tableName: '`:tableName:`' };\xFE";
 z+="                \xFE";
 z+="                      ['skip','take','requireTotalCount','requireGroupCount','sort','filter','totalSummary','group','groupSummary',].forEach((i) => {\xFE";
 z+="                        if (i in loadOptions && isNotEmpty(loadOptions[i])) {\xFE";
 z+="                          args[i] = JSON.stringify(loadOptions[i]);\xFE";
 z+="                        }\xFE";
 z+="                      });\xFE";
 z+="                      \xFE";
 z+="                      $.ajax({\xFE";
 z+="                        url: '`:serverURL:`restApiFetch',\xFE";
 z+="                        dataType: 'json',\xFE";
 z+="                        data: args,\xFE";
 z+="                        success(result) {\xFE";
 z+="                          // debugger;\xFE";
 z+="                          if (result.errors) {\xFE";
 z+="                              deferred.reject('Data Loading Error: ' + result.errors);\xFE";
 z+="                          } else {\xFE";
 z+="                              deferred.resolve(result.data, {\xFE";
 z+="                                totalCount: result.totalCount,\xFE";
 z+="                                summary: result.summary,\xFE";
 z+="                                groupCount: result.groupCount,\xFE";
 z+="                              });\xFE";
 z+="                          }\xFE";
 z+="                        },\xFE";
 z+="                        error() {\xFE";
 z+="                        debugger;\xFE";
 z+="                          deferred.reject('Data Loading Error');\xFE";
 z+="                        },\xFE";
 z+="                        timeout: 33000,\xFE";
 z+="                      });\xFE";
 z+="                \xFE";
 z+="                      return deferred.promise();\xFE";
 z+="                    },\xFE";
 z+="                });\xFE";
 z+="            });\xFE";
 z+="        `\xFE";
 z+="    Else\xFE";
 z+="        open tableName to fTable Then\xFE";
 z+="            select \"*\" from fTable to sl then\xFE";
 z+="                rows = getlist(sl)\xFE";
 z+="                \xFE";
 z+="                S := `\xFE";
 z+="                    // setup an array datastore\xFE";
 z+="                    $(() => {\xFE";
 z+="                        window.`:gridID:`_customDataStore = [`:Join(rows, \",\":crlf()):`];\xFE";
 z+="                    });\xFE";
 z+="                `\xFE";
 z+="            else\xFE";
 z+="                S := `alert(`:jsEscapeString(@Errors):`);`\xFE";
 z+="            end if\xFE";
 z+="        else\xFE";
 z+="            S := `alert(`:jsEscapeString(@Errors):`);`\xFE";
 z+="        end if\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if !Len(userSettings.devXGridLayout) Then userSettings.devXGridLayout = {}\xFE";
 z+="    \xFE";
 z+="    S := `\xFE";
 z+="        $(() => {\xFE";
 z+="            debugger; \xFE";
 z+="            \xFE";
 z+="            var devxGridLayout = `:jsEscapeString(userSettings.devXGridLayout):`;\xFE";
 z+="            localStorage['`:gridID:`'] = devxGridLayout;\xFE";
 z+="            \xFE";
 z+="            $('#`:gridID:`').dxDataGrid({\xFE";
 z+="    `\xFE";
 z+="    \xFE";
 z+="        S := `\xFE";
 z+="                // use a remote oData provider\xFE";
 z+="                // see https://js.devexpress.com/Documentation/18_1/ApiReference/ui_widgets/dxdatagrid/Configuration/remoteOperations/\xFE";
 z+="                remoteOperations: true,  // Grouping on Server\xFE";
 z+="                dataSource: window.`:gridID:`_customDataStore,\xFE";
 z+="                allowColumnReordering: true,\xFE";
 z+="                allowColumnResizing: true,\xFE";
 z+="                rowAlternationEnabled: true,\xFE";
 z+="                showBorders: true,\xFE";
 z+="                showRowLines: true,\xFE";
 z+="                columnChooser: {\xFE";
 z+="                  enabled: true,\xFE";
 z+="                  allowSearch: true,\xFE";
 z+="                },\xFE";
 z+="                selection: { mode: 'single' },\xFE";
 z+="                filterRow: { visible: true },\xFE";
 z+="                groupPanel: { visible: true },\xFE";
 z+="                grouping: { autoExpandAll: false },\xFE";
 z+="                stateStoring: {\xFE";
 z+="                  enabled: true,\xFE";
 z+="                  type: 'localStorage',\xFE";
 z+="                  storageKey: '`:gridID:`', \xFE";
 z+="                },\xFE";
 z+="                searchPanel: {\xFE";
 z+="                  visible: true,\xFE";
 z+="                  highlightCaseSensitive: true,\xFE";
 z+="                },\xFE";
 z+="                scrolling: {\xFE";
 z+="                  mode: 'virtual',\xFE";
 z+="                  rowRenderingMode: 'virtual',\xFE";
 z+="                },\xFE";
 z+="                paging: { pageSize: 10 },\xFE";
 z+="                headerFilter: {\xFE";
 z+="                  visible: true,\xFE";
 z+="                  allowSearch: true,\xFE";
 z+="                },\xFE";
 z+="                wordWrapEnabled: true,\xFE";
 z+="                pager: {\xFE";
 z+="                  showPageSizeSelector: true,\xFE";
 z+="                  allowedPageSizes: [10, 25, 50, 100],\xFE";
 z+="                },\xFE";
 z+="    `\xFE";
 z+="    \xFE";
 z+="    if userSettings.columnAutoWidth Then\xFE";
 z+="        S := `\xFE";
 z+="            columnAutoWidth: true,\xFE";
 z+="        `\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    if !userSettings.hideExportBtns Then\xFE";
 z+="            S := `\xFE";
 z+="                export: {\xFE";
 z+="                    enabled: true,\xFE";
 z+="                    allowExportSelectedData: true,\xFE";
 z+="                },\xFE";
 z+="                onExporting: function(e) {\xFE";
 z+="                    debugger\xFE";
 z+="                    \xFE";
 z+="                    var workbook = new ExcelJS.Workbook(); \xFE";
 z+="                    var worksheet = workbook.addWorksheet('Main sheet'); \xFE";
 z+="                    DevExpress.excelExporter.exportDataGrid({ \xFE";
 z+="                        worksheet: worksheet, \xFE";
 z+="                        component: e.component,\xFE";
 z+="                        customizeCell: function(options) {\xFE";
 z+="                            var excelCell = options;\xFE";
 z+="                            excelCell.font = { name: 'Arial', size: 12 };\xFE";
 z+="                            excelCell.alignment = { horizontal: 'left' };\xFE";
 z+="                        } \xFE";
 z+="                    }).then(function() {\xFE";
 z+="                        workbook.xlsx.writeBuffer().then(function(buffer) { \xFE";
 z+="                            saveAs(new Blob([buffer], { type: 'application/octet-stream' }), 'DataGrid.xlsx'); \xFE";
 z+="                        }); \xFE";
 z+="                    }); \xFE";
 z+="                    e.cancel = true; \xFE";
 z+="                },\xFE";
 z+="            `\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    S := `\xFE";
 z+="\xFE";
 z+="                columns: `:scriptsetupGrid:`,\xFE";
 z+="        \xFE";
 z+="                onContentReady(e) {\xFE";
 z+="                  if (!collapsed) {\xFE";
 z+="                    collapsed = true;\xFE";
 z+="                    // debugger;\xFE";
 z+="                    // e.component.expandRow(['EnviroCare']);\xFE";
 z+="                  }\xFE";
 z+="                },\xFE";
 z+="            });\xFE";
 z+="        });\xFE";
 z+="\xFE";
 z+="        collapsed = false;\xFE";
 z+="    `\xFE";
 z+="    \xFE";
 z+="    return Html:@Script(S)\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="function devxGrid_additionalSettings()\xFE";
 z+="    *$options internal devXGrid, myPage, tc, b\xFE";
 z+="    *$options aspx\xFE";
 z+="    \xFE";
 z+="    myPage = System(29)\xFE";
 z+="    if myPage Then devXGrid = myPage.getControl('devXGrid')\xFE";
 z+="    if !devXGrid Then return \"\"\xFE";
 z+="\xFE";
 z+="    sb = []\xFE";
 z+="    sb[-1] = `{`\xFE";
 z+="    tcSep = \"\"\xFE";
 z+="    For i As Integer = 1 To 2\xFE";
 z+="        Dim tc As Object // ASPxSummaryItemCollection\xFE";
 z+="        If i = 1 Then\xFE";
 z+="            tc = devXGrid.TotalSummary\xFE";
 z+="            if tc.Count then sb[-1] = tcSep:`TotalSummary:[`\xFE";
 z+="        Else\xFE";
 z+="            tc = devXGrid.GroupSummary\xFE";
 z+="            if tc.Count then sb[-1] = tcSep:`GroupSummary:[`\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        For bi = 1 to tc.Count\xFE";
 z+="            b = tc[bi]\xFE";
 z+="            If bi > 1 Then sb[-1] = `,`\xFE";
 z+="            sb[-1] = `{`\xFE";
 z+="            sb[-1] = `FieldName:\"` : b.FieldName : `\"`\xFE";
 z+="            ' sb[-1] = `,Index:` : b.Index\xFE";
 z+="            sb[-1] = `,SummaryType:\"` : b.SummaryType : `\"`\xFE";
 z+="            If Len(b.Tag) Then sb[-1] = `,Tag:\"` : b.Tag : `\"`\xFE";
 z+="            If Len(b.ShowInColumn) Then sb[-1] = `,ShowInColumn:\"` : b.ShowInColumn : `\"`\xFE";
 z+="            If Len(b.ShowInGroupFooterColumn) Then sb[-1] = `,ShowInGroupFooterColumn:\"` : b.ShowInGroupFooterColumn : `\"`\xFE";
 z+="            If Len(b.DisplayFormat) Then sb[-1] = `,DisplayFormat:\"` : b.DisplayFormat : `\"`\xFE";
 z+="            If Len(b.ValueDisplayFormat) Then sb[-1] = `,ValueDisplayFormat:\"` : b.ValueDisplayFormat : `\"`\xFE";
 z+="            sb[-1] = `}`\xFE";
 z+="        Next\xFE";
 z+="        if tc.Count then \xFE";
 z+="            sb[-1] = `]`\xFE";
 z+="            tcSep = \",\"\xFE";
 z+="        end if\xFE";
 z+="    Next\xFE";
 z+="    sb[-1] = `}`\xFE";
 z+="    return join(sb, \"\")\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="function devxGrid_downloadKML(byVal gridID As String, ByVal userSettings As JSON, optional byval noQuestions As Boolean)\xFE";
 z+="    *$options aspx\xFE";
 z+="    \xFE";
 z+="    devXGrid = System(29).getControl(gridID)   // Don't set breakpoints until done using\xFE";
 z+="    \xFE";
 z+="    VisibleRowCount = devXGrid.VisibleRowCount\xFE";
 z+="    doIt = True\xFE";
 z+="    If VisibleRowCount > 10000 and !noQuestions Then\xFE";
 z+="        doIt = Msgbox(\"You have \":VisibleRowCount:\" records, proceed with export?\", \"Yes,No\") = \"Yes\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If doIt Then\xFE";
 z+="        Kml = ['<?xml version=\"1.0\" encoding=\"UTF-8\"?><kml xmlns=\"http://www.opengis.net/kml/2.2\"><Document>']\xFE";
 z+="        devXGrid = System(29).getControl(gridID)   // Don't set breakpoints until done using\xFE";
 z+="        \xFE";
 z+="        // Make each group into a KML folder\xFE";
 z+="        dim grdColumns = devXGrid.Columns\xFE";
 z+="        grdColumnCnt = UBound(grdColumns)\xFE";
 z+="        \xFE";
 z+="        groupColumns = []\xFE";
 z+="        for i = 1 to grdColumnCnt\xFE";
 z+="            grdColumn = grdColumns(i)\xFE";
 z+="            GroupIndex = grdColumn.GroupIndex\xFE";
 z+="            if GroupIndex <> -1 Then\xFE";
 z+="                groupColumns[GroupIndex+1] = grdColumn.FieldName\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="        grpColumnCnt = UBound(groupColumns)\xFE";
 z+="        groupValues = []\xFE";
 z+="        nestedInFolder = false\xFE";
 z+="        GotDetails = False\xFE";
 z+="        \xFE";
 z+="        For VisibleRowNo = 0 To VisibleRowCount - 1\xFE";
 z+="            Row = devXGrid.GetDataRow(VisibleRowNo)\xFE";
 z+="            \xFE";
 z+="            If !devXGrid.IsGroupRow(VisibleRowNo) Then\xFE";
 z+="                if grpColumnCnt Then\xFE";
 z+="                    startANewGroup = False\xFE";
 z+="                    for i = 1 to grpColumnCnt\xFE";
 z+="                        grpCName = groupColumns[i]\xFE";
 z+="                        pVal = groupValues[i]\xFE";
 z+="                        cVal = Row[grpCName]\xFE";
 z+="                        if pVal <> cVal Then \xFE";
 z+="                            startANewGroup = True\xFE";
 z+="                            break\xFE";
 z+="                        end if\xFE";
 z+="                    next\xFE";
 z+="                    \xFE";
 z+="                    if startANewGroup then\xFE";
 z+="                        if nestedInFolder Then Kml[-1] = \"</Folder>\"\xFE";
 z+="                        \xFE";
 z+="                        for i = 1 to grpColumnCnt\xFE";
 z+="                            grpCName = groupColumns[i]\xFE";
 z+="                            cVal = Row[grpCName]\xFE";
 z+="                            groupValues[i] = cVal\xFE";
 z+="                        next\xFE";
 z+="                        \xFE";
 z+="                        Kml[-1] = \"<Folder>\"\xFE";
 z+="                        Kml[-1] = \"<name>\":@HtmlEncode(Join(groupValues, \" \")):\"</name>\"\xFE";
 z+="                        nestedInFolder = true\xFE";
 z+="                    end if\xFE";
 z+="                end if\xFE";
 z+="                   \xFE";
 z+="                Point = '<Point><coordinates>':Row(userSettings.lngColumnName):',':Row(userSettings.latColumnName):'</coordinates></Point>'\xFE";
 z+="                \xFE";
 z+="                desc = []\xFE";
 z+="                for i = 1 to grdColumnCnt\xFE";
 z+="                    grdColumn = grdColumns(i)\xFE";
 z+="                    cName = grdColumn.FieldName\xFE";
 z+="                    val = CStr(Row(cName))\xFE";
 z+="                    if Left(val, 4) = \"http\" Then\xFE";
 z+="                        desc[-1] = @HtmlEncode(cName:\": \"):'<a href=\"':val:'\">':Val:'</a>' \xFE";
 z+="                    Else\xFE";
 z+="                        desc[-1] = @HtmlEncode(cName:\": \":Val) \xFE";
 z+="                    End If\xFE";
 z+="                next\xFE";
 z+="                \xFE";
 z+="                KML[-1] = \"<Placemark><description>\":Join(Desc, \"<br />\"):\"</description>\":Point:\"</Placemark>\"\xFE";
 z+="                GotDetails = True\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        if nestedInFolder Then Kml[-1] = \"</Folder>\"\xFE";
 z+="        KML[-1] = \"</Document></kml>\"\xFE";
 z+="        \xFE";
 z+="        if !GotDetails Then\xFE";
 z+="            Print @Script('alert(\"Please expand at least one group\")'):\xFE";
 z+="        else\xFE";
 z+="            ReportName = userSettings.reportName\xFE";
 z+="            if !ReportName Then ReportName = userSettings.tableName\xFE";
 z+="            if !ReportName Then ReportName = userSettings.databaseName\xFE";
 z+="            if !ReportName Then ReportName = gridID\xFE";
 z+="            \xFE";
 z+="            Print @Script('saveFile(\"':reportName:'.kml\", \"application/vnd.google-earth.kmz\", ':jsEscapeString(Join(KML, \"\\n\")):')'):\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="function devxGrid_VisibleRows(byVal gridID As String) As Array\xFE";
 z+="    *$options aspx\xFE";
 z+="    \xFE";
 z+="    devXGrid = System(29).getControl(gridID)   // Don't set breakpoints until done using\xFE";
 z+="    dim grdColumns = devXGrid.Columns\xFE";
 z+="    grdColumnCnt = UBound(grdColumns)\xFE";
 z+="    VisibleRowCount = devXGrid.VisibleRowCount\xFE";
 z+="    \xFE";
 z+="    Points = []\xFE";
 z+="    For VisibleRowNo = 0 To VisibleRowCount - 1\xFE";
 z+="        Row = devXGrid.GetDataRow(VisibleRowNo)\xFE";
 z+="        oRow = {}\xFE";
 z+="        for i = 1 to grdColumnCnt\xFE";
 z+="            grdColumn = grdColumns(i)\xFE";
 z+="            cName = grdColumn.FieldName\xFE";
 z+="            val = Row(cName)\xFE";
 z+="            if Len(val) then oRow(grdColumn.FieldName) = val\xFE";
 z+="        next\xFE";
 z+="        Points[-1] = CStr(oRow)\xFE";
 z+="    Next\xFE";
 z+="    return Points\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="// =========================\xFE";
 z+="function getDevXGridMeta(serverURL, databaseName, tableName) As JSON\xFE";
 z+="    Dim schemaDefs As JSON = @@dbTableSchema(databaseName, tableName)\xFE";
 z+="       \xFE";
 z+="    Dim gridDefs As Array = []\xFE";
 z+="    Dim firstColumnName As String = \"\"\xFE";
 z+="    Dim primaryKey As String = \"\"\xFE";
 z+="    Dim firstGuid as Boolean = True\xFE";
 z+="    \xFE";
 z+="    if isJson(schemaDefs) Then\xFE";
 z+="        for each ColumnName As String, CI As Integer in schemaDefs\xFE";
 z+="            Dim dbDef As JSON = schemaDefs[ColumnName]\xFE";
 z+="            if dbDef.datatype = \"guid\" then \xFE";
 z+="                if firstGuid Then FirstGuid = False else dbDef.display = \"hidden\"\xFE";
 z+="            end if\xFE";
 z+="            if CI = 1 then firstColumnName = ColumnName\xFE";
 z+="            gridDefs[-1] = jsbDef2DevXGridDef(dbDef)\xFE";
 z+="            if dbDef.primarykey Then primaryKey = ColumnName\xFE";
 z+="        next\xFE";
 z+="    Else\xFE";
 z+="        for each dbDef As JSON, CI As Integer in schemaDefs\xFE";
 z+="            ColumnName = dbDef.name\xFE";
 z+="            if dbDef.datatype = \"guid\" then \xFE";
 z+="                if firstGuid Then FirstGuid = False else dbDef.display = \"hidden\"\xFE";
 z+="            end if\xFE";
 z+="            if CI = 1 then firstColumnName = ColumnName\xFE";
 z+="            gridDefs[-1] = jsbDef2DevXGridDef(dbDef)\xFE";
 z+="            if dbDef.primarykey Then primaryKey = ColumnName\xFE";
 z+="        next\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if !primaryKey then primaryKey = firstColumnName\xFE";
 z+="    return { gridDefs: gridDefs, primaryKey: primaryKey }\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="// tColumn fields: name, label, defaultvalue, required, notblank, tooltip, align, sortable, datatype, primarykey, encrypt, ordinal, canedit, maxlength (for strings), unique\xFE";
 z+="//\xFE";
 z+="function jsbDef2DevXGridDef(tColumn)\xFE";
 z+="    Dim Column As Json = {}\xFE";
 z+="    // setup Column.dataField\xFE";
 z+="    Column.dataField = tColumn.name\xFE";
 z+="    \xFE";
 z+="    Column.allowGrouping = true\xFE";
 z+="    if tColumn.align then Column.alignment = tColumn.align\xFE";
 z+="    \xFE";
 z+="    // Convert datatype from: guid;autointeger;integer;double;boolean;string;date;time;datetime;currency;blob;png;jpg;collection;url;memo;password,jsonarray,jsonrow\xFE";
 z+="    //    to one of these: number, boolean, string, date, datetime\xFE";
 z+="    \xFE";
 z+="    // Setup dataType\xFE";
 z+="    Column.dataType = 'string'\xFE";
 z+="    Column.showEditorAlways = false\xFE";
 z+="    select case tColumn.datatype\xFE";
 z+="        case 'currency': Column.dataType = 'number'; Column.format = 'currency'; Column.allowGrouping = false; if !Column.alignment then Column.alignment = 'right'\xFE";
 z+="        case 'autointeger': Column.dataType = 'number'; Column.allowGrouping = false; if !Column.alignment then Column.alignment = 'right'\xFE";
 z+="        case 'integer': Column.dataType = 'number'; if !Column.alignment then Column.alignment = 'right'\xFE";
 z+="        case 'double': Column.dataType = 'number'; Column.allowGrouping = false; if !Column.alignment then Column.alignment = 'right'\xFE";
 z+="        case 'boolean': Column.dataType = 'boolean'\xFE";
 z+="        case 'date': Column.dataType = 'date'\xFE";
 z+="        case 'time': Column.dataType = 'string'; Column.allowGrouping = false\xFE";
 z+="        case 'datetime': Column.dataType = 'datetime'; Column.allowGrouping = false\xFE";
 z+="    end select\xFE";
 z+="\xFE";
 z+="    if tColumn.Caption then Column.caption = tColumn.Caption else \xFE";
 z+="        if tColumn.label then Column.caption = tColumn.label  else Column.caption = tColumn.ColumnName \xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // https://js.devexpress.com/Documentation/ApiReference/Common/Object_Structures/format/\xFE";
 z+="    // cellTemplate: discountCellTemplate,\xFE";
 z+="    // cssClass: 'bullet'\xFE";
 z+="    \xFE";
 z+="    if tColumn.width then Column.width = tColumn.width\xFE";
 z+="\xFE";
 z+="    if tColumn.display = \"hidden\" Or tColumn.display = \"gridhidden\" then Column.visible = false\xFE";
 z+="    \xFE";
 z+="    /*\xFE";
 z+="        if tColumn.primarykey then Column.primarykey = true\xFE";
 z+="        if tColumn.index then Column.visibleIndex = tColumn.index\xFE";
 z+="    \xFE";
 z+="        \xFE";
 z+="        if tColumn.label then Column.label = tColumn.label\xFE";
 z+="        if tColumn.sorttype then Column.sorttype = tColumn.sorttype \xFE";
 z+="        if tColumn.sortable then Column.sortable = tColumn.sortable\xFE";
 z+="        if tColumn.formatoptions then Column.formatoptions = tColumn.formatoptions\xFE";
 z+="  \xFE";
 z+="\xFE";
 z+="        // https://js.devexpress.com/Documentation/ApiReference/UI_Components/dxDataGrid/Configuration/columns/#format\xFE";
 z+="        Dim ctlType As String = lcase(tColumn.control)\xFE";
 z+="        \xFE";
 z+="        // edittype and editoptions only set if column is editable\xFE";
 z+="        if tColumn.canedit || tColumn.editable then \xFE";
 z+="            Column.allowEditing = true\xFE";
 z+="            if tColumn.edittype then Column.edittype = tColumn.edittype\xFE";
 z+="            if tColumn.editoptions then Column.editoptions = tColumn.editoptions\xFE";
 z+="        else\xFE";
 z+="            ' Not editable\xFE";
 z+="            Column.allowEditing = false\xFE";
 z+="            if ctlType <> \"button\" And ctlType <> \"anchor\" and ctlType <> \"urlbox\" And ctlType <> \"url\" Then ctlType = \"\"\xFE";
 z+="        end if\xFE";
 z+="         \xFE";
 z+="       \xFE";
 z+="        if !Column.edittype and ctlType then\xFE";
 z+="            **\xFE";
 z+="            ** textbox, dropDownBox, combobox, listbox, autotextbox, datebox, timebox, datetimebox, imagebox, currencybox\xFE";
 z+="            **                maskedtextbox, radiobox, multiselectlistbox, multiselectdropDownBox, colorpick, slider\xFE";
 z+="            **                htmlbox, label, imagebox, uploadimagebox, appendbox, passwordbox\xFE";
 z+="            ** ->\xFE";
 z+="            **      text, textarea, checkbox, select, password, button, image, file custom\xFE";
 z+="            *\xFE";
 z+="            if ctlType = \"button\" Then\xFE";
 z+="                Column.formatter = \"^^jqGridAddBtn^^\"\xFE";
 z+="                Dim Url As String = DropIfRight(tColumn.transferurl, \".page\", true)\xFE";
 z+="                Column.editoptions = { colName: Column.Name, primaryKey: PKID, transferurl: Url, transferto: tColumn.transferto, transferaddfrompage: tColumn.transferaddfrompage, transferextra: tColumn.onParentExtra, datausuage: tColumn.datausuage, title: Column.label } \xFE";
 z+="                      \xFE";
 z+="            elseif ctlType = \"imagebox\" Then\xFE";
 z+="                ' Column.allowEditing = false\xFE";
 z+="                \xFE";
 z+="            elseif ctlType = \"checkbox\" Then\xFE";
 z+="                Column.edittype = \"checkbox\"\xFE";
 z+="                Column.editOptions = { value:\"1:0\" }\xFE";
 z+="                Column.formatter = \"checkbox\"\xFE";
 z+="                Column.alignment = \"center\"\xFE";
 z+="                \xFE";
 z+="            elseif ctlType = \"label\" Then\xFE";
 z+="                Column.allowEditing = false\xFE";
 z+="                \xFE";
 z+="            elseif ctlType = \"urlbox\" Or ctlType = \"anchor\" Then\xFE";
 z+="                Column.formatter = `^^function (cellValue, myOptions, rowObject) { return \"<a href=\" + urlEncode(cellValue) + \" target='_blank'>...</a>\";  }^^` \xFE";
 z+="            \xFE";
 z+="            elseif ctlType = \"url\" then\xFE";
 z+="                Column.formatter = `^^function (cellValue, myOptions, rowObject) { return \"<a href=\" + urlEncode(cellValue) + \" target='_blank'>\" + cellValue + \"</a>\";  }^^` \xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="    \xFE";
 z+="        if Right(Column.visibleIndex, 1) = \"#\" Then\xFE";
 z+="            //Column.sorttype = \"int\"\xFE";
 z+="            Column.sortIndex = Left(Column.visibleIndex, Len(Column.visibleIndex) - 1)\xFE";
 z+="            if !Column.alignment Then Column.alignment = \"right\"\xFE";
 z+="            \xFE";
 z+="        elseIf Column.datatype = \"integer\" Or Column.datatype = \"autointeger\" then\xFE";
 z+="            //Column.sorttype = \"int\"\xFE";
 z+="            If !Column.sortIndex Then Column.visibleIndex = Column.name\xFE";
 z+="            if !Column.alignment Then Column.alignment = \"right\"\xFE";
 z+="            \xFE";
 z+="        elseIf Column.datatype = \"double\" Then\xFE";
 z+="            //Column.sorttype = \"float\"\xFE";
 z+="            If !Column.sortIndex Then Column.visibleIndex = Column.name\xFE";
 z+="            if !Column.alignment Then Column.alignment = \"right\"\xFE";
 z+="            \xFE";
 z+="        else\xFE";
 z+="            If !Column.visibleIndex Then Column.index = Column.name\xFE";
 z+="        End If\xFE";
 z+="    */\xFE";
 z+="\xFE";
 z+="    Dim D As String\xFE";
 z+="    if tColumn.defaultvalue then D = tColumn.defaultvalue Else D = tColumn.defaultValue\xFE";
 z+="    If !D Then D = \"\"\xFE";
 z+="    if Column.control = \"json_inline\" Then\xFE";
 z+="        If Left(D,1) <> \"[\" Or Right(D,1) <> \"]\" Then \xFE";
 z+="            if Left(D, 1) = \"{\" And Right(D,1) = \"}\" Then D = \"[\":D:\"]\" Else D = \"[]\"\xFE";
 z+="        End If\xFE";
 z+="        Dim JS As Json = JSon(\"{array:\":D:\"}\")\xFE";
 z+="        D = js.array\xFE";
 z+="    End If\xFE";
 z+="    if Len(D) then Column.defaultValue = D\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    // Column.allowResizing = true ;* default\xFE";
 z+="    \xFE";
 z+="    // groupIndex: 0,\xFE";
 z+="    // allowGrouping\xFE";
 z+="    // width: 150\xFE";
 z+="    \xFE";
 z+="    return Column\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+=""
window.cached_jsb_html["devxgrid"]=z;
var z="/*\xFE";
 z+="    path2Database = AttachDBextended(databaseName, \"\", UserName, Password, InitialCatalog)\xFE";
 z+="    Or a direct path to a local database, ie: `c:\\backups\\awe.mdb` (or .accdb, or .sl3) \xFE";
 z+="          \xFE";
 z+="    Print devXPivotGrid(path2Database, sc, ic, UserName, Password, InitialCatalog)\xFE";
 z+="*/\xFE";
 z+="function devXPivotGrid(ByVal FileNameOrSelectList As Object, ByVal userSettings As JSON) As String\xFE";
 z+="    *$options aspx\xFE";
 z+="    *$options internal devxPivot, myPage, Ds\xFE";
 z+="    Dim devxPivot As Object\xFE";
 z+="\xFE";
 z+="    myPage = System(29)\xFE";
 z+="    if myPage Then devxPivot = myPage.getControl('devxPivot')\xFE";
 z+="    if !devxPivot Then\xFE";
 z+="        // force ourselves to go to the devXPage\xFE";
 z+="        myParams = Field(@Url, \"?\", 2)\xFE";
 z+="        if Len(myParams) Then\xFE";
 z+="            myParams = \"?\":MyParams\xFE";
 z+="            Sep = \"&\"\xFE";
 z+="        Else\xFE";
 z+="            Sep = \"?\"\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        if InStr(myParams, \"basePage=\") = 0 then \xFE";
 z+="            myParams := Sep:\"basePage=\":@UrlEncode(Field(@Url, \"?\", 1)) \xFE";
 z+="            Sep = \"&\"\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        if InStr(myParams, \"_SID_=\") = 0 then \xFE";
 z+="            myParams := Sep:\"_SID_=\":@UrlEncode(@UserNo) \xFE";
 z+="            Sep = \"&\"\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="\xFE";
 z+="        toUrl = @jsbRootAct():'aspxPivotGrid.aspx':myParams\xFE";
 z+="        reDirectPost(toUrl)\xFE";
 z+="\xFE";
 z+="        myPage = System(29)\xFE";
 z+="        if myPage Then devxPivot = myPage.getControl('devxPivot')\xFE";
 z+="        if !devxPivot Then Stop \"We should have redirected to aspxPivotGrid.aspx! and I can't find the devxPivot control!\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    devxPivotLayout = userSettings.devxPivotLayout\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    // filename given?\xFE";
 z+="    if isString(FileNameOrSelectList) Then\xFE";
 z+="        open FileNameOrSelectList to SelectList else return @Errors\xFE";
 z+="    \xFE";
 z+="    // fileHandle given?\xFE";
 z+="    Else if typeOfFile(FileNameOrSelectList) Then\xFE";
 z+="        select \"*\" from s to SelectList else return @Errors\xFE";
 z+="    \xFE";
 z+="    Else\xFE";
 z+="        SelectList = FileNameOrSelectList\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    // Must be SelectList\xFE";
 z+="    Dim ds As Object = SelectList.RowHandle.Table\xFE";
 z+="\xFE";
 z+="    devxPivot = System(29).getControl('devXPivot')\xFE";
 z+="    devxPivot.DataSource = ds\xFE";
 z+="    devxPivot.DataBind()\xFE";
 z+="    devxPivot.RetrieveFields()\xFE";
 z+="       \xFE";
 z+="    if userSettings.devxPivotLayout Then\xFE";
 z+="        devXGrid.LoadLayoutFromString(userSettings.devxPivotLayout)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html = \"{{\":\"marker}}\":@Script(S)\xFE";
 z+="    \xFE";
 z+="    return html\xFE";
 z+="End function"
window.cached_jsb_html["devxpivotgrid"]=z;
var z="function devxPivotSetup(byval tabID, byval databaseName, byVal ColumnList, byval tblID_Or_SQL, byval reportName, pivotLayout)\xFE";
 z+="    * %options aspxC-\xFE";
 z+="    \xFE";
 z+="    if !pivotLayout Then pivotLayout= {}\xFE";
 z+="    isSqlSelect = lcase(left(tblID_Or_SQL, 7)) = \"select \"\xFE";
 z+="    \xFE";
 z+="    dftRowLimit = 1000\xFE";
 z+="    \xFE";
 z+="    Theme = @jsbConfig(\"default_jsb_Themes\", \"theme_none\")\xFE";
 z+="    if Theme Then Theme = \"jsb_themes.\":Theme\xFE";
 z+="    \xFE";
 z+="    if !@jsb_odb.AttachDBextended(databaseName) Then Return False\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    UrlBase = @jsbRootAccount():\"devxPivotSetup\":`?databaseName=`:@UrlEncode(databaseName):`&tableID=`:@UrlEncode(tblID_Or_SQL)\xFE";
 z+="    \xFE";
 z+="    Cmd = \"\"\xFE";
 z+="    Msg = \"\"\xFE";
 z+="\xFE";
 z+="    if pivotLayout.AvailFlds Then\xFE";
 z+="        AvailFlds = pivotLayout.AvailFlds\xFE";
 z+="        possible_Sums = pivotLayout.possible_Sums\xFE";
 z+="        possible_aggElements = pivotLayout.possible_aggElements\xFE";
 z+="        possible_GrpCols = pivotLayout.possible_GrpCols\xFE";
 z+="    Else\xFE";
 z+="    \xFE";
 z+="reloadDefs:\xFE";
 z+="        SchemaDefs = @jsb_mdl.getColumnDefinitions(tblID_Or_SQL, columnNames)\xFE";
 z+="\xFE";
 z+="        AvailFlds = []\xFE";
 z+="        possible_Sums = []\xFE";
 z+="        possible_aggElements = []\xFE";
 z+="        possible_GrpCols = []\xFE";
 z+="        \xFE";
 z+="        ignoreTypes = Split(\"guid;blob;png;jpg;password;json;jsonarray\", \";\")\xFE";
 z+="        ignoreNames = Split(\"llid;lat;lon;lng;latitude;longitude\", \";\")\xFE";
 z+="        summableTypes = Split(\"integer;double;boolean;currency\", \";\")\xFE";
 z+="        AgTypes = Split(\"integer;double;currency\", \";\")\xFE";
 z+="        \xFE";
 z+="        If ColumnList = \"*\" Then ColumnList = \"\"\xFE";
 z+="        if ColumnList Then ColumnList = Split(LCase(Replace(ColumnList, \" \", \"\")), \",\") \xFE";
 z+="        for each dbColumn in SchemaDefs\xFE";
 z+="            CName = dbColumn.name\xFE";
 z+="            locate lcase(cname) in ignoreNames Then Cycle\xFE";
 z+="            if ColumnList Then\xFE";
 z+="                locate lcase(Replace(CName, \" \", \"\")) in ColumnList Else Cycle\xFE";
 z+="            end if\xFE";
 z+="\xFE";
 z+="            dt = dbColumn.datatype // guid;autointeger;integer;double;boolean;string;date;time;datetime;currency;blob;png;jpg;url;memo;password;json;jsonarray\xFE";
 z+="            Locate Dt In ignoreTypes Then Cycle\xFE";
 z+="            \xFE";
 z+="            Locate Dt in summableTypes then isSummable = True Else isSummable = False\xFE";
 z+="            Locate Dt in AgTypes then isAverageable = True Else isAverageable = False\xFE";
 z+="    \xFE";
 z+="            AvailFlds[-1] = CName\xFE";
 z+="            if isSummable Then possible_Sums[-1] = dbColumn.name\xFE";
 z+="            if isAverageable Then possible_aggElements[-1] = dbColumn.name\xFE";
 z+="        next\xFE";
 z+="        \xFE";
 z+="        if isSqlSelect Then\xFE";
 z+="            SqlSelect tblID_Or_SQL To SelectList Else Return False\xFE";
 z+="        Else\xFE";
 z+="            Open tblID_Or_SQL To fTable Else Return False\xFE";
 z+="            Select \"TOP \":dftRowLimit:\" \":Join(columnNames, \",\") From fTable To SelectList Else Return False\xFE";
 z+="        end if\xFE";
 z+="    \xFE";
 z+="        dt = SelectList.RowHandle.Table\xFE";
 z+="        dtColumns = dt.Columns\xFE";
 z+="        dtColCnt = dtColumns.Count\xFE";
 z+="        dtRows = dt.Rows\xFE";
 z+="        \xFE";
 z+="        // Count how many times each column is used\xFE";
 z+="        colCnts = []\xFE";
 z+="        for each cName, ci in ColumnNames\xFE";
 z+="           Select \"Distint Count(*)\" From fTable Where \"[\":cName:\"] <> ''\" To sl Then \xFE";
 z+="               colCnts[ci] = DCount(getlist(sl, true), am())\xFE";
 z+="           End If\xFE";
 z+="        next\xFE";
 z+="        \xFE";
 z+="        possible_GrpCols = [] // based on count\xFE";
 z+="        for each cName, ci in ColumnNames\xFE";
 z+="            if colCnts[ci] < 30 then possible_GrpCols[-1] = cName\xFE";
 z+="        next\xFE";
 z+="        \xFE";
 z+="        pivotLayout.AvailFlds = AvailFlds\xFE";
 z+="        pivotLayout.possible_Sums = possible_Sums\xFE";
 z+="        pivotLayout.possible_aggElements = possible_aggElements\xFE";
 z+="        pivotLayout.possible_GrpCols = possible_GrpCols\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html = []\xFE";
 z+="\xFE";
 z+="    // Setup for javascript\xFE";
 z+="    \xFE";
 z+="    Html[-1] = @Hidden(\"AvailFlds\", Join(AvailFlds, \";\"))\xFE";
 z+="    Html[-1] = @Hidden(\"possible_GrpCols\", Join(possible_GrpCols, \";\"))\xFE";
 z+="    Html[-1] = @Hidden(\"possible_aggElements\", Join(possible_aggElements, \";\"))\xFE";
 z+="    Html[-1] = @Hidden(\"possible_Sums\", Join(possible_Sums, \";\"))\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="// Current selections\xFE";
 z+="    Html[-1] = @Hidden(\"GrpRows\", pivotLayout.GrpRows)\xFE";
 z+="    Html[-1] = @Hidden(\"GrpCols\", pivotLayout.GrpCols)\xFE";
 z+="    Html[-1] = @Hidden(\"Sums\", pivotLayout.Sums)\xFE";
 z+="    Html[-1] = @Hidden(\"Counts\", pivotLayout.Counts)\xFE";
 z+="    Html[-1] = @Hidden(\"Averages\", pivotLayout.Averages)\xFE";
 z+="    Html[-1] = @Hidden(\"StdDevs\", pivotLayout.StdDevs)\xFE";
 z+="    Html[-1] = @Hidden(\"Mins\", pivotLayout.Mins)\xFE";
 z+="    Html[-1] = @Hidden(\"Maxs\", pivotLayout.Mins)\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    Html[-1] = @Html(`\xFE";
 z+="    <div style=\"position: relative\">\xFE";
 z+="        <div style=\"width: 100%; border-style: none; display: flex;\">\xFE";
 z+="            <div style=\"float: left; width: 15%; height: 30; border-style: none;\"></div>\xFE";
 z+="            <div style=\"float: left; width: 15%; height: 30; border-style: none;\"></div>\xFE";
 z+="            <div class=\"pvtHeader\" style=\"float: left; width: 68%; height: 30; border-style: none; text-align: center;\">\xFE";
 z+="                Grouping Columns\xFE";
 z+="            </div>\xFE";
 z+="        </div>\xFE";
 z+="        <div style=\"width: 100%; border-style: none; display: flex; margin-bottom: 5px;\">\xFE";
 z+="            <div class=\"pvtHeader\" style=\"float: left; width: 15%; height: 30; border-style: none; text-align: center;\">\xFE";
 z+="                Avaliable Fields\xFE";
 z+="            </div>\xFE";
 z+="            <div class=\"pvtHeader\" style=\"float: left; width: 15%; height: 30; border-style: none; text-align: center;\">\xFE";
 z+="                Grouping Rows\xFE";
 z+="            </div>\xFE";
 z+="            <div style=\"float: left; width: 68%; height: 30; border-style: none;\">\xFE";
 z+="                <ul id=\"pvtList\" class=\" connectedlist FieldTD\" />\xFE";
 z+="            </div>\xFE";
 z+="        </div>\xFE";
 z+="        <div style=\"float: left; width: 15%; min-height: 510px; border-style: solid; border-color: #000000; border-width: thin; text-align: center; margin-right: 5px;\">\xFE";
 z+="            <ul id=\"fldList\" runat=\"server\" class=\"connectedlist FieldTD\"  />\xFE";
 z+="        </div>\xFE";
 z+="        <div style=\"float: left; width: 15%; min-height: 510px; border-style: none; text-align: center;\">\xFE";
 z+="            <ul id=\"rowList\" class=\"connectedlist FieldTD\" style=\"min-height: 510px;\" />\xFE";
 z+="        </div>\xFE";
 z+="        <div style=\"float: left; width: 60%; min-height: 510px; border-style: none; text-align: center;\">\xFE";
 z+="            <table style=\"width: 100%; min-height: 510px;\">\xFE";
 z+="                <tr>\xFE";
 z+="                    <td class=\"pvtHeader\" style=\"vertical-align: top; width: 49%;\">Counts\xFE";
 z+="                    <br />\xFE";
 z+="                        <ul id=\"cntList\" class=\"connectedlist FieldTD\" style=\"border-style: none; height: 140px\" />\xFE";
 z+="                    </td>\xFE";
 z+="                    <td class=\"pvtHeader\" style=\"vertical-align: top; width: 49%;\">Sums\xFE";
 z+="                    <br />\xFE";
 z+="                        <ul id=\"sumList\" class=\"connectedlist FieldTD\" style=\"border-style: none; height: 140px\" />\xFE";
 z+="                    </td>\xFE";
 z+="                </tr>\xFE";
 z+="                <tr>\xFE";
 z+="                    <td class=\"pvtHeader\" style=\"vertical-align: top; width: 49%;\">Averages\xFE";
 z+="                    <br />\xFE";
 z+="                        <ul id=\"avgList\" class=\"connectedlist FieldTD\" style=\"border-style: none; height: 140px\" />\xFE";
 z+="                    </td>\xFE";
 z+="                    <td class=\"pvtHeader\" style=\"vertical-align: top; width: 49%;\">Standard Deviation\xFE";
 z+="                    <br />\xFE";
 z+="                        <ul id=\"stdList\" class=\"connectedlist FieldTD\" style=\"border-style: none; height: 140px\" />\xFE";
 z+="                    </td>\xFE";
 z+="                </tr>\xFE";
 z+="                <tr>\xFE";
 z+="                    <td class=\"pvtHeader\" style=\"vertical-align: top; width: 49%;\">Minimums\xFE";
 z+="                    <br />\xFE";
 z+="                        <ul id=\"minList\" class=\"connectedlist FieldTD\" style=\"border-style: none; height: 140px\" />\xFE";
 z+="                    </td>\xFE";
 z+="                    <td class=\"pvtHeader\" style=\"vertical-align: top; width: 49%;\">Maximums\xFE";
 z+="                    <br />\xFE";
 z+="                        <ul id=\"maxList\" class=\"connectedlist FieldTD\" style=\"border-style: none; height: 140px\" />\xFE";
 z+="                    </td>\xFE";
 z+="                </tr>\xFE";
 z+="            </table>\xFE";
 z+="        </div>\xFE";
 z+="    </div>\xFE";
 z+="     `)\xFE";
 z+="     \xFE";
 z+="    Html[-1] = @Script(`\xFE";
 z+="    function saveRows(ulID, resultTextElement) {\xFE";
 z+="        var ulElement = document.getElementById(ulID);\xFE";
 z+="        var resultElement = document.getElementById(resultTextElement);\xFE";
 z+="        var cnt = 0;\xFE";
 z+="    \xFE";
 z+="        if (!ulElement || !resultElement) return 0;\xFE";
 z+="    \xFE";
 z+="        var ulNodes = ulElement.getElementsByTagName(\"li\");\xFE";
 z+="        var liTags = \"\";\xFE";
 z+="        if (ulNodes.length != 0) {\xFE";
 z+="            for (var i = 0; i < ulNodes.length; i++) {\xFE";
 z+="                liTags += ulNodes[i].innerText + \";\";\xFE";
 z+="                cnt += 1;\xFE";
 z+="            }\xFE";
 z+="        }\xFE";
 z+="        resultElement.value = liTags;\xFE";
 z+="        return cnt;\xFE";
 z+="    }\xFE";
 z+="    \xFE";
 z+="    function saveRowsAndCols() {\xFE";
 z+="        var hasrows, hascols, hasaggs;\xFE";
 z+="    \xFE";
 z+="        saveRows(\"fldList\", \"GrpRows\");\xFE";
 z+="        hasrows = saveRows(\"rowList\", \"GrpRows\") != 0;\xFE";
 z+="        hascols = saveRows(\"pvtList\", \"GrpCols\") != 0;\xFE";
 z+="        hasaggs = saveRows(\"sumList\", \"Sums\");\xFE";
 z+="        hasaggs += saveRows(\"cntList\", \"Counts\");\xFE";
 z+="        hasaggs += saveRows(\"avgList\", \"Averages\");\xFE";
 z+="        hasaggs += saveRows(\"stdList\", \"StdDevs\");\xFE";
 z+="        hasaggs += saveRows(\"minList\", \"Mins\");\xFE";
 z+="        hasaggs += saveRows(\"maxList\", \"Maxs\");\xFE";
 z+="        hasaggs = hasaggs != 0;\xFE";
 z+="    \xFE";
 z+="        //if (!hasrows) { alert('You must have some fields under the Grouping Rows. Please try again.'); return false; }\xFE";
 z+="        //if (!hascols) { alert('You must have some fields under the Grouping Columns. Please try again.'); return false; }\xFE";
 z+="        if (!hasaggs) { alert('You must have some fields entered in one of the Sum, Cnt, Avg, Min or Max areas. Please try again.'); return false; }\xFE";
 z+="    \xFE";
 z+="        return true;\xFE";
 z+="    }\xFE";
 z+="    \xFE";
 z+="    function loadRows(ulID, resultTextElement) {\xFE";
 z+="        var ulElement = document.getElementById(ulID);\xFE";
 z+="        var resultElement = document.getElementById(resultTextElement);\xFE";
 z+="    \xFE";
 z+="        if (!ulElement || !resultElement) return;\xFE";
 z+="        var liTags = resultElement.value.split(\";\");\xFE";
 z+="        for (var i = 0; i < liTags.length - 1; i++) {\xFE";
 z+="            var newLI = document.createElement(\"li\");\xFE";
 z+="            newLI.innerText = liTags[i];\xFE";
 z+="            ulElement.appendChild(newLI);\xFE";
 z+="        }\xFE";
 z+="    }\xFE";
 z+="    \xFE";
 z+="    function loadRowsAndCols() {\xFE";
 z+="        loadRows(\"fldList\", \"AvailFlds\");\xFE";
 z+="        loadRows(\"rowList\", \"GrpRows\");\xFE";
 z+="        loadRows(\"pvtList\", \"GrpCols\");\xFE";
 z+="        loadRows(\"sumList\", \"Sums\");\xFE";
 z+="        loadRows(\"cntList\", \"Counts\");\xFE";
 z+="        loadRows(\"avgList\", \"Averages\");\xFE";
 z+="        loadRows(\"stdList\", \"StdDevs\");\xFE";
 z+="        loadRows(\"minList\", \"Mins\");\xFE";
 z+="        loadRows(\"maxList\", \"Maxs\");\xFE";
 z+="    }\xFE";
 z+="    \xFE";
 z+="    function onReceive(ui, lielement) {\xFE";
 z+="        var item = ui.item[0].outerText;\xFE";
 z+="        var lst = lielement[0].id;\xFE";
 z+="    \xFE";
 z+="        // Are we dropping into the pivot area?\xFE";
 z+="        if (lst == 'pvtList') {\xFE";
 z+="            // item must exist in possible_GrpCols\xFE";
 z+="            var ulElement = document.getElementById('possible_GrpCols');\xFE";
 z+="            if (!ulElement) return;\xFE";
 z+="            if (ulElement.value.indexOf(item) == -1) {\xFE";
 z+="                var answer = confirm('Are you sure you wish to do this? (' + item + ' is a large group; It might be better in the grouping fields)')\xFE";
 z+="                if (!answer) $(ui.sender).sortable('cancel');\xFE";
 z+="                return;\xFE";
 z+="            }\xFE";
 z+="        }\xFE";
 z+="    \xFE";
 z+="        // Are we dropping into a sum only area?\xFE";
 z+="        if (lst == 'sumList') {\xFE";
 z+="            // item must exist in possible_GrpCols\xFE";
 z+="            var ulElement = document.getElementById('possible_Sums');\xFE";
 z+="            if (!ulElement) return;\xFE";
 z+="            if (ulElement.value.indexOf(item) == -1) {\xFE";
 z+="                alert(item + ' is not numeric and therefore can not be summed.  Please try again.');\xFE";
 z+="                $(ui.sender).sortable('cancel');\xFE";
 z+="                return;\xFE";
 z+="            }\xFE";
 z+="        }\xFE";
 z+="    \xFE";
 z+="        // Are we dropping into a aggragate only area?\xFE";
 z+="        if (lst == 'avgList' || lst == 'stdList' || lst == 'minList' || lst == 'maxList') {\xFE";
 z+="            // item must exist in possible_GrpCols\xFE";
 z+="            var ulElement = document.getElementById('possible_aggElements');\xFE";
 z+="            if (!ulElement) return;\xFE";
 z+="            if (ulElement.value.indexOf(item) == -1) {\xFE";
 z+="                alert(item + ' is not an integer or real number, therefore can not be aggregated.  Please try again.');\xFE";
 z+="                $(ui.sender).sortable('cancel');\xFE";
 z+="                return;\xFE";
 z+="            }\xFE";
 z+="        }\xFE";
 z+="    \xFE";
 z+="        // Valid drop - make a duplicate (if we came from fldlist)\xFE";
 z+="        if (ui.sender[0].id == 'fldList' && lst != 'fldList') {\xFE";
 z+="            var ulElement = document.getElementById(lst);\xFE";
 z+="            var fldlist = document.getElementById('fldList');\xFE";
 z+="            if (!ulElement || !fldlist) return;\xFE";
 z+="    \xFE";
 z+="            // Make sure it doesn't already exists\xFE";
 z+="            var newLI = document.createElement(\"li\");\xFE";
 z+="            newLI.innerText = item;\xFE";
 z+="            fldlist.appendChild(newLI);\xFE";
 z+="        }\xFE";
 z+="    }\xFE";
 z+="    \xFE";
 z+="    $(function () {\xFE";
 z+="        loadRowsAndCols();\xFE";
 z+="        $(\"#pvtList, #fldList, #rowList, #sumList, #cntList, #avgList, #stdList, #minList, #maxList\").sortable({\xFE";
 z+="            connectWith: \".connectedlist\",\xFE";
 z+="            receive: function (event, ui) {\xFE";
 z+="                onReceive(ui, $(this));\xFE";
 z+="            }\xFE";
 z+="        }).disableSelection();\xFE";
 z+="    });\xFE";
 z+="    \xFE";
 z+="    `)\xFE";
 z+="\xFE";
 z+="    Html[-1] = @Style(`\xFE";
 z+="        #fldList, #rowList, #sumList, #cntList, #avgList, #stdList, #minList, #maxList\xFE";
 z+="        {\xFE";
 z+="            list-style-type:none;\xFE";
 z+="            padding:0px;\xFE";
 z+="            margin:0;\xFE";
 z+="            height:100%;\xFE";
 z+="            width:100%;\xFE";
 z+="            white-space:nowrap;\xFE";
 z+="        }\xFE";
 z+="        #pvtList\xFE";
 z+="        {\xFE";
 z+="            list-style-type:none;\xFE";
 z+="            height: 100%;\xFE";
 z+="            width:100%;\xFE";
 z+="            white-space:nowrap;\xFE";
 z+="            margin-top:2px;\xFE";
 z+="            margin-bottom:2px;\xFE";
 z+="            margin-left:2px;\xFE";
 z+="            margin-right:2px;\xFE";
 z+="        }\xFE";
 z+="        #pvtList li {\xFE";
 z+="            display: inline;\xFE";
 z+="            border-style: solid;\xFE";
 z+="            border-width:thin;\xFE";
 z+="            padding-right:3px;\xFE";
 z+="            padding-left:3px;\xFE";
 z+="        }\xFE";
 z+="        #fldList li, #rowList li, #sumList li, #cntList li, #avgList li, #stdList li, #minList li, #maxList li\xFE";
 z+="        {\xFE";
 z+="\xFE";
 z+="        }\xFE";
 z+="        .pvtHeader, .connectedlist {\xFE";
 z+="          border: 1px solid;\xFE";
 z+="        }\xFE";
 z+="        .connectedlist  {\xFE";
 z+="          background-color: rgba(0, 0, 0, .5)\xFE";
 z+="        }\xFE";
 z+="        .FieldTD li {\xFE";
 z+="          background-color: #999;\xFE";
 z+="          \xFE";
 z+="            border-style: solid;\xFE";
 z+="            border-width:thin;\xFE";
 z+="            padding:0px;\xFE";
 z+="            margin:2px;\xFE";
 z+="            margin-top:2px;\xFE";
 z+="            margin-bottom: 2px;\xFE";
 z+="        }\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    `)\xFE";
 z+="\xFE";
 z+="    Html[-1] = @Html(`\xFE";
 z+="        <table style=\"margin-top: 5px\">\xFE";
 z+="            <tbody><tr style=\"height: 10px\"></tr><tr>\xFE";
 z+="               <td>\xFE";
 z+="                  <strong>\xFE";
 z+="                     Title\xFE";
 z+="                  </strong>\xFE";
 z+="               </td>\xFE";
 z+="               <td>\xFE";
 z+="                  `:TextBox(\"Title\", pivotLayout.Title):`\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td></td>\xFE";
 z+="               <td></td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td align=\"center\">\xFE";
 z+="                  <strong>\xFE";
 z+="                     Pivot Options:\xFE";
 z+="                  </strong>\xFE";
 z+="               </td>\xFE";
 z+="               <td>\xFE";
 z+="                    <table cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse:collapse;\">\xFE";
 z+="                     <tbody><tr>\xFE";
 z+="                      <td>`:CheckBox(\"ShowPivotTable\", 1, \"\", pivotLayout.ShowPivotTable):`</td><td><label for=\"I\" style=\"margin-left:2px;\">Show Pivot Table</label></td>\xFE";
 z+="                     </tr>\xFE";
 z+="                    </tbody></table>\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td></td>\xFE";
 z+="               <td>\xFE";
 z+="                  <table cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse:collapse;\">\xFE";
 z+="                     <tbody><tr>\xFE";
 z+="                      <td>`:CheckBox(\"ShowRowGrandTotals\", 1, \"\", pivotLayout.ShowRowGrandTotals):`</td><td><label for=\"I\" style=\"margin-left:2px;\">Show Row Grand Totals</label></td>\xFE";
 z+="                     </tr>\xFE";
 z+="                    </tbody></table>\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td></td>\xFE";
 z+="               <td>\xFE";
 z+="                  <table cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse:collapse;\">\xFE";
 z+="                     <tbody><tr>\xFE";
 z+="                      <td>`:CheckBox(\"ShowColumnGrandTotals\", 1, \"\", pivotLayout.ShowColumnGrandTotals+0):`</td><td><label for=\"I\" style=\"margin-left:2px;\">Show Column Grand Totals</label></td>\xFE";
 z+="                     </tr>\xFE";
 z+="                    </tbody></table>\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr></tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td align=\"center\">\xFE";
 z+="                  <strong>\xFE";
 z+="                     &nbsp;&nbsp;&nbsp;&nbsp; Graphing Options:&nbsp;&nbsp;&nbsp;&nbsp;\xFE";
 z+="                  </strong>\xFE";
 z+="               </td>\xFE";
 z+="               <td>\xFE";
 z+="                  <table cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse:collapse;\">\xFE";
 z+="                     <tbody><tr>\xFE";
 z+="                      <td>`:CheckBox(\"ShowGraph\", 1, \"\", pivotLayout.ShowGraph+0):`</td><td><label for=\"I\" style=\"margin-left:2px;\">Show Graph</label></td>\xFE";
 z+="                     </tr>\xFE";
 z+="                    </tbody></table>\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td></td>\xFE";
 z+="               <td>\xFE";
 z+="                  <table cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse:collapse;\">\xFE";
 z+="                     <tbody><tr>\xFE";
 z+="                      <td>`:CheckBox(\"PointLabels\", 1, \"\", pivotLayout.PointLabels+0):`</td><td><label for=\"I\" style=\"margin-left:2px;\">Show Point Labels</label></td>\xFE";
 z+="                     </tr>\xFE";
 z+="                    </tbody></table>\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td></td>\xFE";
 z+="               <td>\xFE";
 z+="                  <table cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse:collapse;\">\xFE";
 z+="                     <tbody><tr>\xFE";
 z+="                      <td>`:CheckBox(\"ChartDataVertical\", 1, \"\", pivotLayout.ChartDataVertical+0):`</td><td><label for=\"I\" style=\"margin-left:2px;\">Generate Series from Columns</label></td>\xFE";
 z+="                     </tr>\xFE";
 z+="                    </tbody></table>\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td align=\"right\">\xFE";
 z+="                  <label>Chart Type:</label>\xFE";
 z+="               </td>\xFE";
 z+="               <td>\xFE";
 z+="                  `:DropDownBox(\"ChartType\",  Split(\"Bar,StackedBar,FullStackedBar,SideBySideStackedBar,SideBySideFullStackedBar,Pie,Doughnut,Funnel,Point,Line,StepLine,Spline,ScatterLine,SwiftPlot,Area,SplineArea,StackedArea,StackedSplineArea,FullStackedArea,FullStackedSplineArea,RadarPoint,RadarLine,RadarArea,Bar3D,StackedBar3D,FullStackedBar3D,ManhattanBar,SideBySideStackedBar3D,SideBySideFullStackedBar3D,Pie3D,Doughnut3D,Funnel3D,Line3D,StepLine3D,Area3D,StackedArea3D,FullStackedArea3D,Spline3D,SplineArea3D,StackedSplineArea3D,FullStackedSplineArea3D\", \",\"), pivotLayout.ChartType):`\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td align=\"right\">\xFE";
 z+="                  <label>X Axis Caption</label>\xFE";
 z+="               </td>\xFE";
 z+="               <td>\xFE";
 z+="                  `:TextBox(\"XAxisCaption\", pivotLayout.XAxisCaption):`\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td align=\"right\">\xFE";
 z+="                  <label>Y Axis Caption</label>\xFE";
 z+="               </td>\xFE";
 z+="               <td>\xFE";
 z+="                  `:TextBox(\"YAxisCaption\", pivotLayout.YAxisCaption):`\xFE";
 z+="               </td>\xFE";
 z+="            </tr>\xFE";
 z+="            <tr>\xFE";
 z+="               <td align=\"right\"></td>\xFE";
 z+="               <td></td>\xFE";
 z+="            </tr>\xFE";
 z+="         </tbody></table>`)\xFE";
 z+="         \xFE";
 z+="    Return Join(Html, \"\")\xFE";
 z+="         \xFE";
 z+="    @Server.Pause\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    return Cmd = \"Next\"\xFE";
 z+="end function\xFE";
 z+="   \xFE";
 z+="Sub devxUnloadPivot(pivotLayout)\xFE";
 z+="    * %options aspxC-\xFE";
 z+="        \xFE";
 z+="    if !pivotLayout Then pivotLayout = {}\xFE";
 z+="    \xFE";
 z+="    pivotLayout.GrpRows = @formVar(\"GrpRows\")\xFE";
 z+="    pivotLayout.GrpCols = @formVar(\"GrpCols\")\xFE";
 z+="    pivotLayout.Sums = @formVar(\"Sums\")\xFE";
 z+="    pivotLayout.Counts = @formVar(\"Counts\")\xFE";
 z+="    pivotLayout.Averages = @formVar(\"Averages\")\xFE";
 z+="    pivotLayout.StdDevs = @formVar(\"StdDevs\")\xFE";
 z+="    pivotLayout.Mins = @formVar(\"Mins\")\xFE";
 z+="    pivotLayout.Maxs = @formVar(\"Maxs\")\xFE";
 z+="\xFE";
 z+="    pivotLayout.Title = @formVar(\"Title\")\xFE";
 z+="    pivotLayout.XAxisCaption = @formVar(\"XAxisCaption\")\xFE";
 z+="    pivotLayout.YAxisCaption = @formVar(\"YAxisCaption\")\xFE";
 z+="    pivotLayout.ChartType = @formVar(\"ChartType\")\xFE";
 z+="    pivotLayout.ShowPivotTable = Val(@formVar(\"ShowPivotTable\"))\xFE";
 z+="    pivotLayout.ShowRowGrandTotals  = Val(@formVar(\"ShowRowGrandTotals\"))\xFE";
 z+="    pivotLayout.ShowColumnGrandTotals = Val(@formVar(\"ShowColumnGrandTotals\"))\xFE";
 z+="    pivotLayout.ShowGraph = Val(@formVar(\"ShowGraph\"))\xFE";
 z+="    pivotLayout.PointLabels = Val(@formVar(\"PointLabels\"))\xFE";
 z+="    pivotLayout.ChartDataVertical = Val(@formVar(\"ChartDataVertical\"))\xFE";
 z+="end Sub\xFE";
 z+=""
window.cached_jsb_html["devxpivotsetup"]=z;
var z="// ICon is base64 data:, or jQuery class icon (ie, ui-icon-closethick)\xFE";
 z+="function devXQueryBuilderBtn(byval qbID As StRiNg, byval onClick As String, ICon As String, optional byval doSaveFirst As StRiNg, optional byval doSubmitCmd As StRiNg, optional byval LeftOrRight As String) As String\xFE";
 z+="*$options aspx\xFE";
 z+="    Dim HTML As Array\xFE";
 z+="\xFE";
 z+="    if !LeftOrRight then LeftOrRight = \"left\"\xFE";
 z+="    \xFE";
 z+="    if len(onClick) and Right(onClick, 1) <> `;` Then onClick := `;`\xFE";
 z+="    \xFE";
 z+="    if doSaveFirst Then \xFE";
 z+="        onClick = ` `:qbID:`.PerformCallback(\"My Save\"); `:onClick\xFE";
 z+="        if doSubmitCmd Then \xFE";
 z+="            onClick := ` window.doJsbSubmitOnCallBack = true; setInterval(function () { if (window.doTheJsbSubmit) { window.doTheJsbSubmit = false; doJsbSubmit(false) } }, 100)` \xFE";
 z+="        else \xFE";
 z+="            onClick := ` window.doJsbSubmitOnCallBack = false;`\xFE";
 z+="        end if\xFE";
 z+="    Else\xFE";
 z+="        if doSubmitCmd Then onClick := ` window.doJsbSubmit(false);`\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    html = []\xFE";
 z+="    Html[-1] = `<div class=\"dxrd-toolbar-item\" style=\"float:`:LCase(LeftOrRight):`\">`\xFE";
 z+="    Html[-1] = `<button class=\"ui-button ui-widget ui-corner-all\" onclick=\"`:@jsEscapeAttr(onClick, `\"`):`\"`\xFE";
 z+="    if left(ICon, 5) = `data:` Then\xFE";
 z+="        Html[-1] = ` style=\"border:none;\">`\xFE";
 z+="        Html[-1] = `<img class=\"ui-icon ui-widget-icon-block\" style=\"width:32px;height:32px;margin-top:-5px;margin-left:-15px\" src=\"`:ICon:`\" />`\xFE";
 z+="    Else\xFE";
 z+="        Html[-1] = ` style=\"width:32px;height:32px;\">`\xFE";
 z+="        Html[-1] = `<span class=\"ui-icon `:ICon:` ui-widget-icon-block\"></span>`\xFE";
 z+="    End If\xFE";
 z+="    Html[-1] = `</button>`\xFE";
 z+="    Html[-1] = `</div>`\xFE";
 z+="\xFE";
 z+="    return `$(\".dxrd-toolbar\").append('`:Join(Html,``):`'); `\xFE";
 z+="end function"
window.cached_jsb_html["devxquerybuilderbtn"]=z;
var z="/*\xFE";
 z+="    path2Database = `c:\\backups\\awe.mdb` (or .accdb, or .sl3) or \"MSSQLSERVER;UserName=xx;Password=yy;Initial Catalog=zz\"\xFE";
 z+="    path2Database = `D:\\home\\site\\wwwroot\\App_Data\\_database\\Northwind.accdb`\xFE";
 z+="    path2Database = `D:\\home\\site\\wwwroot\\App_Data\\_database\\nwind.mdb`\xFE";
 z+="    \xFE";
 z+="    myBtnICon = `data:image/png;base64,......`\xFE";
 z+="    myBtnICon = `ui-icon-closethick` ;* jQuery ICONS\xFE";
 z+="    myBtnOnclick = `assignBtn(this, \"Quit\"); doJsbSubmit(false);`\xFE";
 z+="    myBtn = devXQueryBuilderBtn(\"myBtn\", myBtnOnclick, myBtnICon, 'right')\xFE";
 z+="    \xFE";
 z+="    Print devXSqlBuilder(\"myID\", path2Database, previousQuery, myBtn)\xFE";
 z+="    \xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="// path2database may be sqlservername.mssql;initial catalog=xxxx\xFE";
 z+="\xFE";
 z+="function devXSqlBuilder(byval qbID As String, path2Database As Object, optional byval useXML As StRiNg, optional byval onInit As StRiNg, optional byval UserName As String, optional byval Password As String, optional byval InitialCatalog As String) As StRiNg\xFE";
 z+="*$options aspx\xFE";
 z+="*$options internal QB, pg, JSBFORM, Marker\xFE";
 z+="    Dim QB As Object\xFE";
 z+="    Dim pg As Object\xFE";
 z+="    Dim JsbForm As Object\xFE";
 z+="    Dim Marker As Object\xFE";
 z+="    \xFE";
 z+="    Dim DATASOURCE As String\xFE";
 z+="    Dim EXT As String\xFE";
 z+="    Dim CONNECTIONSTRING As StRiNg\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if !qbID Then qbID = \"devXQueryBuilder_\":Replace(Right(Timer(), 4), \".\", \"\")\xFE";
 z+="    \xFE";
 z+="    dataSource = field(path2Database, \";\", 1)\xFE";
 z+="    if InStr(dataSource, \".\") Then Ext = LCase(RightField(dataSource, \".\")) Else Ext = \"\"\xFE";
 z+="    \xFE";
 z+="    dataSource = DropIfRight(dataSource, \".mssql\")\xFE";
 z+="    \xFE";
 z+="    If Ext = \"\" Then\xFE";
 z+="        path2Database = @jsb_odb.AttachDBextended(dataSource, \"databaseBuilder_ro\", connectionString, UserName, Password, InitialCatalog) \xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    if !Password And instri(path2Database, \";password=\") then Password = Field(Mid(path2Database, instri(path2Database, \";password=\") + 10), \";\", 1)\xFE";
 z+="    if !UserName And instri(path2Database, \";username=\") then UserName = Field(Mid(path2Database, instri(path2Database, \";username=\") + 10), \";\", 1)\xFE";
 z+="    if !InitialCatalog And instri(path2Database, \";initial catalog=\") then InitialCatalog = Field(Mid(path2Database, instri(path2Database, \";initial catalog=\") + 17), \";\", 1)\xFE";
 z+="        \xFE";
 z+="    ' Setup Page\xFE";
 z+="    //Pg = System(29)\xFE";
 z+="    //if !Pg Then Pg = CreateObject('Page')\xFE";
 z+="    Pg = CreateObject('Page')\xFE";
 z+="    \xFE";
 z+="    Pg.lastXmlQuery = useXML\xFE";
 z+="    Pg.Ext = Ext\xFE";
 z+="    \xFE";
 z+="    If Ext = \"mdb\" Then\xFE";
 z+="        Pg.FileName = dataSource\xFE";
 z+="        if UserName Then Pg.UserName = UserName\xFE";
 z+="        if Password Then Pg.Password = Password\xFE";
 z+="\xFE";
 z+="    ElseIf Ext = \"accdb\" Then\xFE";
 z+="        Pg.FileName = dataSource\xFE";
 z+="        if Password Then Pg.Password = Password\xFE";
 z+="        \xFE";
 z+="    ElseIf Ext = \"mssql\" Or Ext = \"\" Then\xFE";
 z+="        Pg.AuthorizationType = 1 ;* MsSqlAuthorizationType.SqlServer\xFE";
 z+="        Pg.ServerName = path2Database \xFE";
 z+="        if UserName Then Pg.UserName = UserName\xFE";
 z+="        if Password Then Pg.Password = Password\xFE";
 z+="        if InitialCatalog Then Pg.DatabaseName = InitialCatalog\xFE";
 z+="        \xFE";
 z+="    Else ' Assume SqLite (.db or .sl3)\xFE";
 z+="        Pg.FileName = dataSource\xFE";
 z+="        if Password Then Pg.Password = Password\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="   // If !Pg.SetConnectionParameters() Then @Errors = \"Unable to create ConnectionParameters\"; Return @Errors\xFE";
 z+="    \xFE";
 z+="    JsbForm = Pg.myForm\xFE";
 z+="    \xFE";
 z+="    Dim SM As Object = Pg.getControl('scriptManager')\xFE";
 z+="    if !SM Then\xFE";
 z+="        SM = CreateObject(\"scriptManager\")\xFE";
 z+="        SM.ID = \"scriptManager\"\xFE";
 z+="        JsbForm.Controls.Add(SM)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Marker = CreateObject('HtmlGenericControl')\xFE";
 z+="    Marker.ID = \"_\":qbID:\"_ControlStart_\"\xFE";
 z+="    JsbForm.Controls.Add(Marker)\xFE";
 z+="    \xFE";
 z+="    Qb = Createobject(\"ASPxQueryBuilder\")\xFE";
 z+="    Qb.ID = QBID\xFE";
 z+="\xFE";
 z+="    JsbForm.Controls.Add(Qb)\xFE";
 z+="    Pg.queryBuilder = Qb\xFE";
 z+="\xFE";
 z+="    Marker = CreateObject('HtmlGenericControl')\xFE";
 z+="    Marker.ID = \"_\":qbID:\"_ControlEnd_\"\xFE";
 z+="    JsbForm.Controls.Add(Marker)\xFE";
 z+="\xFE";
 z+="    Html := @Style(`\xFE";
 z+="       .dx-scrollview-content table { background-color: inherit; }\xFE";
 z+="       .dxd-tableview-titles table  { background-color: inherit; }\xFE";
 z+="    `)\xFE";
 z+="    \xFE";
 z+="    Html := @Script(`\xFE";
 z+="        fixJQuery();\xFE";
 z+="       window.jQueryDialog = $.fn.dialog.clone();\xFE";
 z+="    `)\xFE";
 z+="       \xFE";
 z+="    qb.ClientSideEvents.BeginCallback = qbID:\"_BeginCallback\"\xFE";
 z+="    Html := @Script(`function `:qbID:`_BeginCallback(s, e) { window.cbName = e.command }`)\xFE";
 z+="    \xFE";
 z+="    qb.ClientSideEvents.SaveCommandExecute = qbID:\"_SaveCommandExecute\"\xFE";
 z+="    Html := @Script(`function `:qbID:`_SaveCommandExecute(s, e) { window.cbName = 'Saved'; }`)\xFE";
 z+="    \xFE";
 z+="    // Force server side code to run after a callback (a Save)\xFE";
 z+="    qb.ClientSideEvents.EndCallback = qbID:\"_EndCallback\"\xFE";
 z+="  //  Html := @Script(`function `:qbID:`_EndCallback(s, e) { if (window.doJsbSubmitOnCallBack) window.doTheJsbSubmit = true; else if (window.cbName) { alert('Saved'); window.cbName = ''  }}`) \xFE";
 z+="    Html := @Script(`function `:qbID:`_EndCallback(s, e) { if (window.doJsbSubmitOnCallBack) window.doTheJsbSubmit = true; else if (window.cbName) { window.doTheJsbSubmit = true; setInterval(function () { if (window.doTheJsbSubmit) { window.doTheJsbSubmit = false; doJsbSubmit(false) } }, 100)  }}`) \xFE";
 z+="    \xFE";
 z+="    if onInit Then \xFE";
 z+="        qb.ClientSideEvents.Init = qbID:\"_onInit\"\xFE";
 z+="        Html := @Script(`function `:qbID:`_onInit(s, e) { `:onInit:`}`)\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Html := Chr(28):\"<<%%>>\":qbID:\"<<%%>>\":Chr(29)\xFE";
 z+="    \xFE";
 z+="    Html := @Script(`$.fn.dialog = window.jQueryDialog`)\xFE";
 z+="    Return Html\xFE";
 z+="End Function"
window.cached_jsb_html["devxsqlbuilder"]=z;
var z="* Print @Div('this is an example', { style: 'border: solid 2px blue' })\xFE";
 z+="* Print @Div('id1', 'another example')\xFE";
 z+="* Print @Div('id', 'Center Vertically', { style: 'position: absolute; top: 50%; left: 50%; width: 200px; transform: translateX(-50%) translateY(-50%);' })\xFE";
 z+="* Print @Div('this is another div')\xFE";
 z+="\xFE";
 z+="Function Div(ByVal ID As String, Optional ByVal Content As String, Optional ByVal AdditionalAttributes As Object) As String\xFE";
 z+="    * $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If IsMissing(AdditionalAttributes) Then\xFE";
 z+="        If IsMissing(Content) Then\xFE";
 z+="            if IsJSON(ID) then AdditionalAttributes = ID Else Content = Id\xFE";
 z+="            ID = ''\xFE";
 z+="        Else\xFE";
 z+="            If IsArray(Content) Or IsJSON(Content) Then\xFE";
 z+="                AdditionalAttributes = Content\xFE";
 z+="                Content = Id\xFE";
 z+="                Id = ''\xFE";
 z+="            Else If IsJSON(ID) then\xFE";
 z+="                AdditionalAttributes = ID\xFE";
 z+="                Id = ''\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html = Chr(28):\"<div\"\xFE";
 z+="    If Id Then Html := \" id='\":Id:\"' name='\":Id:\"'\"\xFE";
 z+="    If AdditionalAttributes Then Html := JoinAttributes(AdditionalAttributes)\xFE";
 z+="    Html := \">\":Chr(29):Content:Chr(28):\"</div>\":Chr(29)\xFE";
 z+="    Return Html"
window.cached_jsb_html["div"]=z;
var z="*\xFE";
 z+="* Values is a ForEach Array.  Each Value can be \"Display,Value\"\xFE";
 z+="*\xFE";
 z+="* ============================= HTML =============================\xFE";
 z+="Function DropDownBox(ByVal ID As String, byval Values As Object, optional byval Default As String, optional byval addBlank As Boolean, optional byval ReadOnly As Boolean, optional byval AdditionalAttributes As Object, optional byval multiValuedData As StRiNg, optional byval DesciptionField As String, optional byval ValueField As String) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim OPTS As Array\xFE";
 z+="    Dim SUBDELIMITER As String\xFE";
 z+="    Dim CRLF As String\xFE";
 z+="    Dim FOUNDDEFAULTVALUE As Boolean\xFE";
 z+="    Dim LDEFAULT As String\xFE";
 z+="    Dim V As String\xFE";
 z+="    Dim S As String\xFE";
 z+="    Dim DISPLAY As String\xFE";
 z+="\xFE";
 z+="    Dim Vals As Array = makeArray(Values); SubDelimiter = @Ni\xFE";
 z+="    If !Instr(Values, SubDelimiter) Then SubDelimiter = \"\"\xFE";
 z+="    if IsMissing(multiValuedData) Then multiValuedData = True\xFE";
 z+="    \xFE";
 z+="    Crlf = Crlf()\xFE";
 z+="    foundDefaultValue = False\xFE";
 z+="\xFE";
 z+="    Opts = []\xFE";
 z+="    lDefault = LCase(Default)\xFE";
 z+="    \xFE";
 z+="    If addBlank Then\xFE";
 z+="        If Len(Default)=0 Then\xFE";
 z+="            foundDefaultValue = True\xFE";
 z+="            Opts[-1] = `<option selected value=\"\"></option>`\xFE";
 z+="        Else\xFE";
 z+="            Opts[-1] = `<option></option>`\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If (SubDelimiter And multiValuedData) Or SubDelimiter >= Chr(252) Then\xFE";
 z+="        For Each V In Vals\xFE";
 z+="            S = \"\"\xFE";
 z+="            If Instr(V, SubDelimiter) Then\xFE";
 z+="                Display = Field(V, SubDelimiter, 1)\xFE";
 z+="                V = @DropLeft(V, SubDelimiter)\xFE";
 z+="                If LCase(V) = lDefault And Len(Default) Then S = \" selected\"; foundDefaultValue = True\xFE";
 z+="                Opts[-1] = `<option`:S:` value=\"`:V:`\">`:@HtmlEncode(Display):`</option>`\xFE";
 z+="            Else\xFE";
 z+="                If LCase(V) = lDefault And Len(Default) Then S = ` selected`; foundDefaultValue = True\xFE";
 z+="                Opts[-1] = `<option`:S:`>`:@HtmlEncode(V):`</option>`\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="    ElseIf Vals Then\xFE";
 z+="        For Each V In Vals\xFE";
 z+="            S = \"\"\xFE";
 z+="            If LCase(V) = lDefault And Len(Default) Then S = \" selected\"; foundDefaultValue = True\xFE";
 z+="            Opts[-1] = `<option`:S:`>`:@HtmlEncode(V):`</option>`\xFE";
 z+="        Next\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If Not(foundDefaultValue) Then\xFE";
 z+="        If !Default Then\xFE";
 z+="            If Len(Opts) = 1 Then\xFE";
 z+="                Opts[LBound(Opts)] = Replace(Opts[LBound(Opts)], \"<option selected\", \"<option \")\xFE";
 z+="            Else\xFE";
 z+="                Opts.Insert(1, `<option disabled selected value=''>Select Something</option>`)\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            Opts[-1] = `<option selected>`:@HtmlEncode(Default):`</option>`\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Id Then Id = \" id='\":Id:\"' name='\":Id:\"'\"\xFE";
 z+="    \xFE";
 z+="    If ReadOnly Then\xFE";
 z+="        Return Chr(28):\"<select\":Id:\" tabindex='-1'  readonly \":Join(@MergeAttribute(\"class\", \"DropDownBox_ReadOnly form-control\", \" \", AdditionalAttributes), \" \"):\">\":Crlf:Join(Opts, Crlf):Crlf:\"</select>\":Crlf:Chr(29)\xFE";
 z+="    Else\xFE";
 z+="        Return  Chr(28):\"<select\":Id:\" \":Join(@MergeAttribute(\"class\", \"DropDownBox form-control\", \" \", AdditionalAttributes), \" \"):\">\":Crlf:Join(Opts, Crlf):Crlf:\"</select>\":Crlf:Chr(29)\xFE";
 z+="    End If\xFE";
 z+="End Function"
window.cached_jsb_html["dropdownbox"]=z;
var z="* ============================= HTML =============================\xFE";
 z+="*\xFE";
 z+="* To load via AJAX:\xFE";
 z+="*    create a restful function:\xFE";
 z+="*\xFE";
 z+="*       restful function aJaxCallName(arg1)\xFE";
 z+="*          return ['this', 'is', 'a', 'load']\xFE";
 z+="*\xFE";
 z+="* Url is @jsbRootExecute(`aJaxCallName?arg1=randy`)\xFE";
 z+="*\xFE";
 z+="Function DropDownBoxAJAX(byval Id As Object, byval Url As String, byval Default As Object, byval addBlank As Object, byval ReadOnly As Object, byval AdditionalAttributes As Object, byval multiValuedData As Object, optional byval DesciptionField As Object, optional byval ValueField As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim ONSUCCESS As String\xFE";
 z+="    Dim ONFAILURE As String\xFE";
 z+="    Dim HTML As StRiNg\xFE";
 z+="\xFE";
 z+="    if IsMissing(ValueField) Then ValueField = DesciptionField\xFE";
 z+="    OnSuccess = `\xFE";
 z+="      $('#dd_`:ID:`').empty();\xFE";
 z+="      \xFE";
 z+="      for(var key in json) { \xFE";
 z+="         var value = json[key];`\xFE";
 z+="\xFE";
 z+="    If ValueField = \"\" Or DesciptionField = \"\" Then\xFE";
 z+="        OnSuccess := `\xFE";
 z+="                         var option = $('<option>').text(value).attr('value', value);`\xFE";
 z+="    Else\xFE";
 z+="        OnSuccess := `\xFE";
 z+="                         if (typeof value === 'string') value = string2json(value)\xFE";
 z+="                         var option = $('<option>').text(value['`:DesciptionField:`']).attr('value', value['`:ValueField:`']);`\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    OnSuccess := `\xFE";
 z+="            $('#dd_`:ID:`').append(option);\xFE";
 z+="       };\xFE";
 z+="       \xFE";
 z+="       \xFE";
 z+="       if ($('#dd_`:ID:`').find('option').length == 1) $('#dd_`:ID:`').find('option:first').attr('selected', 'selected'); else $('#dd_`:ID:`').val('')\xFE";
 z+="       $('#dd_`:ID:`').trigger( \"change\" )\xFE";
 z+="    `\xFE";
 z+="\xFE";
 z+="    OnFailure = `alert('failed combobox ajax call to ' + `:jsEscapeString(Url):` + '; error: ' + textStatus)`\xFE";
 z+="    Html = @DropDownBox(Id, [], Default, addBlank, ReadOnly, AdditionalAttributes, multiValuedData, DesciptionField, ValueField)\xFE";
 z+="    \xFE";
 z+="    // QuotedUrl, jsSuccess, jsFailure, PostPayLoad, infoMsg, HeaderJSON, Ok2Cache)\xFE";
 z+="    return Html:@Script(@Jsb_bf.Ajax(jsEscapeHREF(Url), OnSuccess, OnFailure, Nothing, Nothing, Nothing, true))\xFE";
 z+="end function"
window.cached_jsb_html["dropdownboxajax"]=z;
window.cached_jsb_html["dropdownboxincludeurl"]="Function DropDownBoxIncludeURL(byval Id As Object, byval URL As Object, byval ArrayID As StRiNg, optional byval Default As Object, optional byval addBlank As Object, optional byval ReadOnly As Object, optional byval AdditionalAttributes As Object, optional byval multiValuedData As Object, optional byval DesciptionField As Object, optional byval ValueField As Object) As StRiNg\xFE    $options async-\xFE    \xFE    Dim HTML As String\xFE\xFE    HTML = @Head(@JSLink(URL))\xFE\xFE    Html := @DropDownBox(Id, [], Default, addBlank, ReadOnly, AdditionalAttributes, multiValuedData, DesciptionField, ValueField)\xFE    \xFE    If Id Then Html := @Script(`$( document ).ready( function () { urlDropDownLoad($('#`:Id:`'), `:Val(addBlank):`, `:ArrayID:`, '`:Id:`') } )`)\xFE\xFE    Return Html\xFE end function";
window.cached_jsb_html["emphasized"]="function emphasized(byval text As StRiNg) As String\xFE    $options async-\xFE    return Chr(28):\"<em>\":Chr(29):text:Chr(28):\"</em>\":Chr(29)";
window.cached_jsb_html["fieldset"]="*    Print @fieldset(\"Profile Information\", @label(\"Name\"):@TextBox(\"Name\"):@BR:@label(\"Address\"):@TextBox(\"Adr\"):@BR:@label(\"City\"):@TextBox(\"City\"))\xFE\xFEFUNCTION FieldSet(ByVal ID As String, optional byval Legend As StRiNg, optional byval InnerHTML As String, optional byval AdditionalAttributes As Object) As StRiNg\xFE   $options async-\xFE   \xFE    Dim HTML As String\xFE\xFE   HTML = CHR(28):\"<fieldset\"\xFE   IF ID THEN Html := \" id='\":ID:\"' name='\":ID:\"'\"\xFE   Html := \" \":Join(@MergeAttribute(\"class\", \"FieldSet\", \" \", AdditionalAttributes), \" \")\xFE   Html := '>':CRLF():Chr(29)\xFE   If Legend Then Html := CHR(28):\"<legend>\":Chr(29):Legend:Chr(28):\"</legend>\":CRLF():Chr(29)\xFE   Html := InnerHTML\xFE   Html := Chr(28):CRLF():\"</fieldset>\":CRLF():Chr(29)\xFE   RETURN HTML";
var z="****************** HTML *****************************\xFE";
 z+="*\xFE";
 z+="* This is a jqueryUI only function...\xFE";
 z+="*\xFE";
 z+="* Print @(-1):@fieldSetBtns('id1', ['red', 'blue', 'green', 'yellow'], ['blue'], False, [], [`style='min-width: 90px'`])\xFE";
 z+="* input pau; \xFE";
 z+="* print \"result is \":@formvar('id1')\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="* Values is a ForEach Array.  Each Value can be \"Display,Value\"\xFE";
 z+="*\xFE";
 z+="* To load via AJAX - see dropDownBox\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="* Values is a ForEach Array.  Each Value can be \"Display,Value\"\xFE";
 z+="*\xFE";
 z+="* To load via AJAX - see dropDownBox\xFE";
 z+="*\xFE";
 z+="* Print @(-1):@FieldSetBtns('id1', ['red', 'blue', 'green', 'yellow'], 'blue')\xFE";
 z+="*\xFE";
 z+="* See also @fieldsetBtns('id1', ['red', 'blue', 'green', 'yellow'], 'blue')\xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="FUNCTION FieldSetBtns(ByVal ID As String, byval Values As Object, optional byval DEFAULT As String, optional ByVal ReadOnly As Boolean, optional byval AdditionalAttributes As Object, optional byval multiValuedData As Boolean) As String\xFE";
 z+="    $options async-\xFE";
 z+="\xFE";
 z+="    Dim SubDelimiter As String\xFE";
 z+="    Dim VALS As Array = makeArray(Values); SubDelimiter = @NI\xFE";
 z+="    If !InStr(Values, SubDelimiter) Then SubDelimiter = \"\"\xFE";
 z+="\xFE";
 z+="    Dim foundDefaultValue As Boolean = False\xFE";
 z+="    Dim Opts As Array = []\xFE";
 z+="\xFE";
 z+="    Dim IA As String = dataAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    IA := ' ':`onclick='window.fieldSetBtn_Change(this)'`\xFE";
 z+="    \xFE";
 z+="    if ID then \xFE";
 z+="        Dim Name As String = \" name='\":ID:\"'\"\xFE";
 z+="        IA := ` data-parsley-errors-container=\"#`:ID:`_errors\" `\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Dim S2 As String\xFE";
 z+="    If ReadOnly Then S2 = \" tabindex='-1' readonly \" Else S2 = \"\"\xFE";
 z+="    \xFE";
 z+="    If (SubDelimiter And multiValuedData) Or SubDelimiter >= Chr(252) Then\xFE";
 z+="        For Each V As String In Vals\xFE";
 z+="            S = \"\"\xFE";
 z+="            If InStr(V, SubDelimiter) Then\xFE";
 z+="                Dim Display As String = Field(V, SubDelimiter, 1)\xFE";
 z+="                V = @DropLeft(V, SubDelimiter)\xFE";
 z+="                IF V = Default And Len(Default) Then S = \" checked\"; foundDefaultValue = True\xFE";
 z+="                Opts[-1] = `<label class='fieldSetBtnLbl`:S:`'>`:@HtmlEncode(Display):`<input type='radio' class='fieldSetBtn'`:Name:IA:S2:S:` value=\"`:V:`\"/></label>`\xFE";
 z+="            Else\xFE";
 z+="                IF V = Default And Len(Default) Then S = ` checked`; foundDefaultValue = True\xFE";
 z+="                Opts[-1] = `<label class='fieldSetBtnLbl`:S:`'>`:@HtmlEncode(V):`<input type='radio' class='fieldSetBtn'`:Name:IA:S2:S:` value=\"`:V:`\"/></label>`\xFE";
 z+="            End If\xFE";
 z+="        NEXT\xFE";
 z+="        \xFE";
 z+="    ElseIf Vals Then\xFE";
 z+="        for each V As String in Vals\xFE";
 z+="            Dim S As String = \"\"\xFE";
 z+="            IF V = Default And Len(Default) THEN S = \" checked\"; foundDefaultValue = True\xFE";
 z+="            Opts[-1] = `<label class='fieldSetBtnLbl`:S:`'>`:@HtmlEncode(V):`<input type='radio' class='fieldSetBtn'`:Name:IA:S2:S:` value=\"`:V:`\"/></label>`\xFE";
 z+="        next\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If Not(foundDefaultValue) And Len(Default) THEN\xFE";
 z+="        Opts[-1] = `<label class='fieldSetBtnLbl checked' `:IA:`>`:@HtmlEncode(Default):`<input type='radio' class='fieldSetBtn'`:Name:IA:S2:` checked value=\"`:Default:`\"/></label>`\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Dim Div As String\xFE";
 z+="    Dim XOA As String\xFE";
 z+="    \xFE";
 z+="    Dim OA As String = uiAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    If ReadOnly Then\xFE";
 z+="        xOA = ` onchange=\"this.selectedIndex=this.defaultIndex;\"`\xFE";
 z+="        xOA := `onfocus=\"this.defaultIndex=this.selectedIndex;\"`\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If ID Then\xFE";
 z+="        Div = @Html(`<fieldset class='fieldSetBtnsFrame form-control' `:OA:`>\xFE";
 z+="                       <div class='fieldSetBtnsDiv' id=\"`:ID:`\" `:OA:`>`:Crlf():Join(Opts, Crlf()):Crlf():`\xFE";
 z+="                       </div></fieldset>\xFE";
 z+="                       <div id=\"`:ID:`_errors\" style=\"display: inline-block\"></div>\xFE";
 z+="                     `)\xFE";
 z+="    Else\xFE";
 z+="        // KOModel\xFE";
 z+="        Div = @Html(`<fieldset class='fieldSetBtnsFrame form-control' `:OA:`>\xFE";
 z+="                       <div class='fieldSetBtnsDiv' `:OA:`>`:Crlf():Join(Opts, Crlf()):Crlf():`\xFE";
 z+="                       </div></fieldset>\xFE";
 z+="                     `)\xFE";
 z+="    End If\xFE";
 z+="                  \xFE";
 z+="    Return Div"
window.cached_jsb_html["fieldsetbtns"]=z;
var z="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE";
 z+="\xFE";
 z+="* Print @Font(\"\", \"250%\", \"blue\", \"yellow\", \"Hi\", { 'read-only': true })\xFE";
 z+="\xFE";
 z+="function Font(byval Family As String, byval Size As String, byval Color As String, byval BackColor As String, byval Text As String, optional byval AdditionalAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="\xFE";
 z+="    Dim NEWSTYLES As Json\xFE";
 z+="    Dim ATTRIBUTES As String\xFE";
 z+="\xFE";
 z+="    newStyles = { display: 'inline' }\xFE";
 z+="    if Family Then newStyles['font-family'] = Family\xFE";
 z+="    if Size Then newStyles['font-size'] = Size\xFE";
 z+="    if Color Then newStyles['color'] = Color\xFE";
 z+="    if BackColor Then newStyles['background-color'] = BackColor\xFE";
 z+="    \xFE";
 z+="    attributes = JoinAttributes(MergeStyle(newStyles, AdditionalAttributes))\xFE";
 z+="    \xFE";
 z+="    Return CHR(28):\"<span \":attributes:\">\":Chr(29):Text:Chr(28):\"</span>\":Chr(29)\xFE";
 z+="end function\xFE";
 z+=""
window.cached_jsb_html["font"]=z;
var z="* Example:\xFE";
 z+="*   HName = @label(\"Name:\"):@TextBox(\"Name\")\xFE";
 z+="*   S1 = @fieldset(\"Profile Name\", HName)\xFE";
 z+="*\xFE";
 z+="*   HAdr = @label(\"Address:\"):@TextBox(\"Adr\")\xFE";
 z+="*   S2 = @fieldset(\"Profile Address\", HAdr)\xFE";
 z+="*\xFE";
 z+="*   HCity = @label(\"City:\"):@TextBox(\"City\")\xFE";
 z+="*   S3 = @fieldset(\"Profile City\", HCity)\xFE";
 z+="*\xFE";
 z+="*   Print @Div('myID', S1:S2:S3):\xFE";
 z+="*   Print @SubmitBtn('formBtn', 'OK'):\xFE";
 z+="*   Print @FormWizard(\"myID\", 'formBtn')\xFE";
 z+="*\xFE";
 z+="*   @Server.Pause\xFE";
 z+="*   @Server.End\xFE";
 z+="*\xFE";
 z+="FUNCTION FormWizard(byval DivID As StRiNg, optional byval LastPageBtnID As StRiNg) As StRiNg\xFE";
 z+="   $options async-\xFE";
 z+="   \xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim S As String\xFE";
 z+="\xFE";
 z+="   HTML = @Head(@JSLink(@jsbroot:\"js/formToWizard.js\"))\xFE";
 z+="   \xFE";
 z+="   s = \"debugger; \"\xFE";
 z+="   //if system(1) = \"gae\" OR system(1) = \"aspx\" then s<-1> = `$( document ).ready( function () {`\xFE";
 z+="   s<-1> = `jsbIgnoreHashChanges = true;`\xFE";
 z+="   if LastPageBtnID Then\xFE";
 z+="       s<-1> = `   $(\"#`:DivID:`\").formToWizard({ submitButton: '`:LastPageBtnID:`' });`\xFE";
 z+="   End Else\xFE";
 z+="       s<-1> = `   $(\"#`:DivID:`\").formToWizard();`\xFE";
 z+="   End If\xFE";
 z+="   s<-1> = `   $(\"#steps\").hide();`\xFE";
 z+="   //if system(1) = \"gae\" OR system(1) = \"aspx\" then s<-1> = `});`\xFE";
 z+="\xFE";
 z+="   Html := @JSB_HTML.script(s)\xFE";
 z+="   Return Html"
window.cached_jsb_html["formwizard"]=z;
var z="// Load a style\xFE";
 z+="FUNCTION FullStyle(byval FLOAT As StRiNg, byval LEFT As StRiNg, byval RIGHT As StRiNg, byval TOP As StRiNg, byval BOTTOM As StRiNg, byval WIDTH As StRiNg, byval HEIGHT As StRiNg, byval BORDER As StRiNg, byval OVERFLOW As StRiNg, byval COLOR As StRiNg, byval BACKGROUND As StRiNg) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    HTML = \"\"\xFE";
 z+="    IF FLOAT THEN Html := \"float:\":FLOAT:\"; \"\xFE";
 z+="    IF LEFT THEN Html := \"left:\":LEFT:\"; \"\xFE";
 z+="    IF RIGHT THEN Html := \"right:\":RIGHT:\"; \"\xFE";
 z+="    IF TOP THEN Html := \"top:\":TOP:\"; \"\xFE";
 z+="    IF BOTTOM THEN Html := \"bottom:\":BOTTOM:\"; \"\xFE";
 z+="    IF WIDTH THEN Html := \"width:\":WIDTH:\"; \"\xFE";
 z+="    IF HEIGHT THEN Html := \"height:\":HEIGHT:\"; \"\xFE";
 z+="    IF BORDER THEN Html := \"border:\":BORDER:\"; \"\xFE";
 z+="    IF OVERFLOW THEN Html := \"overflow:\":OVERFLOW:\"; \"\xFE";
 z+="    IF COLOR THEN Html := \"color:\":COLOR:\"; \"\xFE";
 z+="    IF BACKGROUND THEN Html := \"background-color:\":BACKGROUND:\"; \"\xFE";
 z+="    IF OVERFLOW THEN Html := \"overflow:\":OVERFLOW:\"; \"\xFE";
 z+="    RETURN \"style=\":jsEscapeAttr(Html)\xFE";
 z+="end function"
window.cached_jsb_html["fullstyle"]=z;
window.cached_jsb_html["glyphicon"]="* nameAfterHyphen: asterisk, plus, eur, minue, cloud, ... (see http://getbootstrap.com/components/)\xFE*\xFE* Example: Print Glyphicon('remove')\xFE*\xFEfunction Glyphicon(byval nameAfterHyphen As String)  As String\xFE   $options async-\xFE   \xFE   return CHR(28):\"<span class='glyphicon glyphicon-\":lcase(nameAfterHyphen):\"' aria-hidden='true'></span>\":CHR(29)";
window.cached_jsb_html["h1"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEFUNCTION H1(ByVal CONTENT As StRiNg) As String\xFE    $options async-\xFE   Return CHR(28):\"<h1><span>\":CHR(29):CONTENT:CHR(28):\"</span></h1>\":CHR(29)";
window.cached_jsb_html["h2"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEFUNCTION H2(byval CONTENT As StRiNg) As String\xFE    $options async-\xFE    Return CHR(28):\"<h2><span>\":CHR(29):CONTENT:CHR(28):\"</span></h2>\":CHR(29)";
window.cached_jsb_html["h3"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEFUNCTION H3(byval CONTENT As StRiNg) As String\xFE    $options async-\xFE    return CHR(28):\"<h3><span>\":CHR(29):CONTENT:CHR(28):\"</span></h3>\":CHR(29)";
window.cached_jsb_html["h4"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEFUNCTION H4(byval CONTENT As StRiNg) As String\xFE    $options async- \xFE    Return CHR(28):\"<h4><span>\":CHR(29):CONTENT:CHR(28):\"</span></h4>\":CHR(29)";
window.cached_jsb_html["head"]="* Print @head(\"<title> this is put into the html header </title>\")\xFE* See also Print @csslink, jslink\xFE\xFEfunction Head(byval html As StRiNg) As String\xFE    $options async-\xFE    return Chr(28):\"<head>\":Html:\"</head>\":Chr(29)";
window.cached_jsb_html["hidden"]="function Hidden(ByVal ID As String, Optional ByVal DefaultValue As String, Optional Byval AdditionalAttributes As Object) As StRiNg\xFE    $options async-\xFE    \xFE    Dim HTML As String\xFE    Dim AA As String\xFE\xFE    Html = Chr(28):\"<input\"\xFE    If Id Then Html := \" id='\":Id:\"' name='\":Id:\"'\"\xFE    Aa  = @MergeAttribute(\"\", \"\", \"\", AdditionalAttributes)\xFE    Html := ' style=\"display:none\" value=\"':@Jsb_bf.HtmlEncode(DefaultValue):'\" ':Aa:'/>':Chr(29)\xFE    Return Html\xFEEnd function";
window.cached_jsb_html["hiddenvar"]="function HiddenVar(Byval Id As Object, Optional Byval DefaultValue As Object, Optional Byval AdditionalAttributes As Object) As StRiNg\xFE    $options async-\xFE    \xFE    return Hidden(Id, Defaultvalue, AdditionalAttributes)\xFEend function";
window.cached_jsb_html["hilight"]="function Hilight(byval text As StRiNg) As String\xFE    $options async-\xFE    return Chr(28):\"<mark>\":Chr(29):text:Chr(28):\"</mark>\":Chr(29)";
window.cached_jsb_html["hline"]="FUNCTION HLine() As String\xFE    $options async-\xFEReturn CHR(28):\"<hr />\":CHR(29)";
window.cached_jsb_html["hr"]="FUNCTION Hr() As String\xFE    $options async-\xFE    Return CHR(28):\"<hr />\":CHR(29)";
var z="\xFE";
 z+=" FUNCTION HSplitter(ByVal ID As String, byval topDIV As String, byval botDIV As String, optional byval startpixeloffset As Integer) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    if !startpixeloffset And IsNum(botDIV) then\xFE";
 z+="        startpixeloffset = botDIV\xFE";
 z+="        botDIV = topDIV\xFE";
 z+="        topDIV = ID\xFE";
 z+="        ID = ''\xFE";
 z+="    end if\xFE";
 z+="        \xFE";
 z+="    if !ID Then ID = 'HSplitter_':Rnd(99999)\xFE";
 z+="    if !startpixeloffset then startpixeloffset = 150\xFE";
 z+="\xFE";
 z+="    Dim HTML As String = CHR(28):`\xFE";
 z+="        <div id=\"`:ID:`\" class=\"hsplitter\">\xFE";
 z+="            <div id=\"`:ID:`_TOP\" class=\"hsplittertop\" style=\"height:`:startpixeloffset:`px\">`:CHR(29):topDIV:CHR(28):`</div>\xFE";
 z+="            <div id=\"`:ID:`_SEP\" class=\"hsplitterseperator\" ></div>\xFE";
 z+="            <div id=\"`:ID:`_BOT\" class=\"hsplitterbottom\">`:CHR(29):botDIV:CHR(28):`</div>\xFE";
 z+="        </div>\xFE";
 z+="        <script>\xFE";
 z+="            hSplitterDragElement(\"`:ID:`\");\xFE";
 z+="        </script>\xFE";
 z+="    `:Chr(29)\xFE";
 z+="\xFE";
 z+="    Return HTML\xFE";
 z+="end function\xFE";
 z+=""
window.cached_jsb_html["hsplitter"]=z;
var z="* SCRIPT SHOULD START WITH <html>\xFE";
 z+="    \xFE";
 z+="* PRINT IFRAME(`<html><head><title></title></head><body>Hello world.</body></html>`)\xFE";
 z+="*\xFE";
 z+="Function Iframe(ByVal ID As String, optional byval Url_or_html As String, optional byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim ISHTML As Boolean\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if IsMissing(Url_or_html) Then\xFE";
 z+="        Url_or_html = Id\xFE";
 z+="        Url_or_html = ''\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html = Chr(28):\"<iframe application='yes'\"\xFE";
 z+="    Ishtml = Url_or_html[1,1] = \"<\"\xFE";
 z+="    If Ishtml And !Id Then Id = @NewGuid\xFE";
 z+="    If Id Then Html := \" id='\":Id:\"' name='\":Id:\"'\"\xFE";
 z+="    Html := \" \":Join(@MergeAttribute(\"class\", \"IFrame\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="    If Ishtml Then\xFE";
 z+="        Html := \" />\":Chr(29)\xFE";
 z+="        Html := @Script(`\xFE";
 z+="            var doc = document.getElementById('`:ID:`').contentWindow.document;\xFE";
 z+="            doc.open();\xFE";
 z+="            doc.write(`:jsEscapeString(URL_OR_HTML):`);\xFE";
 z+="            doc.close();\xFE";
 z+="         `)\xFE";
 z+="    Else\xFE";
 z+="        Html := ` src=`:jsEscapeHREF(Url_or_html):`>`:Chr(29):`Loading `:Id:Chr(28):`...</iframe>`:Chr(29)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Return Html\xFE";
 z+="End Function"
window.cached_jsb_html["iframe"]=z;
var z="* Print  @Image(\"bk\", \"data:image/png;base64,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\")\xFE";
 z+="    \xFE";
 z+="function IMAGE(ByVal ID As String, Optional Byval Src As Object, Optional Byval altText As Object, Optional Byval stretchWidth As Object, Optional Byval stretchHeight As Object, Optional Byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    // Did we pass the image (string data only) in the ID?\xFE";
 z+="    If isMissing(Src) Or isNum(Left(Src, 1)) Or isJson(Src) Then\xFE";
 z+="        Src = Id\xFE";
 z+="        Id = ''\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if isNum(Left(altText, 1)) then\xFE";
 z+="        AdditionalAttributes = stretchHeight\xFE";
 z+="        stretchHeight = stretchWidth\xFE";
 z+="        stretchWidth = altText\xFE";
 z+="        altText = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // AdditionalAttributes always the last parameter\xFE";
 z+="    if isJson(altText) Then\xFE";
 z+="        AdditionalAttributes = altText\xFE";
 z+="        altText = ''\xFE";
 z+="        \xFE";
 z+="    else if isJson(stretchWidth) Then\xFE";
 z+="        AdditionalAttributes = stretchWidth\xFE";
 z+="        stretchWidth = ''\xFE";
 z+="        \xFE";
 z+="    else if isJson(stretchHeight) Then\xFE";
 z+="        AdditionalAttributes = stretchHeight\xFE";
 z+="        stretchHeight = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Html = `<img`\xFE";
 z+="    If Id Then Html := \" id='\":Id:\"' name='\":Id:\"'\"\xFE";
 z+="    Html := ` border=\"0\" src=\"`:Src:`\"`\xFE";
 z+="    If altText Then Html := ` alt=\"`:@HtmlEncode(altText):`\"`\xFE";
 z+="    If stretchWidth Then Html := ` width=\"`:stretchWidth:`\"`\xFE";
 z+="    If stretchHeight Then Html := ` height=\"`:stretchHeight:`\"`\xFE";
 z+="    Html := \" \":Join(@MergeAttribute(\"class\", \"img-fluid\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="    Html := `/>`\xFE";
 z+="    Return @Html(Html)\xFE";
 z+="End function"
window.cached_jsb_html["image"]=z;
window.cached_jsb_html["inputgroup"]="* This is a Bootstrap method of combining controls into one.\xFE*\xFE* print @inputGroup('$', @TextBox('id', '', false, { class: \"form-control\" }))\xFE\xFEfunction InputGroup(byval prefixText As String, byval controlHtml As StRiNg, optional byval suffixText As String) As StRiNg\xFE    $options async-\xFE    \xFE    Dim HTML As String\xFE\xFE    html = Chr(28):`<div class=\"input-group\">`\xFE    if prefixText then html := `<span class=\"input-group-addon\">`:HtmlEncode(prefixText):`</span>`\xFE    html := chr(29):controlHtml:Chr(28)\xFE    if suffixText then html := `<span class=\"input-group-addon\">`:HtmlEncode(suffixText):`</span>`\xFE    html := `</div>`:chr(29)\xFE    return html";
var z="***************** HTML *****************************\xFE";
 z+="*\xFE";
 z+="* PRINT @InputPopSelection('id', [30,32,44,55,66,88,99], 44)\xFE";
 z+="*\xFE";
 z+="FUNCTION InputPopSelection(byval ID As Object, byval VALUES As Object, optional byval DEFAULTVALUE As Object, optional byval AdditionalAttributes As Object, optional byval width As StRiNg, optional byval height As StRiNg, optional byval Title As StRiNg) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim DIALOGCLICK As String\xFE";
 z+="    Dim DIALOG As String\xFE";
 z+="    Dim POPSCRIPT As StRiNg\xFE";
 z+="\xFE";
 z+="    dialogclick = `onclick=\"event.stopPropagation(); setTimeout(function () { $(this).prop('onclick', null).off('click'); $('#popOutDIV').dialog('close') }, 10); \"`\xFE";
 z+="    \xFE";
 z+="    Dialog = @fieldSetBtns('id1', VALUES, DEFAULTVALUE, False, [`style='min-width: 90px'`, dialogclick])\xFE";
 z+="\xFE";
 z+="    popScript = @Script(`\xFE";
 z+="        function `:id:`_popScript(ctl) {\xFE";
 z+="              var Dialog = $(`:jsEscapeString(Dialog):`);\xFE";
 z+="              var dftValue = $(ctl).val();\xFE";
 z+="              \xFE";
 z+="              new popoutWindow('`:Title:`', Dialog, '`:width:`', '`:height:`', false /* onCloseSubmit */, ctl /*putResultInCtlOrID */, self /* pFromWindow */);\xFE";
 z+="              \xFE";
 z+="              // Set the correct dftValue\xFE";
 z+="              if (dftValue) {\xFE";
 z+="                  setTimeout(function() { \xFE";
 z+="                      var radioBtn = $(\":radio[value=\" + dftValue + \"]\", Dialog)\xFE";
 z+="                      $(radioBtn).prop('checked', true)\xFE";
 z+="                      $(radioBtn).trigger(\"change\")\xFE";
 z+="                      $(radioBtn).focus()\xFE";
 z+="                  }) \xFE";
 z+="              }\xFE";
 z+="            }\xFE";
 z+="        `)\xFE";
 z+="\xFE";
 z+="    AdditionalAttributes[-1] = `onclick='`:id:`_popScript(this)'`\xFE";
 z+="    Return TEXTBOX(ID, DEFAULTVALUE, False, AdditionalAttributes):popScript"
window.cached_jsb_html["inputpopselection"]=z;
var z="FUNCTION INTEGERBOX(ByVal ID As String, ByVal DefaultValue As String, byval ReadOnly As Boolean, optional byval AdditionalAttributes As Object, optional byval minValue As StRiNg, optional byval maxValue As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If ReadOnly Then \xFE";
 z+="         HTML = CHR(28):\"<input id='\":ID:\"' name='\":ID:\"' readonly tabindex='-1' \":Join(@MergeAttribute(\"class\", \"IntegerBox_ReadOnly form-control\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="    Else\xFE";
 z+="         HTML = CHR(28):\"<input id='\":ID:\"' name='\":ID:\"' type='number' \":Join(@MergeAttribute(\"class\", \"IntegerBox form-control\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="         IF Len(minValue) THEN HTML := \" min='\":minValue:\"'\"\xFE";
 z+="         IF Len(maxValue) THEN HTML := \" max='\":maxValue:\"'\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If Len(DEFAULTVALUE) Then HTML := ' value=\"':@jsb_bf.HtmlEncode(DEFAULTVALUE):'\"'\xFE";
 z+="    \xFE";
 z+="    HTML := ` onfocus='if (isMobile() && !$(this).attr(\"readonly\")) $(this).keypad({ layout: \"integer\" })' />`:CHR(29)\xFE";
 z+="    \xFE";
 z+="    RETURN HTML"
window.cached_jsb_html["integerbox"]=z;
window.cached_jsb_html["italic"]="function Italic(Byval Text As StRiNg, optional byval AdditionalAttributes As String) As String\xFE    $options async-\xFE    Return Chr(28):\"<i\":joinAttributes(AdditionalAttributes):\">\":Chr(29):Text:Chr(28):\"</i>\":Chr(29)\xFEend function";
window.cached_jsb_html["italics"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEfunction Italics(Byval Text As StRiNg, optional byval AdditionalAttributes As String) As String\xFE    $options async-\xFE    Return Chr(28):\"<i\":joinAttributes(AdditionalAttributes):\">\":Chr(29):Text:Chr(28):\"</i>\":Chr(29)\xFEend function";
window.cached_jsb_html["javascript"]="Function JavaScript(byval Src As String) As String\xFE    $options async-\xFE    Return Chr(28):`<script>`:Src:`</script>`:crlf():Chr(29)";
var z="/*\xFE";
 z+="    See documentation for this grid at http://www.trirand.com/jqgridwiki/doku.php?id=wiki:jqgriddocs\xFE";
 z+="              and column options here: http://www.trirand.com/jqgridwiki/doku.php?id=wiki:colmodel_options\xFE";
 z+="    //////////////////// Possible Grid Options ////////////////////\xFE";
 z+="    \xFE";
 z+="    myOptions = {\xFE";
 z+="        doPaging: doPaging, \xFE";
 z+="        HeadForeColor: #,         HeadBackColor: #,              RowForeColor: #,\xFE";
 z+="        RowBackColor: #,          AltForeColor: #,               AltBackColor: #,\xFE";
 z+="        allowInserts: true,       allowUpdates: true,            allowDeletes: true,\xFE";
 z+="        noFilterBar: true,        addRowNumbers: true,           WidthMultiplier: 1,\xFE";
 z+="        width100percent: false,   sortablerows: false,           caption: \"\",        \xFE";
 z+="        addRowNumbers: true,      sortname: \"colname,colname\",   sortorder: \"desc,asc\"\xFE";
 z+="    }\xFE";
 z+="    \xFE";
 z+="    //////////////////// Possible Column Options ////////////////////\xFE";
 z+="    colOptions = {\xFE";
 z+="        name: string,\xFE";
 z+="        label: string, \xFE";
 z+="        primaryKey: boolean,\xFE";
 z+="        datatype: string,    // int, b\xFE";
 z+="        align: string,       // left, right or center\xFE";
 z+="        width: int,\xFE";
 z+="        index: string,       // used to position in gird columns (optional)\xFE";
 z+="        tooltip: string,\xFE";
 z+="        sortable: boolean, \xFE";
 z+="        sorttype: \"int\" ,\xFE";
 z+="        defaultvalue: \"autoincrement\",\xFE";
 z+="        editable: true,\xFE";
 z+="        \xFE";
 z+="        edittype: string, // textbox, select, dropDownBox, combobox, listbox, autotextbox, datebox, timebox, datetimebox, \xFE";
 z+="                          // imagebox, currencybox, passwordbox, appendbox, uploadimagebox, imagebox\xFE";
 z+="                          // maskedtextbox, radiobox, multiselectlistbox, multiselectdropDownBox, colorpick, slider\xFE";
 z+="                          // htmlbox, label\xFE";
 z+="                \xFE";
 z+="        edittype:\"textbox\", editoptions:{size:\"20\",maxlength:\"30\"},\xFE";
 z+="        \xFE";
 z+="        edittype:\"select\", formatter: \"select\", editoptions:{value:\"FE:FedEx;IN:InTime;TN:TNT;AR:ARAMEX\"} ,\xFE";
 z+="        \xFE";
 z+="        edittype:\"checkbox\", align: 'center', editoptions: {value:\"1:0\"}, formatoptions: { disabled: false },\xFE";
 z+="\xFE";
 z+="        edittype:\"textarea\", editoptions:{rows:\"4\",cols:\"20\"} \xFE";
 z+="    }\xFE";
 z+="    //////////////////// Possible Column Options ////////////////////\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    //////////////////// How to responds to events rowSelected and dblClickRow\xFE";
 z+="    Print @jqGrid(\"myID\", [ {id: 1, color: 'blue', type:'honda' }, {id: 2, color: 'white', type:'toyota' }], @jqGridDefaultModel([{id: 1, color: 'blue', type:'honda' }]), false)\xFE";
 z+="            \xFE";
 z+="    ' trap rowSelected and dbl click\xFE";
 z+="    Print genEventHandler(\"rowSelected\", null, 11, \"debugger; alert('You selected the row ' + primaryKeyName + ' with data: ' + CStr(parentDataRow));  \"): \xFE";
 z+="    Print genEventHandler(\"dblClickRow\", null, 11, \"debugger; alert('You doubled clicked the row ' + primaryKeyName + ' with data: ' + CStr(parentDataRow));  \"): \xFE";
 z+="\xFE";
 z+="    //////////////////// How to build column options from your data ////////////////////\xFE";
 z+="    UserModelColumns = jqGridDefaultModel(mydata)\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    //////////////////// Example1: ////////////////////\xFE";
 z+="    mydata = [\xFE";
 z+="        { id: 48803, name: \"DSK1\", stock: Yes, ship:\"AR\", note: \"\" },\xFE";
 z+="        { id: 48804, name: \"DSK2\", stock: Yes, ship:\"IN\", note: \"\" },\xFE";
 z+="        { id: 48805, name: \"DSK3\", stock: No,  ship:\"FE\", note: \"\" }\xFE";
 z+="    ]\xFE";
 z+="\xFE";
 z+="    UserModelColumns = [\xFE";
 z+="        {name:'id', primarykey: true, index:'id', primaryKey: true, width:9, sorttype:\"int\", editable: true, defaultvalue: \"autoincrement\" },\xFE";
 z+="        {name:'name',index:'name', width:15, editable: true, editoptions:{size:\"20\",maxlength:\"30\"} },\xFE";
 z+="        {name:'stock',index:'stock', width:6, editable: true,edittype:\"checkbox\",editoptions: {value:\"Yes:No\"}},\xFE";
 z+="        {name:'ship',index:'ship', width:9, editable: true,edittype:\"select\", formatter: \"select\", editoptions:{value:\"FE:FedEx;IN:InTime;TN:TNT;AR:ARAMEX\"} },  \xFE";
 z+="        {name:'note',index:'note', width:20, sortable:false,editable: true, edittype:\"textarea\", editoptions:{rows:\"4\",cols:\"20\"} }  \xFE";
 z+="    ]\xFE";
 z+="\xFE";
 z+="    myOptions = {  allowInserts: true, allowUpdates: true, allowDeletes: true, doPaging: false, width100percent: true, AltBackColor: 'lightgray' }\xFE";
 z+="\xFE";
 z+="    Print @jqGrid(\"myID\", mydata, UserModelColumns, myOptions)  \xFE";
 z+="    \xFE";
 z+="    ///// On postback: \xFE";
 z+="    /////    ops = @formVar(\"myID_ops\")\xFE";
 z+="    /////    dataset = @formVar(\"myID\")\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    //////////////////// Example2: ////////////////////\xFE";
 z+="    Print @jqGrid(\"myID\", [ {id: 1, color: 'blue', type:'honda' }, {id: 2, color: 'white', type:'toyota' }], @jqGridDefaultModel([{id: 1, color: 'blue', type:'honda' }]), false)\xFE";
 z+="            \xFE";
 z+="    ' Launch a child:\xFE";
 z+="    Print @jsb_bf.onParentSelect(Url, 4, \"newEdit\":Rnd(9999)):\xFE";
 z+="\xFE";
 z+="    '   A child can tell Parent to refresh his data, child has updated a record:\xFE";
 z+="    Print @jsb_html.Script(\"if (parent.refreshData) parent.refreshData();\"):\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="function jqGrid(byval jqGridID As Object, byval RestfulNameOrDataArray As Object, byval UserModelColumns As Array, byval myOptions As JSON) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    // Check if we need to read values for reference controls\xFE";
 z+="    Dim refCtls As Array = [\"autotextbox\",\"cascadingautotextbox\",\"cascadingcombobox\",\"cascadingdropdownbox\",\"combobox\",\"dropdownbox\",\"fieldsetbtns\",\"multiselectdropdownbox\",\"multiselectfieldsetbtns\",\"multiselectlistbox\",\"popselection\",\"radiobox\",\"label\",\"sliderlabeled\"]\xFE";
 z+="\xFE";
 z+="    For Each Column As Json In UserModelColumns\xFE";
 z+="        If Len(Column.name) And !Column.edittype And (Column.reflist Or Column.reffile)  Then\xFE";
 z+="            Locate lcase(Column.control) In refCtls Then\xFE";
 z+="                Dim Values As Array = @jsb_mdl.mdlGetRefValues(\"\", Column, {})\xFE";
 z+="                Dim vals As Array = []\xFE";
 z+="                if Column.addBlank Then vals[-1] = \":\"\xFE";
 z+="\xFE";
 z+="                for each v As String in Values\xFE";
 z+="                    if instr(v, chr(255)) Then \xFE";
 z+="                        v = replace(v, chr(255), \":\")\xFE";
 z+="                        \xFE";
 z+="                    elseif instr(v, chr(254)) Then \xFE";
 z+="                        v = replace(v, chr(254), \":\")\xFE";
 z+="                        \xFE";
 z+="                    elseif instr(v, chr(253)) Then \xFE";
 z+="                        v = replace(v, chr(253), \":\")\xFE";
 z+="                        \xFE";
 z+="                    elseif instr(v, chr(252)) Then \xFE";
 z+="                        v = replace(v, chr(252), \":\")\xFE";
 z+="                        \xFE";
 z+="                    Else if instr(v, \",\") then \xFE";
 z+="                        v = replace(v, \",\", \":\") \xFE";
 z+="                        \xFE";
 z+="                    else if V = \"\" Then\xFE";
 z+="                        if !Column.addBlank Then V = \":\"\xFE";
 z+="                        \xFE";
 z+="                    else\xFE";
 z+="                        v = v:\":\":v\xFE";
 z+="                    end if\xFE";
 z+="                    \xFE";
 z+="                    vals[-1] = field(v, \":\", 2):\":\":field(v, \":\", 1) ;* code:desc\xFE";
 z+="                next\xFE";
 z+="                \xFE";
 z+="                Column.edittype = \"select\"\xFE";
 z+="                Column.formatter = \"select\"\xFE";
 z+="                Column.editoptions = { value: Join(vals, \";\") } ;*  \"FE:FedEx;IN:InTime;TN:TNT;AR:ARAMEX\"\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    return jqGrid2(jqGridID, RestfulNameOrDataArray, UserModelColumns, myOptions)\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="function jsbDef2jqGridDef(myOptions, tColumn)\xFE";
 z+="    Dim Column As Json = {}\xFE";
 z+="    Column.name = tColumn.name\xFE";
 z+="    if tColumn.datatype then Column.datatype = tColumn.datatype\xFE";
 z+="    if tColumn.primarykey then Column.primarykey = true\xFE";
 z+="    if tColumn.index then Column.index = tColumn.index\xFE";
 z+="    if tColumn.align then Column.align = tColumn.align\xFE";
 z+="    if tColumn.width then Column.width = tColumn.width\xFE";
 z+="    if tColumn.label then Column.label = tColumn.label\xFE";
 z+="    if tColumn.sorttype then Column.sorttype = tColumn.sorttype \xFE";
 z+="    if tColumn.sortable then Column.sortable = tColumn.sortable\xFE";
 z+="    if tColumn.formatoptions then Column.formatoptions = tColumn.formatoptions\xFE";
 z+="    \xFE";
 z+="    if tColumn.tooltip Then Column.cellattr = `^^function () { return ' title=\"`:UrlEncode(tColumn.tooltip):`\"'; }^^` \xFE";
 z+="    if !Column.label Then Column.label = Column.name\xFE";
 z+="\xFE";
 z+="    // Valid formatters: http://www.trirand.com/jqgridwiki/doku.php?id=wiki:predefined_formatter\xFE";
 z+="    //   integer, number, currency, date, email, link, showlink, checkbox, select, actions\xFE";
 z+="    if tColumn.formatter then \xFE";
 z+="        Column.formatter = tColumn.formatter \xFE";
 z+="        \xFE";
 z+="    Else If Column.datatype = \"date\"  Or Column.datatype = \"datetime\" Then\xFE";
 z+="        Column.formatter = 'date'\xFE";
 z+="        \xFE";
 z+="    Else If Column.datatype = \"currency\" Then\xFE";
 z+="        Column.formatter = 'currency'\xFE";
 z+="        \xFE";
 z+="    //Else If Column.datatype = \"url\" Then\xFE";
 z+="    //    Column.formatter = 'link'\xFE";
 z+="        \xFE";
 z+="    Else if Column.datatype = \"integer\" Then\xFE";
 z+="        // Column.formatter = 'integer' // By making the formatter an integer, the data will be converted to an integer, and thus empty becomes 0\xFE";
 z+="        \xFE";
 z+="    Else if Column.datatype = \"autointeger\" Then \xFE";
 z+="        Column.formatter = 'integer'\xFE";
 z+="        \xFE";
 z+="    Else if Column.datatype = \"double\" Then \xFE";
 z+="        Column.formatter = 'number'\xFE";
 z+="        \xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    if tColumn.display = \"hidden\" Or tColumn.display = \"gridhidden\" then Column.hidden = true\xFE";
 z+="    \xFE";
 z+="    // http://www.trirand.com/jqgridwiki/doku.php?id=wiki:common_rules\xFE";
 z+="    Dim ctlType As String = lcase(tColumn.control)\xFE";
 z+="    \xFE";
 z+="    // edittype and editoptions only set if column is editable\xFE";
 z+="    if tColumn.canedit || tColumn.editable then \xFE";
 z+="        Column.editable = true\xFE";
 z+="        if tColumn.edittype then Column.edittype = tColumn.edittype\xFE";
 z+="        if tColumn.editoptions then Column.editoptions = tColumn.editoptions\xFE";
 z+="    else\xFE";
 z+="        ' Not editable\xFE";
 z+="        Column.editable = false\xFE";
 z+="        if ctlType <> \"button\" And ctlType <> \"anchor\" and ctlType <> \"urlbox\" And ctlType <> \"url\" Then ctlType = \"\"\xFE";
 z+="    end if\xFE";
 z+="     \xFE";
 z+="    if !Column.edittype and ctlType then\xFE";
 z+="        **\xFE";
 z+="        ** textbox, dropDownBox, combobox, listbox, autotextbox, datebox, timebox, datetimebox, imagebox, currencybox\xFE";
 z+="        **                maskedtextbox, radiobox, multiselectlistbox, multiselectdropDownBox, colorpick, slider\xFE";
 z+="        **                htmlbox, label, imagebox, uploadimagebox, appendbox, passwordbox\xFE";
 z+="        ** ->\xFE";
 z+="        **      text, textarea, checkbox, select, password, button, image, file custom\xFE";
 z+="        *\xFE";
 z+="        if ctlType = \"button\" Then\xFE";
 z+="            Column.formatter = \"^^jqGridAddBtn^^\"\xFE";
 z+="            Dim Url As String = DropIfRight(tColumn.transferurl, \".page\", true)\xFE";
 z+="            dim PKID as string = \"\"\xFE";
 z+="            Column.editoptions = { colName: Column.Name, primaryKey: PKID, transferurl: Url, transferto: tColumn.transferto, transferaddfrompage: tColumn.transferaddfrompage, transferextra: tColumn.onParentExtra, datausuage: tColumn.datausuage, title: Column.label } \xFE";
 z+="                  \xFE";
 z+="        elseif ctlType = \"imagebox\" Then\xFE";
 z+="            ' Column.editable = false\xFE";
 z+="            \xFE";
 z+="        elseif ctlType = \"checkbox\" Then\xFE";
 z+="            Column.edittype = \"checkbox\"\xFE";
 z+="            Column.editoptions = { value:\"1:0\" }\xFE";
 z+="            Column.formatter = \"checkbox\"\xFE";
 z+="            Column.align = \"center\"\xFE";
 z+="            \xFE";
 z+="        elseif ctlType = \"label\" Then\xFE";
 z+="            Column.editable = false\xFE";
 z+="            \xFE";
 z+="        elseif ctlType = \"urlbox\" Or ctlType = \"anchor\" Then\xFE";
 z+="            Column.formatter = `^^function (cellValue, myOptions, rowObject) { return \"<a href=\" + urlEncode(cellValue) + \" target='_blank'>...</a>\";  }^^` \xFE";
 z+="        \xFE";
 z+="        elseif ctlType = \"url\" then\xFE";
 z+="            Column.formatter = `^^function (cellValue, myOptions, rowObject) { return \"<a href=\" + urlEncode(cellValue) + \" target='_blank'>\" + cellValue + \"</a>\";  }^^` \xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    if Right(Column.index, 1) = \"#\" Then\xFE";
 z+="        Column.sorttype = \"int\"\xFE";
 z+="        Column.index = Left(Column.index, Len(Column.index) - 1)\xFE";
 z+="        if !Column.align Then Column.align = \"right\"\xFE";
 z+="        \xFE";
 z+="    elseIf Column.datatype = \"integer\" Or Column.datatype = \"autointeger\" then\xFE";
 z+="        Column.sorttype = \"int\"\xFE";
 z+="        If !Column.index Then Column.index = Column.name\xFE";
 z+="        if !Column.align Then Column.align = \"right\"\xFE";
 z+="        \xFE";
 z+="    elseIf Column.datatype = \"double\" Then\xFE";
 z+="        Column.sorttype = \"float\"\xFE";
 z+="        If !Column.index Then Column.index = Column.name\xFE";
 z+="        if !Column.align Then Column.align = \"right\"\xFE";
 z+="        \xFE";
 z+="    else\xFE";
 z+="        If !Column.index Then Column.index = Column.name\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    if myOptions.WidthMultiplier and IsNumeric(Column.width) and Len(Column.width) Then Column.width = Column.width * myOptions.WidthMultiplier\xFE";
 z+="\xFE";
 z+="    * need a default row?\xFE";
 z+="    if myOptions.allowInserts then \xFE";
 z+="        Dim D As String\xFE";
 z+="        if tColumn.defaultvalue then D = tColumn.defaultvalue Else D = tColumn.defaultValue\xFE";
 z+="        If !D Then D = \"\"\xFE";
 z+="        if Column.control = \"json_inline\" Then\xFE";
 z+="            If Left(D,1) <> \"[\" Or Right(D,1) <> \"]\" Then \xFE";
 z+="                if Left(D, 1) = \"{\" And Right(D,1) = \"}\" Then D = \"[\":D:\"]\" Else D = \"[]\"\xFE";
 z+="            End If\xFE";
 z+="            Dim JS As Json = JSon(\"{array:\":D:\"}\")\xFE";
 z+="            D = js.array\xFE";
 z+="        End If\xFE";
 z+="        if Len(D) then Column.defaultValue = D\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Column.resizable = true ;* default\xFE";
 z+="    \xFE";
 z+="    return Column\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+=" \xFE";
 z+="function jqGrid2(byval jqGridID As String, byval RestfulNameOrDataArray As Object, byval UserModelColumns As Array, byval myOptions As JSON) As String\xFE";
 z+="    $options async-\xFE";
 z+="\xFE";
 z+="    if !jqGridID Then jqGridID = \"jqGrid_\":Rnd(99999)\xFE";
 z+="    if !myOptions.WidthMultiplier then myOptions.WidthMultiplier = 1\xFE";
 z+="\xFE";
 z+="    // Moved to head - Html = @CssLink(@jsbroot:\"css/ui.jqgrid.css\")\xFE";
 z+="    Dim Html As String = @Head(@JSLink(@jsbroot:\"js/grid.locale-en.js\"))\xFE";
 z+="    Html := @Head(@JSLink(@jsbroot:\"js/jquery.jqgrid.js\"))\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    Dim ColumnModel As Array = []\xFE";
 z+="    For Each tColumn In UserModelColumns\xFE";
 z+="        If Len(tColumn.name) Then ColumnModel[-1] = jsbDef2jqGridDef(myOptions, tColumn)\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    Dim PKID As String = \"\"\xFE";
 z+="    Dim defaultRow As Json = {}\xFE";
 z+="    Cols = []\xFE";
 z+="    For Each Column In ColumnModel\xFE";
 z+="        If Column.primarykey Then PKID = Column.name\xFE";
 z+="        if len(Column.d) then defaultRow[Column.name] = Column.d\xFE";
 z+="        Cols[-1] = \"'\":Column.label:\"'\"\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    if myOptions.allowDeletes then\xFE";
 z+="        Column = {}\xFE";
 z+="        Column.name = \"jqGridAction\"\xFE";
 z+="        Column.label = \"Delete\"\xFE";
 z+="        Column.sortable = false\xFE";
 z+="        Column.width = \"65px\"\xFE";
 z+="        Column.editable = false\xFE";
 z+="        ColumnModel[-1] = Column\xFE";
 z+="        Cols[-1] = \"'\":Column.label:\"'\"\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Dim TBL As String = Chr(28):`<table id='`:jqGridID:`' style=\" position: relative; background-color: transparent;\" ><tr><td></td></tr></table>`:CRLF():Chr(29)\xFE";
 z+="    \xFE";
 z+="    if myOptions.allowInserts Or myOptions.allowUpdates Or myOptions.allowDeletes Then\xFE";
 z+="        if !PKID Then Tbl := Chr(28):\"You must setup a primary key column in order for your CRUD operations to work<br />\":Chr(29)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if myOptions.allowInserts Then \xFE";
 z+="        Dim AddBtn As String  = Chr(28):`<input type=\"BUTTON\" id=\"`:jqGridID:`_newRow\" value=\"New Row\" onclick=\"jqGrid_NewRow('`:jqGridID:`', `:jqGridID:`_dr, `:Val(myOptions.allowDeletes):`, '`:PKID:`')\" />`:Chr(29)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if myOptions.doPaging Then \xFE";
 z+="        Dim Pager As String = Chr(28):`<div id=\"`:jqGridID:`_pager\"></div>`:Chr(29)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if myOptions.doPaging Or myOptions.allowInserts Then \xFE";
 z+="        Html := @jsb_html.Rows2('%', Tbl, '30px', AddBtn:Pager) \xFE";
 z+="    Else \xFE";
 z+="        Html := Tbl\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    Dim joinedModel As String = Join(CStr(ColumnModel), \",\":Crlf())\xFE";
 z+="\xFE";
 z+="    // Need to turn these (^^) back into non-JSON strings\xFE";
 z+="    Loop While InStr(joinedModel, `\"^^`) Do\xFE";
 z+="       Dim LH As String = Field(joinedModel, `\"^^`, 1)\xFE";
 z+="       joinedModel = DropLeft(joinedModel, `\"^^`)\xFE";
 z+="       Dim sArg As String = Field(joinedModel, `^^\"`, 1)\xFE";
 z+="       Dim RH As StRiNg = DropIfLeft(joinedModel, `^^\"`)\xFE";
 z+="       Dim jArg As JSON = JSON('{ Arg: \"':sArg:'\"}')\xFE";
 z+="       sArg = jArg.Arg\xFE";
 z+="       joinedModel = LH:sARG:RH\xFE";
 z+="    Repeat\xFE";
 z+="    \xFE";
 z+="    Dim S As String = `\xFE";
 z+="            // Initial column order for `:jqGridID:`\xFE";
 z+="            var `:jqGridID:`_cm = [`:joinedModel:`];\xFE";
 z+="            var `:jqGridID:`_dr = `:defaultRow:`\xFE";
 z+="        `\xFE";
 z+="    \xFE";
 z+="    if system(1) = \"gae\" OR system(1) = \"aspx\" then\xFE";
 z+="        s := `\xFE";
 z+="              // Calc how many rows we can display\xFE";
 z+="              $(function() {\xFE";
 z+="           `\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    s := `\xFE";
 z+="           var gheight = $(\"#`:jqGridID:`\").height();\xFE";
 z+="           var gwidth = $(\"#`:jqGridID:`\").width();\xFE";
 z+="        `\xFE";
 z+="    \xFE";
 z+="   if TypeOf(RestfulNameOrDataArray) = \"Array\" Then\xFE";
 z+="        d = Join(RestfulNameOrDataArray, \",\")\xFE";
 z+="        d = Replace(d, am(), `\\xFE`)\xFE";
 z+="        d = Replace(d, crlf(), `\\r\\n`)\xFE";
 z+="        d = Replace(d, cr(), `\\r`)\xFE";
 z+="        d = Replace(d, lf(), `\\n`)\xFE";
 z+="        \xFE";
 z+="        s := `\xFE";
 z+="            var `:jqGridID:`_data = [`:d:`]\xFE";
 z+="            window.refreshData = function () {  }\xFE";
 z+="            \xFE";
 z+="            `:jqGridID:`_options = {\xFE";
 z+="                datatype: \"local\",\xFE";
 z+="                data: `:jqGridID:`_data,\xFE";
 z+="                scroll: 1,\xFE";
 z+="                rowNum: 9999,\xFE";
 z+="        `\xFE";
 z+="   Else\xFE";
 z+="        if myOptions.doPaging Then \xFE";
 z+="            s := `\xFE";
 z+="                var rowHeight = 23; //  $(\"#`:jqGridID:` tr\").eq(1).height();\xFE";
 z+="                var rowsperpage = parseInt(gheight / rowHeight);\xFE";
 z+="            `\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        s := `\xFE";
 z+="        window.refreshData = function () { $(\"#`:jqGridID:`\").trigger('reloadGrid'); }\xFE";
 z+="\xFE";
 z+="        var `:jqGridID:`_options = {\xFE";
 z+="            url:`:jsEscapeString(CStr(RestfulNameOrDataArray)):`,\xFE";
 z+="            datatype: \"json\",\xFE";
 z+="            `\xFE";
 z+="        if myOptions.doPaging Then \xFE";
 z+="            s := `\xFE";
 z+="            rowNum: rowsperpage,\xFE";
 z+="            rowList:[5, 10, 30, 60, 90, 200],\xFE";
 z+="            pager: '#`:jqGridID:`_pager',\xFE";
 z+="            `\xFE";
 z+="        else\xFE";
 z+="            s := `\xFE";
 z+="            rowNum: 9999,\xFE";
 z+="            scroll: 1,\xFE";
 z+="            `\xFE";
 z+="        End If\xFE";
 z+="   End If\xFE";
 z+="\xFE";
 z+="/*\xFE";
 z+="                iconSet: \"fontAwesome\",\xFE";
 z+="                shrinkToFit: false,\xFE";
 z+="                autoResizing: { compact: true },\xFE";
 z+="\xFE";
 z+="*/\xFE";
 z+="    Dim AW As String\xFE";
 z+="    if myOptions.width100percent then aw = \"true\" else aw = \"false\"\xFE";
 z+="    s := `\xFE";
 z+="            colNames: [`:Join(Cols, \",\"):`],\xFE";
 z+="            colModel: `:jqGridID:`_cm,\xFE";
 z+="            cmTemplate: { autoResizable: true, title: false },\xFE";
 z+="            autoresizeOnLoad: true,\xFE";
 z+="            multiselect: false,\xFE";
 z+="            gridview: true, // makes it faster but prohibits the use of treeGrid and subGrid\xFE";
 z+="            sortable: true, // allow column reordering\xFE";
 z+="            height: '98%',\xFE";
 z+="            autowidth: `:aw:`,\xFE";
 z+="            ignoreCase: true,\xFE";
 z+="            caption: `:jsEscapeString(myOptions.caption):`,\xFE";
 z+="            sortname: `:jsEscapeString(myOptions.sortname):`,\xFE";
 z+="            sortorder:`:jsEscapeString(myOptions.sortorder):`,\xFE";
 z+="            sortable: {\xFE";
 z+="                update: function () { saveColumnStates(\"`:jqGridID:`\") }\xFE";
 z+="            },\xFE";
 z+="\xFE";
 z+="            gridComplete: function() { jqGrid_gridComplete('`:jqGridID:`')},\xFE";
 z+="            loadComplete: function(data) { jqGrid_loadComplete('`:jqGridID:`')},\xFE";
 z+="            \xFE";
 z+="            resizeStop: function () { saveColumnStates(\"`:jqGridID:`\") },\xFE";
 z+="\xFE";
 z+="            onSelectRow: function(id, a, dataRow) { \xFE";
 z+="                // jqGrid_onSelectRow() will call eventHandler_eventHandler_rowSelected() - Setup your events with JSB_BF @genEventHandler(\"rowSelected\", ...)\xFE";
 z+="                jqGrid_onSelectRow(dataRow, '`:jqGridID:`', id) \xFE";
 z+="            },\xFE";
 z+="            ondblClickRow: function(id, a, b, e) { \xFE";
 z+="                // jqGrid_ondblClickRow() will call eventHandler_dblClickRow() - Setup your events with JSB_BF @genEventHandler(\"dblClickRow\", ...)\xFE";
 z+="                jqGrid_ondblClickRow(e, '`:jqGridID:`', id) \xFE";
 z+="            },\xFE";
 z+="            \xFE";
 z+="            altRows:true,\xFE";
 z+="        };\xFE";
 z+="        \xFE";
 z+="        jqGrid_Create(\"`:jqGridID:`\", `:myOptions:`, `:jqGridID:`_options, '`:PKID:`');\xFE";
 z+="        \xFE";
 z+="        function `:jqGridID:`_refresh() {\xFE";
 z+="             $('`:jqGridID:`').trigger('reloadGrid'); \xFE";
 z+="        }\xFE";
 z+="        `\xFE";
 z+="\xFE";
 z+="    if system(1) = \"gae\" OR system(1) = \"aspx\" then\xFE";
 z+="            s := `\xFE";
 z+="          });\xFE";
 z+="       `\xFE";
 z+="\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Return Html:@jsb_html.Script(S)\xFE";
 z+="end function"
window.cached_jsb_html["jqgrid"]=z;
var z="function jqGrid2(byval jqGridID As String, byval RestfulNameOrDataArray As String, byval UserModelColumns As Array, byval myOptions As JSON) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim COLS As Array\xFE";
 z+="    Dim COLUMNMODEL As Array\xFE";
 z+="    Dim DEFAULTROW As Json\xFE";
 z+="    Dim JS As Json\xFE";
 z+="    Dim TCOLUMN As Json\xFE";
 z+="    Dim COLUMN As Json\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim PKID As String\xFE";
 z+="    Dim CTLTYPE As String\xFE";
 z+="    Dim URL As String\xFE";
 z+="    Dim D As String\xFE";
 z+="    Dim ADDBTN As String\xFE";
 z+="    Dim PAGER As String\xFE";
 z+="    Dim JOINEDMODEL As String\xFE";
 z+="    Dim LH As String\xFE";
 z+="    Dim RH As StRiNg\xFE";
 z+="    Dim AW As String\xFE";
 z+="    Dim TBL As String\xFE";
 z+="    Dim S As String\xFE";
 z+="    Dim ARG As String\xFE";
 z+="\xFE";
 z+="    if typeof(myOptions) <> \"JSonObject\" then myOptions = { }\xFE";
 z+="    \xFE";
 z+="    if !jqGridID Then jqGridID = \"jqGrid_\":Rnd(99999)\xFE";
 z+="\xFE";
 z+="    // Moved to head - Html = @CssLink(@jsbroot:\"css/ui.jqgrid.css\")\xFE";
 z+="    Html = @Head(@JSLink(@jsbroot:\"js/grid.locale-en.js\"))\xFE";
 z+="    Html := @Head(@JSLink(@jsbroot:\"js/jquery.jqgrid.js\"))\xFE";
 z+="\xFE";
 z+="    Cols = []\xFE";
 z+="    ColumnModel = []\xFE";
 z+="    defaultRow = {}\xFE";
 z+="\xFE";
 z+="    if !myOptions.WidthMultiplier then myOptions.WidthMultiplier = 1\xFE";
 z+="    \xFE";
 z+="    PKID = \"\"\xFE";
 z+="    For Each tColumn In UserModelColumns\xFE";
 z+="        If Len(tColumn.name) And tColumn.primarykey Then PKID = tColumn.name; Break\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    For Each tColumn In UserModelColumns\xFE";
 z+="        If Len(tColumn.name) Then\xFE";
 z+="            Column = {}\xFE";
 z+="            Column.name = tColumn.name\xFE";
 z+="            if tColumn.datatype then Column.datatype = tColumn.datatype\xFE";
 z+="            if tColumn.primarykey then Column.primarykey = true\xFE";
 z+="            if tColumn.index then Column.index = tColumn.index\xFE";
 z+="            if tColumn.align then Column.align = tColumn.align\xFE";
 z+="            if tColumn.width then Column.width = tColumn.width\xFE";
 z+="            if tColumn.label then Column.label = tColumn.label\xFE";
 z+="            if tColumn.sorttype then Column.sorttype = tColumn.sorttype \xFE";
 z+="            if tColumn.sortable then Column.sortable = tColumn.sortable\xFE";
 z+="            if tColumn.tooltip Then Column.cellattr = `^^function () { return ' title=\"`:UrlEncode(tColumn.tooltip):`\"'; }^^` \xFE";
 z+="            if !Column.label Then Column.label = Column.name\xFE";
 z+="\xFE";
 z+="            // Valid formatters: http://www.trirand.com/jqgridwiki/doku.php?id=wiki:predefined_formatter\xFE";
 z+="            //   integer, number, currency, date, email, link, showlink, checkbox, select, actions\xFE";
 z+="            if tColumn.formatter then \xFE";
 z+="                Column.formatter = tColumn.formatter \xFE";
 z+="                \xFE";
 z+="            Else If Column.datatype = \"date\"  Or Column.datatype = \"datetime\" Then\xFE";
 z+="                Column.formatter = 'date'\xFE";
 z+="                \xFE";
 z+="            Else If Column.datatype = \"currency\" Then\xFE";
 z+="                Column.formatter = 'currency'\xFE";
 z+="                \xFE";
 z+="            //Else If Column.datatype = \"url\" Then\xFE";
 z+="            //    Column.formatter = 'link'\xFE";
 z+="                \xFE";
 z+="            Else if Column.datatype = \"integer\" Then\xFE";
 z+="                // Column.formatter = 'integer' // By making the formatter an integer, the data will be converted to an integer, and thus empty becomes 0\xFE";
 z+="                \xFE";
 z+="            Else if Column.datatype = \"autointeger\" Then \xFE";
 z+="                Column.formatter = 'integer'\xFE";
 z+="                \xFE";
 z+="            Else if Column.datatype = \"double\" Then \xFE";
 z+="                Column.formatter = 'number'\xFE";
 z+="                \xFE";
 z+="            End If\xFE";
 z+="\xFE";
 z+="            if tColumn.display = \"hidden\" Or tColumn.display = \"gridhidden\" then Column.hidden = true\xFE";
 z+="            \xFE";
 z+="            // http://www.trirand.com/jqgridwiki/doku.php?id=wiki:common_rules\xFE";
 z+="            ctlType = lcase(tColumn.control)\xFE";
 z+="            \xFE";
 z+="            // edittype and editoptions only set if column is editable\xFE";
 z+="            if tColumn.canedit || tColumn.editable then \xFE";
 z+="                Column.editable = true\xFE";
 z+="                if tColumn.edittype then Column.edittype = tColumn.edittype\xFE";
 z+="                if tColumn.editoptions then Column.editoptions = tColumn.editoptions\xFE";
 z+="            else\xFE";
 z+="                ' Not editable\xFE";
 z+="                Column.editable = false\xFE";
 z+="                if ctlType <> \"button\" And ctlType <> \"anchor\" and ctlType <> \"urlbox\" And ctlType <> \"url\" Then ctlType = \"\"\xFE";
 z+="            end if\xFE";
 z+="             \xFE";
 z+="            if !Column.edittype and ctlType then\xFE";
 z+="                **\xFE";
 z+="                ** textbox, dropDownBox, combobox, listbox, autotextbox, datebox, timebox, datetimebox, imagebox, currencybox\xFE";
 z+="                **                maskedtextbox, radiobox, multiselectlistbox, multiselectdropDownBox, colorpick, slider\xFE";
 z+="                **                htmlbox, label, imagebox, uploadimagebox, appendbox, passwordbox\xFE";
 z+="                ** ->\xFE";
 z+="                **      text, textarea, checkbox, select, password, button, image, file custom\xFE";
 z+="                *\xFE";
 z+="                if ctlType = \"button\" Then\xFE";
 z+="                    Column.formatter = \"^^jqGridAddBtn^^\"\xFE";
 z+="                    Url = DropIfRight(tColumn.transferurl, \".page\", true)\xFE";
 z+="                    Column.editoptions = { colName: Column.Name, primaryKey: PKID, transferurl: Url, transferto: tColumn.transferto, transferaddfrompage: tColumn.transferaddfrompage, transferextra: tColumn.onParentExtra, datausuage: tColumn.datausuage, title: Column.label } \xFE";
 z+="                          \xFE";
 z+="                elseif ctlType = \"imagebox\" Then\xFE";
 z+="                    ' Column.editable = false\xFE";
 z+="                    \xFE";
 z+="                elseif ctlType = \"checkbox\" Then\xFE";
 z+="                    Column.edittype = \"checkbox\"\xFE";
 z+="                    Column.editoptions = { value:\"1:0\" }\xFE";
 z+="                    Column.formatter = \"checkbox\"\xFE";
 z+="                    Column.align = \"center\"\xFE";
 z+="                    \xFE";
 z+="                elseif ctlType = \"label\" Then\xFE";
 z+="                    Column.editable = false\xFE";
 z+="                    \xFE";
 z+="                elseif ctlType = \"urlbox\" Or ctlType = \"anchor\" Then\xFE";
 z+="                    Column.formatter = `^^function (cellValue, myOptions, rowObject) { return \"<a href=\" + urlEncode(cellValue) + \" target='_blank'>...</a>\";  }^^` \xFE";
 z+="                \xFE";
 z+="                elseif ctlType = \"url\" then\xFE";
 z+="                    Column.formatter = `^^function (cellValue, myOptions, rowObject) { return \"<a href=\" + urlEncode(cellValue) + \" target='_blank'>\" + cellValue + \"</a>\";  }^^` \xFE";
 z+="                end if\xFE";
 z+="            end if\xFE";
 z+="\xFE";
 z+="            if Right(Column.index, 1) = \"#\" Then\xFE";
 z+="                Column.sorttype = \"int\"\xFE";
 z+="                Column.index = Left(Column.index, Len(Column.index) - 1)\xFE";
 z+="                if !Column.align Then Column.align = \"right\"\xFE";
 z+="                \xFE";
 z+="            elseIf Column.datatype = \"integer\" Or Column.datatype = \"autointeger\" then\xFE";
 z+="                Column.sorttype = \"int\"\xFE";
 z+="                If !Column.index Then Column.index = Column.name\xFE";
 z+="                if !Column.align Then Column.align = \"right\"\xFE";
 z+="                \xFE";
 z+="            elseIf Column.datatype = \"double\" Then\xFE";
 z+="                Column.sorttype = \"float\"\xFE";
 z+="                If !Column.index Then Column.index = Column.name\xFE";
 z+="                if !Column.align Then Column.align = \"right\"\xFE";
 z+="                \xFE";
 z+="            else\xFE";
 z+="                If !Column.index Then Column.index = Column.name\xFE";
 z+="            End If\xFE";
 z+="\xFE";
 z+="            if myOptions.WidthMultiplier and IsNumeric(Column.width) and Len(Column.width) Then Column.width = Column.width * myOptions.WidthMultiplier\xFE";
 z+="\xFE";
 z+="            * need a default row?\xFE";
 z+="            if myOptions.allowInserts then \xFE";
 z+="                if tColumn.defaultvalue then D = tColumn.defaultvalue Else D = tColumn.defaultValue\xFE";
 z+="                If !D Then D = \"\"\xFE";
 z+="                if Column.control = \"json_inline\" Then\xFE";
 z+="                    If Left(D,1) <> \"[\" Or Right(D,1) <> \"]\" Then \xFE";
 z+="                        if Left(D, 1) = \"{\" And Right(D,1) = \"}\" Then D = \"[\":D:\"]\" Else D = \"[]\"\xFE";
 z+="                    End If\xFE";
 z+="                    js = JSon(\"{array:\":D:\"}\")\xFE";
 z+="                    D = js.array\xFE";
 z+="                End If\xFE";
 z+="                defaultRow[Column.name] = D\xFE";
 z+="            end if\xFE";
 z+="            \xFE";
 z+="            Column.resizable = true ;* default\xFE";
 z+="            \xFE";
 z+="            Cols[-1] = \"'\":Column.label:\"'\"\xFE";
 z+="\xFE";
 z+="            ColumnModel[-1] = Column\xFE";
 z+="            If Column.primarykey Then PKID = Column.name\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    if myOptions.allowDeletes then\xFE";
 z+="        Column = {}\xFE";
 z+="        Column.name = \"jqGridAction\"\xFE";
 z+="        Column.label = \"Delete\"\xFE";
 z+="        Column.sortable = false\xFE";
 z+="        Column.width = \"65px\"\xFE";
 z+="        Column.editable = false\xFE";
 z+="        ColumnModel[-1] = Column\xFE";
 z+="        Cols[-1] = \"'\":Column.label:\"'\"\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Tbl = Chr(28):`<table id='`:jqGridID:`' style=\" position: relative; background-color: transparent;\" ><tr><td></td></tr></table>`:CRLF():Chr(29)\xFE";
 z+="    \xFE";
 z+="    if myOptions.allowInserts Or myOptions.allowUpdates Or myOptions.allowDeletes Then\xFE";
 z+="        if !PKID Then Tbl := Chr(28):\"You must setup a primary key column in order for your CRUD operations to work<br />\":Chr(29)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if myOptions.allowInserts Then \xFE";
 z+="        AddBtn = Chr(28):`<input type=\"BUTTON\" id=\"`:jqGridID:`_newRow\" value=\"New Row\" onclick=\"jqGrid_NewRow('`:jqGridID:`', `:jqGridID:`_dr, `:Val(myOptions.allowDeletes):`, '`:PKID:`')\" />`:Chr(29)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if myOptions.doPaging Then \xFE";
 z+="        Pager = Chr(28):`<div id=\"`:jqGridID:`_pager\"></div>`:Chr(29)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if myOptions.doPaging Or myOptions.allowInserts Then \xFE";
 z+="        Html := @jsb_html.Rows2('%', Tbl, '30px', AddBtn:Pager) \xFE";
 z+="    Else \xFE";
 z+="        Html := Tbl\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    joinedModel = Join(CStr(ColumnModel), \",\":Crlf())\xFE";
 z+="    \xFE";
 z+="    // Need to turn these (^^) back into non-JSON strings\xFE";
 z+="    Loop While InStr(joinedModel, `\"^^`) Do\xFE";
 z+="       LH = Field(joinedModel, `\"^^`, 1)\xFE";
 z+="       joinedModel = DropLeft(joinedModel, `\"^^`)\xFE";
 z+="       Arg = Field(joinedModel, `^^\"`, 1)\xFE";
 z+="       RH = DropIfLeft(joinedModel, `^^\"`)\xFE";
 z+="       \xFE";
 z+="       dim jArg As JSON = JSON('{ Arg: \"':Arg:'\"}')\xFE";
 z+="       Arg = jArg.Arg\xFE";
 z+="       \xFE";
 z+="       joinedModel = LH:ARG:RH\xFE";
 z+="    Repeat\xFE";
 z+="    \xFE";
 z+="    s = `\xFE";
 z+="            // Initial column order for `:jqGridID:`\xFE";
 z+="            var `:jqGridID:`_cm = [`:joinedModel:`];\xFE";
 z+="            var `:jqGridID:`_dr = `:defaultRow:`\xFE";
 z+="        `\xFE";
 z+="    \xFE";
 z+="    if system(1) = \"gae\" OR system(1) = \"aspx\" then\xFE";
 z+="        s := `\xFE";
 z+="              // Calc how many rows we can display\xFE";
 z+="              $(function() {\xFE";
 z+="           `\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    s := `\xFE";
 z+="           var gheight = $(\"#`:jqGridID:`\").height();\xFE";
 z+="           var gwidth = $(\"#`:jqGridID:`\").width();\xFE";
 z+="        `\xFE";
 z+="    \xFE";
 z+="   if TypeOf(RestfulNameOrDataArray) = \"Array\" Then\xFE";
 z+="        d = Join(RestfulNameOrDataArray, \",\")\xFE";
 z+="        d = Replace(d, am(), `\\xFE`)\xFE";
 z+="        d = Replace(d, crlf(), `\\r\\n`)\xFE";
 z+="        d = Replace(d, cr(), `\\r`)\xFE";
 z+="        d = Replace(d, lf(), `\\n`)\xFE";
 z+="        \xFE";
 z+="        s := `\xFE";
 z+="            var `:jqGridID:`_data = [`:d:`]\xFE";
 z+="            window.refreshData = function () {  }\xFE";
 z+="            \xFE";
 z+="            `:jqGridID:`_options = {\xFE";
 z+="                datatype: \"local\",\xFE";
 z+="                data: `:jqGridID:`_data,\xFE";
 z+="                scroll: 1,\xFE";
 z+="                rowNum: 9999,\xFE";
 z+="        `\xFE";
 z+="   Else\xFE";
 z+="        if myOptions.doPaging Then \xFE";
 z+="            s := `\xFE";
 z+="                var rowHeight = 23; //  $(\"#`:jqGridID:` tr\").eq(1).height();\xFE";
 z+="                var rowsperpage = parseInt(gheight / rowHeight);\xFE";
 z+="            `\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        s := `\xFE";
 z+="        window.refreshData = function () { $(\"#`:jqGridID:`\").trigger('reloadGrid'); }\xFE";
 z+="\xFE";
 z+="        var `:jqGridID:`_options = {\xFE";
 z+="            url:`:jsEscapeString(RestfulNameOrDataArray):`,\xFE";
 z+="            datatype: \"json\",\xFE";
 z+="            `\xFE";
 z+="        if myOptions.doPaging Then \xFE";
 z+="            s := `\xFE";
 z+="            rowNum: rowsperpage,\xFE";
 z+="            rowList:[5, 10, 30, 60, 90, 200],\xFE";
 z+="            pager: '#`:jqGridID:`_pager',\xFE";
 z+="            `\xFE";
 z+="        else\xFE";
 z+="            s := `\xFE";
 z+="            rowNum: 9999,\xFE";
 z+="            scroll: 1,\xFE";
 z+="            `\xFE";
 z+="        End If\xFE";
 z+="   End If\xFE";
 z+="\xFE";
 z+="/*\xFE";
 z+="                iconSet: \"fontAwesome\",\xFE";
 z+="                shrinkToFit: false,\xFE";
 z+="                autoResizing: { compact: true },\xFE";
 z+="\xFE";
 z+="*/\xFE";
 z+="    if myOptions.width100percent then aw = \"true\" else aw = \"false\"\xFE";
 z+="    s := `\xFE";
 z+="            colNames: [`:Join(Cols, \",\"):`],\xFE";
 z+="            colModel: `:jqGridID:`_cm,\xFE";
 z+="            cmTemplate: { autoResizable: true },\xFE";
 z+="            autoresizeOnLoad: true,\xFE";
 z+="            multiselect: false,\xFE";
 z+="            gridview: true, // makes it faster but prohibits the use of treeGrid and subGrid\xFE";
 z+="            sortable: true, // allow column reordering\xFE";
 z+="            height: '98%',\xFE";
 z+="            autowidth: `:aw:`,\xFE";
 z+="            ignoreCase: true,\xFE";
 z+="            caption: `:jsEscapeString(myOptions.caption):`,\xFE";
 z+="            sortname: `:jsEscapeString(myOptions.sortname):`,\xFE";
 z+="            sortorder:`:jsEscapeString(myOptions.sortorder):`,\xFE";
 z+="            sortable: {\xFE";
 z+="                update: function () { saveColumnStates(\"`:jqGridID:`\") }\xFE";
 z+="            },\xFE";
 z+="\xFE";
 z+="            gridComplete: function() { jqGrid_gridComplete('`:jqGridID:`')},\xFE";
 z+="            loadComplete: function(data) { jqGrid_loadComplete('`:jqGridID:`')},\xFE";
 z+="            \xFE";
 z+="            resizeStop: function () { saveColumnStates(\"`:jqGridID:`\") },\xFE";
 z+="\xFE";
 z+="            onSelectRow: function(id, a, dataRow) { \xFE";
 z+="                // jqGrid_onSelectRow() will call eventHandler_eventHandler_rowSelected() - Setup your events with JSB_BF @genEventHandler(\"rowSelected\", ...)\xFE";
 z+="                jqGrid_onSelectRow(dataRow, '`:jqGridID:`', id) \xFE";
 z+="            },\xFE";
 z+="            ondblClickRow: function(id, a, b, e) { \xFE";
 z+="                // jqGrid_ondblClickRow() will call eventHandler_dblClickRow() - Setup your events with JSB_BF @genEventHandler(\"dblClickRow\", ...)\xFE";
 z+="                jqGrid_ondblClickRow(e, '`:jqGridID:`', id) \xFE";
 z+="            },\xFE";
 z+="            \xFE";
 z+="            altRows:true,\xFE";
 z+="        };\xFE";
 z+="        \xFE";
 z+="        jqGrid_Create(\"`:jqGridID:`\", `:myOptions:`, `:jqGridID:`_options, '`:PKID:`');\xFE";
 z+="        \xFE";
 z+="        function `:jqGridID:`_refresh() {\xFE";
 z+="             $('`:jqGridID:`').trigger('reloadGrid'); \xFE";
 z+="        }\xFE";
 z+="        `\xFE";
 z+="\xFE";
 z+="    if system(1) = \"gae\" OR system(1) = \"aspx\" then\xFE";
 z+="            s := `\xFE";
 z+="          });\xFE";
 z+="       `\xFE";
 z+="\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Return Html:@jsb_html.Script(S)\xFE";
 z+="end function"
window.cached_jsb_html["jqgrid2"]=z;
var z="function jqGridDefaultModel(byval Rows As Array) As Array\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim M As Array\xFE";
 z+="    Dim JS As Json\xFE";
 z+="    Dim S As Json\xFE";
 z+="    Dim NAME As String\xFE";
 z+="    Dim V As String\xFE";
 z+="    Dim VTYPE As String\xFE";
 z+="\xFE";
 z+="    M = []\xFE";
 z+="\xFE";
 z+="    If Len(Rows) Then \xFE";
 z+="        JS = JSon(Rows[1])\xFE";
 z+="        For Each Name in JS\xFE";
 z+="            V = JS[Name]\xFE";
 z+="            S = {}\xFE";
 z+="            S.name = Name\xFE";
 z+="            S.index = Name\xFE";
 z+="            S.label = UCase(Left(Name, 1)):Mid(Name, 2)\xFE";
 z+="            S.width = 150\xFE";
 z+="            \xFE";
 z+="            vtype = typeof(V)\xFE";
 z+="            If Left(V, 7) = \"http://\" Or Left(V, 8) = \"https://\" Then\xFE";
 z+="                S.control = \"anchor\"\xFE";
 z+="                S.width = 15\xFE";
 z+="                S.sortable = false\xFE";
 z+="                \xFE";
 z+="            ElseIf vtype = \"Double\"  Then \xFE";
 z+="                S.datatype = \"double\"\xFE";
 z+="                S.width = 80\xFE";
 z+="                \xFE";
 z+="            ElseIf vtype = \"Integer\" Or (IsNumeric(V) And !IsNull(V)) Then \xFE";
 z+="                S.datatype = \"integer\"\xFE";
 z+="                S.width = 80\xFE";
 z+="                \xFE";
 z+="\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            M[-1] = S\xFE";
 z+="        Next\xFE";
 z+="    Else\xFE";
 z+="        M[-1] = { name: 'no rows' }\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Return M\xFE";
 z+="End Function"
window.cached_jsb_html["jqgriddefaultmodel"]=z;
window.cached_jsb_html["jslink"]="Function JsLink(byval Url As String) As String\xFE    $options ijs\xFE    if !instr(Url, `/`) And !instr(Url, `\\`) then Url = @jsbRoot:`js/`:Url\xFE    Return Chr(28):`<script src=`:jsEscapeHREF(Url):`></script>`:crlf():Chr(29)\xFEend Function\xFE";
window.cached_jsb_html["json2table"]="function json2table(Byval Id As Object, Optional Byval jsArray As Object, Optional Byval classNameOrAttributes As Object) As StRiNg\xFE        $options async-\xFE        return jsonArray2table(ID, jsArray, classNameOrAttributes)\xFEend function";
var z="// ID is optional too, just pass the array of json as the 1st parameter\xFE";
 z+="function jsonArray2table(Byval Id As Object, Optional Byval jsArray As Array, Optional Byval classNameOrAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HEADER As Array\xFE";
 z+="    Dim TRS As Array\xFE";
 z+="    Dim THS As Array\xFE";
 z+="    Dim TDS As Array\xFE";
 z+="    Dim ROW As Json\xFE";
 z+="    Dim ROW1 As StRiNg\xFE";
 z+="    Dim TAG As StRiNg\xFE";
 z+="\xFE";
 z+="    If isArray(Id) Then\xFE";
 z+="        classNameOrAttributes = jsArray\xFE";
 z+="        jsArray = Id\xFE";
 z+="        Id = \"\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    TRs = []\xFE";
 z+="    THs = []\xFE";
 z+="    If !Len(jsArray) Then Return\xFE";
 z+="    Row1 = jsArray[1]\xFE";
 z+="    \xFE";
 z+="    TRs[-1] = @Html(\"<thead style='background-color: rgb(50%,50%,50%);'>\")\xFE";
 z+="    For Each Tag In Row1\xFE";
 z+="        THs[-1] = Th(Tag)\xFE";
 z+="    Next\xFE";
 z+="    TRs[-1] = Tr(THs)\xFE";
 z+="    TRs[-1] = @Html(\"</thead>\")\xFE";
 z+="    \xFE";
 z+="    TRs[-1] = @Html(\"<tbody>\")\xFE";
 z+="    For Each Row In jsArray\xFE";
 z+="        TDs = []\xFE";
 z+="        For Each Tag In Row1\xFE";
 z+="            TDs[-1] = Td(Row[Tag])\xFE";
 z+="        Next\xFE";
 z+="        TRs[-1] = Tr(TDs)\xFE";
 z+="    Next\xFE";
 z+="    TRs[-1] = @Html(\"</tbody>\")\xFE";
 z+="    \xFE";
 z+="    Header = []\xFE";
 z+="    Header[-1] = @csslink(@jsbroot:`js/bootstrap-table/bootstrap-table.css`)\xFE";
 z+="    Header[-1] = @jslink(@jsbRoot:`js/bootstrap-table/bootstrap-table.js`)\xFE";
 z+="    Header[-1] = @jslink(@jsbRoot:`js/bootstrap-table/extensions/mobile/bootstrap-table-mobile.js`)\xFE";
 z+="    \xFE";
 z+="    Return Join(Header, \"\"):Table(Id, TRs, classNameOrAttributes)\xFE";
 z+="End function"
window.cached_jsb_html["jsonarray2table"]=z;
var z="*\xFE";
 z+="*  a JsonMenu uses the same set of tags and properties as jsonTree (interchangable) and menuBar (Bootstrap version)\xFE";
 z+="*  \xFE";
 z+="*     If a property is \xFE";
 z+="*         simply a string: it is an onclick script as a leaf with the id and caption of the tag name.\xFE";
 z+="*         {a json object}, it is a leaf if it has tags onclick or id, otherwise it is a folder\xFE";
 z+="*\xFE";
 z+="*  By default, click events will attempt a call to eithter eventHandler_folderSelected() and eventHandler_leafSelected()\xFE";
 z+="*    Use something like:  Print @jsb_bf.genEventHandler(\"leafSelected\", \"\", 11, \"alert('you selected leag ' + parentDataRow[primaryKeyName] + ' ' + parentDataRow['nodeID']) \"): \xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="/*\xFE";
 z+="  Each menu {} structure may optionally have:\xFE";
 z+=" \xFE";
 z+="        class: 'optional_extraClasses',\xFE";
 z+="        id: 'js_id_file',\xFE";
 z+="        caption: 'File',  // override tag name \xFE";
 z+="        \xFE";
 z+="        disabled: false,\xFE";
 z+="        \xFE";
 z+="        // optional user data: will get passed to eventHandlers, ie:    eventHandler_xxxxx(data, pkID, eventName, e)\xFE";
 z+="        pkID: 'id',         // default name for primary key if using attribute 'data'\xFE";
 z+="        data: { id: 'my id' }, // a user defined structure\xFE";
 z+="        \xFE";
 z+="        // optional dynamic loading URL\xFE";
 z+="        url: null,     // A url to fetch dynamic content\xFE";
 z+="        \xFE";
 z+="        // optional onClick code (if using dynamic loading, will run after load)\xFE";
 z+="        onclick: null, // user javascript code\xFE";
 z+="\xFE";
 z+="      \xFE";
 z+="      Menu = {\xFE";
 z+="         File: { \xFE";
 z+="                 // leafs\xFE";
 z+="                 New:   { id: 'New', onclick: 'alert(\"Hi\")' },\xFE";
 z+="                 sep: 'ignore anything starting with sep', // seperator\xFE";
 z+="                 Open:  { id: 'Open' },\xFE";
 z+="                 Close: { id: 'Close' }\xFE";
 z+="          },\xFE";
 z+="         Edit: { \xFE";
 z+="                 Cut:   { id: 'Cut' },\xFE";
 z+="                 Copy:  { id: 'Copy' },\xFE";
 z+="                 Paste: { id: 'Paste' }\xFE";
 z+="          },\xFE";
 z+="         Help: { id: 'Help' },\xFE";
 z+="         Stop:  {id: 'Stop', iconurl:'stop.png'},\xFE";
 z+="         Exit:  {id: 'Exit', iconurl:'/jsb/pics/exit.png'}\xFE";
 z+="      }\xFE";
 z+="\xFE";
 z+="    // define a general event handler for event \"leafSelected\" or event \"folderSelected\"\xFE";
 z+="    Print @genEventHandler(\"leafSelected\", \"\", 11, \"alert('you clicked ' + parentDataRow[primaryKeyName] + ' ' + parentDataRow['id']) \"):\xFE";
 z+="    \xFE";
 z+="    // show the menu\xFE";
 z+="    Print jsonMenu(menu)\xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="function JSONMenu(ByVal ID As String, optional byval staticMenu As Object) As StRiNg\xFE";
 z+="* $options async-\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if isMissing(staticMenu) then\xFE";
 z+="        staticMenu = id\xFE";
 z+="        id = @NewGuid\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Html = @Html(`<span id='`:id:`'>menu view</span>`)\xFE";
 z+="    if isJson(staticMenu) Then \xFE";
 z+="        Html := @Script(`$('#`:id:`').html(jsonMenu(`:staticMenu:`, false));`)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Return Html\xFE";
 z+="end function"
window.cached_jsb_html["jsonmenu"]=z;
var z="*\xFE";
 z+="*  a JsonTree is a set of tags/properties.  \xFE";
 z+="*     If a property is \xFE";
 z+="*         simply a string: it is an onclick script as a leaf with the id and caption of the tag name.\xFE";
 z+="*         {a json object}, it is a leaf if it has tags onclick or id, otherwise it is a folder\xFE";
 z+="*\xFE";
 z+="*  By default, click events will attempt a call to eithter eventHandler_folderSelected() and eventHandler_leafSelected()\xFE";
 z+="*    Use something like:  Print @jsb_bf.genEventHandler(\"leafSelected\", \"\", 11, \"alert('you selected leag ' + parentDataRow[primaryKeyName] + ' ' + parentDataRow['nodeID']) \"): \xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="/*\xFE";
 z+="  tree = {\xFE";
 z+="     file: { // optional opened attribute\xFE";
 z+="             opened: true,\xFE";
 z+="             \xFE";
 z+="             // optional attributes for both folders and leafs\xFE";
 z+="             class: 'optional extraClasses',\xFE";
 z+="             id: 'id or default to caption',\xFE";
 z+="             caption: 'specific caption or default to tagName',\xFE";
 z+="             disabled: false,\xFE";
 z+="             \xFE";
 z+="             // optional user data: will get passed to eventHandlers, ie:    eventHandler_xxxxx(data, pkID, eventName, e)\xFE";
 z+="             pkID: 'id',         // default name for primary key if using attribute 'data'\xFE";
 z+="             data: { a user json structure }\xFE";
 z+="\xFE";
 z+="             // optional dynamic loading URL\xFE";
 z+="             url: null,     // 'a url to fetch dynamic content\xFE";
 z+="             \xFE";
 z+="             // optional onClick code (if using dynamic loading, will run after load)\xFE";
 z+="             onclick: null, // user javascript code\xFE";
 z+="\xFE";
 z+="             // ignored for compatablility with JSB_HTML MenuBar\xFE";
 z+="             collaspable: true,\xFE";
 z+="             rightalign: false, // ignored\xFE";
 z+="             sep: 'ignore anything starting with sep', // seperator\xFE";
 z+="             \xFE";
 z+="             \xFE";
 z+="             // leafs\xFE";
 z+="             new:   { id: 1, onclick: 'alert(\"Hi\")' },\xFE";
 z+="             open:  { id: 2 },\xFE";
 z+="             close: { id: 3 }\xFE";
 z+="      },\xFE";
 z+="     edit: { initOpen: false,\xFE";
 z+="             cut:   { id: 4 },\xFE";
 z+="             copy:  { id: 5 },\xFE";
 z+="             paste: { id: 6 }\xFE";
 z+="      },\xFE";
 z+="     help: { id: 7 }\xFE";
 z+="  }\xFE";
 z+="\xFE";
 z+="    // define a general event handler for event \"leafSelected\" or event \"folderSelected\"\xFE";
 z+="    Print @genEventHandler(\"leafSelected\", \"\", 11, \"alert('you clicked ' + parentDataRow[primaryKeyName] + ' ' + parentDataRow['id']) \"):\xFE";
 z+="    \xFE";
 z+="    // show the tree\xFE";
 z+="    Print jsonTree(tree)\xFE";
 z+="    Stop\xFE";
 z+="\xFE";
 z+="    // Second example to load via AJAX\xFE";
 z+="    Print jsonTree('id', '', @jsbRestCall(`getTheTree?arguments=`:UrlEncode(arguments)))\xFE";
 z+="    Stop\xFE";
 z+="    \xFE";
 z+="    restful function getTheTree(arguments)\xFE";
 z+="        return { file: { new: \"callback1\", open: \"callback2\" } }\xFE";
 z+="    end function\xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="function JSONTree(ByVal ID As String, optional byval staticTree As Object, optional byval dynamicURL As String) As StRiNg\xFE";
 z+="* $options async-\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim ONSUCCESS As String\xFE";
 z+="    Dim ONFAILURE As String\xFE";
 z+="\xFE";
 z+="    if isMissing(staticTree) then\xFE";
 z+="        staticTree = json(id)\xFE";
 z+="        id = @NewGuid\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Html = @Html(`<span id='`:id:`'>tree view</span>`)\xFE";
 z+="    if isJson(staticTree) Then \xFE";
 z+="        Html := @Script(`$('#`:id:`').html(jsonTree(`:staticTree:`, false));`)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if dynamicURL then\xFE";
 z+="        // Load by AJAX\xFE";
 z+="        OnSuccess = `$('#`:id:`').html(jsonTree(json))` \xFE";
 z+="        OnFailure = `alert('failed treeview load ajax call to ' + `:jsEscapeString(dynamicURL):` + '; error: ' + textStatus)` \xFE";
 z+="        Html := @Script(`\xFE";
 z+="            function `:id:`_refresh() {\xFE";
 z+="                `:@Jsb_bf.Ajax(jsEscapeHREF(dynamicURL), OnSuccess, OnFailure):`\xFE";
 z+="            }\xFE";
 z+="            `:iif(staticTree, \"\", id:`_refresh();`):`\xFE";
 z+="        `)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Return Html\xFE";
 z+="end function"
window.cached_jsb_html["jsontree"]=z;
var z="***************** HTML *****************************\xFE";
 z+="*\xFE";
 z+="* See https://github.com/aterrien/jQuery-Knob\xFE";
 z+="*\xFE";
 z+="*     print @KNOB('id', 50, false, { onrelease: 'alert( \"value \" + v)', 20, 150, \"\", \"red\"):\xFE";
 z+="*\xFE";
 z+="*     dynamically set value: $('#':id).val(50).trigger('change')\xFE";
 z+="*\xFE";
 z+="FUNCTION Knob(ByVal ID As String, optional ByVal DefaultValue As String, optional ByVal ReadOnly As Boolean, optional byval AdditionalAttributes As Object, optional byval minValue As StRiNg, optional byval maxValue As StRiNg, optional byval size As StRiNg, optional byval color As StRiNg) As StRiNg\xFE";
 z+="   $options async-\xFE";
 z+="   \xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim CT As String\xFE";
 z+="    Dim ONCHANGE As String\xFE";
 z+="    Dim ONRELEASE As String\xFE";
 z+="    Dim AA As String\xFE";
 z+="\xFE";
 z+="   HTML = @Head(@JSLink(@jsbroot:\"js/knob.js\"))\xFE";
 z+="  \xFE";
 z+="   If ReadOnly Then CT = \"KNOB_ReadOnly\" Else CT = \"KNOB\"\xFE";
 z+="   AA  = JoinAttributes(@MergeAttribute(\"class\", CT, \" \", AA))\xFE";
 z+="   \xFE";
 z+="   If ReadOnly Then \xFE";
 z+="       HTML := CHR(28):\"<input id='\":ID:\"' tabindex='-1' name='\":ID:\"' readonly \":AA\xFE";
 z+="   Else\xFE";
 z+="       HTML := CHR(28):\"<input id='\":ID:\"' name='\":ID:\"' \":AA\xFE";
 z+="   End If\xFE";
 z+="   \xFE";
 z+="   HTML := ' value=\"':Val(DEFAULTVALUE):'\"'\xFE";
 z+="   if size then html := ` data-width=\"`:size:`\"`\xFE";
 z+="   if minValue then html := ` data-min=\"`:minValue:`\"`\xFE";
 z+="   if maxValue then html := ` data-max=\"`:maxValue:`\"`\xFE";
 z+="   if color then html := ` data-fgColor=\"`:color:`\"`\xFE";
 z+="   HTML := ' data-cursor=true data-linecap=round />':CHR(29)\xFE";
 z+="   \xFE";
 z+="   onchange = hasAttribute(\"onchange\", AdditionalAttributes)\xFE";
 z+="   onrelease = hasAttribute(\"onrelease\", AdditionalAttributes)\xFE";
 z+="   if onchange then onChange = `change: function (v) { `:onchange:` }` Else onChange = ''\xFE";
 z+="   if onrelease then onrelease = `release: function (v) { `:onrelease:` }` Else onrelease = ''\xFE";
 z+="   if onchange and onrelease then onchange := `,`\xFE";
 z+="   \xFE";
 z+="   HTML := @script(`$(\"#`:ID:`\").knob({ `:onchange:onrelease:` })`)\xFE";
 z+="   RETURN HTML"
window.cached_jsb_html["knob"]=z;
var z="function Label(Byval Labeltext As String, Optional Byval Forid As Object, Optional Byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If IsMissing(AdditionalAttributes) Then\xFE";
 z+="        If IsJSON(ForID) Or InStr(ForID, \"=\") Then\xFE";
 z+="            AdditionalAttributes = ForID\xFE";
 z+="            ForID = ''\xFE";
 z+="        Else\xFE";
 z+="            AdditionalAttributes = [\"style='width:200px;'\"]\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html = Chr(28):\"<label \"\xFE";
 z+="    If ForID Then Html=Html:\" id='lbl_\":ForID:\"' for='\":ForID:\"'\"\xFE";
 z+="    Html=Html:\" \":Join(@MergeAttribute(\"class\", \"Label form-control-label\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="    If Labeltext Then Labeltext = Labeltext:\":\"\xFE";
 z+="    Html := \">\":Replace(Replace(@HtmlEncode(@Jsb_bf.Language(Labeltext)), Chr(255), \"<br />\"), Chr(13), \"<br />\"):\"&nbsp</label>\":Chr(29)\xFE";
 z+="    \xFE";
 z+="    Return Html"
window.cached_jsb_html["label"]=z;
var z="FUNCTION LAYOUT(byval CenterHtml As StRiNg, byval NorthHtml As StRiNg, byval NorthOptions As String, byval SouthHtml As StRiNg, byval SouthOptions As String, byval EastHtml As StRiNg, byval EastOptions As String, byval WestHtml As StRiNg, byval WestOptions As String) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="*\xFE";
 z+="* Options: Fixed (!resizable, !slidable, !closable)\xFE";
 z+="*          resizable, slidable, closable    (defaults)\xFE";
 z+="*          minSize:int, maxSize:int, startsize:int, initClosed, initHidden, allowOverFlow\xFE";
 z+="*    \xFE";
 z+="* example: \xFE";
 z+="*   NorthHtml := @button('', @Html(`<span class=\"glyphicon glyphicon-menu-hamburger\"></span>`), { onclick: 'if (myLayout.west.state.isVisible) return myLayout.hide(\"west\"); myLayout.open(\"west\"); myLayout.show(\"west\") ' } ) \xFE";
 z+="*   print @JSB_HTML.LAYOUT(CenterHtml, NorthHtml, \"!resizable, slidable, allowoverflow, startsize:300\", SouthHtml, \"initClosed, startsize:30, minSize:15\", EastHtml, \"startsize: 60, minSize:15\", WestHtml, \"startsize: 60\"):\xFE";
 z+="*\xFE";
 z+="* NO options at all will force closed and hidden\xFE";
 z+="*\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim NORTHSIZE As String\xFE";
 z+="    Dim SOUTHSIZE As String\xFE";
 z+="    Dim EASTSIZE As String\xFE";
 z+="    Dim WESTSIZE As String\xFE";
 z+="    Dim NORTHMINSIZE As String\xFE";
 z+="    Dim SOUTHMINSIZE As String\xFE";
 z+="    Dim EASTMINSIZE As String\xFE";
 z+="    Dim WESTMINSIZE As String\xFE";
 z+="    Dim NORTHMAXSIZE As String\xFE";
 z+="    Dim SOUTHMAXSIZE As String\xFE";
 z+="    Dim EASTMAXSIZE As String\xFE";
 z+="    Dim WESTMAXSIZE As String\xFE";
 z+="    Dim NORTHOVERFLOW As String\xFE";
 z+="    Dim SOUTHOVERFLOW As String\xFE";
 z+="    Dim EASTOVERFLOW As String\xFE";
 z+="    Dim WESTOVERFLOW As String\xFE";
 z+="\xFE";
 z+="    Dim needLoad As Boolean = true\xFE";
 z+="    if system(1) = \"js\" then\xFE";
 z+="        if window.jQuery.layout then needload = false\xFE";
 z+="    end if\xFE";
 z+="    if needload then\xFE";
 z+="        Html = @Head(@JSLink(@jsbroot:\"js/jquery.layout.js\"))\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="  if !NorthOptions Then NorthOptions = \"initClosed, initHidden, Fixed\" Else NorthOptions = Replace(NorthOptions, \"px\", \"\")\xFE";
 z+="  if !SouthOptions Then SouthOptions = \"initClosed, initHidden, Fixed\" Else SouthOptions = Replace(SouthOptions, \"px\", \"\")\xFE";
 z+="  if !EastOptions Then EastOptions = \"initClosed, initHidden, Fixed\" Else EastOptions = Replace(EastOptions, \"px\", \"\")\xFE";
 z+="  if !WestOptions Then WestOptions = \"initClosed, initHidden, Fixed\" Else WestOptions = Replace(WestOptions, \"px\", \"\")\xFE";
 z+="\xFE";
 z+="  NorthOptions = LCase(NorthOptions)\xFE";
 z+="  SouthOptions = LCase(SouthOptions)\xFE";
 z+="  EastOptions = LCase(EastOptions)\xFE";
 z+="  WestOptions = LCase(WestOptions)\xFE";
 z+="\xFE";
 z+="  if Field(NorthOptions, \"startsize:\", 2) then NorthSize = \"size: '\":Field(Field(NorthOptions, \"startsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(SouthOptions, \"startsize:\", 2) then SouthSize = \"size: '\":Field(Field(SouthOptions, \"startsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(EastOptions, \"startsize:\", 2) then EastSize = \"size: '\":Field(Field(EastOptions, \"startsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(WestOptions, \"startsize:\", 2) then WestSize = \"size: '\":Field(Field(WestOptions, \"startsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="\xFE";
 z+="  if Field(NorthOptions, \"minsize:\", 2) then NorthminSize = \"minSize: '\":Field(Field(NorthOptions, \"minsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(SouthOptions, \"minsize:\", 2) then SouthminSize = \"minSize: '\":Field(Field(SouthOptions, \"minsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(EastOptions, \"minsize:\", 2) then EastminSize = \"minSize: '\":Field(Field(EastOptions, \"minsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(WestOptions, \"minsize:\", 2) then WestminSize = \"minSize: '\":Field(Field(WestOptions, \"minsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="\xFE";
 z+="  if Field(NorthOptions, \"maxsize:\", 2) then NorthmaxSize = \"maxSize: '\":Field(Field(NorthOptions, \"maxsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(SouthOptions, \"maxsize:\", 2) then SouthmaxSize = \"maxSize: '\":Field(Field(SouthOptions, \"maxsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(EastOptions, \"maxsize:\", 2) then EastmaxSize = \"maxSize: '\":Field(Field(EastOptions, \"maxsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="  if Field(WestOptions, \"maxsize:\", 2) then WestmaxSize = \"maxSize: '\":Field(Field(WestOptions, \"maxsize:\", 2), \",\", 1):\"',\"\xFE";
 z+="\xFE";
 z+="  if InStr(NorthOptions, \"fixed\") then NorthOptions = NorthOptions:\", !resizable, !slidable, !closable\"\xFE";
 z+="  if InStr(SouthOptions, \"fixed\") then SouthOptions = SouthOptions:\", !resizable, !slidable, !closable\"\xFE";
 z+="  if InStr(EastOptions, \"fixed\") then EastOptions = EastOptions:\", !resizable, !slidable, !closable\"\xFE";
 z+="  if InStr(WestOptions, \"fixed\") then WestOptions = WestOptions:\", !resizable, !slidable, !closable\"\xFE";
 z+="\xFE";
 z+="  if InStr(NorthOptions,  \"allowoverflow\") then NorthOverflow = \"showOverflowOnHover: true,\"\xFE";
 z+="  if InStr(SouthOptions,  \"allowoverflow\") then SouthOverflow = \"showOverflowOnHover: true,\"\xFE";
 z+="  if InStr(EastOptions,   \"allowoverflow\") then EastOverflow  = \"showOverflowOnHover: true,\"\xFE";
 z+="  if InStr(WestOptions,   \"allowoverflow\") then WestOverflow  = \"showOverflowOnHover: true,\"\xFE";
 z+="\xFE";
 z+="  Html := `\xFE";
 z+="     <div id=\"mylayout\" style=\"position: absolute; top: 0; bottom: 0; left: 0; right: 0; border: 0; padding: 0; margin: 0;\">\xFE";
 z+="         <div class=\"ui-layout-center\">`:CenterHtml:`</div>\xFE";
 z+="         <div class=\"ui-layout-north\">`:NorthHtml:`</div>\xFE";
 z+="         <div class=\"ui-layout-south\">`:SouthHtml:`</div>\xFE";
 z+="         <div class=\"ui-layout-east\">`:EastHtml:`</div>\xFE";
 z+="         <div class=\"ui-layout-west\">`:WestHtml:`</div>\xFE";
 z+="      </div>\xFE";
 z+="      <script type=\"text/javascript\">\xFE";
 z+="            window.myLayout = $('#mylayout').layout({\xFE";
 z+="                applyDemoStyles: true,\xFE";
 z+="                defaults: {\xFE";
 z+="                    fxName: \"slide\",\xFE";
 z+="                     fxSpeed: \"fast\"\xFE";
 z+="                    , resizerClass: \"resizer\"   \xFE";
 z+="                    , togglerClass: \"toggler\"   \xFE";
 z+="                    , buttonClass: \"button\" ,\xFE";
 z+="                    paneClass: \"pane\"  \xFE";
 z+="                },\xFE";
 z+="                north: {\xFE";
 z+="                    initHidden: `:(Index(NorthOptions, \"inithidden\", 1) > 0):`,\xFE";
 z+="                    initClosed: `:(Index(NorthOptions, \"initclosed\", 1) > 0):`,\xFE";
 z+="                    resizable: `:(Index(NorthOptions, \"!resizable\", 1) = 0):`,\xFE";
 z+="                    slidable: `:(Index(NorthOptions, \"!slidable\", 1) = 0):`,\xFE";
 z+="                    `:NorthSize:`\xFE";
 z+="                    `:NorthminSize:`\xFE";
 z+="                    `:NorthmaxSize:`\xFE";
 z+="                    `:NorthOverflow:`\xFE";
 z+="                    closable: `:(Index(NorthOptions, \"!closable\", 1) = 0):`\xFE";
 z+="                },\xFE";
 z+="                south: {\xFE";
 z+="                    initHidden: `:(Index(southOptions, \"inithidden\", 1) > 0):`,\xFE";
 z+="                    initClosed: `:(Index(southOptions, \"initclosed\", 1) > 0):`,\xFE";
 z+="                    resizable: `:(Index(southOptions, \"!resizable\", 1) = 0):`,\xFE";
 z+="                    slidable: `:(Index(southOptions, \"!slidable\", 1) = 0):`,\xFE";
 z+="                    `:southSize:`\xFE";
 z+="                    `:southminSize:`\xFE";
 z+="                    `:southmaxSize:`\xFE";
 z+="                    `:southOverflow:`\xFE";
 z+="                    closable: `:(Index(southOptions, \"!closable\", 1) = 0):`\xFE";
 z+="                },\xFE";
 z+="                east: {\xFE";
 z+="                    initHidden: `:(Index(eastOptions, \"inithidden\", 1) > 0):`,\xFE";
 z+="                    initClosed: `:(Index(eastOptions, \"initclosed\", 1) > 0):`,\xFE";
 z+="                    resizable: `:(Index(eastOptions, \"!resizable\", 1) = 0):`,\xFE";
 z+="                    slidable: `:(Index(eastOptions, \"!slidable\", 1) = 0):`,\xFE";
 z+="                    `:eastSize:`\xFE";
 z+="                    `:eastminSize:`\xFE";
 z+="                    `:eastmaxSize:`\xFE";
 z+="                    `:eastOverflow:`\xFE";
 z+="                    closable: `:(Index(eastOptions, \"!closable\", 1) = 0):`\xFE";
 z+="                },\xFE";
 z+="                west: {\xFE";
 z+="                    initHidden: `:(Index(westOptions, \"inithidden\", 1) > 0):`,\xFE";
 z+="                    initClosed: `:(Index(westOptions, \"initclosed\", 1) > 0):`,\xFE";
 z+="                    resizable: `:(Index(westOptions, \"!resizable\", 1) = 0):`,\xFE";
 z+="                    slidable: `:(Index(westOptions, \"!slidable\", 1) = 0):`,\xFE";
 z+="                    `:westSize:`\xFE";
 z+="                    `:westminSize:`\xFE";
 z+="                    `:westmaxSize:`\xFE";
 z+="                    `:westOverflow:`\xFE";
 z+="                    closable: `:(Index(westOptions, \"!closable\", 1) = 0):`\xFE";
 z+="                }\xFE";
 z+="            });\xFE";
 z+="     </script>\xFE";
 z+="     `\xFE";
 z+="     \xFE";
 z+="    if InStr(NorthOptions,  \"allowoverflow\") then \xFE";
 z+="        Html := `\xFE";
 z+="            <style>\xFE";
 z+="                .ui-layout-north { overflow: visible !important; border: none !important }\xFE";
 z+="                .resizer-north { display: none !important }\xFE";
 z+="            </style>\xFE";
 z+="           `\xFE";
 z+="    end if\xFE";
 z+="Return Chr(28):Html:Chr(29)"
window.cached_jsb_html["layout"]=z;
var z="***************** HTML *****************************\xFE";
 z+="*\xFE";
 z+="* print LISTBOX('id2', ['one', 'two', 'three', 'four'], '', [`style='width:100%'`, `onchange='alert(this.options[this.selectedIndex].text); doJsbSubmit(true)'`, `class='ui-widget ui-widget-content'`]) \xFE";
 z+="* @server.pause\xFE";
 z+="* print @formvar('id2')\xFE";
 z+="*\xFE";
 z+="* To load via AJAX:\xFE";
 z+="*    create a restful function:\xFE";
 z+="*\xFE";
 z+="*       restful function aJaxCallName(arg1)\xFE";
 z+="*          return ['this', 'is', 'a', 'load']\xFE";
 z+="*\xFE";
 z+="* Url is @jsbRootExecute(`aJaxCallName?arg1=randy`)\xFE";
 z+="*\xFE";
 z+="FUNCTION ListBox(byval ID As Object, byval VALUES As Object, optional byval DEFAULT As Object, optional byval addBlank As Object, optional byval ReadOnly As Object, optional byval AdditionalAttributes As Object, optional byval multiValuedData As Object) As StRiNg \xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    if isJson(DEFAULT) Or IsArray(DEFAULT) Then\xFE";
 z+="        AdditionalAttributes = DEFAULT\xFE";
 z+="        DEFAULT = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if isJson(addBlank) Or IsArray(addBlank) Then\xFE";
 z+="        AdditionalAttributes = addBlank\xFE";
 z+="        addBlank = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if isJson(ReadOnly) Or IsArray(ReadOnly) Then\xFE";
 z+="        AdditionalAttributes = ReadOnly\xFE";
 z+="        ReadOnly = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Values = makeArray(Values)\xFE";
 z+="    dim listSize As String\xFE";
 z+="    if Values Then listSize = Len(Values) else listSize = \"5\"\xFE";
 z+="    AdditionalAttributes = @MergeAttribute(\"size\", listSize, \" \", AdditionalAttributes)\xFE";
 z+="    return @JSB_HTML.DropDownBox(ID, Values, DEFAULT, addBlank, ReadOnly, AdditionalAttributes, multiValuedData)\xFE";
 z+="end function"
window.cached_jsb_html["listbox"]=z;
window.cached_jsb_html["listboxajax"]="FUNCTION ListBoxAJAX(ByVal ID As Object, ByVal URL As Object, byval DesciptionField As Object, optional byval ValueField As Object, optional byval AdditionalAttributes As Object) As StRiNg\xFE    $options async-\xFE    \xFE    if isJson(ValueField) Or IsArray(ValueField) Then\xFE        AdditionalAttributes =  ValueField\xFE        ValueField = DesciptionField\xFE    end if\xFE    \xFE    if IsMissing(ValueFIeld) Then ValueField = DesciptionField\xFE    \xFE    AdditionalAttributes = @MergeAttribute(\"size\", \"5\", \" \", AdditionalAttributes)\xFE    return @JSB_HTML.DropDownBox(ID, URL, DesciptionField, ValueField)";
var z="FUNCTION ListBoxIncludeURL(byval ID As Object, byval SrcUrl As Object, byval ArrayID As Object, optional byval addBlank As Object, optional byval DEFAULT As Object, optional byval ReadOnly As Object, optional byval AdditionalAttributes As Object, optional byval multiValuedData As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    if isJson(DEFAULT) Or IsArray(DEFAULT) Then\xFE";
 z+="        AdditionalAttributes = DEFAULT\xFE";
 z+="        DEFAULT = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if isJson(addBlank) Or IsArray(addBlank) Then\xFE";
 z+="        AdditionalAttributes = addBlank\xFE";
 z+="        addBlank = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if isJson(ReadOnly) Or IsArray(ReadOnly) Then\xFE";
 z+="        AdditionalAttributes = ReadOnly\xFE";
 z+="        ReadOnly = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    AdditionalAttributes = @MergeAttribute(\"size\", \"5\", \" \", AdditionalAttributes)\xFE";
 z+="    return @JSB_HTML.DropDownBoxIncludeURL(ID, SrcUrl, ArrayID, addBlank, DEFAULT, ReadOnly, AdditionalAttributes, multiValuedData)"
window.cached_jsb_html["listboxincludeurl"]=z;
window.cached_jsb_html["mark"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEfunction Mark(byval text As StRiNg) As String\xFE    $options async-\xFE    return Chr(28):\"<mark>\":Chr(29):text:Chr(28):\"</mark>\":Chr(29)";
var z="/*\xFE";
 z+="    * Example Menu\xFE";
 z+="    JsonMenu = {}\xFE";
 z+="    \xFE";
 z+="    * Icon's must start with iconXXXX\xFE";
 z+="    JsonMenu.iconUrl   = {\"id\":\"the Icon\",\"iconurl\":\"stop.png\"} ;* will postback to SelectedID \xFE";
 z+="    JsonMenu.iconGlyph = {\"id\":\"the Glyph\",\"glyphicon\":\"education\"} \xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    JsonMenu.File = {}\xFE";
 z+="        // Sub Menu File\xFE";
 z+="        JsonMenu.File.Who = { id: \"the id Who\" } ;* id is by default a parameter postback @FormVal('SelectedMenu')\xFE";
 z+="        JsonMenu.File.seperatorXXX = True\xFE";
 z+="        JsonMenu.File.Time = { id: \"the id Time\" }\xFE";
 z+="    \xFE";
 z+="    // One item alone on the menu bar\xFE";
 z+="    JsonMenu.TCL = { id: \"the id tcl\" }\xFE";
 z+="    JsonMenu.JS = \"alert('pure javascript'); debugger\"\xFE";
 z+="    \xFE";
 z+="    // any HTML\xFE";
 z+="    JsonMenu.html1 = \"<b>&nbsp;Any HTML&nbsp;</b>\"\xFE";
 z+="\xFE";
 z+="    // Can collaspe here after Any HTML\xFE";
 z+="    JsonMenu.collaspable = true\xFE";
 z+="    \xFE";
 z+="    JsonMenu.WWW = {}\xFE";
 z+="        JsonMenu.WWW.Security = { id: \"the id for Security\" }\xFE";
 z+="        JsonMenu.WWW.Detail = { id: \"the id for Detail\" }\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    // Right align next stuff\xFE";
 z+="    JsonMenu.rightalign = true\xFE";
 z+="    \xFE";
 z+="    // Input Box with optional button\xFE";
 z+="    JsonMenu.txtInput1 = \"User Name\" ;* Entered Data in @FormVar(\"txtInput1\")\xFE";
 z+="\xFE";
 z+="    // A Button\xFE";
 z+="    JsonMenu.btn1 = \"Quit\" ;* a Button whose Text is put into @FormVar('SelectedMenu') will be \"Quit\"\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    * Build Menu Options\xFE";
 z+="    additionalProps = {}\xFE";
 z+="    additionalProps.MenuBarTextColor = \"Blue\"\xFE";
 z+="    additionalProps.BackgroundColor = \"yellow\";\xFE";
 z+="    additionalProps.MenuBarBackground = \"green\"\xFE";
 z+="    additionalProps.HilightTextColor = \"cyan\"\xFE";
 z+="    additionalProps.HilightBackground = \"tan\"\xFE";
 z+="    additionalProps.Center = False\xFE";
 z+="    \xFE";
 z+="    MenuHeight = 33\xFE";
 z+="    HTMLMenuBar = @Jsb_html.MenuBar(JsonMenu, \"RPT\", False, False, MenuHeight, additionalProps)\xFE";
 z+="    \xFE";
 z+="    Loop\xFE";
 z+="       Print @(-1):@Jsb_html.LAYOUT(Div(\"centerView\",\"\"), HTMLMenuBar, \"startsize:\":MenuHeight + 2:\", allowoverflow, Fixed\", \"South\", \"initClosed, startsize:30, minSize:15\", \"East\", \"startsize: 60, minSize:15\",  \"West\", \"startsize: 90\")\xFE";
 z+="        @Server.Pause\xFE";
 z+="        Ans = @FormVar(\"SelectedMenu\")\xFE";
 z+="    Until Ans = \"Quit\" Do\xFE";
 z+="        Alert('You selected ':Ans)\xFE";
 z+="    Repeat\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="*/\xFE";
 z+="     \xFE";
 z+="Function MenuBar(byval JsonMenu As JSON, optional byval BrandHTML As Object, optional byval FixToTop As Object, optional byval verticalExpand As Object, optional byval barHeight As Object, optional byval additionalProps As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim MenuHtml As Array = []\xFE";
 z+="    \xFE";
 z+="    if IsMissing(additionalProps) Then\xFE";
 z+="        if IsJson(barHeight) Then additionalProps = barHeight; barHeight = Nothing\xFE";
 z+="        if IsJson(verticalExpand) Then additionalProps = verticalExpand; verticalExpand = Nothing\xFE";
 z+="        if IsJson(FixToTop) Then additionalProps = FixToTop; FixToTop = Nothing\xFE";
 z+="        if IsJson(BrandHTML) Then additionalProps = BrandHTML; BrandHTML = Nothing\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if IsMissing(FixToTop) Then FixToTop = True\xFE";
 z+="    if !barHeight Then barHeight = \"40px\"\xFE";
 z+="    if Val(barHeight) = CStr(barHeight) then barHeight := \"px\"\xFE";
 z+="\xFE";
 z+="    MenuHtml[-1] = '<style>'\xFE";
 z+="    // MenuHtml[-1] = ' .in { display: table !important }' ;* This messes up other jquery controls which use .in (jquery.keypad)\xFE";
 z+="    \xFE";
 z+="    if IsJson(additionalProps) then\xFE";
 z+="        Dim jAdditionalProps As JSON = additionalProps\xFE";
 z+="        if jAdditionalProps.MenuBarTextColor and jAdditionalProps.BackgroundColor then \xFE";
 z+="            MenuHtml[-1] = '   .navbar-default {  color: ' : jAdditionalProps.MenuBarTextColor : ' !important; background: ' : jAdditionalProps.BackgroundColor : ' !important; }'\xFE";
 z+="            MenuHtml[-1] = '   .navbar-default a {  color: ' : jAdditionalProps.MenuBarTextColor : ' !important; background: ' : jAdditionalProps.BackgroundColor : ' !important; }'\xFE";
 z+="            MenuHtml[-1] = '   .navbar-default>li>a {  color: ' : jAdditionalProps.MenuBarTextColor : ' !important; background: ' : jAdditionalProps.BackgroundColor : ' !important; }'\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        if jAdditionalProps.MenuBarTextColor and jAdditionalProps.MenuBarBackground then MenuHtml[-1] = '   .navbar-default .dropdown-menu  {  color: ' : jAdditionalProps.MenuBarTextColor : ' !important; background: ' : jAdditionalProps.MenuBarBackground : ' !important; }'\xFE";
 z+="        if jAdditionalProps.HilightTextColor and jAdditionalProps.HilightBackground then MenuHtml[-1] = '   .navbar-default .dropdown-menu li:hover {  color: ' : jAdditionalProps.HilightTextColor : ' !important; background: ' : jAdditionalProps.HilightBackground : ' !important; }'\xFE";
 z+="        \xFE";
 z+="        Dim Center As Boolean = jAdditionalProps.Center\xFE";
 z+="    end if\xFE";
 z+="    MenuHtml[-1] = '</style>'\xFE";
 z+="    \xFE";
 z+="    if verticalExpand then\xFE";
 z+="        Dim UL As String = `<ul class=\"nav nav-pills nav-stacked\" style=\"list-style-type:none; margin: 0; padding: 0; width: auto; height: `:barHeight:` \">` \xFE";
 z+="    else\xFE";
 z+="        UL = `<ul class=\"navbar-nav\" style=\"list-style-type:none; margin: 0; padding: 0; width: auto; height: `:barHeight:`; align-items: center; display: flex;\">` \xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Dim rightLeft As String = \"left\"\xFE";
 z+="    Dim hasCollaspe As Boolean = False\xFE";
 z+="    Dim NeedEndDiv As Boolean = false\xFE";
 z+="    \xFE";
 z+="    For Each TagName As String In JsonMenu\xFE";
 z+="        Dim Tnl As String = LCase(TagName)\xFE";
 z+="        If Tnl = \"collaspable\" Then hasCollaspe = True\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If FixToTop Then\xFE";
 z+="        // MenuHtml[-1] = '<style> body { padding-top: 60px; } </style>'\xFE";
 z+="        MenuHtml[-1] = `<nav role=\"navigation\" class=\"navbar-default navbar-fixed-top\" >`  ;* navbar style=\"position: relative\"\xFE";
 z+="    Else\xFE";
 z+="        MenuHtml[-1] = `<nav role=\"navigation\" class=\"navbar-default\">` ;* navbar\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Center Then\xFE";
 z+="        MenuHtml[-1] = `<div class=\"container-fluid\" style=\"display: table;\">`\xFE";
 z+="    else\xFE";
 z+="        MenuHtml[-1] = `<div class=\"container-fluid\" style=\"padding-left: 2px;\">`\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    * The Hamburger goes in header\xFE";
 z+="    if hasCollaspe then\xFE";
 z+="        MenuHtml[-1] = `\xFE";
 z+="        <button id=\"mnuHamburger\" type=\"button\" class=\"navbar-toggle collapsed\" style=\"padding: 1px\" data-toggle=\"collapse\" data-target=\"#navcollaspe\" aria-expanded=\"false\">\xFE";
 z+="            <span class=\"sr-only\">Toggle navigation</span>\xFE";
 z+="            <span class=\"icon-bar\"></span>\xFE";
 z+="            <span class=\"icon-bar\"></span>\xFE";
 z+="            <span class=\"icon-bar\"></span>\xFE";
 z+="         </button>\xFE";
 z+="          `\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Dim liStyle As String = \"display: table; height: 100%; padding: 0 4px 0;\"\xFE";
 z+="    Dim liStyleICon As String = \"height: 100%; padding: 0 2px 0;\"\xFE";
 z+="    Dim liInside As String = \"display: table-cell; height: 100%; border: none; background-color: transparent; color: inherit;\"\xFE";
 z+="    Dim btnStyle As String = \"min-width: 50px; height: 100%; border: none; background-color: transparent; color: inherit; padding: 0 4px 0;\"\xFE";
 z+="    Dim textStyle As String = \"cursor: pointer;\" // padding-top: 8px; \xFE";
 z+="    \xFE";
 z+="    If BrandHTML Then\xFE";
 z+="        Dim NeedUL As Boolean = False\xFE";
 z+="        MenuHtml[-1] = UL \xFE";
 z+="        \xFE";
 z+="        // If brand has onlick\xFE";
 z+="        //MenuHtml[-1] = `<li class=\"dropdown pull-` : rightLeft : `\" style=\"`:liStyle:`\">`\xFE";
 z+="        //MenuHtml[-1] = ` <b id=\"mnuBrand\" class=\"btn\" href=\"#\" style=\"padding-left: 0; font-weight: bold; cursor: default;\">` : BrandHTML : `</b>`\xFE";
 z+="        \xFE";
 z+="        MenuHtml[-1] = `<li class=\"pull-` : rightLeft : `\" style=\"`:liStyle:`\">`\xFE";
 z+="        MenuHtml[-1] = ` <b id=\"mnuBrand\" class=\"\" style=\"display: table-header-group; font-weight: bold; cursor: default;\">` : BrandHTML : `</b>`\xFE";
 z+="        MenuHtml[-1] = `</li>`\xFE";
 z+="    else\xFE";
 z+="        NeedUL = True\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    For Each TagName In JsonMenu\xFE";
 z+="        Dim So As Object = JsonMenu[TagName]\xFE";
 z+="        Tnl = LCase(TagName)\xFE";
 z+="\xFE";
 z+="        If verticalExpand And Tnl <> \"rightalign\" Then\xFE";
 z+="            If !NeedUL Then MenuHtml[-1] = '</ul>'; NeedUL = True\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If Tnl = \"rightalign\" Then\xFE";
 z+="            if !verticalExpand Then\xFE";
 z+="                If !NeedUL Then MenuHtml[-1] = '</ul>'\xFE";
 z+="                rightLeft = \"right\"\xFE";
 z+="                NeedUL = True\xFE";
 z+="                if NeedEndDiv Then MenuHtml[-1] = '</div>'\xFE";
 z+="                MenuHtml[-1] = `<div class=\"navbar-header navbar-right\">`\xFE";
 z+="            end if\xFE";
 z+="\xFE";
 z+="        ElseIf Tnl = \"collaspable\" Then\xFE";
 z+="            If !NeedUL Then MenuHtml[-1] = '</ul>'\xFE";
 z+="            if NeedEndDiv Then MenuHtml[-1] = '</div>'\xFE";
 z+="            MenuHtml[-1] = `<div class=\"collapse navbar-collapse\" id=\"mnucollaspe\" style=\"overflow: visible\">`\xFE";
 z+="            NeedUL = True\xFE";
 z+="\xFE";
 z+="        ElseIf Left(Tnl, 3) = \"txt\" Then\xFE";
 z+="            If NeedUL Then MenuHtml[-1] = UL; NeedUL = False\xFE";
 z+="            MenuHtml[-1] = `    <input id='` : TagName : `' name='` : TagName : `' type=\"text\" class=\"form-control\" placeholder=\"` : HtmlEncode(CStr(So)) : `\">`\xFE";
 z+="\xFE";
 z+="        ElseIf Left(Tnl, 3) = \"btn\" Then\xFE";
 z+="            If NeedUL Then MenuHtml[-1] = UL; NeedUL = False\xFE";
 z+="            MenuHtml[-1] = `<button id=\"`:TagName:`\" type=\"button\" onclick=`:@jsEscapeAttr(`window.eventHandler_SelectMenu({ id: '`: CStr(So) :`'}, \"id\")`):` class=\"btn-default btn\" style=\"`:btnStyle:`\">` : HtmlEncode(CStr(So)) : `</button>` ;*  btn\xFE";
 z+="\xFE";
 z+="        ElseIf Left(TagName, 4) = \"html\" Then\xFE";
 z+="            If NeedUL Then MenuHtml[-1] = UL; NeedUL = False\xFE";
 z+="            MenuHtml[-1] = CStr(So)\xFE";
 z+="\xFE";
 z+="        ElseIf IsJSON(So) Then\xFE";
 z+="            Dim jSO as Json = So\xFE";
 z+="\xFE";
 z+="            If NeedUL Then MenuHtml[-1] = UL; NeedUL = False\xFE";
 z+="            Dim myOnClick As String\xFE";
 z+="            if jSO.onclick then myOnClick = `onclick=`:@jsEscapeAttr(jSO.onclick) else myOnClick = `onclick=`:@jsEscapeAttr(`window.eventHandler_SelectMenu(` : CStr(So) : `, \"id\")`)\xFE";
 z+="            \xFE";
 z+="            Dim Caption As String\xFE";
 z+="            if jSO.caption then caption = jSO.caption else caption = TagName\xFE";
 z+="            \xFE";
 z+="            If jSO.id Then\xFE";
 z+="                If jSO.glyphicon Then\xFE";
 z+="                    MenuHtml[-1] = `<li class=\"navbar-text dropdown pull-` : rightLeft : `\" style=\"`:liStyle:`\">`\xFE";
 z+="                    MenuHtml[-1] = `<a id=\"mnu`:TagName:`\" `:myOnClick:` class=\"btn\" style=\"`:liInside:` `:btnStyle:`\">`\xFE";
 z+="                    MenuHtml[-1] = ` <span class=\"glyphicon glyphicon-` : jSO.glyphicon : `\" style=\"`:jSO.style:`\" class=\"icone icone-custom \" ondragstart=\"return false\"></span>`\xFE";
 z+="                    MenuHtml[-1] = `</a>`\xFE";
 z+="                    MenuHtml[-1] = '</li>'\xFE";
 z+="                    \xFE";
 z+="                ElseIf jSO.iconurl Then\xFE";
 z+="                    Dim Url As String = jSO.iconurl\xFE";
 z+="                    \xFE";
 z+="                    // Url paths?\xFE";
 z+="                    if InStr(url, \":\") Then\xFE";
 z+="                        so = Clone(so)\xFE";
 z+="                        remove so, \"iconurl\"\xFE";
 z+="                    else\xFE";
 z+="                        if !InStr(url, \"/\") and !InStr(url, `\\`) then url = @jsbRoot:`pics/`:url\xFE";
 z+="                        if left(url, 1) = \"/\" and Left(url, len(@jsbRoot)) <> @jsbRoot then url = @jsbRoot:Mid(url, 2)\xFE";
 z+="                        if left(url, 2) = \"./\" then url = @jsbRoot:Replace(Mid(url, 3), `\\`, `/`)\xFE";
 z+="                            \xFE";
 z+="                        // File system path?\xFE";
 z+="                        If Left(url, 2) <> `\\\\` and left(url, 4) <> \"http\" And InStr(url, \"/\") and !InStr(url, `\\`) then url = replace(url, \"/\", `\\`)\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    MenuHtml[-1] = `<li class=\"dropdown pull-` : rightLeft : `\" style=\"`:liStyleICon:`\">` ;* Drop display: table; \xFE";
 z+="                    MenuHtml[-1] = `<img id=\"mnu`:TagName:`\" src=\"` : url : `\" style=\"`:liInside:` `:jSO.style:`\" `:myOnClick:` class=\"btn-default btn\" ondragstart=\"return false\">` ;* btn \xFE";
 z+="                    MenuHtml[-1] = '</li>'\xFE";
 z+="                Else\xFE";
 z+="                    MenuHtml[-1] = `<li class=\"dropdown pull-` : rightLeft : `\" style=\"`:liStyle:`\">`\xFE";
 z+="                    So = Replace(Replace(So, `\"`, `&quot;`), `'`, `&apos;`)\xFE";
 z+="                    If NeedUL Then MenuHtml[-1] = UL; NeedUL = False\xFE";
 z+="                    MenuHtml[-1] = `<button id=\"mnu`:TagName:`\" type=\"button\" `:myOnClick:` class=\"btn-default btn\" style=\"`:liStyle:`; padding: 0; `:btnStyle:`\">` : HtmlEncode(caption) : `</button>` ;* btn \xFE";
 z+="                    MenuHtml[-1] = '</li>'\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="            Else\xFE";
 z+="                MenuHtml[-1] = `<li class=\"navbar-text dropdown btn pull-` : rightLeft : `\" style=\"`:liStyle:`\">`\xFE";
 z+="                MenuHtml[-1] = `  <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\" style=\"display: table-cell; padding: 0; vertical-align: middle;`:jSO.style:`\">` \xFE";
 z+="                MenuHtml[-1] =       HtmlEncode(TagName)\xFE";
 z+="                // Bootstrap CSS handles now -  MenuHtml[-1] = `     <b class=\"caret\"></b>`\xFE";
 z+="                MenuHtml[-1] = `  </a>`\xFE";
 z+="                MenuHtml[-1] = `  <ul id=\"mnu`:TagName:`\" class=\"dropdown-menu\" style=\"list-style-type:none; margin: 0; position: absolute; border: lightgray solid 1px; border-radius: 5px; font-size: smaller\">`\xFE";
 z+="                For Each Tn2 As String In So\xFE";
 z+="                    Dim Ltn2 As String = LCase(Tn2)\xFE";
 z+="                    Dim So2 As Object = So[Tn2]\xFE";
 z+="                    Tn2 = @Jsb_BF.HtmlEncode(Tn2)\xFE";
 z+="                    If IsJson(So2) Then\xFE";
 z+="                        Dim jSO2 as Json = So2\xFE";
 z+="                        if jSO2.onclick then myOnClick = `onclick=`:@jsEscapeAttr(jSO2.onclick) else myOnClick = `onclick=`:@jsEscapeAttr(`window.eventHandler_SelectMenu(` : CStr(jSO2) : `, \"id\")`)\xFE";
 z+="                        if jSO2.caption then caption = HtmlEncode(jSO2.caption) else caption = Tn2\xFE";
 z+="                        MenuHtml[-1] = `<li id=\"mnu`:Tn2:`\" `:myOnClick:`>` : caption : `</li>`\xFE";
 z+="\xFE";
 z+="                    ElseIf Left(Ltn2, 3) = \"sep\" Then\xFE";
 z+="                        MenuHtml[-1] = `<li role=\"seperator\" class=\"divider\"></li>`\xFE";
 z+="                    \xFE";
 z+="                    ElseIf Ltn2 <> \"rightalign\" And Ltn2 <> \"collaspable\" Then\xFE";
 z+="                        MenuHtml[-1] = `<li id=\"mnu`:Tn2:`\" onclick=`:@jsEscapeAttr(CStr(So2)):`>` : Tn2 : `</li>`\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="                MenuHtml[-1] = '  </ul>'\xFE";
 z+="                MenuHtml[-1] = '</li>'\xFE";
 z+="            End If  \xFE";
 z+="        Else\xFE";
 z+="            If NeedUL Then MenuHtml[-1] = UL; NeedUL = False\xFE";
 z+="            MenuHtml[-1] = `<li id=\"mnu`:TagName:`\" class=\"navbar-text btn dropdown pull-` : rightLeft : `\" style=\"`:textStyle:`\" onclick=`:@jsEscapeAttr(CStr(So)):`>` : HtmlEncode(TagName) : `</li>`\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+=" \xFE";
 z+="    If !NeedUL Then MenuHtml[-1] = '</ul>'\xFE";
 z+="    if NeedEndDiv Then MenuHtml[-1] = '</div>'\xFE";
 z+="                  \xFE";
 z+="    MenuHtml[-1] = '</div>' ;* container fluid\xFE";
 z+="    MenuHtml[-1] = '</nav>'\xFE";
 z+="    \xFE";
 z+="    // Create the default POSTBACK for SelectMenu to put value in @FormVar('SelectedMenu')\xFE";
 z+="    \xFE";
 z+="    MenuHtml[-1] = `<script>if (!window.eventHandler_SelectMenu) { ` \xFE";
 z+="    Dim OP As String = @genEventHandler(\"SelectMenu\" /* onParentSelectMenu() called */, NULL, 7, 'SelectedMenu' /* FormVar('SelectedMenu') gets SelectedID */) \xFE";
 z+="    OP = DropLeft(OP, \">\") ;* drop script tag\xFE";
 z+="    OP = DropRight(OP, \"</script>\")\xFE";
 z+="    MenuHtml[-1] = OP\xFE";
 z+="    MenuHtml[-1] = \"}</script>\"\xFE";
 z+="\xFE";
 z+="    Return @Html(Join(MenuHtml, Crlf()))\xFE";
 z+="End Function"
window.cached_jsb_html["menubar"]=z;
var z="*   MenuBar= {}\xFE";
 z+="*   MenuBar.File = {}\xFE";
 z+="*   MenuBar.File[\"Save\"] = \"alert('pute javascript')\"\xFE";
 z+="*   MenuBar.File[\"Close\"] = {}\xFE";
 z+="*   MenuBar.File[\"Close\"].id = \"edp%20scp%20\":edpName:\"?fromPage=\":@UrlEncode(@Url)\xFE";
 z+="*\xFE";
 z+="*   Print @jsb_html.MenuBarCSS(Menu, True, \"5px\", \"#ebead9\" , \"#d3cfb9\",  \"black\", \"white\",  \"black\"):\xFE";
 z+="*   Print @genEventHandler(\"SelectMenu\", @jsbRootExecute(\"cmd&id={!id}\"), 12, \"\"):\xFE";
 z+="\xFE";
 z+="Function MenuBarX(ByVal JsonMenu As Array, optional byval UseBorders As StRiNg, optional byval Padding As String, optional byval Center As StRiNg, optional byval UseDownArrow As StRiNg, optional byval BackgroundColor As StRiNg, optional byval MenuBarBackground As StRiNg, optional byval MenuBarTextColor As StRiNg, optional byval HilightBackground As StRiNg, optional byval HilightTextColor As StRiNg) As String ;* 10\xFE";
 z+="    $options aspxc-\xFE";
 z+="    \xFE";
 z+="*\xFE";
 z+="* //cssdeck.com/labs/another-simple-css3-dropdown-menu\xFE";
 z+="* \xFE";
 z+="    * Convert JSON to Html Menu\xFE";
 z+="    Dim MENUHTML As Array\xFE";
 z+="    Dim IBAR As Array\xFE";
 z+="    Dim BORDERS As String\xFE";
 z+="    Dim TAGNAME As StRiNg\xFE";
 z+="    Dim ONCLICK As String\xFE";
 z+="    Dim DA As String\xFE";
 z+="    Dim LI As String\xFE";
 z+="    Dim TN2 As StRiNg\xFE";
 z+="    Dim SO2 As String\xFE";
 z+="    Dim SO As Object\xFE";
 z+="\xFE";
 z+="    If UseBorders Then Borders = ` border: 1px solid; margin-top: 2px;`\xFE";
 z+="    If !Padding Then Padding = \"10px\"\xFE";
 z+="    MenuHtml =[]\xFE";
 z+="    MenuHtml[-1] = '<style>'\xFE";
 z+="    If Center Then\xFE";
 z+="        MenuHtml[-1] = '   .menuBar {  padding-top: ' : Padding : '; padding-bottom: ' : Padding : '; text-align: center }'\xFE";
 z+="    Else\xFE";
 z+="        MenuHtml[-1] = '   .menuBar {  padding-top: ' : Padding : '; padding-bottom: ' : Padding : ' }'\xFE";
 z+="    End If\xFE";
 z+="    MenuHtml[-1] = '   .menuBar ul {  color: ' : MenuBarTextColor : '; }'\xFE";
 z+="    MenuHtml[-1] = '   .menuBar ul li {  background: ' : MenuBarBackground : ';  color: ' : MenuBarTextColor : '; ' : Borders : ' }'\xFE";
 z+="    MenuHtml[-1] = '   .menuBar ul li:hover {  background: ' : HilightBackground : ';  color: ' : HilightTextColor : '; }'\xFE";
 z+="    MenuHtml[-1] = '   .menuBar ul li:hover ul {  background: ' : BackgroundColor : '; height: auto }'\xFE";
 z+="    MenuHtml[-1] = '   .menuBar ul li ul li { background: ' : MenuBarBackground : ';  color: ' : MenuBarTextColor : '; }'\xFE";
 z+="    MenuHtml[-1] = '</style>'\xFE";
 z+="    MenuHtml[-1] = '<menuBar class=\"menuBar\"><ul>'\xFE";
 z+="    \xFE";
 z+="    // All Top level items with ICONS go first\xFE";
 z+="    Ibar = []\xFE";
 z+="    For Each TagName In JsonMenu\xFE";
 z+="        So = JsonMenu[TagName]\xFE";
 z+="        If Left(So, 1) = \"{\" Then\xFE";
 z+="            If So.id And(So.iconurl Or So.glyphicon) Then\xFE";
 z+="                Ibar[-1] = TagName\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Len(Ibar)  Then\xFE";
 z+="        MenuHtml[-1] = '<div class=\"btn-group\">'\xFE";
 z+="        For Each TagName In Ibar\xFE";
 z+="            So = JsonMenu[TagName]\xFE";
 z+="            \xFE";
 z+="            OnClick = Replace(So, `'`, `\\u0027`)\xFE";
 z+="            OnClick = `onclick='window.eventHandler_SelectMenu(` : OnClick : `, \"id\")'`\xFE";
 z+="            \xFE";
 z+="            MenuHtml[-1] = '<button type=\"button\" title=\"' : TagName : '\" type=\"button\" class=\"btnbar btn-default btn\" data-toggle=\"tooltip\" ':OnClick:'>' ;* btn \xFE";
 z+="            If So.iconurl Then\xFE";
 z+="                MenuHtml[-1] = ` <img src=\"`:@jsbRoot:`pics/` : So.iconurl : `\" class=\"img-responsive\"  ondragstart=\"return false\" />`\xFE";
 z+="            Else\xFE";
 z+="                MenuHtml[-1] = ` <span class=\"glyphicon glyphicon-` : So.glyphicon : `\"  ondragstart=\"return false\"></span>`\xFE";
 z+="            End If\xFE";
 z+="            MenuHtml[-1] = '</button>'\xFE";
 z+="        Next\xFE";
 z+="        MenuHtml[-1] = '</div>'\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If UseDownArrow Then Da = \"&#9660;\" Else Da = \"\"\xFE";
 z+="    \xFE";
 z+="    For Each TagName In JsonMenu\xFE";
 z+="        So = JsonMenu[TagName]\xFE";
 z+="        TagName = @Jsb_BF.HtmlEncode(TagName)\xFE";
 z+="        If Left(So, 1) = \"{\" Then\xFE";
 z+="            If So.id Then\xFE";
 z+="                If So.iconurl Or So.glyphicon Then\xFE";
 z+="                    // Skip Button Bar ICons\xFE";
 z+="                Else\xFE";
 z+="                    So = Replace(So, `'`, `\\u0027`)\xFE";
 z+="                    Li = `<li onclick='window.eventHandler_SelectMenu(` : So : `, \"id\")'>` : TagName : `</li>`\xFE";
 z+="                    MenuHtml[-1] = Li\xFE";
 z+="                End If\xFE";
 z+="            Else\xFE";
 z+="                MenuHtml[-1] = '<li>' : TagName : Da : '<ul>'\xFE";
 z+="                \xFE";
 z+="                For Each Tn2 In So\xFE";
 z+="                    So2 = So[Tn2]\xFE";
 z+="                    Tn2 = @Jsb_BF.HtmlEncode(Tn2)\xFE";
 z+="                    If Left(So2, 1) = \"{\" Then\xFE";
 z+="                        So2 = Replace(So2, `'`, `\\u0027`)\xFE";
 z+="                        MenuHtml[-1] = `<li onclick='window.eventHandler_SelectMenu(` : So2 : `, \"id\")'>` : Tn2 : `</li>`\xFE";
 z+="                    Else\xFE";
 z+="                        MenuHtml[-1] = `<li onclick=`:@jsEscapeAttr(So2):`>` : Tn2 : `</li>`\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="                MenuHtml[-1] = '</ul></li>'\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            Li = `<li onclick=`:@jsEscapeAttr(so):`>` : TagName : `</li>`\xFE";
 z+="            MenuHtml[-1] = Li\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    *\xFE";
 z+="    MenuHtml[-1] = '</ul></menuBar></nav>'\xFE";
 z+="    \xFE";
 z+="    Return  @Html('<div style=\"height: 1.9em; background: ':BackgroundColor:';\">'):@Html(Join(MenuHtml, \"\")):@Html('</div>')"
window.cached_jsb_html["menubarx"]=z;
window.cached_jsb_html["mono"]="FUNCTION Mono(ByVal ID As String, Optional ByVal Content As Object, optional byval AdditionalAttributes As Object) As StRiNg\xFE    $options async-\xFE\xFE    Dim HTML As String\xFE\xFE    if isJson(Content) Or isArray(Content) then\xFE        AdditionalAttributes = Content\xFE        Content = ID\xFE        ID = ''\xFE        \xFE    Elseif IsMissing(Content) Then\xFE        Content = ID\xFE        ID = ''\xFE    end if\xFE    \xFE    AdditionalAttributes = MergeAttribute(\"style\", \"font-family:monospace\", \";\", additionalAttributes)\xFE    Html = HtmlEncode(Content)\xFE    Html = Replace(Html, \" \", \"&nbsp;\")\xFE    Html = Replace(Html, CRLF(), \"<br />\")\xFE    If ID Then ID = \" id='\":ID:\"' \"\xFE    HTML = CHR(28):\"<span\":ID:joinAttributes(AdditionalAttributes):\">\":HTML:\"</span>\":CHR(29)\xFE    RETURN HTML\xFEEnd Function";
window.cached_jsb_html["monospace"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEFUNCTION MonoSpace(ByVal ID As Object, Optional ByVal Content As Object, optional byval AdditionalAttributes As Object) As StRiNg\xFE    $options async-\xFE    Return Mono(Id, Content, AdditionalAttributes)";
var z="*\xFE";
 z+="* Print @(-1):@multiSelectDropDownBox('id1', ['red', 'blue', 'green', 'yellow'], ['blue', 'green']); \xFE";
 z+="* input pau; \xFE";
 z+="* print \"result is \":@formvar('id1')\xFE";
 z+="*\xFE";
 z+="FUNCTION multiSelectDropDownBox(ByVal ID As String, ByVal Values As Object, optional byval DEFAULTS As String, optional byval AdditionalAttributesDisplay As Object, optional byval Binding As Array) As String\xFE";
 z+="   $options async-\xFE";
 z+="    \xFE";
 z+="   Dim Delimiter As String\xFE";
 z+="   Dim sVals As String = CStr(Values)\xFE";
 z+="\xFE";
 z+="   If InStr(sVals, AM()) Then \xFE";
 z+="      Delimiter = AM()\xFE";
 z+="   ElseIf InStr(sVals, VM()) Then \xFE";
 z+="      Delimiter = VM()\xFE";
 z+="   ElseIf InStr(sVals, SVM()) Then \xFE";
 z+="      Delimiter = SVM()\xFE";
 z+="   ElseIf InStr(sVals, \";\") Then \xFE";
 z+="      Delimiter = \";\"\xFE";
 z+="   ElseIf InStr(sVals, \",\") Then \xFE";
 z+="      Delimiter = \",\"\xFE";
 z+="   Else\xFE";
 z+="      if Binding Then Delimiter = ',' Else Delimiter = AM()\xFE";
 z+="   End If\xFE";
 z+="   \xFE";
 z+="   Dim Vals As Array = Split(Replace(sVals, Delimiter:\" \", Delimiter), Delimiter)\xFE";
 z+="   If Defaults = \"*\" Then Defaults = Vals\xFE";
 z+="   \xFE";
 z+="   DEFAULTS = Replace(DEFAULTS, Delimiter:\" \", Delimiter)\xFE";
 z+="   \xFE";
 z+="   Dim HTML As String = CHR(28):`<div class='dropdown-check-list form-control' `:JoinAttributes(AdditionalAttributesDisplay, \" \"):`>\xFE";
 z+="        <span class=\"anchor\">\xFE";
 z+="            <input id=\"`:ID:`\" name=\"`:ID:`\" type='textbox' tabindex='-1' readonly class='dropdown-input form-control'`\xFE";
 z+="            If InStr(AdditionalAttributesDisplay, \"required\") Then Html := `required `\xFE";
 z+="            Html := Join(Binding, \" \"):` autocomplete='offItGoes' onclick='multiSelectCheckBoxShowlist(this)' value='`:Replace(DEFAULTS, Delimiter, \",\"):`'/>\xFE";
 z+="        </span>\xFE";
 z+="        <div class=\"dropdown-check-list-arrow\" onclick='multiSelectCheckBoxShowlist(this)'></div><div class=\"itemsnbtns\">\xFE";
 z+="        <ul class=\"multiselect-items\">`:Crlf():CHR(29)\xFE";
 z+="\xFE";
 z+="   Dim I As Integer\xFE";
 z+="   Dim V As Object\xFE";
 z+="   \xFE";
 z+="   FOR EACH V, I IN Vals\xFE";
 z+="      Html := CHR(28):`<li><input id=\"`:ID:`_`:I:`\" type='checkbox' onchange='multiSelectCheckBoxChanged(this);' style='float:left;width:9%' />`\xFE";
 z+="      Html := `<span onclick=\"clickMyCompanion(this, '`:ID:`_`:I:`'); multiSelectCheckBoxChanged(this);\"  style='float:left;width:90%'>`:CHR(29):CStr(V):CHR(28):\"</span></li>\":Crlf():CHR(29)\xFE";
 z+="   NEXT\xFE";
 z+="\xFE";
 z+="   Return Html:CHR(28):`</ul><div class=\"centerBtns\">    \xFE";
 z+="          <button type='button' class='smallbtn' onclick='multiSelectAll(this)'>Select All</button>\xFE";
 z+="          <button type='button' class='smallbtn' onclick='multiSelectNone(this)'>Select None</button>\xFE";
 z+="          <button type='button' class='smallbtn' onclick='multiSelectCheckBoxShowlist(this, true)'>OK</button>\xFE";
 z+="       </div></div></div>`:Crlf():CHR(29)\xFE";
 z+="       \xFE";
 z+="   Return Html:CHR(28):`<li class=\"centerBtns\">    \xFE";
 z+="          <button type='button' class='smallbtn' onclick='multiSelectAll(this)'>Select All</button>\xFE";
 z+="          <button type='button' class='smallbtn' onclick='multiSelectNone(this)'>Select None</button>\xFE";
 z+="          <button type='button' class='smallbtn' onclick='multiSelectCheckBoxShowlist(this, true)'>OK</button>\xFE";
 z+="       </li></ul></div>`:Crlf():CHR(29)\xFE";
 z+="end function\xFE";
 z+=""
window.cached_jsb_html["multiselectdropdownbox"]=z;
var z="****************** HTML *****************************\xFE";
 z+="*\xFE";
 z+="* This is a jqueryUI only function...\xFE";
 z+="*\xFE";
 z+="* Print @(-1):@multiSelectFieldSetBtns('id1', ['red', 'blue', 'green', 'yellow'], ['blue'], False, [], [`style='min-width: 90px'`])\xFE";
 z+="* input pau; \xFE";
 z+="* print \"result is \":@formvar('id1')\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="* Values is a ForEach Array.  Each Value can be \"Display,Value\"\xFE";
 z+="*\xFE";
 z+="* To load via AJAX - see dropDownBox\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="* Values is a ForEach Array.  Each Value can be \"Display,Value\"\xFE";
 z+="*\xFE";
 z+="* To load via AJAX - see dropDownBox\xFE";
 z+="*\xFE";
 z+="* Print @(-1):@multiSelectFieldSetBtns('id1', ['red', 'blue', 'green', 'yellow'], 'blue')\xFE";
 z+="*\xFE";
 z+="* See also @multiSelectFieldSetBtns('id1', ['red', 'blue', 'green', 'yellow'], 'blue')\xFE";
 z+="*\xFE";
 z+="FUNCTION multiSelectFieldSetBtns(ByVal ID As String, byval Values As Object, optional byval DefaultValues As Array, optional ByVal ReadOnly As Boolean, optional byval AdditionalAttributes As Object, optional byval multiValuedData As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim SubDelimiter As String\xFE";
 z+="    Dim Vals As Array = makeArray(Values); SubDelimiter = @NI\xFE";
 z+="    If !InStr(Values, SubDelimiter) Then SubDelimiter = \"\"\xFE";
 z+="\xFE";
 z+="    Dim Opts As Array = []\xFE";
 z+="    Dim IA As String = dataAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    IA := ' ':`onclick='window.msfieldSetBtn_Change(this)'`\xFE";
 z+="    \xFE";
 z+="    if ID then \xFE";
 z+="        Dim Name As String = \" name='\":ID:\"'\" \xFE";
 z+="        IA := ` data-parsley-errors-container=\"#`:ID:`_errors\" `\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Dim S2 As String\xFE";
 z+="    If ReadOnly Then S2 = \" tabindex='-1' readonly \" Else S2 = \"\"\xFE";
 z+="    \xFE";
 z+="    If (SubDelimiter And multiValuedData) Or SubDelimiter >= Chr(252) Then\xFE";
 z+="        For Each V As String In Vals\xFE";
 z+="            If InStr(V, SubDelimiter) Then\xFE";
 z+="                Dim Display As String = Field(V, SubDelimiter, 1)\xFE";
 z+="                V = @DropLeft(V, SubDelimiter)\xFE";
 z+="                Dim S As String\xFE";
 z+="                If V Then Locate V In DefaultValues Then S = \" checked\" ELse S = \"\" Else S = \"\"\xFE";
 z+="                Opts[-1] = `<label class='fieldSetBtnLbl`:S:`'>`:@HtmlEncode(Display):`<input type='checkbox' class='fieldSetBtn'`:Name:IA:S2:S:` value=\"`:CStr(V):`\"></label>`\xFE";
 z+="            Else\xFE";
 z+="                Locate V In DefaultValues Then S = \" checked\" Else S = \"\"\xFE";
 z+="                Opts[-1] = `<label class='fieldSetBtnLbl`:S:`'>`:@HtmlEncode(V):`<input type='checkbox' class='fieldSetBtn'`:Name:IA:S2:S:` value=\"`:V:`\"></label>`\xFE";
 z+="            End If\xFE";
 z+="        NEXT\xFE";
 z+="        \xFE";
 z+="    ElseIf Vals Then\xFE";
 z+="        for each V in Vals\xFE";
 z+="            Locate V In DefaultValues Then S = \" checked\" Else S = \"\"\xFE";
 z+="            Opts[-1] = `<label class='fieldSetBtnLbl`:S:`'>`:@HtmlEncode(V):`<input type='checkbox' class='fieldSetBtn'`:Name:IA:S2:S:` value=\"`:V:`\"></label>`\xFE";
 z+="        next\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Dim OA As String = uiAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    Dim Div As String\xFE";
 z+=" \xFE";
 z+="    IF ID Then\xFE";
 z+="        Div = @Html(`<fieldset class='fieldSetBtnsFrame form-control' `:OA:`>\xFE";
 z+="                       <div class='fieldSetBtnsDiv' id=\"`:ID:`\" `:OA:`>`:Crlf():Join(Opts, Crlf()):Crlf():`\xFE";
 z+="                       </div></fieldset>\xFE";
 z+="                       <div id=\"`:ID:`_errors\" style=\"display: inline-block\"></div>\xFE";
 z+="                     `)\xFE";
 z+="    Else\xFE";
 z+="        Div = @Html(`<fieldset class='fieldSetBtnsFrame form-control' `:OA:`>\xFE";
 z+="                       <div class='fieldSetBtnsDiv' `:OA:`>`:Crlf():Join(Opts, Crlf()):Crlf():`\xFE";
 z+="                       </div></fieldset>\xFE";
 z+="                     `)\xFE";
 z+="    End If\xFE";
 z+="                  \xFE";
 z+="    Return Div"
window.cached_jsb_html["multiselectfieldsetbtns"]=z;
var z="*\xFE";
 z+="* Print @(-1):@multiSelectListBox('id1', ['red', 'blue', 'green', 'yellow'], ['blue', 'green'], [], [], '300px'); \xFE";
 z+="* input pau; \xFE";
 z+="* print \"result is \":@formvar('id1')\xFE";
 z+="\xFE";
 z+="FUNCTION multiSelectListBox(ByVal ID As String, byval VALUES As Object, optional byval  DEFAULTS As String, optional byval AdditionalAttributes As Object, optional byval Binding As Array, optional byval ItemWidth As String) As String\xFE";
 z+="   $options async-\xFE";
 z+="    \xFE";
 z+="   Dim Delimiter As String\xFE";
 z+="   Dim sVals As String = CStr(Values)\xFE";
 z+="\xFE";
 z+="   If InStr(sVals, AM()) Then \xFE";
 z+="      Delimiter = AM()\xFE";
 z+="   ElseIf InStr(sVals, VM()) Then \xFE";
 z+="      Delimiter = VM()\xFE";
 z+="   ElseIf InStr(sVals, SVM()) Then \xFE";
 z+="      Delimiter = SVM()\xFE";
 z+="   ElseIf InStr(sVals, \";\") Then \xFE";
 z+="      Delimiter = \";\"\xFE";
 z+="   ElseIf InStr(sVals, \",\") Then \xFE";
 z+="      Delimiter = \",\"\xFE";
 z+="   Else\xFE";
 z+="      if Binding Then Delimiter = ',' Else Delimiter = AM()\xFE";
 z+="   End If\xFE";
 z+="   \xFE";
 z+="   Dim Vals As Array = Split(Replace(sVals, Delimiter:\" \", Delimiter), Delimiter)\xFE";
 z+="   If Defaults = \"*\" Then Defaults = Vals\xFE";
 z+="   \xFE";
 z+="   DEFAULTS = Replace(DEFAULTS, Delimiter:\" \", Delimiter)\xFE";
 z+="   \xFE";
 z+="   Dim XH As String\xFE";
 z+="   if ItemWidth Then xh = ` style='display: inline; list-style-type: none; padding-right: 20px; width: `:ItemWidth:`; overflow-x:hidden; white-space:nowrap;'`\xFE";
 z+="   Dim Defs As Array = Split(Defaults, Delimiter)\xFE";
 z+="   \xFE";
 z+="   If Binding Then \xFE";
 z+="      Dim onupdate As String = `onupdate: function (input, bindingContext) { multiSelectReflectValues(input) }`\xFE";
 z+="      Binding = @MergeAttribute(\"data-bind\", onupdate, \",\", Binding)\xFE";
 z+="   Else\xFE";
 z+="      Binding = \"\"\xFE";
 z+="   End If\xFE";
 z+="\xFE";
 z+="   Dim HTML As String = CHR(28):`<div class='check-list form-control' `:uiAdditionalAttributes(AdditionalAttributes):`>\xFE";
 z+="          <span class=\"anchor\"><input id=\"`:ID:`\" name=\"`:ID:`\" style=\"height: 100%\" type='textbox' `:Join(Binding, \" \"):` value='`:Join(Defaults, \",\"):`' `:dataAdditionalAttributes(AdditionalAttributes):` /></span>\xFE";
 z+="          <ul class=\"listbox-items\" style=\"white-space: normal\">`:CRLF():CHR(29)\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="   Dim I As Integer\xFE";
 z+="   Dim V As Object\xFE";
 z+="   \xFE";
 z+="   For each V, I in Vals\xFE";
 z+="      Dim Checked As String = \"\"\xFE";
 z+="      For J As Integer = 1 To DCount(DEFAULTS, Delimiter)\xFE";
 z+="         If V = FIELD(DEFAULTS, Delimiter, J) Then\xFE";
 z+="            Checked = \"checked \"\xFE";
 z+="            exit for\xFE";
 z+="         end if  \xFE";
 z+="      next\xFE";
 z+="\xFE";
 z+="      Html := CHR(28):`<li`:xh:`><input type='checkbox' `:Checked:` onchange='multiSelectCheckBoxChanged(this);' />`:CHR(29):V:CHR(28):\"</li>\":Crlf():CHR(29)\xFE";
 z+="   NEXT\xFE";
 z+="\xFE";
 z+="   Html := CHR(28):`</ul></div>`:Crlf():CHR(29)\xFE";
 z+="\xFE";
 z+="   RETURN HTML"
window.cached_jsb_html["multiselectlistbox"]=z;
var z="*\xFE";
 z+="* mvTree's are converted into json trees\xFE";
 z+="*\xFE";
 z+="* multiValued Tree structure:\xFE";
 z+="*\xFE";
 z+="*   mvTree<1> = \"File\":VM():\"Save\":VM():\"Save As\":VM():\"Open\":VM():\"Exit\"\xFE";
 z+="*   mvTree<2> = \"Edit\":VM():\"Cut\":VM():\"Copy\":VM():\"Paste\"\xFE";
 z+="*   mvTree<3> = \"Subs\":VM():\"Sub\":SVM():\"Sub1\":SVM():\"Sub2\"\xFE";
 z+="*   \xFE";
 z+="* \xFE";
 z+="function mvTree(byval mvTree As String) As String\xFE";
 z+="* $options aspxc-\xFE";
 z+="*\xFE";
 z+="    * Convert to JSON structure\xFE";
 z+="    Dim SECONDLEVEL As Array\xFE";
 z+="    Dim SUBSUBCAPTION As String\xFE";
 z+="    Dim AMI As Integer\xFE";
 z+="    Dim VMI As Integer\xFE";
 z+="    Dim SVMI As Integer\xFE";
 z+="    Dim JSFOLDER1 As Json\xFE";
 z+="    Dim JSFOLDER2 As Json\xFE";
 z+="    Dim TREEFOLDERS As Json\xFE";
 z+="    Dim FOLDER As String\xFE";
 z+="    Dim FOLDERNAME As String\xFE";
 z+="    Dim SUBCAPTION As String\xFE";
 z+="    Dim FOLDER2NAME As String\xFE";
 z+="\xFE";
 z+="    treeFolders = {}\xFE";
 z+="\xFE";
 z+="    for Each Folder, AmI in Split(mvTree, AM())\xFE";
 z+="        SecondLevel = []\xFE";
 z+="        FolderName = Folder<1,1,1>\xFE";
 z+="        Folder = Delete(Folder, 1, 1)\xFE";
 z+="        treeFolders[FolderName] = { } ;* id: \"F_\":AmI \xFE";
 z+="        \xFE";
 z+="        jsFolder1 = treeFolders[FolderName] \xFE";
 z+="        for each subCaption, VmI In Split(Folder, VM())\xFE";
 z+="            if InStr(subCaption, SVM()) Then\xFE";
 z+="                Folder2Name = subCaption<1,1,1>\xFE";
 z+="                subCaption = Delete(subCaption, 1, 1, 1)\xFE";
 z+="                \xFE";
 z+="                jsFolder1[Folder2Name] = { } ;* id: \"F_\":AmI:\"_\":VmI\xFE";
 z+="                jsFolder2 = jsFolder1[Folder2Name]\xFE";
 z+="                for each subsubCaption, SvmI in Split(subCaption, SVM())\xFE";
 z+="                    if subsubCaption Then jsFolder2[subsubCaption] = { id: \"A_\":AmI:\"_\":VmI:\"_\":SvmI }\xFE";
 z+="                next\xFE";
 z+="            else\xFE";
 z+="                if subCaption then jsFolder1[subCaption] = { id: \"A_\":AmI:\"_\":VmI }\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="    next\xFE";
 z+="    \xFE";
 z+="    return jsonTree(treeFolders)\xFE";
 z+="end function"
window.cached_jsb_html["mvtree"]=z;
var z="* print @nanogallery('id1', '110070799136410122654') \xFE";
 z+="*\xFE";
 z+="* colorScheme: 'none', 'dark','darkRed', 'darkGreen', 'darkBlue', 'darkOrange', 'light', 'lightBackground'\xFE";
 z+="* theme: 'default', 'clean', 'light'\xFE";
 z+="*\xFE";
 z+="function Nanogallery(ByVal ID As String, byval userID As String, Optional Byval Theme As String, Optional Byval colorScheme As String) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If !Theme Then Theme = 'default'\xFE";
 z+="    If !colorScheme Then colorScheme = 'none'\xFE";
 z+="\xFE";
 z+="    Html =      @Head(@JSLink(\"//cdnjs.cloudflare.com/ajax/libs/nanogallery/5.1.1/jquery.nanogallery.min.js\"))\xFE";
 z+="    Html := @Head(@CssLink(\"//cdnjs.cloudflare.com/ajax/libs/nanogallery/5.1.1/css/nanogallery.min.css\"))\xFE";
 z+="\xFE";
 z+="    If !userID Then userID = '110070799136410122654'\xFE";
 z+="    Html := Chr(28):`\xFE";
 z+="      <div id=\"`:ID:`\" name=\"`:ID:`\"></div>\xFE";
 z+="\xFE";
 z+="      <script type=\"text/javascript\"> \xFE";
 z+="    `\xFE";
 z+="    If System(1) = \"gae\" Or System(1) = \"aspx\" Then Html := ` $(document).ready(function () { `\xFE";
 z+="    \xFE";
 z+="    Html := `\xFE";
 z+="          $(\"#`:ID:`\").nanoGallery({\xFE";
 z+="            kind: 'picasa',\xFE";
 z+="            userID: '`:userID:`',\xFE";
 z+="            colorScheme: '`:userID:`',\xFE";
 z+="          });\xFE";
 z+="        `\xFE";
 z+="    If System(1) = \"gae\" Or System(1) = \"aspx\" Then Html := ` }); `\xFE";
 z+="    \xFE";
 z+="    Html := ` </script> `:Chr(29)\xFE";
 z+="    Return Html\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="/*\xFE";
 z+="    Http://nanogallery.brisbois.fr/#firstSteps\xFE";
 z+="    \xFE";
 z+="    thumbnailHeight Integer/string 154 Thumbnails Image Height In Pixels, Or 'auto'.'auto' Means Cascading Grid Layout.\xFE";
 z+="\xFE";
 z+="    thumbnailWidth Integer/string 230 Thumbnails Image Width In Pixels, Or 'auto'.\xFE";
 z+="'auto' Means Justified Layout.\xFE";
 z+="\xFE";
 z+="    thumbnailAlignment String 'center' Set The Thumbnail Alignment. Possible Values: 'left', 'right', 'justified', 'center'.\xFE";
 z+="Note: Value 'justified' Will Ignore The 'thumbnailGutterWidth'.\xFE";
 z+="\xFE";
 z+="    thumbnailHoverEffect String/object/array 'none' Thumbnail Mouse Hover Effect. The Effect Will Also Be Triggered By 'tap' On Touch-Screen.\xFE";
 z+="    Combinations: Define Multiple Effect Names In The Parameter To Combine Them.\xFE";
 z+="    Example: thumbnailHoverEffect='borderDarker,labelAppear75'\xFE";
 z+="    Please Note That Some Effects Can Not Be Combined (For Example: 'imageSlideUp' And 'imageFlipHorizontal').\xFE";
 z+="And Some Combinations Can Results In Weirds Effects...\xFE";
 z+="    Possible Values: 'borderLighter', 'borderDarker', 'scale120', 'scaleLabelOverImage', 'overScale', 'overScaleOutside', 'slideUp', 'slideDown', 'slideRight', 'slideLeft', 'rotateCornerBL', 'rotateCornerBR', 'imageScale150', 'imageScaleIn80', 'imageScale150Outside', 'imageSplit4', 'imageSplitVert', 'imageSlideUp', 'imageSlideDown', 'imageSlideRight', 'imageSlideLeft', 'imageRotateCornerBL', 'imageRotateCornerBR', 'imageFlipHorizontal', 'imageFlipVertical', 'labelAppear', 'labelAppear75', 'labelOpacity50', 'descriptionAppear', 'descriptionSlideUp', 'labelSlideUpTop', 'labelSlideUp', 'labelSlideDown', 'labelSplit4', 'labelSplitVert', 'labelAppearSplit4', 'labelAppearSplitVert'\xFE";
 z+="\xFE";
 z+="    Theme String 'default' Name Of The Theme (Default', 'Clean', 'Light')\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    colorScheme String/ Object 'none' Gallery Color Scheme (Breadcrumb And Thumbnails).\xFE";
 z+="    Possible Values: 'none', 'dark','darkRed', 'darkGreen', 'darkBlue', 'darkOrange', 'light', 'lightBackground'\xFE";
 z+="    Custom Color Schemes Are Supported.\xFE";
 z+="    \xFE";
 z+="    colorSchemeViewer String/ Object 'default' Image Viewer Color Scheme.\xFE";
 z+="    Possible Values: 'none', 'dark', 'darkRed', 'darkGreen', 'darkBlue', 'darkOrange', 'light'\xFE";
 z+="*/"
window.cached_jsb_html["nanogallery"]=z;
var z="*\xFE";
 z+="* Note - your DefaultValue needs to be @HtmlEncode(xxx) before coming here - HTML text expected\xFE";
 z+="*\xFE";
 z+="* Print NicEditor('id', @HtmlEncode('1\\a2\\a3\\afour'), true, { style: 'min-height: 6em' } ) ;* 6 lines high\xFE";
 z+="* Print @SubmitBtn('OK')\xFE";
 z+="* @Server.Pause\xFE";
 z+="* result = @formVar('id')\xFE";
 z+="* Saved Or Canceled = @FormVar('id_formbtn')\xFE";
 z+="*\xFE";
 z+="Function NicEditor(ByVal ID As String, ByVal DefaultValue As String, optional byval OnContextMenu As String, optional byval AdditionalAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim STYLERIBBONBAR As String\xFE";
 z+="    Dim S As String\xFE";
 z+="\xFE";
 z+="    DefaultValue = Replace(DefaultValue, Chr(254), \"<br />\")\xFE";
 z+="    \xFE";
 z+="    // This code was intended to insure that all the DIVs were balanced - didn't work to good\xFE";
 z+="    if instr(defaultValue, `class=\"docExample\"`) and false then\xFE";
 z+="        DefaultValue = Replace(DefaultValue, \"<div\", \"&lt;div\")\xFE";
 z+="        DefaultValue = Replace(DefaultValue, `&lt;div class=\"docExample\"`, `<div class=\"docExample\"`)\xFE";
 z+="        DefaultValue = Replace(DefaultValue, \"</div>\", \"&lt;/div&gt;\")\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    HTML = @Head(@JSLink(@jsbroot:\"js/nicEdit.js\"))\xFE";
 z+="    HTML := @Head(@JSLink(@jsbroot:\"js/jquery.tooltip.pack.js\"))\xFE";
 z+="    \xFE";
 z+="    // When do we display the button bar?\xFE";
 z+="    if OnContextMenu Then \xFE";
 z+="        styleRibbonBar = ` style=\"position: static; display: none; top: 0; left: 130px; border: 1,solid; width: 770px\"`\xFE";
 z+="\xFE";
 z+="        Html := Chr(28):`<div id=\"`:ID:`_nicBtns\" style=\"position:relative; display: none; \">`:crlf():Chr(29)\xFE";
 z+="        Html := @submitBtn(ID:`_formbtn`, 'Save', 'Save')\xFE";
 z+="        Html := @submitBtn(ID:`_formbtn`, 'Cancel', 'Cancel')\xFE";
 z+="        Html := Chr(28):`   <div id=\"`:ID:`_myNicPanel\"`:styleRibbonBar:`></div>`:crlf():Chr(29)\xFE";
 z+="        Html := Chr(28):`</div>`:crlf():Chr(29)\xFE";
 z+="    Else\xFE";
 z+="        Html := @Html(`<div id=\"`:ID:`_myNicPanel\" style=\"width: 770px; position: fixed;\"></div>`)\xFE";
 z+="        AdditionalAttributes = @MergeAttribute(\"style\", \"margin-top: 30px\", \";\", AdditionalAttributes)\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    // results get placed here\xFE";
 z+="    Html := Chr(28):`<input id=\"`:ID:`\" name=\"`:ID:`\" type='hidden' />`:crlf():Chr(29)\xFE";
 z+="    \xFE";
 z+="    // Nic editor displays here\xFE";
 z+="    Html := Chr(28):`<div id=\"x_`:ID:`\" `:JoinAttributes(AdditionalAttributes):` class=\"nicEditorDiv\">`:Replace(DefaultValue, Chr(254), \"<br />\"):`</div>`:crlf():Chr(29)\xFE";
 z+="\xFE";
 z+="    if !OnContextMenu Then \xFE";
 z+="        * Html = @Rows2(\"30px\", @Html(`<div id=\"`:ID:`_myNicPanel\"></div>`), \"%\", Html, \"\", \"overflow:auto\" )\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    if OnContextMenu Then\xFE";
 z+="        If OnContextMenu = True Then\xFE";
 z+="            Html := @jsb_bf.AttachToEvent(\"#x_\":ID, \"contextmenu\", `function (e) { return `:ID:`_cMenu(e, this) }`)\xFE";
 z+="            s<-1> = `function `:ID:`_cMenu(e) {`\xFE";
 z+="            s<-1> = `   if ($('#`:ID:`_myNicPanel').is(':visible')) return true;`\xFE";
 z+="            s<-1> = `   var cMenu = $(\"<ul id='contextMenu' />\");`\xFE";
 z+="            s<-1> = `   $(cMenu).append('<li onclick=\"`:ID:`_EnableEditing()\">Edit HTML</li>');`\xFE";
 z+="            s<-1> = `   return jsbContentMenu(e, cMenu)`\xFE";
 z+="            s<-1> = `}`\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        s<-1> = `function `:ID:`_EnableEditing(e, fromObj) {`\xFE";
 z+="    End Else\xFE";
 z+="        if system(1) = \"gae\" OR system(1) = \"aspx\" then  s<-1> = `$( document ).ready( function () {`\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    S<-1> = `   var myNicEditor = new nicEditor({ fullPanel : true });` \xFE";
 z+="    S<-1> = `   $('#`:ID:`_myNicPanel').show()`\xFE";
 z+="    S<-1> = `   $('#`:ID:`_nicBtns').show()`\xFE";
 z+="    S<-1> = `   myNicEditor.setPanel('`:ID:`_myNicPanel');`\xFE";
 z+="    S<-1> = `   myNicEditor.addInstance(\"x_`:ID:`\");`\xFE";
 z+="\xFE";
 z+="    * Disable labels from jumping to their corresponding controls\xFE";
 z+="    S<-1> = `   disableLabelJump();`\xFE";
 z+="\xFE";
 z+="    if OnContextMenu Then\xFE";
 z+="        S<-1> = `   $(\"#x_`:ID:`\").focus();`\xFE";
 z+="        s<-1> = `}`\xFE";
 z+="    End Else\xFE";
 z+="        if system(1) = \"gae\" OR system(1) = \"aspx\" then s<-1> = `});`\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    S<-1> = `$(\"#jsb\").on(\"submit.`:ID:`\", function( event ) {`\xFE";
 z+="    s<-1> = `   var nicE = new nicEditors.findEditor(\"x_`:ID:`\");`\xFE";
 z+="    S<-1> = `   if (nicE.getContent) {`\xFE";
 z+="    S<-1> = `      var nicContent = nicE.getContent()`\xFE";
 z+="    S<-1> = `   } else {`\xFE";
 z+="    S<-1> = `      var nicContent = $('#x_`:ID:`').html()`\xFE";
 z+="    S<-1> = `   }`\xFE";
 z+="    S<-1> = `   nicContent = Change(nicContent, \"</div>\", \"</div >\")`\xFE";
 z+="    S<-1> = `   nicContent = Change(nicContent, \"&lt;div\", \"<div\")`\xFE";
 z+="    S<-1> = `   nicContent = Change(nicContent, \"&lt;/div&gt;\", \"</div>\")`\xFE";
 z+="    S<-1> = `   $(\"#`:ID:`\").val(nicContent);`\xFE";
 z+="    S<-1> = ``\xFE";
 z+="    S<-1> = `   unloadDynamicScript(\"`:ID:`_cMenu\")`\xFE";
 z+="    S<-1> = `   unloadDynamicScript(\"`:ID:`_EnableEditing\")`\xFE";
 z+="    S<-1> = `   unloadDynamicScript(\"`:ID:`_nicBtns\")`\xFE";
 z+="    S<-1> = `   unloadDynamicScript(\"`:ID:`_myNicPanel\")`\xFE";
 z+="    S<-1> = `   unloadDynamicScript(\"`:ID:`_formbtn\")`\xFE";
 z+="    S<-1> = `   unloadDynamicScript(\"x_`:ID:`\")`\xFE";
 z+="    S<-1> = ``\xFE";
 z+="    S<-1> = `  $(\"#jsb\").off(\"submit.`:ID:`\");`\xFE";
 z+="\xFE";
 z+="    S<-1> = `});`\xFE";
 z+="\xFE";
 z+="    Html := @JSB_HTML.script(s)\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    Return Html"
window.cached_jsb_html["niceditor"]=z;
var z="***************** HTML *****************************\xFE";
 z+="*\xFE";
 z+="* For multi-line text boxes use TEXTAREA\xFE";
 z+="*\xFE";
 z+="*  To use BootStrap add a \"form-control\" class:  \xFE";
 z+="*     print @nouiSlider('id', 50, false, { }, 20, 150, \"120px\", \"red\"):\xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="* PRINT @nouiSlider('id', '', false, { })\xFE";
 z+="*  Print $('#id').change(function (e) { console.log($(this).val()) })\xFE";
 z+="*\xFE";
 z+="Function nouiSlider(ByVal ID As String, optional ByVal DefaultValue As String, optional ByVal ReadOnly As Boolean, optional byval AdditionalAttributes As Object, optional byval minValue As Integer, optional byval maxValue As Single, optional byval Size As String, optional byval Color As StRiNg, optional byval Units As String) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim ONCHANGE As Boolean\xFE";
 z+="    Dim REQUIRED As Boolean\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim CT As String\xFE";
 z+="    Dim AA As String\xFE";
 z+="\xFE";
 z+="    Html = @Head(@CssLink(@jsbroot:\"css/nouislider.css\"))\xFE";
 z+="    Html := @Head(@JSLink(@jsbroot:\"js/nouislider.js\"))\xFE";
 z+="\xFE";
 z+="    If !minValue Then minValue = 0\xFE";
 z+="    If isMissing(maxValue) Then maxValue = 100 Else maxValue = Val(maxValue)\xFE";
 z+="    If ReadOnly Then Ct = \"NOUISLIDER_ReadOnly\" Else Ct = \"NOUISLIDER\"\xFE";
 z+="    If ReadOnly Then ReadOnly = \" readonly\" Else ReadOnly = \"\"\xFE";
 z+="    If Size Then Size = `; width: `:Size\xFE";
 z+="    if IsMissing(AdditionalAttributes) Then AdditionalAttributes = []\xFE";
 z+="    \xFE";
 z+="    onchange = AdditionalAttributes['onchange']\xFE";
 z+="    if !onchange then onchange = AdditionalAttributes['onupdate']\xFE";
 z+="    \xFE";
 z+="    Aa  = @MergeAttribute(\"class\", Ct, \" \", AdditionalAttributes)\xFE";
 z+="   \xFE";
 z+="    Html := Chr(28):`<div id='slider_`:Id:`' `:uiAdditionalAttributes(Aa):` style=\"margin-right: 5px; margin-top: 40px; margin-bottom: 10px; form-control`:Size:`\"></div>`\xFE";
 z+="    Html := `<input id='`:Id:`' name='`:Id:`'`:Readonly:` style='display:none' `:dataAdditionalAttributes(Aa):`/>`:Chr(29)\xFE";
 z+="   \xFE";
 z+="    Html := @Script(`\xFE";
 z+="        var nouiSlider_`:ID:` = document.getElementById('slider_`:ID:`');\xFE";
 z+="\xFE";
 z+="        noUiSlider.create(nouiSlider_`:ID:`, {\xFE";
 z+="         start: `:Val(DEFAULTVALUE):`,\xFE";
 z+="            tooltips: true,\xFE";
 z+="            step: 1,\xFE";
 z+="         behaviour: 'none',\xFE";
 z+="         range: {\xFE";
 z+="          'min': `:minValue:`,\xFE";
 z+="          'max': `:maxValue:`\xFE";
 z+="         },\xFE";
 z+="         format: {\xFE";
 z+="           to: function ( value ) {\xFE";
 z+="          return Field(value, '.', 1)`:IFF(units, ` + '&nbsp`:units:`'`, ''):`\xFE";
 z+="           },\xFE";
 z+="           from: function ( value ) {\xFE";
 z+="          return `:IFF(units, `parseInt(value)`, 'value'):`\xFE";
 z+="           }\xFE";
 z+="         }\xFE";
 z+="        });\xFE";
 z+="    `)\xFE";
 z+="            \xFE";
 z+="    If !minValue Then Locate \"required\" In AdditionalAttributes Then Required = True\xFE";
 z+="    \xFE";
 z+="    If Required Then\xFE";
 z+="        Html := @Script(`\xFE";
 z+="            nouiSlider_`:ID:`.noUiSlider.on('update', function( values, handle, unencoded, tap, positions ) {\xFE";
 z+="             var value = parseInt(values[handle]);\xFE";
 z+="             if (value) {\xFE";
 z+="                 var myInput = document.getElementById('`:ID:`');\xFE";
 z+="                  myInput.value = value;\xFE";
 z+="                  if ($(myInput).parsley && $(myInput).parsley().reset) $(myInput).parsley().reset()\xFE";
 z+="                  $(myInput).trigger(\"change\")\xFE";
 z+="                }\xFE";
 z+="            });  \xFE";
 z+="        `)\xFE";
 z+="    Else\xFE";
 z+="        Html := @Script(`\xFE";
 z+="            nouiSlider_`:ID:`.noUiSlider.on('update', function( values, handle, unencoded, tap, positions ) {\xFE";
 z+="               var value = parseInt(values[handle]);\xFE";
 z+="               var myInput = document.getElementById('`:ID:`');\xFE";
 z+="               myInput.value = parseInt(value);\xFE";
 z+="               if ($(myInput).parsley && $(myInput).parsley().reset) $(myInput).parsley().reset()\xFE";
 z+="               $(myInput).trigger(\"change\")\xFE";
 z+="            });  \xFE";
 z+="        `)   \xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Color Then Html := @Script(`$('#slider_`:Id:` > .noUi-base').css('background-color', '`:Color:`')`)\xFE";
 z+="    if onchange then Html := @Script(`$('#`:ID:`').change(function (e) { `:onchange:` });`)\xFE";
 z+="    Return Html"
window.cached_jsb_html["nouislider"]=z;
window.cached_jsb_html["onswipe"]="*\xFE* OnSwipe's remain in effect until the next clearscreen\xFE*\xFE/*\xFE    print @onSwipeDown('btn', 'swiped down'):\xFE    print @onSwipeUp('btn', 'swiped up'):\xFE    print @onSwipeLeft('btn', 'swiped left'):\xFE    print @onSwipeRight('btn', 'swiped right'):\xFE    @server.pause\xFE    print @formvar('btn')\xFE*/\xFE\xFEFUNCTION ONSWIPE As StRiNg\xFE    $options aspxc-\xFEEND FUNCTION";
var z="FUNCTION OnSwipeDown(ByVal ID As String, BYVAL SUBMITVALUE As String) As String\xFE";
 z+="    $options aspxc-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If !SUBMITVALUE Then SUBMITVALUE = \"SWIPEDDOWN\"\xFE";
 z+="   \xFE";
 z+="    if system(1) = \"js\" then\xFE";
 z+="       RETURN @Script(`\xFE";
 z+="          enableSwipes();\xFE";
 z+="          onSwipedDown = function () { \xFE";
 z+="             parsleyDestroy();\xFE";
 z+="             assignBtn('`:ID:`', '`:SUBMITVALUE:`'); \xFE";
 z+="             if (!ProcessQ.length) { ProcessQ.push(pauseRoutine); setTimeout(go, 30); }\xFE";
 z+="          }`)\xFE";
 z+="    Else\xFE";
 z+="       HTML = CHR(28):`<button id='swipe_down' name='`:ID:`'\" type='submit' class='SubmitBtn' style='display: none' value='`:SUBMITVALUE:`'>Swipe Left</button>&nbsp;`:CHR(29)\xFE";
 z+="       RETURN HTML:@Script(`\xFE";
 z+="          enableSwipes();\xFE";
 z+="          onSwipedDown = function () { \xFE";
 z+="             parsleyDestroy();\xFE";
 z+="             $('#swipe_down').trigger('click'); \xFE";
 z+="          }`)\xFE";
 z+="    End If\xFE";
 z+="end function"
window.cached_jsb_html["onswipedown"]=z;
var z="FUNCTION OnSwipeLeft(ByVal ID As String, BYVAL SUBMITVALUE As String) As String\xFE";
 z+="    $options aspxc-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If !SUBMITVALUE Then SUBMITVALUE = \"SWIPEDLEFT\"\xFE";
 z+="   \xFE";
 z+="    if system(1) = \"js\" then\xFE";
 z+="       RETURN @Script(`\xFE";
 z+="          enableSwipes();\xFE";
 z+="          onSwipedLeft = function () { \xFE";
 z+="             parsleyDestroy();\xFE";
 z+="             assignBtn('`:ID:`', '`:SUBMITVALUE:`'); \xFE";
 z+="             if (!ProcessQ.length) { ProcessQ.push(pauseRoutine); setTimeout(go, 30); }\xFE";
 z+="          }`)\xFE";
 z+="    Else\xFE";
 z+="       HTML = CHR(28):`<button id='swipe_Left' name='`:ID:`'\" type='submit' class='SubmitBtn' style='display: none' value='`:SUBMITVALUE:`'>Swipe Left</button>&nbsp;`:CHR(29)\xFE";
 z+="       RETURN HTML:@Script(`\xFE";
 z+="          enableSwipes();\xFE";
 z+="          onSwipedLeft = function () { \xFE";
 z+="             parsleyDestroy();\xFE";
 z+="             $('#swipe_Left').trigger('click'); \xFE";
 z+="          }`)\xFE";
 z+="    End If\xFE";
 z+="end function"
window.cached_jsb_html["onswipeleft"]=z;
var z="FUNCTION OnSwipeRight(ByVal ID As String, BYVAL SUBMITVALUE As String) As String\xFE";
 z+="    $options aspxc-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If !SUBMITVALUE Then SUBMITVALUE = \"SWIPEDRIGHT\"\xFE";
 z+="   \xFE";
 z+="    if system(1) = \"js\" then\xFE";
 z+="       RETURN @Script(`\xFE";
 z+="          enableSwipes();\xFE";
 z+="          onSwipedRight = function () { \xFE";
 z+="             parsleyDestroy();\xFE";
 z+="             assignBtn('`:ID:`', '`:SUBMITVALUE:`'); \xFE";
 z+="             if (!ProcessQ.length) { ProcessQ.push(pauseRoutine); setTimeout(go, 30); }\xFE";
 z+="          }`)\xFE";
 z+="    Else\xFE";
 z+="       HTML = CHR(28):`<button id='swipe_right' name='`:ID:`'\" type='submit' class='SubmitBtn' style='display: none' value='`:SUBMITVALUE:`'>Swipe Left</button>&nbsp;`:CHR(29)\xFE";
 z+="       RETURN HTML:@Script(`\xFE";
 z+="          enableSwipes();\xFE";
 z+="          onSwipedRight = function () { \xFE";
 z+="             parsleyDestroy();\xFE";
 z+="             $('#swipe_right').trigger('click'); \xFE";
 z+="          }`)\xFE";
 z+="    End If\xFE";
 z+="end function"
window.cached_jsb_html["onswiperight"]=z;
var z="FUNCTION OnSwipeUp(ByVal ID As String, BYVAL SUBMITVALUE As String) As String\xFE";
 z+="    $options aspxc-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If !SUBMITVALUE Then SUBMITVALUE = \"SWIPEDUP\"\xFE";
 z+="    \xFE";
 z+="    if system(1) = \"js\" then\xFE";
 z+="       RETURN @Script(`\xFE";
 z+="          enableSwipes();\xFE";
 z+="          onSwipedUp = function () { \xFE";
 z+="             parsleyDestroy();\xFE";
 z+="             assignBtn('`:ID:`', '`:SUBMITVALUE:`'); \xFE";
 z+="             if (!ProcessQ.length) { ProcessQ.push(pauseRoutine); setTimeout(go, 30); }\xFE";
 z+="          }`)\xFE";
 z+="    Else\xFE";
 z+="       HTML = CHR(28):`<button id='swipe_up' name='`:ID:`'\" type='submit' class='SubmitBtn' style='display: none' value='`:SUBMITVALUE:`'>Swipe Left</button>&nbsp;`:CHR(29)\xFE";
 z+="       RETURN HTML:@Script(`\xFE";
 z+="          enableSwipes();\xFE";
 z+="          onSwipedUp = function () { \xFE";
 z+="             parsleyDestroy();\xFE";
 z+="             $('#swipe_up').trigger('click'); \xFE";
 z+="          }`)\xFE";
 z+="    End If\xFE";
 z+="end function"
window.cached_jsb_html["onswipeup"]=z;
window.cached_jsb_html["para"]="function PARA(byval ClassName As String, Optional Byval Content As String, Optional Byval AdditionalAttributes As String) As StRiNg\xFE    $options async-\xFE    \xFE    Dim HTML As String\xFE\xFE    If IsMissing(Content) Then\xFE        Content = ClassName\xFE        ClassName = \"\"\xFE    End If\xFE    \xFE    Html = Chr(28):\"<p class='\":ClassName:\"'\"\xFE    If AdditionalAttributes Then Html := JoinAttributes(AdditionalAttributes)\xFE    Html := \"><span>\":Chr(29)\xFE    Html := Content\xFE    Html := Chr(28):\"</span></p>\":Chr(29)\xFE    Return Html\xFEend function\xFE";
var z="*\xFE";
 z+="* Auto submit with: AdditionalAttributes[-1] = `onkeypress=\"if (event.keyCode == 13) form.submit();\"`\xFE";
 z+="*\xFE";
 z+="function Passwordbox(ByVal ID As String, Optional Byval Defaultvalue As Object, Optional Byval ReadOnly As Object, Optional Byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If isJson(Defaultvalue) Or IsArray(Defaultvalue) Then\xFE";
 z+="        AdditionalAttributes = Defaultvalue\xFE";
 z+="        Defaultvalue = ''\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If isJson(ReadOnly) Or IsArray(ReadOnly) Then\xFE";
 z+="        AdditionalAttributes = ReadOnly\xFE";
 z+="        ReadOnly = False\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If ReadOnly Then\xFE";
 z+="        Html = Chr(28):\"<input id='\":Id:\"' name='\":Id:\"' tabindex='-1' readonly \":Join(@MergeAttribute(\"class\", \"PasswordBox_ReadOnly form-control\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="    Else\xFE";
 z+="        Html = Chr(28):\"<input id='\":Id:\"' name='\":Id:\"' \":Join(@MergeAttribute(\"class\", \"PasswordBox form-control\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Html := \"type='password' value='\":Chr(29):Defaultvalue:Chr(28):\"' />\":Chr(29)\xFE";
 z+="    Return Html\xFE";
 z+="end function"
window.cached_jsb_html["passwordbox"]=z;
window.cached_jsb_html["prettyprint"]="// pretty print some javaScript code\xFE//    - this add color to the identifies, constants, comments, etc.\xFE//\xFEfunction prettyPrint(byVal JSCode As String) As StRiNg\xFE    $options async-\xFE    \xFE    Dim HTML As String\xFE\xFE    HTML = @Head(@JSLink(\"//cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js\"))\xFE    \xFE    JSCode = Replace(JSCode, AM(), CRLF())\xFE    Html := Chr(28):`<div style=\"height:100%; overflow: auto; margin: 0; padding: 0; border: 0;\"><code class=\"prettyprint\">`:Replace(Replace(@Jsb_BF.HtmlEncode(JSCode), Chr(10), \"<br/>\"), \" \", \"&nbsp;\"):`</code></div>`:Crlf():Chr(29)\xFE\xFE    Return Html\xFEEnd function\xFE";
var z="/*\xFE";
 z+="Program ProgressBar\xFE";
 z+="    Print ProgressBar('progressBarID', { style: 'position: absolute; width: 300px; top: 50%; left: 50%' } ):\xFE";
 z+="    For I = 1 To 10\xFE";
 z+="        @Server.Flush\xFE";
 z+="        Print updateProgressBar('progressBarID', I, 1, 10):\xFE";
 z+="        Sleep .3\xFE";
 z+="    Next\xFE";
 z+="    if system(1) = \"js\" then $('#':progressBarID).remove()\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="function ProgressBar(ByVal ID As String, optional ByVal AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    AdditionalAttributes = MergeAttribute('style', 'height:1.4em', ';', AdditionalAttributes)\xFE";
 z+="    Html = Chr(28):\"<div id='\":Id:\"' class='progress' \":JoinAttributes(AdditionalAttributes):\">\"\xFE";
 z+="    Html := \"<div id='\":Id:\"_bar' class='progress-bar' role='progressbar'>\"\xFE";
 z+="    Html := \"<span id='\":Id:\"_text'></span>\"\xFE";
 z+="    Html := \"</div></div><script>$('#\":Id:\"').css('z-index', window.nextZIndex())</script>\":Chr(29)\xFE";
 z+="    Return Html\xFE";
 z+="End function"
window.cached_jsb_html["progressbar"]=z;
var z="*\xFE";
 z+="* Values is a ForEach Array.  Each Value can be \"Display,Value\"\xFE";
 z+="*\xFE";
 z+="* To load via AJAX - see dropDownBox\xFE";
 z+="*\xFE";
 z+="* Print @(-1):@RadioBtns('id1', ['red', 'blue', 'green', 'yellow'], 'blue')\xFE";
 z+="*\xFE";
 z+="* See also @fieldsetBtns('id1', ['red', 'blue', 'green', 'yellow'], 'blue')\xFE";
 z+="*\xFE";
 z+="FUNCTION RadioBtns(ByVal ID As String, byval Values As Object, optional byval DEFAULT As String, optional ByVal ReadOnly As Boolean, optional byval AdditionalAttributes As Object, optional byval multiValuedData As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim OPTS As Array\xFE";
 z+="    Dim VALS As Array\xFE";
 z+="    Dim VI As Integer\xFE";
 z+="    Dim XOA As Array\xFE";
 z+="    Dim SUBDELIMITER As String\xFE";
 z+="    Dim CRLF As String\xFE";
 z+="    Dim FOUNDDEFAULTVALUE As Boolean\xFE";
 z+="    Dim IA As String\xFE";
 z+="    Dim S2 As String\xFE";
 z+="    Dim NAME As String\xFE";
 z+="    Dim V As String\xFE";
 z+="    Dim S As String\xFE";
 z+="    Dim DISPLAY As String\xFE";
 z+="    Dim OA As String\xFE";
 z+="    Dim DIV As StRiNg\xFE";
 z+="\xFE";
 z+="    Vals = makeArray(Values); SubDelimiter = @NI\xFE";
 z+="    If !InStr(Values, SubDelimiter) Then SubDelimiter = \"\"\xFE";
 z+="\xFE";
 z+="    Crlf = CRLF()\xFE";
 z+="    foundDefaultValue = False\xFE";
 z+="    Opts = []\xFE";
 z+="\xFE";
 z+="    IA = dataAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    IF IA Then IA = ' ':IA\xFE";
 z+="    IA := ` data-parsley-errors-container=\"#`:ID:`_errors\" `\xFE";
 z+="    \xFE";
 z+="    If ReadOnly Then S2 = \" tabindex='-1' readonly\" Else S2 = \"\"\xFE";
 z+="    \xFE";
 z+="    if ID then Name = \" name='\":ID:\"'\"\xFE";
 z+="    \xFE";
 z+="    If SubDelimiter Then\xFE";
 z+="        For Each V, VI In Vals\xFE";
 z+="            S = \"\"\xFE";
 z+="            If InStr(V, SubDelimiter) Then\xFE";
 z+="            \xFE";
 z+="                Display = Field(V, SubDelimiter, 1)\xFE";
 z+="                V = @DropLeft(V, SubDelimiter)\xFE";
 z+="                IF V = Default And Len(Default) Then S = \" checked\"; foundDefaultValue = True\xFE";
 z+="                Opts[-1] = \"<input type='radio' class='RadioBtn'\":Name:IA:S2:S:` value=\"`:V:`\"><label for=\"`:Name:`\"/>`:@HtmlEncode(Display):\"</label>\"\xFE";
 z+="            Else\xFE";
 z+="                IF V = Default And Len(Default) Then S = ` checked`; foundDefaultValue = True\xFE";
 z+="                Opts[-1] = `<input type='radio' class='RadioBtn'`:Name:IA:S2:S:` value=\"`:`><label for=\"`:Name:`\"/>`:@HtmlEncode(V):`</label>`\xFE";
 z+="            End If\xFE";
 z+="            // IA = \"\" * for knockout\xFE";
 z+="        NEXT\xFE";
 z+="        \xFE";
 z+="    ElseIf Vals Then\xFE";
 z+="        for each V, VI in Vals\xFE";
 z+="            S = \"\"\xFE";
 z+="            IF V = Default And Len(Default) Then S = \" checked\"; foundDefaultValue = True\xFE";
 z+="            Opts[-1] = \"<input type='radio' class='RadioBtn'\":Name:IA:S2:S:` value=\"`:V:`\"><label for=\"`:Name:`\"/>`:@HtmlEncode(V):\"</label>\"\xFE";
 z+="            // IA = \"\"  * for knockout\xFE";
 z+="        next\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If Not(foundDefaultValue) And Len(Default) THEN\xFE";
 z+="        Opts[-1] = \"<input type='radio' class='RadioBtn'\":Name:S2:\" checked\":` value=\"`:Default:`\"/>`:@HtmlEncode(Default):\"</label>\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    OA = uiAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    If ReadOnly Then\xFE";
 z+="        xOA[-1] = `onfocus=\"this.defaultIndex=this.selectedIndex;\"`\xFE";
 z+="        xOA[-1] = `onchange=\"this.selectedIndex=this.defaultIndex;\"`\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Div = @Html(`<fieldset class='RadioBtnsFrame form-control' `:OA:`>\xFE";
 z+="                      <div class='RadioBtnsDiv' id=\"`:ID:`\" `:OA:`>`:Crlf:Join(Opts, Crlf):Crlf:`\xFE";
 z+="                      </div>\xFE";
 z+="                   </fieldset>\xFE";
 z+="                   <div id=\"`:ID:`_errors\" style=\"display: inline-block\"></div>\xFE";
 z+="                 `)\xFE";
 z+="                 \xFE";
 z+="    RETURN Div"
window.cached_jsb_html["radiobtns"]=z;
var z="// Returns a javascript function to requery a combobox, or other datalist control from a url\xFE";
 z+="//  jsLoadRoutine is one of: autoCompleteTextBox\xFE";
 z+="\xFE";
 z+="function reloadDataListFromUrl_OnParent_Change(ByVal ID As String, byval ChangeOn_ParentID As String, byval QuotedUrl As String, optional byval jsLoadRoutine As String) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim onSuccess As String\xFE";
 z+="    Dim Script As String\xFE";
 z+="    \xFE";
 z+="    Script = `\xFE";
 z+="        function `:ID:`_`:ChangeOn_ParentID:`_OnChange(pObj, newid, childCtl, firstLoad) {\xFE";
 z+="            var parentObj = pObj;\xFE";
 z+="            \xFE";
 z+="            if (!childCtl) childCtl = findMyCompanion(parentObj, '`:ID:`')\xFE";
 z+="            if (!childCtl) return alert('Unable to find matching companion of `:ID:`');\xFE";
 z+="            \xFE";
 z+="            var Url = `:QuotedUrl:`;\xFE";
 z+="            var NewID = newid;\xFE";
 z+="            Url = urlCtlSubstitutions(Url, { id: newid, `:ChangeOn_ParentID:`: newid })\xFE";
 z+="\xFE";
 z+="            // Check if already loaded \xFE";
 z+="            var lastFetch = CStr($(parentObj).data('lastFetch_`:ID:`'));\xFE";
 z+="            if (lastFetch == \"..pending..\") return\xFE";
 z+="            \xFE";
 z+="            if (lastFetch && lastFetch == CStr(newid)) {\xFE";
 z+="                var a = $(parentObj).data('lastFetchData_`:ID:`');\xFE";
 z+="                if (a) `:jsLoadRoutine:`;\xFE";
 z+="                return\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            if (formVar(pObj) != newid) window._isDirty = true;\xFE";
 z+="            \xFE";
 z+="\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', \"..pending..\");\xFE";
 z+="         `\xFE";
 z+="         * OnSuccess for AJax\xFE";
 z+="         onSuccess = `\xFE";
 z+="            $(parentObj).data('lastFetchData_`:ID:`', []);\xFE";
 z+="            var a;\xFE";
 z+="            for(var key in json) { \xFE";
 z+="               a = json[key];\xFE";
 z+="               if (isArray(a)) { \xFE";
 z+="                   $(parentObj).data('lastFetchData_`:ID:`', a);\xFE";
 z+="                   break;\xFE";
 z+="                }\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            `:jsLoadRoutine:`\xFE";
 z+="\xFE";
 z+="            $(parentObj).data('lastFetch_`:ID:`', NewID);\xFE";
 z+="         `\xFE";
 z+="         \xFE";
 z+="         // QuotedUrl, jsSuccess, jsFailure, PostPayLoad, infoMsg, HeaderJSON, Ok2Cache)\xFE";
 z+="         Script = Script:@jsb_bf.Ajax('Url', onSuccess, Nothing, Nothing, Nothing, Nothing, true):`\xFE";
 z+="      }\xFE";
 z+="    `\xFE";
 z+="    Return @jsb_html.Script(Script)"
window.cached_jsb_html["reloaddatalistfromurl_onparent_change"]=z;
var z="*\xFE";
 z+="* knockout repeater * See example: http://jsfiddle.net/f9c58cse/1/\xFE";
 z+="*\xFE";
 z+="function repeaterHtml(ByVal ID As String, byval Tag As StRiNg, byval outerHtmlPrefix As StRiNg, byval innerHtml As StRiNg, byval outerHtmlSuffix As StRiNg, optional byval parentModel As String) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As Array\xFE";
 z+="    Dim CRLF As StRiNg\xFE";
 z+="    Dim KOID As String\xFE";
 z+="\xFE";
 z+="    Html = []\xFE";
 z+="    Crlf = @jsb_bf.Html(CRLF()) // Don't convert CRLF into a <br>\xFE";
 z+="    \xFE";
 z+="    if parentModel Then KOID = @NiceName(Replace(parentModel, \"().\", \"_\")):ID Else KOID = @NiceName(ID)\xFE";
 z+="    \xFE";
 z+="    if parentModel Then\xFE";
 z+="        Html[-1] = @jsb_html.Script(` \xFE";
 z+="               koModel.`:KOID:`_delRow = function(theRow, index, myParent) { \xFE";
 z+="               parsleyDestroy(); \xFE";
 z+="               myParent.`:ID:`.remove(theRow) \xFE";
 z+="            } \xFE";
 z+="        `)\xFE";
 z+="        Html[-1] = outerHtmlPrefix:Crlf\xFE";
 z+="        Html[-1] = @jsb_bf.Html(`<`:Tag:` data-bind=\"foreach: `:@NiceName(ID):`\">`):Crlf ;* nested inside another foreach: ($parent)\xFE";
 z+="    Else\xFE";
 z+="        //Html[-1] = @jsb_bf.Html(`<head><script src=\"`:@jsbRoot:`js/knockout-min.js\"></script></head>`:CRLF())\xFE";
 z+="        //Html[-1] = @jsb_bf.Html(`<head><script src=\"`:@jsbRoot:`js/komap.js\"></script></head>`:CRLF())\xFE";
 z+="        Html[-1] = @Head(@JSLink(@jsbroot:\"js/knockout-min.js\"))\xFE";
 z+="        Html[-1] = @Head(@JSLink(@jsbroot:\"js/komap.js\"))\xFE";
 z+="        Html[-1] = @jsb_bf.Html(`<input id=\"`:ID:`\" class=\"repeaterHtml\" name=\"`:ID:`\" type='hidden' />`:CRLF())\xFE";
 z+="        Html[-1] = @jsb_html.Script(`\xFE";
 z+="            if (!window.koModel) koModel = {}\xFE";
 z+="\xFE";
 z+="            koModel.`:KOID:`_delRow = function(theRow) { \xFE";
 z+="               parsleyDestroy(); \xFE";
 z+="               koModel.`:ID:`.remove(theRow) \xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            koModel.`:KOID:`_Value = function() { \xFE";
 z+="               return ko.mapping.toJSON(koModel.`:KOID:`);\xFE";
 z+="            }\xFE";
 z+="\xFE";
 z+="            $( 'form' ).on(\"submit.`:ID:`\", function( event ) {\xFE";
 z+="                 var V = ko.mapping.toJSON(koModel.`:KOID:`);\xFE";
 z+="                 $(\"#`:ID:`\").val(V);\xFE";
 z+="                 $( 'form' ).off(\"submit.`:KOID:`\")\xFE";
 z+="                 return true;\xFE";
 z+="            });\xFE";
 z+="\xFE";
 z+="            ko.bindingHandlers.addIfNotInList = {\xFE";
 z+="                 update: function(element, valueAccessor, allBindings, viewModel, bindingContext) {\xFE";
 z+="                     var found = false;\xFE";
 z+="                     var entry, value;\xFE";
 z+="            \xFE";
 z+="                     value = allBindings().value\xFE";
 z+="                     if (typeof(value) == \"function\") value = value();\xFE";
 z+="                     if (isString(value) || isNumber(value)) {\xFE";
 z+="                         if (allBindings().options) {\xFE";
 z+="                              allBindings().options().forEach(function(entry) {\xFE";
 z+="                                 if (entry == value) found = true;\xFE";
 z+="                              })\xFE";
 z+="                              if (!found) allBindings().options().push(value);\xFE";
 z+="                         } else {\xFE";
 z+="                              $(element).find('option').each(function() {\xFE";
 z+="                                 if (this.value == value) found = true;\xFE";
 z+="                              });\xFE";
 z+="                              if (!found)  {\xFE";
 z+="                                $(element).append($('<option></option>').attr(\"value\", value))\xFE";
 z+="                              }\xFE";
 z+="                         }\xFE";
 z+="                     }\xFE";
 z+="                }\xFE";
 z+="            };\xFE";
 z+="        `)\xFE";
 z+="        \xFE";
 z+="        Html[-1] = outerHtmlPrefix:Crlf\xFE";
 z+="        Html[-1] = @jsb_bf.Html(`<`:Tag:` data-bind=\"foreach: $data.`:ID:`\">`):Crlf\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Html[-1] = innerHtml:Crlf\xFE";
 z+="    Html[-1] = @jsb_bf.Html(`</`:Tag:`>`):Crlf\xFE";
 z+="    Html[-1] = outerHtmlSuffix:Crlf\xFE";
 z+="\xFE";
 z+="    return Join(Html, '')\xFE";
 z+="End Function"
window.cached_jsb_html["repeaterhtml"]=z;
var z="function repeaterLoad(ByVal ID As String, byval newRow As String, byval jsonArray As Object, optional byval parentModel As String) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="\xFE";
 z+="    Dim PARENT As String\xFE";
 z+="    Dim KOID As String\xFE";
 z+="    Dim S As String\xFE";
 z+="\xFE";
 z+="    s = `if (!window.koModel) koModel = {}`:CRLF()\xFE";
 z+="    if !newRow Then newRow = {}\xFE";
 z+="    if parentModel Then \xFE";
 z+="        Parent = `koModel.`:@NiceName(Replace(parentModel, \"().\", \"\"))\xFE";
 z+="        KOID = Parent:\"_\":@niceName(ID)\xFE";
 z+="        s := KOID:`_DefaultRow = `:Change(newRow, Chr(160), Chr(32)):CRLF()\xFE";
 z+="        s := KOID:`_newRow = function(index) { \xFE";
 z+="            `:Parent:`()[index].`:@niceName(ID):`.push(ko.mapping.fromJS(`:KOID:`_DefaultRow)); \xFE";
 z+="            }`:CRLF()\xFE";
 z+="    Else \xFE";
 z+="        KOID = `koModel.`:@NiceName(ID)\xFE";
 z+="        s := KOID:`_DefaultRow = `:Change(newRow, Chr(160), Chr(32)):CRLF()\xFE";
 z+="        s := KOID:`_newRow = function() { \xFE";
 z+="                `:KOID:`.push(ko.mapping.fromJS(`:KOID:`_DefaultRow)); \xFE";
 z+="            }`:CRLF()\xFE";
 z+="        \xFE";
 z+="        // LOAD DATA\xFE";
 z+="        if TypeOf(jsonArray) = \"Array\" Then\xFE";
 z+="            s := KOID:` = makeObservableKO([`:Change(Join(jsonArray, \",\"), CHR(160), Chr(32)):`], `:KOID:`_DefaultRow);`:CRLF()\xFE";
 z+="        Else\xFE";
 z+="            s := KOID:` = makeObservableKO(`:ID:`, `:KOID:`_DefaultRow)`:CRLF()\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    // Can only do this once, and after all models are setup\xFE";
 z+="    s := `$(document).ready(function () { rebindKnockout() }); `:CRLF()\xFE";
 z+="\xFE";
 z+="    return @Script(S)\xFE";
 z+="end function"
window.cached_jsb_html["repeaterload"]=z;
window.cached_jsb_html["requestfile"]="// Use this function to get upload results = @REQUESTFILE(ID)\xFEFunction RequestFile(ByVal ID As String) As Boolean\xFE* $options aspx, gae, aspxc-\xFE    Dim FILENAME As String\xFE\xFE    FileName = @REQUEST.FileName(ID)\xFE    If !FileName Then return false\xFE    return @REQUEST.FILE(ID)\xFEend function\xFE\xFEFunction RequestFile(ByVal ID As String) As Boolean\xFE* $options js, aspxc-\xFE* $options external formFile\xFE    \xFE    FileName = @REQUEST.FileName(ID)\xFE    If !FileName Then return false\xFE    results = \"\"\xFE    formFile(me, ID, CallBack(results))\xFE    return results\xFEend function";
var z="* PRINT RESETBTN('id', 'Reset', { style: 'width: 180px' }, 'success', 'lg' )\xFE";
 z+="\xFE";
 z+="* btnType: primary, secondary, success, warning, danger, link\xFE";
 z+="* btnSize: lg, sm\xFE";
 z+="FUNCTION ResetBtn(ByVal ID As String, optional byval DisplayText As String, optional byval AdditionalAttributes As Object, optional byval btnType As String, optional byval btnSize As String) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if IsMissing(DisplayText) Then DisplayText = \"RESET\"\xFE";
 z+="    \xFE";
 z+="    AdditionalAttributes = @MergeAttribute(\"onclick\", `parsleyDestroy();`, \";\", AdditionalAttributes)\xFE";
 z+="    AdditionalAttributes  = @MergeAttribute(\"class\", \"ResetBtn\", \" \", AdditionalAttributes)\xFE";
 z+="    if !btnType then btnType = \"default\"\xFE";
 z+="    if left(btnType, 4) <> \"btn-\" then btnType = \"btn-\":btnType\xFE";
 z+="    if Not(InStr(AdditionalAttributes, \"btn-\")) Then AdditionalAttributes = @MergeAttribute(\"class\", \"btn \":btnType, \" \", AdditionalAttributes)\xFE";
 z+="\xFE";
 z+="    if btnSize Then\xFE";
 z+="        if left(btnSize, 4) <> \"btn-\" then btnSize = \"btn-\":btnSize\xFE";
 z+="        AdditionalAttributes = @MergeAttribute(\"class\", btnSize, \" \", AdditionalAttributes)\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    HTML = CHR(28):\"<input \":JoinAttributes(AdditionalAttributes)\xFE";
 z+="    IF ID THEN Html := \" id='\":ID:\"'\" ;*  name='\":ID:\"'\"\xFE";
 z+="    Html := 'type=\"reset\" value=\"':CHR(29):@jsb_bf.Language(DisplayText):CHR(28):'\" />&nbsp;':CHR(29)\xFE";
 z+="    RETURN HTML"
window.cached_jsb_html["resetbtn"]=z;
var z="*\xFE";
 z+="* Print @(-1):@jsb_Html.Rows2(\"80%\", \"This is row1\", \"20px\", \"This is row 2\", \"color: blue; overflow: auto\")\xFE";
 z+="*\xFE";
 z+="FUNCTION Rows2(byval R1Height As String, byval R1Content As StRiNg, optional byval R2Height As String, optional byval R2Content As StRiNg, optional byval R1Style As Object, optional byval R2Style As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim R1H As String\xFE";
 z+="    Dim R2H As String\xFE";
 z+="    Dim ID As String\xFE";
 z+="    Dim R1C As String\xFE";
 z+="    Dim R2C As String\xFE";
 z+="\xFE";
 z+="    if IsMissing(R2Height) Then\xFE";
 z+="        R2Content = R1Content\xFE";
 z+="        R1Content = R1Height\xFE";
 z+="        R1Height = \"50%\"\xFE";
 z+="        R2Height = \"50%\"\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if isJSON(R1Style) Then\xFE";
 z+="        R1Style = MergeAttribute(\"style\", \"\", \";\", R1Style)\xFE";
 z+="    Elseif !R1Style Then\xFE";
 z+="        if InStr(R1Height, \"%\") Then R1Style = \"overflow-y: auto\" Else R1Style = \"overflow-y: hidden\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if isJSON(R2Style) Then\xFE";
 z+="        R2Style = MergeAttribute(\"style\", \"\", \";\", R2Style)\xFE";
 z+="    Elseif !R2Style Then\xFE";
 z+="        if InStr(R2Height, \"%\") Then R2Style = \"overflow-y: auto\" Else R2Style = \"overflow-y: hidden\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If InStr(R1Height, \"%\") And (InStr(R2Height, \"px\") Or R2Height = \"\") Then\xFE";
 z+="        R1h = \"position:absolute; top:0; bottom:\":val(R2Height)+1:\"px;\"\xFE";
 z+="        R2h = \"position:absolute; bottom:0;\"\xFE";
 z+="        If R2Height Then R2h := \" height:\":R2Height:\";\"\xFE";
 z+="        ID = \"ROWS2PF_\":RND(999)\xFE";
 z+="        r1c = 'ROWS2PF_a'\xFE";
 z+="        r2c = 'ROWS2PF_b'\xFE";
 z+="\xFE";
 z+="    ElseIf (InStr(R1Height, \"px\") Or R1Height = \"\") And InStr(R2Height, \"%\") Then\xFE";
 z+="        R1h = \"position:relative; top:0;\"\xFE";
 z+="        R2h = \"position:absolute; bottom:0;\"\xFE";
 z+="        \xFE";
 z+="        If R1Height Then \xFE";
 z+="            R1h := \" height:\":R1Height:\";\"\xFE";
 z+="            R2h := \" top:\":val(R1Height):\"px;\"\xFE";
 z+="        Else\xFE";
 z+="            R1h := \" height:100%;\"\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        ID = \"ROWS2FP_\":RND(999)\xFE";
 z+="        r1c = 'ROWS2FP_a'\xFE";
 z+="        r2c = 'ROWS2FP_b'\xFE";
 z+="            \xFE";
 z+="    ElseIf InStr(R1Height, \"%\") And InStr(R2Height, \"%\") Then\xFE";
 z+="        if R1Height then R1h = \"position:relative; height: \":R1Height:\";\"\xFE";
 z+="        if R2Height Then R2h = \"position:relative; height: \":R2Height:\";\"\xFE";
 z+="        ID = \"ROWS2PP_\":RND(999)\xFE";
 z+="        r1c = 'ROWS2FP_a'\xFE";
 z+="        r2c = 'ROWS2FP_b' \xFE";
 z+="    Else\xFE";
 z+="\xFE";
 z+="        if R1Height then R1h = \"position:relative; height: \":R1Height:\";\"\xFE";
 z+="        if R2Height Then R2h = \"position:relative; height: \":R2Height:\";\"\xFE";
 z+="        ID = \"ROWS2FF_\":RND(999)\xFE";
 z+="        r1c = 'ROWS2FF_a'\xFE";
 z+="        r2c = 'ROWS2FF_b' \xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    return Chr(28):`\xFE";
 z+="      <div id='`:ID:`1' style=\"display: block; left: 0; right: 0; `:R1h:` `:R1Style:`\" class=\"ROWS2_TOP `:r1c:`\">`:Chr(29):R1Content:Chr(28):`</div>\xFE";
 z+="      <div id='`:ID:`2' style=\"display: block; left: 0; right: 0; `:R2h:` `:R2Style:`\" class=\"ROWS2_BOT `:r2c:`\">`:Chr(29):R2Content:Chr(28):`</div>\xFE";
 z+="   `:Chr(29)"
window.cached_jsb_html["rows2"]=z;
window.cached_jsb_html["saveanchor"]="* A Save btn made to look like an anchor\xFEFUNCTION SaveAnchor(ByVal ID As Object, ByVal DefaultValue As Object, BYVAL DisplayText As Object, optional ByVal AdditionalAttributes As Object, optional ByVal ParsleyCheck As StRiNg) As StRiNg\xFE    $options async-\xFE    RETURN @JSB_HTML.SUBMITANCHOR(ID, DefaultValue, DisplayText, AdditionalAttributes, True)\xFEEND FUNCTION";
window.cached_jsb_html["savebtn"]="*\xFE* Just like SubmitBtn but does parsleyIsValid instead of parsleyDestroy\xFE*\xFE* btnType: primary, secondary, success, warning, danger, link\xFE* btnSize: lg, sm\xFE*\xFEfunction SaveBtn(Optional ByVal Id As Object, Optional Byval DefaultValue As Object, Optional Byval DisplayText As Object, Optional Byval AdditionalAttributes As Object, Optional Byval btnType As String, Optional Byval btnSize As String, Optional ByVal onCLick As String) As StRiNg\xFE    $options async-\xFE    Return Submitbtn(Id, DefaultValue, DisplayText, AdditionalAttributes, btnType, btnSize, `if (!parsleyIsValid(true)) return false; `:onClick)\xFEEnd function";
window.cached_jsb_html["script"]="function Script(byval s As String) As String\xFE* $options async-\xFEReturn CHR(28):CRLF():`<script type=\"text/javascript\">`:CRLF():Replace(s, Chr(254), CRLF()):CRLF():'</script>':CRLF():CHR(29)";
window.cached_jsb_html["scriptsrc"]="Function ScriptSrc(byval Url As String) As String\xFE    $options async-\xFE    Return Chr(28):`<script src=`:jsEscapeHREF(Url):`></script>`:crlf():Chr(29)";
window.cached_jsb_html["setattribute"]="function setAttribute(byval CONTROLID As String, byval ATTRIBUTENAME As StRiNg, byval VALUE As StRiNg) As StRiNg\xFE    $options async-\xFE    \xFE    Dim HTML As String\xFE\xFE    if Left(ControlID, 1) <> \".\" And Left(ControlID, 1) <> \"#\" and ControlID <> \"body\" and ControlID <> \"window\" then ControlID = \"#\":ControlID\xFE    HTML = Chr(28):`<script type=\"text/javascript\">`\xFE    Html := '    $(\"':CONTROLID:'\").attr(\"':ATTRIBUTENAME:'\", \"':VALUE:'\");'\xFE    Html := '</script>':CHR(29)\xFE    RETURN HTML";
window.cached_jsb_html["setclass"]="function SetClass(ByVal CONTROLID As String, byval CLASSNAME As StRiNg) As StRiNg\xFE    $options async-\xFE    \xFE    Dim HTML As String\xFE\xFE    if Left(ControlID, 1) <> \".\" And Left(ControlID, 1) <> \"#\" and ControlID <> \"body\" and ControlID <> \"window\" then ControlID = \"#\":ControlID\xFE    HTML = Chr(28):`<script type=\"text/javascript\">`\xFE    Html := '    $(\"':CONTROLID:'\").addClass(\"':CLASSNAME:'\");'\xFE    Html := '</script>':CHR(29)\xFE    RETURN HTML";
window.cached_jsb_html["setfocus"]="function SetFocus(ByVal CONTROLID As String) As StRiNg\xFE    $options async-\xFE    \xFE    Dim HTML As String\xFE\xFE    if Left(ControlID, 1) <> \".\" And Left(ControlID, 1) <> \"#\" and ControlID <> \"body\" and ControlID <> \"window\" then ControlID = \"#\":ControlID\xFE    HTML = Chr(28):`<script type=\"text/javascript\">`\xFE    Html := '    $(\"':CONTROLID:'\").focus();'\xFE    Html := '</script>':CHR(29)\xFE    RETURN HTML";
var z="*   Print @div('id1', @Center(\"it's a good day for a penut butter cup\")):@setStyle('id1', 'background-color', 'cyan') \xFE";
 z+="function setStyle(Byval Controlid As String, Byval jsonOrATTRIBUTENAME As Array, optional Byval Value As String) As Object\xFE";
 z+="* $options async-\xFE";
 z+="    Dim STYLENAME As StRiNg\xFE";
 z+="    Dim HTML As Object\xFE";
 z+="\xFE";
 z+="    If Left(ControlID, 1) <> \".\" And Left(ControlID, 1) <> \"#\" And ControlID <> \"body\" And ControlID <> \"window\" Then ControlID = \"#\":ControlID\xFE";
 z+="    \xFE";
 z+="    If isMissing(Value) Then\xFE";
 z+="        Html = []\xFE";
 z+="        For Each Stylename In jsonOrATTRIBUTENAME\xFE";
 z+="            Html[-1] = '$(\"':ControlID:'\").css(':jsEscapeString(Stylename):', ':jsEscapeString(jsonOrATTRIBUTENAME[Stylename]):');'\xFE";
 z+="        Next\xFE";
 z+="        Return @Script(Join(Html, Crlf()))\xFE";
 z+="    Else\xFE";
 z+="        Html = Chr(28):`<script type=\"text/javascript\">`\xFE";
 z+="        Html := '    $(\"':ControlID:'\").css(':jsEscapeString(jsonOrATTRIBUTENAME):', ':jsEscapeString(Value):');'\xFE";
 z+="        Html := '</script>':Chr(29)\xFE";
 z+="        Return Html\xFE";
 z+="    End If\xFE";
 z+="End function"
window.cached_jsb_html["setstyle"]=z;
var z="* print slider(\"id\", 50, 1, 100, 1, { onchange: ' alert(\"abc\")'} ) ;* one time event per change\xFE";
 z+="* print slider(\"id\", 50, 1, 100, 1, { oninput: ' $(\"body\").append(this.value + \"<br>\")'} );* real time events per step\xFE";
 z+="* print \xFE";
 z+="\xFE";
 z+="* Do form AdditionalAttributes[-1] = `onkeypress=\"if (event.keyCode == 13) form.submit();\"`\xFE";
 z+="FUNCTION Slider(ByVal ID As String, ByVal DefaultValue As String, byval MinValue As StriNg, byval MaxValue As Integer, optional byval StepSize As Integer, optional byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="   $options async-\xFE";
 z+="   \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="   if ID Then ID = \"id='\":ID:\"' name='\":ID:\"' \"\xFE";
 z+="   HTML = CHR(28):\"<input \":ID:\"tabindex='-1' type='range' \":Join(@MergeAttribute(\"class\", \"Slider form-control\", \" \", AdditionalAttributes), \" \")\xFE";
 z+="\xFE";
 z+="   if !MinValue Then MinValue = \"0\"\xFE";
 z+="   if !MaxValue Then MaxValue = MinValue + 100\xFE";
 z+="   if DEFAULTVALUE <= MinValue Then DEFAULTVALUE = MinValue\xFE";
 z+="   if DEFAULTVALUE > MaxValue Then DEFAULTVALUE = MaxValue\xFE";
 z+="   if !StepSize Then StepSize = 1\xFE";
 z+="   \xFE";
 z+="   Html := \" min=\":MinValue:\" max=\":MaxValue:\" value=\":DEFAULTVALUE\xFE";
 z+="   if StepSize then Html := \" step=\":StepSize\xFE";
 z+="   \xFE";
 z+="   Html := \" />\":CHR(29)\xFE";
 z+="   RETURN HTML"
window.cached_jsb_html["slider"]=z;
var z="***************** HTML *****************************\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="*  To use BootStrap add a \"form-control\" class:  \xFE";
 z+="*     Fractions = [\"0\", \"1/16\", \"1/8\", \"3/16\", \"1/4\", \"5/16\", \"3/8\",  \"7/16\",  \"1/2\",  \"9/16\",  \"5/8\",  \"11/16\",  \"3/4\",  \"13/16\",  \"7/8\",  \"15/16\"]\xFE";
 z+="*     print @sliderLabeled('id', [\"0\", \"1/16\", \"1/8\", \"3/16\", \"1/4\"], 4, false /* addBlank */, false /* ReadOnly */, { style: \"background-color: red\" })\xFE";
 z+="*\xFE";
 z+="**                          http://simeydotme.github.io/jQuery-ui-Slider-Pips/\xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="* ============================= HTML =============================\xFE";
 z+="FUNCTION sliderLabeled(ByVal ID As String, ByVal Values As Object, optional byval  DefaultValue As String, optional byval addBlank As StRiNg, optional ByVal ReadOnly As Boolean, optional byval AdditionalAttributes As Object, optional byval multiValuedData As StRiNg) As StRiNg \xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    If IsMissing(multiValuedData) Then multiValuedData = True\xFE";
 z+="    \xFE";
 z+="    Dim Html As String = @Head(@CssLink(@jsbroot:\"css/slider_pips.css\"))\xFE";
 z+="    Html := @Head(@JSLink(@jsbroot:\"js/slider_pips.js\"))\xFE";
 z+="    \xFE";
 z+="    Dim CT As String\xFE";
 z+="    If ReadOnly Then CT = \"sliderLabeled_ReadOnly\" Else CT = \"sliderLabeled\"\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    Dim Vals As Array = makeArray(Values)\xFE";
 z+="    Dim SubDelimiter As String = @NI\xFE";
 z+="    If !InStr(Values, SubDelimiter) Then SubDelimiter = \"\"\xFE";
 z+="\xFE";
 z+="    Dim foundDefaultValue As Boolean = Len(DefaultValue)=0\xFE";
 z+="\xFE";
 z+="    Dim iOpts As Array = []\xFE";
 z+="    Dim iVals As Array = []\xFE";
 z+="\xFE";
 z+="    if addBlank Then iOpts[-1] = ''\xFE";
 z+="\xFE";
 z+="    If (SubDelimiter And multiValuedData) Or SubDelimiter >= Chr(252) Then\xFE";
 z+="        For Each V As String In Vals\xFE";
 z+="            Dim S As String = \"\"\xFE";
 z+="            If InStr(V, SubDelimiter) Or Len(iVals) Then\xFE";
 z+="                Dim Display As String = Field(V, SubDelimiter, 1)\xFE";
 z+="                V = @DropLeft(V, SubDelimiter)\xFE";
 z+="                IF V = DefaultValue And Len(DefaultValue) THEN foundDefaultValue = True\xFE";
 z+="                iOpts[-1] = CStr(Display)\xFE";
 z+="                iVals[-1] = V\xFE";
 z+="            Else\xFE";
 z+="                IF V = DefaultValue And Len(DefaultValue) THEN foundDefaultValue = True\xFE";
 z+="                iOpts[-1] = CStr(V)\xFE";
 z+="            End If\xFE";
 z+="        NEXT\xFE";
 z+="    ElseIf Vals Then\xFE";
 z+="        for each V in Vals\xFE";
 z+="            IF V = DefaultValue And Len(DefaultValue) THEN foundDefaultValue = True\xFE";
 z+="            iOpts[-1] = CStr(V)\xFE";
 z+="        next\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If Not(foundDefaultValue) Then \xFE";
 z+="        iOpts[-1] = CStr(DefaultValue)\xFE";
 z+="        if Len(iVals) Then iVals[-1] = CStr(DefaultValue)\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="   \xFE";
 z+="    if addBlank and Len(iVals) Then iVals.Insert(1, '')\xFE";
 z+="\xFE";
 z+="    Dim AA As Array  = @MergeAttribute(\"class\", CT, \" \", AdditionalAttributes)\xFE";
 z+="    'AA  = @MergeAttribute(\"class\", \"form-control\", \" \", AA)\xFE";
 z+="    AA  = @MergeAttribute(\"style\", \"border: none\", \";\", AA)\xFE";
 z+="    if !iVals Then iVals = \"null\"\xFE";
 z+="    \xFE";
 z+="    if ID then \xFE";
 z+="        HTML := CHR(28):`\xFE";
 z+="            <span class=\"form-control ui-widget-content slider-labeled\"><div id='slider_`:ID:`' `:uiAdditionalAttributes(AA):`>\xFE";
 z+="                <div id='handle_`:ID:`' class=\"ui-slider-handle ui-slider-handle-custom\" style=\"margin-left: -25px\" ></div>\xFE";
 z+="            </div>\xFE";
 z+="            <input id='`:ID:`' name='`:ID:`' type='text' style='display:none' `:dataAdditionalAttributes(AA):` class='SliderLabeled' />\xFE";
 z+="            </span>\xFE";
 z+="        `:Chr(29)\xFE";
 z+="        if !IsNum(DefaultValue) Or Len(DefaultValue) = 0 Then DefaultValue = \"'\":DefaultValue:\"'\"\xFE";
 z+="        HTML := @script(`sliderLabeled_onLoad($(\"#`:ID:`\"), `:DefaultValue:`, `:json2string(iOpts):`, `:Val(ReadOnly):`, `:json2string(iVals):`)`)\xFE";
 z+="    else\xFE";
 z+="        HTML := CHR(28):`\xFE";
 z+="            <span class=\"form-control ui-widget-content slider-labeled\"><div `:uiAdditionalAttributes(AA):`>\xFE";
 z+="                <div class=\"ui-slider-handle ui-slider-handle-custom\" style=\"margin-left: -25px\" ></div></div>\xFE";
 z+="            </div>\xFE";
 z+="            <input `:dataAdditionalAttributes(AA):` class='SliderLabeled' type='text' style='color: back;' myOpts='`:HtmlEncode(json2string(iOpts)):`'  myVals='`:HtmlEncode(json2string(iVals)):`' />\xFE";
 z+="            </span>\xFE";
 z+="        `:Chr(29)  ;* style='display:none'\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    RETURN HTML"
window.cached_jsb_html["sliderlabeled"]=z;
var z="/*\xFE";
 z+="    Imgs = Get(\"http://crossorigin.me/https://photos.google.com/share/AF1QipMzCmoD0CU2jFz3xI1kFuZIcewdefUbwduTdkr6Ej13be_Ex5DHEnCvS2qkmWQDyw?key=R0loV1JOTnhvTzlHNlJOajJnVDBDLTNmT0w5X2NR\", \"get\")\xFE";
 z+="    Imgs = Split(Imgs, '[\"https://lh3.googleusercontent.com/')\xFE";
 z+="    Imgs.Delete(1)\xFE";
 z+="    arrayOfPhoto_URLs = []\xFE";
 z+="    For Each Url In Imgs\xFE";
 z+="        Url = Field(Url, '\"', 1)\xFE";
 z+="        arrayOfPhoto_URLs[-1] = \"https://lh3.googleusercontent.com/\":Url\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    Print Slideshow(arrayOfPhoto_URLs)\xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="/*\xFE";
 z+="    arrayOfPhoto_URLs = [\"data:image/jpeg;base64,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\",\xFE";
 z+="    \"data:image/jpeg;base64,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\",\xFE";
 z+="    \"data:image/jpeg;base64,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\",\xFE";
 z+="    \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxISEBUQEhAVEBAPDw8QDw8VEBUQFQ8PFRUXFhURFRUYHSggGBolHRUVITEhJSkrLi4uFx8zODMtNygtLisBCgoKDg0OFxAQGy8lHR0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLf/AABEIAKgBLAMBEQACEQEDEQH/xAAbAAADAQEBAQEAAAAAAAAAAAABAgMEAAUGB//EAEMQAAEDAQQGBggDBgYDAQAAAAEAAgMRBBIhUTFBYXGRoQUTIlKBsQYUQlOSwdHwMmLhFSNygrLxFjNjc6LCQ4OjB//EABoBAAMBAQEBAAAAAAAAAAAAAAECAwAEBQb/xAA6EQACAgACBggEBQMFAQEAAAAAAQIRAxITITFBUaEEYXGRscHR8BRSgeEFFSIy8ULS4mJygqLCkjP/2gAMAwEAAhEDEQA/APydcZ9KMEApBWHSCgEIQCggLDDBYKGAQHQQEB0h2hKykUUaEpVIcBAqkOEGUQ4KUomMCgOVY5K0aigolNQpCIRCiEUlMAFVjAqsY4lYFikoitiko0TbAiLZywbDVA1nVRo1nVQo1nXlqNmFqiLmDVY1gqsazqrBzHqN9HbUXFogcXDSKt7xbnmCPAqminwON9P6PV5vEhbOhbREzrJIi1nZ7VWkdqt3QddFnCSVtGw+lYOJLLGVs89KX1HmBdB4qGCwyQQELHoIagHKMGrBoYNQsdRDdQsbKMAhY6iMAhY6iUaECsUOAlKJDgIFEggIDJBWGCEBkMCgMmMChQw15CggRMCiwKAQiCgUWAwFEVilERioiARAdVYFgqsCwXlqBmAXI0K5AqsCwgoDJhWGOWMcsY9V/T8hpUu7JBb++fQEEEUFdRaCMiBkraVvcecugRjqvlH0I23pmSSPq3F13DDrHuFAcBQmiEsRtUNhdEjhzzp8kebVIdRi6tWs81YbCI0LGUGMGIWMoMai1j5Q3ULDlCAhYyiOAhY6iMGoFFEcNQsoojBqAyiEBAdIcIDpBAQHSDRANBosGhgFhqCAgMkNRAOU6i1hynUWsGUFEQUKQiK0KQsK0KQiI0KQiI0KQiI0KURQFEVgWFFRAMsY6qFBzBvLUHMAuWoDkC8iCwoGOWMcsEiGp7OdRCGoWPlGDUA5Q3FrDlOuLWHIddWs2UYNQsZRHaECiQwCBRIYBCx1EICFhUQ3UBsoaLBoICwaGAQHSGDULHUSjY0rY1DiFLmMN1CGcwDCjnMI6JFSMIWprA0IQmsRxEIRJtCkIiNCEIk2hSERGhSERGhSiIIURGKSiI2CqILZ1VqNbOBQMmx2oFEUCBVIaiA2VHUWNRFqY50OGoWUURw1CyiiMGoWOoBEaFjaMIiWzG0YTChmNkBcRsGU4NWsZRCAgOkOGoDBohYyQwCwyQwahYaGEaWx0XjhSOQTVHApOYCzYEjmax+pQzAsBhWzGsk+BOphM0kKopBMz41RMxIhOhGhHBMTaJkIkmhSmJtCEIiMUok2hHBERilERioiHVWNaBfWoGdBD1qGUxw9LQ6xBhItQ6xA30KDnNIspU9IdGiQRZzkhnGUEUFmKXSIZRR3q5yWzoakO2AoOaCWZAkcwWaWWUHUpPEaFbCejidC2mFzIU9HOGpHTo2ZE32I5JlioZSJ9QQmz2NYQzYhY1jNiQcg2VbZkrmHMWZZ1NzDmNDLOkcw5jRHBqpUnADTU5KbmJKdaz3rD6KWiTEtEQPfND8IqeNFzS6VBdZ5mN+LYGHqTvs9T1GegjjptAG6In/sp/GdRxP8dS/o5/YhafQaYDsSMk2GsZ8NI5p49KjvKYf47hP98WufofO9IdGSwm7LG6MnRUYHc4YHwXRDEUtjPXwOlYeMrw5X74bTz5IlZSOlSMc0KtGQ5hkZRWTMSITonJE3BMSaJkJibQpRJsQoiMUhEmxCiTYhTE2KURGhSiIxURTqrAOvlajZmd1i1B0jPogF557hZimzGuINKlKwGlsIyUnIFjsg2IOQLLtswyU3NgsqyEZJXJiNl2xjJTcmLYTEFswLJPs1UymHMY57ErRxR1MyusaqsUopidQmzjqRRkaVsNmmNim2Y2WKxukeGMFXHkNZOxRniKKtksXGjhxcpbD7bonotkAqBek1yEY7hkF5mLjyxH1HznSulTx3r1LgexHIpWcEomlj0yZJxKhOmTJ2izskaWPaHtdpaRUFMm07Q0MSWHJSi6aPz70p9GjB+9jq6AnGuJiJ0AnWMjx29+Dj5tT2n1X4b+J6f9E9U/H7+0fKSxrrjI9uLMFojXRFjmF7VdMDRNwTEmiZTEmhCmJMQoiMUok2IUSbEKIjFKYmxCihGAoisBWFFWACiIp9o2KmoLxnKz3xw0ZBLbMOxuxBsxpjdTUFJqxTQ2RqRpgHqM+aUUZrzkg0gMq2TMJXEUdrwUrTFHCADiFjEnw1TKQUyL7KnWIOpk/Vk2copjthSuQc59P0FGImVp230JOQ1NXndIxHKVbkeP0yTxZ1uR67bWuY4HglBbNiFi6EtHbEVInLBNsNpqnUjnlhGkFUTsi1QssYc0tcA5rgWuadBB0gop07QYycWpR2o/J/SDow2ed0WkDtMPejOg/LeCvVwp5opn3HQekrpGDGe/f2nh2hi6os9BHmzNXRFhM5VETkibkxFk3JkTYpRJsQpibEciTYhREYpRJsUphBSiKwLCgKwAIin3vrTdbQvB0ctzPdofrY8qJcswUwCePNHJMNMJnZmChkkamSktLU6gzUxBaUdGaizLS7akcEK0WZanZpHhoVxRpjtVdKm8MRxKCXalygoq2duY4pcrBlY3WtzCGVmpndYM1qZqYpeFqYVFjxNBIGmpQk2lZpNxVntxuOvBcLo8+SW40xvUmiMkaWCqm9RJ6jRHChmRGUzVEQjniRkmboXtzTrEhvZzTTLXgm00OJOmfHf/olnBbFKNIc6I7QRebwuu4rt6Hixk3FPrPf/AsRqU8P6+Xmj8/nC9SLPqYnmWgLpgMZHKyFkTcmIsmUyIsQok2KURGIUSbEKYmxCiIKURGBMKxSsKzisKKsA9T1w94rm0aPX06FNrOaOjQH0g71s5raNA+JHbazmg8NDrHsu22nWpvCRRYiZojtbdam8NjWjRFa296inLDfADRf1qvtBJo63Ayim0ka6o6M2UlJbTnzTLCGUDP64cyqaJD5UVZbjmUrwUNo0zQy211qbwgrDNUNoJUpQQdGj3PRp160xNOgucD8LqLh6YqwZNe9ZwfiCy9Hm171o+9f0e05LwFjM+ZXSJIQ9GjNNp2N8Szm2E5oPFA8c0RwEa1NzJOd7igi2oZhcwQ2mtBsDdlb6ShMp876dPHqzf8AfZT4Xr0vwtPTPs80er+DJ/EP/a/FH51Mvo4n1kTzbQuiA5jcroWRJyZEWTKJJilMTYhREYpRJsQok2IQiI0AoiNC0RFaAQiLQKIgoFFgUaurUrO3Rs7qlswdEzuqWzG0THEZQsdYTQ10oWPlYQEBqYbq1hys4ArajVIYVQ1DpSGAKA6THDULHSY7WpWyiLxNU2xzdC5QkgnpdH2zq5GSdx7XeAOI4LnxcLPFx4o58fB0kJQ4o/QB03H3xxXz3wk+B8v8DicA/tuPvDit8JLgD4KfA79ts7w4rfCT4G+CnwO/bcfeHFb4SfA3wU+B37bZ3hxW+ElwN8FPgd+2o+8OK3ws+Bvgp8Dv22zvDit8JLgb4KfA+d9LulmyBkbTUAue7fob/wBl6P4f0ZwzSfYet+F9ElhuU2ur3yPlJXr1oo9pKjDMrRCZHtVkxWTc1MmTaELUbJuIhamsm4sUtRsRwYpYjYrgxSxGybgxDGUbEeGwGMrWLo2KYzkjYujZ3VlbMDRMHVnJHMDRMHVnJbMDRMr6w7NLkRb4jF4hFodmhkQ66RicRhaDmUMqGXSJ8RhaDmVsiGXSJcRxaNpSuA66RLiyjZ9/JK4DaZ8SzbQO6T4pHAOllxKttQ7nNK8N8Q6SXEuy0D3Y4qbg+Ic0uJoZM33YU3F8Q5pcTRG5vu28FNqXENy4mqNjPdt4KbcuJnm4mhkEfum8FNznxJuU1/UaGWSL3TeCm8SfzE3iT+Y12Xo2JzgOqbiQNCjPHxEm8zIYnSMSMW8zPo2ei9n9234GrzX+IY3E8l/ieP8AM+9jj0Xs3u2/A36IfmGPxE/M+kfM+9jD0Ys3um/CPoh+YY/zMH5n0j5n3h/wxZvdM+EfRD8wx/mZvzPpHzPvO/wxZvct+ELfmGP8zN+Z9I+Z94D6MWb3TfhCP5hj/MzfmfSPmfeKfRize6b8IR+Px/mYy/E+kfMzyemeg4I6FsTcfyhdfRul4s7uTO7onTcbEtSkzxJLHH7tvwhdqxZ8WeisWb3szSWdncb8IVVOXEqpSe8zSMb3G/CFROXEor4mWVzR7LfhCrFPiNr4mSSf8rfhCsodYLfEzPtexvwqiwxcz4kXW05N+FOsJCub4knWx2zgnWEibxZLeSda3bOCZYaEePJbybrU7NMsNE30mfEQ2p2abRoR9LxOIptbs0dHEX4vE4im1uzW0cRX0zF4g9bdmjo4i/GYvE71p+a2jiH4vF4hogY6iwRg1AKQ7WoWOirY0rY6LMiSOQ1lmRJHINl2WY5JHMOY0x2Y5KUphzGlkByU3MKkaI4lNyGUjXFGothcjTG1TbJyZpjapNkmz0ejR+8bvXNjftZx9I//ADZ9U168pxPEaKNclaFaGDkKBQ1UBTlqMCqNBEcUyQyPD6fd2B/F8l3dFWtno9BX6mfNTFelE9mJimKvE6ImKYq0SyME7l0RRjDK5WigMxyFWQjZJxTkpMmSmRGTJOKYjJiEook2ISmJtiEoiNiko0LYCUaFbBVYWz0wxc9npDiPefkhZhmx7EGw0VZDs8UrkMqLNiCRyDZpjYNGFVJs1mmIbPI+KnI1mhg+81Ngs1Rs14qTZrLNZp8qpGxkyjYdyVyGzl2M4KbYcxVrfHwSNiuRaMJGI2bbEaPG9QxP2s5sb9jPoIpPunNcEonlSiaGP289Kk0TaLg54b8ElEmdeGfzRUWagh2xNlNR16urPJHIYjMaeOqn0CoooaJ4XTrjdGOtdfR46z0+hJZj5yVy74o9eJilcrxReJimdsVooqefM5dEUazFK5XihWzK8qiJtknFOSkyTimIyZNxTIjJkyUyJNiEok2xSURGxURGwVWFbAiA9prguRo9Oxwa668cNiAbKR6cBsp96Ur2azWVbpprrTJKw2UpqrjxHjglNZoHI6/ophs0NAI0EUOWW1TeoFmiEb/PHxU5Gs0sk1Go0Y4jwIUnHejGi7XSTjow0eCnYUxmPwxJOygofFZoYu1+ynAV4lTaMUa8EYHHjj4JGmYdrj9nzQaNRpsr8Ro26+SlNaiOKtR7EVpGdN36rllh2edKBuifWmn4fmueUTnkirTrqR4fVBqtRN8Cg2HQO6XJQDlxIGB06dBpsCZJJi6kSvnaBrOivEqiihqshaHVGOedDywCeKd2ikFTR4HTD602aBeryXXgxo9Toiqzw5nLrij04owzPXRFFkYp3K0UPZhmcrxQGzFKVaIjZmcVRE5Mk4pkRkyTimIyZMlMRbEJTEmxCURGxSURGwEoitgJWFbAsY9cH70U+q5qPRuinZ0Vprx/VDWa1xKRux/FhvGjgla6jWWaQcLwJyrpGytMUjvbQ1lywUr5n6BJeujWPHJjpB0YfipvroSuIbLXyNOs1A0eRSUmazVF3jnm43eFQpS4Gs0mZtRUb8SCFPK6MWa/JxIz0+FbtEjXFe+8KHoDt1nsgV8KFLrX8/cZMoJgfapq14DaCAlyNbhkObSNddhw+X1S6OwpFRNX2hjm8DyKXLW7kai8LgCKlowzLuIJCRp66JzTa1HqQWj/AFN1C2nAOXNKHV4+hxSw+r33Gxs4r3qjRUg/1KOR179Dncfp77DSJTrBA9nt1O6gcSFPKr1eH2JuKezw+xUS1rgTSl6pccPjWy17XoTcev33AcQDU8PVnknxoUyTr/JG1vV/6QZbRpAG4CIjwxaeCZQ939wRhvfj9zDaZxjg4ED2mBoPxMVowa1+f3OiEXa9fueDb5BtJrmacLgXTCL9/wAnq4Ea9/dnlyu28TQcF0ROxdZildTWK7x8laKKIwzP28z9VeKDZgmeM+dPmrxQLMsh+6/qqoRszuKdEpMk4p0RkyZKZEWyZKJFsmSmJtilERgqsLYCURWwIgAsKepd/KR8+K576z0K6irdt7dkPApX1GSHa0DU7TrJHMj5pW2+A2wuyTGl3VrcXcjrSOOraFD7dFT3RoQN2FmSCg7WGgfhNODSka17PH1DZWItNe0KnUW/2SSzLdz/AJNfWUilp/5Gn8tCB/WhKN7n7+hsyZVkzRh1jAToxDfHspXGT10w2XitF7bTD8VL3MnyU3DKGzRHI4ezQ6qdYOam0nv8B9o5lOF53a2yAeAJS5VuXIZDXzWhvDXjIx1duhClWrwY6NLL1PwE7TdNfAlTdcQF4JTrYaZB7I/6nUPBJKPB+L8ELNavtZvs07vZDyNkkBI8LwK55wX9Vd0vRnNiRjv8Jej8DfZ3VxLZN7uq4YGqjJbtXM5pxrVa5lWvc04NkpmIYxTbfvIUnw734UI0pbWu9+FCm0CtTIHEHEObZzzvE8E6g9yr6y9KBk1bK+svSjpLXGcaC8TgWtd2fFriCjHDns980NHDls3dq80CW2RtFC6NtdF+jHV3B1SnWHJ7L9/QWEJSepP6bPAxSy6XHtUFe057qDc44DcqKO46IpOktXcvDaeNJO5wLiWHH2Xv8tCuopceR6EIqLqjE94rS82uXWVPlVVSe2uR0IxzyAaCCdklPoqxTf8AA1mOWTZ/yB+ZVoxNZhlk+6hXSFbMsj9/JVSEbIOP3gnIt+9RJ33oTIjIm4pkRkyZP3RMSbFKJNilEVirCs5EDYFgArsRFvqNmrRzBUjr+nMYuFNHJrvlghTM3x8hop6HG8dVAW+QGCDjYUyzpBTTIMqg4Dikp9Qykusds4aMHGmYazyLkHC9q8TLEW4s2e9Ttu31Y3kXBJkrcufoMn28iwLqjt4HXRjq/wD1KXVw8f7Q+/essHYYujrWgF8Bw20xCnv1J9w0eo1NtZaKdgUwF5rK8RI3BTeHfHn6MZax/W3DCjDXXWnABxrxQ0UXr1+/p5DJDNnJP4WbQSwDxJcfJK4qt/P0HRpjEg/DGw66iQ6MvxgFTbjvb7vsMO2R1aXAK91w+clEHGO2/fcMinVHVA0nMvDa/C7HgkzL5n3eqHNELy3G51ZGT5QOIcApySe+/ovRiuNrW/M1ia92rgdQU9tx/wCYcOam41qvw8q8CX7VSb99lPkOOkQ38Qkbv60V2Dqi1vFLoW9lPu802I8HN+2vpXmma4LRC/8AeXrRU6HCR0QByq4480kozjqqPdZCaxI/o/T3X5FZJWtN71idgwP+a6XiwQ0Pi5Kot/0xf0S55vISCclWWLfZX/ryOitbi+620ySGhwNiDbusAkuFeCbRpLXBL/l9gygoxTeGl/z+wH2ktqTK2p0lnq7Xk5XHux5LKCe7x8kMsOLqotduZrvSMU1s0lzhowvQWeQ/Cy0CnBVjh7vBy84lo4fy33yXNw8zzLR0i2QU69rroxaICKbP8+iusJxf7ef+JfChKF6uf2MUs5phgMz2QeEhVVFXr98joRhmfqLmk7aHzkVor37Qb9+2ZXb20GTmDycqr3t9AX71GSY46qfxD6qsRGyDz91/VOhJS9+2QJ+/spyLfv2yTj91TnO2ITsRJtiFMTYpWF1gRF2gWAciKcQsZoCxtQWHx36OYWZk329v8FmucNY8A3zLUjUff8lf18e6vQu1slMReH+5+gSXDd4BUZ71z+yHY3/Rrtqw+QB5oN/6vEfXvj4FRK9uF0NyvNceV13mlcYvXfd7QczW733MLJHHBsLZCTiaCp3VaKINRWtya99obk9yfvrRR0jwcbO5uo3Q2vAAVSpReyXiBN/K+Qj5TXtxyOH5g9pG7TgmUfla5D5uN8ytnmjJvXTjh/mta7mQlnGey+TKWmjQ6RraOBnaMw9jxxBUkm9X6ea8gxe4qLUyTBrZHuzd1chPhTDmlyShtaS+qKR7QNjIxo8D8sHzbRZu9Wrv9bKJUVjkj0meRrtrS0nwN7zStT2KK99w2ouzqTgJS7MdWwcbwA80j0i2x5vysZM0Ms9MWl2GhzWsA8brFJzvU+d+bGXabYw00Jlffy62KLk6ME+FVJtrYlXY35k5Zla3d/mbo7Y6tPXjFQYAyRPO7BgcOag8JbdHf0a82iDwo1eS+/7m9nXPAuzTyGmktjII1XZDCa7lJ6OO2KXf4ZiTjhwu0l381aA6S1RGgkMWOmZjqO2Y2VgPxIqODPXlvsf+b8AKODNXt7K/vb5EbTa7SNPVvJpQxRCYbzWL5p44eFutdrrzGw4YEvu6fKXkZy+Y4CyPc/W8Wdha3aQIDTiqLJ86rtf9xZxw1/UkuGbzzGYsmFTJZwQNJFnew77zIQAn/Q/2y5rzkwxeFqUJK+2+Vma1291MWPAGq9I4c8PJPDCXFci8IZdngkeVJaQTW5eOrsjDkV0qDS2jX1E33zpgwzI0cUyyrZINvgY5KVxF3+QfRWj71iN8VyMpGX9IVCbfuiTyMzw/VOicpLi+77knEff902si3H3/ACTcR90TIk2vdEyiTbQERdQCsK2KURWBEU6qILOqga1uCCsG0MCdHYJ2yE+RQ1dfcbNLZq/+mwtBPdH3nVC0OlLqXvtG6h2mjTtbWq2ZCqM07VfQpGHj2XeLXjm0pXle/wAClz92BjzkPB7cONSFmjKT3+QQ7Jpf4vdh/LRauOruM2vdlGuND2QN4eOZfRLSvb4ehk5bvB+pzLY5opgR3bz/ACDlnhpu/T0KKckEWonBsTdwiDj8RBdzQyJa2+ftDaVXeUN9vtRlp/hxHMIU9zLLEi9bi19Cpe0jTSmjAf8AZ/kEtNe/sMpL3/I8U4GqNxOtzDUeNQhKLfFDWr2o0xzRHS0tObXfIj5qTjNbGVTTNUbsy52Q62PR/C5h81Nrh4PxTGKdZFoo+uwxNp43EtT6ufqN2G5lnYaUfM07mgcWhtVFzktqXvvDrZ6cUOA7bp26Cx1rmiunOgDqcVzOXVT/ANqfoc9SVtKn2fwGa6RdYZmCuIb0jK4DeJIaU3LRtO5U/wDgvKQIYU28z5x/yFDJWCjZSQMulWim8Ma3mmuMtq/6erYP0N/rS+sX9xPVrS49mUOvaW/tESE72tkFfFHPhLav+leTKqWFtrZ/pl6AtXRNrDaGJ4BxumZ4ruaZaHgjDGwbu+S9BI4uA5XF8vseZJZpG4OYG5l8TSG7yLzuSupwex9z/hHTmbV7SEjKHCeB1NTb7Ruo5rfJOn/ply8mxYyb17O2vUzyWl2q44fxgDk4AqihHr7vsM5MzvrTGNu9tT5EhUVcffcI7+Xu/kyue7Ux2+h+aqkt7J5pbosi9x1jl+iZJbibct6JOds5JkTcq3chXE5Iom2+BIlMSbYCiKwLCgRABYV2KiANVjWCn3RYFMKwaYwae4cPzt8gFr6+QqUvl5ryHDHHQ0cSPMJbW9lVGW5c35oL+sb7Lh/PULLLLfyFvEju52NHa3AaCf5gKcq80HhoZYs3sQ7bUTpc6udSacTRDIlsGz3t98wC0ge047pLvkCs4Xu5Ac1x5lHSFza9o/8Asc6n/GiVRSf2XqFSk/5foI6Ue03g4c8Ecr3Ma6/cH1rClXBuQe4cqraPeNpI77GYW96n8V7HgEHm4FouO595egp9HPA5inNJrv8AgouzmPFaWDB1mbJt6148jRLKEnsnX0QHJ3+3V2lTJA78MT43ZdYHN5ivNIlirbJP6FY5HqqgxkA4sa4fmD8PAUWdvY/Aps3GtoY/ACFu58rOTipPNHbmfc/AaKi1roYQxDAsvHX2xd8DpQzTetM2jRWOMDRCx2V5zXDx7XzSOV7ZP39DOCqq8DVFAC0gixx4/heZQ4bnNqKeKm569Wd9ledeBGcXFp032URLY60PVgjXG944XhQprnuv615HRFKir7Cw0uTtbUaZJBFQ7TdxQWK1tj3KxGpU3K/p9jDLYbte3G7a17XV3V0+CssW9z7gpS2368yLZXg0BcOSZxi0bMwyzPpj1jht+qyjG9VAba3Mzm2O0Bzhu/sn0ceAmkfWRmmcdLnV2uBTxihZYj6yLpXHQSeSoopCOc3ssQh2uqOoVvE3pkXb/kmRFtiVTCWAlYDa3gRFdAWFAURRSiBnLG1nVWBrOWBsFqjQuY//2Q==\",\xFE";
 z+="    \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTjW8bNJ8aH8zic1Xhucj6C_61cS1EWcCf98FEnv9_JyGmid8kdzg\"]\xFE";
 z+="    Print Slideshow(arrayOfPhoto_URLs)\xFE";
 z+="*/ \xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="function Slideshow(byval arrayOfPhoto_URLs As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim ID As String\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim PHOTO_URL As StRiNg\xFE";
 z+="\xFE";
 z+="    Id = NewGuid()\xFE";
 z+="    Html =  @Head(@JsLink(@jsbRoot:`js/jquery.bxslider.js`))\xFE";
 z+="    Html := @Head(@CssLink(@jsbRoot:`css/jquery.bxslider.css`))\xFE";
 z+="\xFE";
 z+="    Html := Chr(28):`\xFE";
 z+="        <ul id=\"`:ID:`\">\xFE";
 z+="    `\xFE";
 z+="    \xFE";
 z+="    For Each photo_URL In arrayOfPhoto_URLs\xFE";
 z+="        Html := '<li><img src=':jsEscapeHREF(photo_URL):'/></li>':Crlf()\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    Html := `\xFE";
 z+="        </ul>\xFE";
 z+="        <style>\xFE";
 z+="            .bx-wrapper .bx-viewport { background-color: black; }\xFE";
 z+="            .bx-wrapper img { display: initial !important }\xFE";
 z+="            #`:ID:` li { position: relative !important; text-align: center !important }\xFE";
 z+="        </style>\xFE";
 z+="        <script type=\"text/javascript\">\xFE";
 z+="            $(document).ready(function(){\xFE";
 z+="                $('#`:ID:`').bxSlider({\xFE";
 z+="                    auto: true,\xFE";
 z+="                    autoControls: true,\xFE";
 z+="                    infiniteLoop: true,\xFE";
 z+="                    speed: 800,\xFE";
 z+="                    pause: 4000,\xFE";
 z+="                    mode: 'fade'\xFE";
 z+="                });\xFE";
 z+="            });\xFE";
 z+="        </script>\xFE";
 z+="    `:chr(29) \xFE";
 z+="    Return Html\xFE";
 z+="end function"
window.cached_jsb_html["slideshow"]=z;
var z="* Uss a TableName to fetch values, and adds ItemID's to that table if they don't exist\xFE";
 z+="\xFE";
 z+="function smartComboBox(byval ID As Object, byval tblName As Object, optional byval DEFAULTVALUE As Object, optional byval addBlank As Object, optional byval AdditionalAttributes As Object) As String\xFE";
 z+="    Dim HTML As Array\xFE";
 z+="    Dim SL As SelectList\xFE";
 z+="    Dim VALUES As Object\xFE";
 z+="\xFE";
 z+="    if isJson(DEFAULTVALUE) Or IsArray(DEFAULTVALUE) Then\xFE";
 z+="        AdditionalAttributes = DEFAULTVALUE\xFE";
 z+="        DEFAULTVALUE = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if isJson(addBlank) Or IsArray(addBlank) Then\xFE";
 z+="        AdditionalAttributes = addBlank\xFE";
 z+="        addBlank = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if !tblName then \xFE";
 z+="        Values = [\"Your smart combo box does not have a reffile\"]\xFE";
 z+="    else\xFE";
 z+="        select fHandle('', tblName, true) to SL Then \xFE";
 z+="            Values = GetList(sl)\xFE";
 z+="            Values = Split(Values, AM())\xFE";
 z+="            Values[-1] = ''\xFE";
 z+="            Values = Sort(Values, 'LAI')\xFE";
 z+="        Else\xFE";
 z+="            Values = [@Errors]\xFE";
 z+="        End If\xFE";
 z+="   End If\xFE";
 z+="   \xFE";
 z+="    HTML = []\xFE";
 z+="    Html[-1] = ComboBox(ID, VALUES, DEFAULTVALUE, addBlank, \"\", \"\", AdditionalAttributes)\xFE";
 z+="\xFE";
 z+="    /* if system(1) = \"js\" Then\xFE";
 z+="        Html[-1] = @Script(`\xFE";
 z+="            var pElement = $('*#`:ID:`');\xFE";
 z+="            $(pElement).on('blur', function (e,u) { jsbCall('jsb_html', 'smartComboBoxBlur',  $(this).val(), '`:tblName:`', '`:ID:`' ) } );\xFE";
 z+="        `)\xFE";
 z+="    end if\xFE";
 z+="    */\xFE";
 z+="    \xFE";
 z+="    return Join(HTML, CRLF())\xFE";
 z+="end function"
window.cached_jsb_html["smartcombobox"]=z;
window.cached_jsb_html["smartcomboboxblur"]="function smartComboBoxBlur(byval s, byval tblName, byval id) As String\xFE*$options js\xFE\xFE    if !s then return null\xFE    f = fHandle('', tblName, true)\xFE    read x from f, s then return null\xFE    write '' on f, s else alert(@errors)\xFE    \xFE    ' Update with new values\xFE    select fHandle('', tblName, true) to SL Then Values = GetList(sl) Else Return Alert(@Errors)\xFE\xFE    Values = Sort(Values, 'LAI')\xFE    window.loadOptions('dd_':id, Values)\xFE    window.storeVal(id, s)\xFE    \xFE    return true\xFEend function";
var z="* Print @(-1):@SortableListBox('id1', ['red', 'blue', 'green', 'yellow']); \xFE";
 z+="* input pau; \xFE";
 z+="* print \"result is \":@formvar('id1')\xFE";
 z+="* print \"if sorting on, then result is \":@formvar('id1_Sorted')\xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="function SortableListBox(ByVal ID As String, ByVal Values As Object, Optional ByVal AdditionalAttributes As Object, Optional ByVal Binding As StRiNg) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim I As Integer\xFE";
 z+="    Dim DELIMITER As String\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim S As StRiNg\xFE";
 z+="    Dim V As StRiNg\xFE";
 z+="\xFE";
 z+="    AdditionalAttributes = @MergeAttribute('class', 'uiSortableList', ' ', AdditionalAttributes)\xFE";
 z+="    \xFE";
 z+="    if isArray(Values) Then\xFE";
 z+="        Delimiter = Am()\xFE";
 z+="    Else\xFE";
 z+="        Values = CStr(Values)\xFE";
 z+="    \xFE";
 z+="        If Instr(Values, Am()) Then\xFE";
 z+="            Delimiter = Am()\xFE";
 z+="        ElseIf Instr(Values, Vm()) Then\xFE";
 z+="            Delimiter = Vm()\xFE";
 z+="        ElseIf Instr(Values, Svm()) Then\xFE";
 z+="            Delimiter = Svm()\xFE";
 z+="        ElseIf Instr(Values, \";\") Then\xFE";
 z+="            Delimiter = \";\"\xFE";
 z+="        ElseIf Instr(Values, \",\") Then\xFE";
 z+="            Delimiter = \",\"\xFE";
 z+="        Else\xFE";
 z+="            If Binding Then Delimiter = ',' Else Delimiter = Am()\xFE";
 z+="        End If\xFE";
 z+="        Values = Split(Replace(Values, Delimiter:\" \", Delimiter), Delimiter)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    // If we are returning a value, we need to put the list back together with the correct delimeter\xFE";
 z+="    Html := Chr(28):`<input id=\"`:Id:`\" name=\"`:Id:`\" type='hidden' value=\"`:@Jsb_bf.HtmlEncode(Values):`\" `:Join(Binding, \" \"):`/>`:CRLF():Chr(29)\xFE";
 z+="    Html := Chr(28):`<ul id='ul_`:Id:`' `:JoinAttributes(AdditionalAttributes, \" \"):`>`:CRLF():Chr(29)\xFE";
 z+="    \xFE";
 z+="    S = @Script(`\xFE";
 z+="        function onChange_`:ID:`() {\xFE";
 z+="            var myUL = $('#ul_`:Id:`');\xFE";
 z+="            var del = Chr(`:Seq(Delimiter):`);\xFE";
 z+="            var results = $(myUL).find(\"li\").map(function(){ return $(this).text(); }).get(); \xFE";
 z+="            \xFE";
 z+="            var myTxtBox = $('#`:Id:`');\xFE";
 z+="            $(myTxtBox).val(results.join(del))\xFE";
 z+="        }\xFE";
 z+="        \xFE";
 z+="        $(function() {\xFE";
 z+="          $( \"#ul_`:ID:`\" ).sortable({\xFE";
 z+="                stop: onChange_`:ID:`,\xFE";
 z+="                receive: onChange_`:ID:`,\xFE";
 z+="                remove: onChange_`:ID:`\xFE";
 z+="          }).disableSelection();\xFE";
 z+="        });\xFE";
 z+="     `)\xFE";
 z+="\xFE";
 z+="    For Each V, I In Values\xFE";
 z+="        Html := Chr(28):`<li  class=\"list-group-item\">`:Chr(29):V:Chr(28):\"</li>\":CRLF():Chr(29)\xFE";
 z+="    Next\xFE";
 z+="    Html := Chr(28):\"</ul>\":Chr(29)\xFE";
 z+="\xFE";
 z+="    Return Html:S"
window.cached_jsb_html["sortablelistbox"]=z;
var z="// Print Span('spanid', 'here is some text in a span', 600, MergeStyle({'font-family': 'times', 'font-size': '12px', color: 'blue', border: '1px solid black'}))\xFE";
 z+="\xFE";
 z+="function SPAN(ByVal ID As String, Byval Spantext As Object, Optional ByVal Pxwidth As Object, Optional ByVal AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If isMissing(AdditionalAttributes) Then\xFE";
 z+="        If isJson(Pxwidth) Or IsArray(Pxwidth) Then\xFE";
 z+="            AdditionalAttributes = Pxwidth\xFE";
 z+="            Pxwidth = Nothing\xFE";
 z+="            \xFE";
 z+="        ElseIf isMissing(Pxwidth) And (isJson(SpanText) Or IsArray(SpanText)) Then\xFE";
 z+="            AdditionalAttributes = SpanText\xFE";
 z+="            SpanText = Id\xFE";
 z+="            Id = ''\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="    ElseIf isMissing(SpanText) Then\xFE";
 z+="        SpanText = Id\xFE";
 z+="        Id = ''\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    AdditionalAttributes = @Jsb_bf.MergeAttribute('class', 'Span', ' ', AdditionalAttributes)\xFE";
 z+="\xFE";
 z+="    If Pxwidth Then\xFE";
 z+="        If CStr(Val(pxWidth)) = pxWidth Then pxWidth := 'px'\xFE";
 z+="        AdditionalAttributes = @Jsb_bf.MergeAttribute('style', 'width: ':pxWidth, ';', AdditionalAttributes)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html = Chr(28):\"<span\"\xFE";
 z+="    If Id Then Html := \" id='\":Id:\"'\"\xFE";
 z+="    Html := JoinAttributes(AdditionalAttributes):\">\":Chr(29):SpanText:Chr(28):\"</span>\":Chr(29)\xFE";
 z+="    Return Html"
window.cached_jsb_html["span"]=z;
var z="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE";
 z+="\xFE";
 z+="* print Html(\"<div \":Style({'background-color': 'yellow', color: 'cyan'}):\">Hello</div>\")\xFE";
 z+="* \xFE";
 z+="// Output a style tag with contents\xFE";
 z+="function Style(byval S As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    // Build a style attribute for an HTML tag\xFE";
 z+="    if typeof(s) = \"JSonObject\" Then\xFE";
 z+="        Dim JsonStyles As Json = S\xFE";
 z+="        Dim HTML As String = \"\"\xFE";
 z+="        For Each JTag As String In JsonStyles\xFE";
 z+="            Dim JValue As Object = JsonStyles[JTag]\xFE";
 z+="            If JValue Then\xFE";
 z+="                If Html Then Html := \"; \" \xFE";
 z+="                Html := JTag:\":\":CStr(JValue)\xFE";
 z+="            end if\xFE";
 z+="        Next\xFE";
 z+="        RETURN `style=`:jsEscapeAttr(Html)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // Return an inline-style\xFE";
 z+="    Return CHR(28):`<style>`:crlf():Replace(s, am(), crlf()):crlf():'</style>':crlf():CHR(29)\xFE";
 z+="end function"
window.cached_jsb_html["style"]=z;
var z="* A Submit button made to look like an anchor\xFE";
 z+="FUNCTION SubmitAnchor(ByVal ID As Object, ByVal DefaultValue As Object, BYVAL DisplayText As Object, optional ByVal AdditionalAttributes As Object, optional ByVal ParsleyCheck As StRiNg) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    Dim BTNTYPE As String\xFE";
 z+="    Dim BTNSZE As String\xFE";
 z+="    Dim ONCLICK As String\xFE";
 z+="\xFE";
 z+="    if IsMissing(AdditionalAttributes) Then AdditionalAttributes = []\xFE";
 z+="    \xFE";
 z+="    AdditionalAttributes = @MergeAttribute(\"class\", \"SubmitAnchor\", \" \", AdditionalAttributes) \xFE";
 z+="    if ParsleyCheck Then onCLick = `if (!parsleyIsValid(true)) return false` Else onCLick = `parsleyDestroy();`\xFE";
 z+="    btnType = \"\"\xFE";
 z+="    btnSze = \"\"\xFE";
 z+="    return SubmitBtn(ID, DefaultValue, DisplayText, AdditionalAttributes, \"default\" /* bootstrap type */, \"\" /* lg, sm */, onCLick)\xFE";
 z+="End Function"
window.cached_jsb_html["submitanchor"]=z;
var z="* \xFE";
 z+="* No parsley check - Use saveBtn if you want a validation check\xFE";
 z+="*\xFE";
 z+="* Print @jsb_html.SubmitBtn('id', '', 'Click Me', {}, 'danger', 'lg', \"alert('you clicked it')\")\xFE";
 z+="*\xFE";
 z+="* Print @SUBMITBTN('', 'value', 'DisplayLabel' )\xFE";
 z+="*     options:\xFE";
 z+="*         AdditionalAttributes: { style: 'width: 180px' }\xFE";
 z+="*         btnType: primary, secondary, success, warning, danger, link   (Bootstrap types)\xFE";
 z+="*         btnSize: lg, sm\xFE";
 z+="*\xFE";
 z+="function SubmitBtn(Optional Byval Id As Object, Optional Byval DefaultValue As Object, Optional Byval DisplayText As Object, Optional Byval AdditionalAttributes As Object, Optional Byval btnType As String, Optional Byval btnSize As String, Optional ByVal onCLick As String) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if !AdditionalAttributes Then\xFE";
 z+="        if IsJSON(id) Then\xFE";
 z+="            AdditionalAttributes = id\xFE";
 z+="            id = ''\xFE";
 z+="        Else If IsJSON(DefaultValue) Then\xFE";
 z+="            AdditionalAttributes = DefaultValue\xFE";
 z+="            DefaultValue = ''\xFE";
 z+="        Else If IsJSON(DisplayText) Then\xFE";
 z+="            AdditionalAttributes = DisplayText\xFE";
 z+="            DisplayText = ''\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    IF !DefaultValue THEN DefaultValue = DisplayText\xFE";
 z+="    IF !DefaultValue THEN DefaultValue = ID\xFE";
 z+="    IF !DefaultValue THEN DefaultValue = \"Submit\"\xFE";
 z+="    IF !DisplayText THEN DisplayText = DefaultValue\xFE";
 z+="\xFE";
 z+="    DisplayText = @jsb_bf.Language(DisplayText)\xFE";
 z+="    \xFE";
 z+="    if !onCLick Then onCLick = `parsleyDestroy();`\xFE";
 z+="    \xFE";
 z+="    HTML = CHR(28):\"<button type='submit'\"\xFE";
 z+="    onCLick = onCLick:`; assignBtn(this, `:@jsEscapeString(DefaultValue):`); ` ;* Creates an input element by the same name for the form data\xFE";
 z+="    \xFE";
 z+="    IF ID THEN Html := \" id='\":ID:\"' \" ;* name='\":ID:\"'\" - removed this because the js version will get a value for formvar(id) even if it's not clicked\xFE";
 z+="    AdditionalAttributes = @MergeAttribute(\"onclick\", onCLick, \";\", AdditionalAttributes)\xFE";
 z+="    AdditionalAttributes  = @MergeAttribute(\"class\", \"SubmitBtn\", \" \", AdditionalAttributes)\xFE";
 z+="    if !btnType then btnType = \"default\"\xFE";
 z+="    if left(btnType, 4) <> \"btn-\" then btnType = \"btn-\":btnType\xFE";
 z+="    if Not(InStr(AdditionalAttributes, \"btn-\")) Then AdditionalAttributes = @MergeAttribute(\"class\", \"btn \":btnType, \" \", AdditionalAttributes)\xFE";
 z+="\xFE";
 z+="    if btnSize Then\xFE";
 z+="        if left(btnSize, 4) <> \"btn-\" then btnSize = \"btn-\":btnSize\xFE";
 z+="        AdditionalAttributes = @MergeAttribute(\"class\", btnSize, \" \", AdditionalAttributes)\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Html := JoinAttributes(AdditionalAttributes)\xFE";
 z+="    Html := ' value=\"':CHR(29):DefaultValue:CHR(28):'\"'\xFE";
 z+="    Html := \">\":Chr(29):@jsb_bf.Language(DisplayText):Chr(28):\"</button>&nbsp;\":CHR(29)\xFE";
 z+="    RETURN HTML\xFE";
 z+="End Function"
window.cached_jsb_html["submitbtn"]=z;
window.cached_jsb_html["subscript"]="function SubScript(byval text As StRiNg, optional byval AdditionalAttributes As String) As String\xFE    $options async-\xFE    return Chr(28):\"<sub \":joinAttributes(AdditionalAttributes):\">\":Chr(29):text:Chr(28):\"</sub>\":Chr(29)";
window.cached_jsb_html["superscript"]="function SuperScript(byval text As StRiNg, optional byval AdditionalAttributes As String) As String\xFE    $options async-\xFE    return Chr(28):\"<sup\":joinAttributes(AdditionalAttributes):\">\":Chr(29):text:Chr(28):\"</sup>\":Chr(29)\xFEend function";
var z="*\xFE";
 z+="* Print @Switch('id', 1, 'Click Me', { onclick: 'alert(\"OK\");', ondblclick: 'doJsbSubmit();' })\xFE";
 z+="*\xFE";
 z+="* Print @Switch('id', 1, 'Click Me', false, {}, \"danger\") \xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="' btnType: primary, secondary, success, warning, danger, link\xFE";
 z+="\xFE";
 z+="FUNCTION Switch(ByVal ID As String, byval VALUE As String, optional byval DESCRIPTION As Object, optional byval CHECKED As Object, optional byval AdditionalAttributes As Object, optional byval btnType As String) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim OA As String\xFE";
 z+="    Dim IA As StRiNg\xFE";
 z+="    Dim XOA As String\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    if isJson(DESCRIPTION) Or IsArray(DESCRIPTION) Then\xFE";
 z+="        AdditionalAttributes = DESCRIPTION\xFE";
 z+="        DESCRIPTION = ''\xFE";
 z+="        \xFE";
 z+="    ElseIf isJson(CHECKED) Or IsArray(CHECKED) Then\xFE";
 z+="        AdditionalAttributes = CHECKED\xFE";
 z+="        if Description = False Or Description = True Then\xFE";
 z+="           Checked = Description\xFE";
 z+="           Description = \"\"\xFE";
 z+="        else\xFE";
 z+="            CHECKED = False\xFE";
 z+="        end if\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if !btnType then btnType = \"default\"\xFE";
 z+="    if left(btnType, 4) <> \"btn-\" then btnType = \"btn-\":btnType\xFE";
 z+="    \xFE";
 z+="    AdditionalAttributes = @MergeAttribute(\"class\", \"switch slider round\", \" \", AdditionalAttributes)\xFE";
 z+="    if Not(InStr(AdditionalAttributes, \"btn-\")) Then AdditionalAttributes = @MergeAttribute(\"class\", btnType, \" \", AdditionalAttributes)\xFE";
 z+="\xFE";
 z+="    OA = uiAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    IA = dataAdditionalAttributes(AdditionalAttributes)\xFE";
 z+="    if InStr(OA, \"form-control\") Then xOA = \"class='form-control'\" else xOA = \"\"\xFE";
 z+="    HTML = CHR(28):`<div `:xOA:` style=\"padding-top: 4px; padding-left: 0; border: 0; display: inline-block;\">`\xFE";
 z+="    HTML := `<label class=\"switch\" style=\"align-items: center; display: inline-flex; height: 39px;\">`\xFE";
 z+="    HTML := `<input type='checkbox' id='`:ID:`' name='`:ID:`'`:joinAttributes(additionalAttributes, ' '):`/>`\xFE";
 z+="    HTML := `<span value='`:@HtmlEncode(VALUE):`'`:joinAttributes(additionalAttributes, ' ')\xFE";
 z+="    IF CHECKED THEN Html := ' checked'\xFE";
 z+="    Html := `></span></input></label>&nbsp;`:@HtmlEncode(Description):\"</div>\":CHR(29)\xFE";
 z+="    RETURN HTML\xFE";
 z+="end function"
window.cached_jsb_html["switch"]=z;
var z="// ID is optional too, just pass the innerTR as the 1st parameter\xFE";
 z+="//\xFE";
 z+="function TABLE(ByVal ID As String, Optional Byval innerTR, Optional Byval classNameOrAttributes As Object) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    If isMissing(innerTR) Then\xFE";
 z+="        innerTR = Id\xFE";
 z+="        Id = ''\xFE";
 z+="        \xFE";
 z+="    ElseIf isJSON(innerTR) Then\xFE";
 z+="        classNameOrAttributes = innerTR\xFE";
 z+="        innerTR = Id\xFE";
 z+="        Id = ''\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Id Then Id = \"id='\":Id:\"' \"\xFE";
 z+="    If !classNameOrAttributes Then classNameOrAttributes = `table table-striped table-bordered`\xFE";
 z+="    If isArray(innerTR) Then innerTR = Join(innerTR, Chr(28):Crlf():Chr(29))\xFE";
 z+="    \xFE";
 z+="    Return Chr(28):`<table data-toggle=\"table\" data-sortable=\"true\" `:Id:classOrAtttributes(classNameOrAttributes):`>`:Chr(29):innerTR:Chr(28):`</table>`:Chr(29)\xFE";
 z+="  \xFE";
 z+="    Return Chr(28):`<table `:Id:classOrAtttributes(classNameOrAttributes):`>`:Chr(29):innerTR:Chr(28):`</table>`:Chr(29)\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function TABLE(ByVal ID As String, optional byval html As Object, optional byval classNameOrAttributes As Object) As String\xFE";
 z+="   $options async-\xFE";
 z+="   \xFE";
 z+="   if isMissing(html) Then\xFE";
 z+="       html = id\xFE";
 z+="       id = ''\xFE";
 z+="       \xFE";
 z+="   Elseif isJSON(html) Then\xFE";
 z+="       classNameOrAttributes = html\xFE";
 z+="       html = id\xFE";
 z+="       id = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="   if id then id = \"id='\":id:\"' \"\xFE";
 z+="   return Chr(28):\"<table \":id:classOrAtttributes(classNameOrAttributes):\">\":Chr(29):html:Chr(28):\"</table>\":Chr(29)\xFE";
 z+="End function"
window.cached_jsb_html["table"]=z;
var z="*\xFE";
 z+="* print @(-1):@tabs('id1', ['a', 'b', 'c'], ['this is a', 'this is b', 'this is c'])\xFE";
 z+="*  OR\xFE";
 z+="* print @tabs(\"id1\", \"c1\", \"this is a\", \"b\", \"this is b\", \"c\", \"this is c\")\xFE";
 z+="*\xFE";
 z+="function TABS(Byval Id As Object, Optional Byval Tab1caption As Object, Optional Byval Tab1content As Object, Optional Byval Tab2caption As String, Optional Byval Tab2content As String, Optional Byval Tab3caption As String, Optional Byval Tab3content As String) As StRiNg\xFE";
 z+="* $options async-\xFE";
 z+="    \xFE";
 z+="    Dim TABCAPTIONARRAY As Array\xFE";
 z+="    Dim TABCONTENTARRAY As Array\xFE";
 z+="    Dim I As Integer\xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    If IsArray(Tab1caption) Then\xFE";
 z+="        TabCaptionArray = Tab1caption\xFE";
 z+="        TabContentArray = Tab1content\xFE";
 z+="        \xFE";
 z+="    Else\xFE";
 z+="        TabCaptionArray = []\xFE";
 z+="        TabContentArray = []\xFE";
 z+="        If Tab1caption Then TabCaptionArray[-1] = Tab1caption; TabContentArray[-1] = Tab1content\xFE";
 z+="        If Tab2caption Then TabCaptionArray[-1] = Tab2caption; TabContentArray[-1] = Tab2content\xFE";
 z+="        If Tab3caption Then TabCaptionArray[-1] = Tab3caption; TabContentArray[-1] = Tab3content\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html = Chr(28):\"<ul style='border-style:hidden hidden solid hidden'>\":Crlf()\xFE";
 z+="\xFE";
 z+="    For I = 1 To UBound(TabCaptionArray)\xFE";
 z+="        Html := \"<li id='tabsli_\":I:\"'><a href='#tabs_\":I:\"'>\":TabCaptionArray[I]:\"</a><span class='ui-icon ui-icon-circle-close' role='presentation'>Remove Tab</span></li>\":Crlf()\xFE";
 z+="    Next\xFE";
 z+="    Html := \"</ul>\":Crlf():Chr(29)\xFE";
 z+="*\xFE";
 z+="    For I = 1 To UBound(TabCaptionArray)\xFE";
 z+="        Html := @Jsb_html.DIV(\"tabs_\":I, TabContentArray[I], [\"style='border-top: 0;'\"])\xFE";
 z+="    Next\xFE";
 z+="*\xFE";
 z+="    Html = @Jsb_html.DIV(Id, Html, [\"class='tabs'\"])\xFE";
 z+="*\xFE";
 z+="    Html := Chr(28):`<script>`:Crlf()\xFE";
 z+="    Html := `  var tabs = $(\"#`:Id:`\");`:Crlf()\xFE";
 z+="    Html := `  tabs.tabs({`:Crlf()\xFE";
 z+="    Html := `     select: function (e, ui) {  }`:Crlf()\xFE";
 z+="    Html := `  });`:Crlf()\xFE";
 z+="\xFE";
 z+="    Html := `  // close icon: removing the tab on click`:Crlf()\xFE";
 z+="    Html := `  $(tabs).on(\"click\", \".ui-icon-close\", onjqTabClose);`:Crlf()\xFE";
 z+="    Html := `  $(tabs).css('border-color', $(tabs).find(\"ul\").css(\"background-color\")); `:Crlf()\xFE";
 z+="    Html := `  var p = tabs.parent(); `:Crlf()\xFE";
 z+="    Html := `  $(p).css('overflow', 'hidden'); `:Crlf()\xFE";
 z+="    \xFE";
 z+="    Html := `</script>`:Crlf():Chr(29)\xFE";
 z+="\xFE";
 z+="    Return Html"
window.cached_jsb_html["tabs"]=z;
window.cached_jsb_html["td"]="function TD(byval html As String, optional byval classNameOrAttributes As Object) As String\xFE    $options async-\xFE    return Chr(28):\"<td\":classOrAtttributes(classNameOrAttributes):\">\":Chr(29):html:Chr(28):\"</td>\":Chr(29)\xFEEnd function";
var z="***************** HTML *****************************\xFE";
 z+="FUNCTION TextArea(ByVal ID As String, optional byval DEFAULTTEXT As String, optional byval ROWS As StRiNg, optional byval COLS As StRiNg, optional byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="   $options async-\xFE";
 z+="   \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="   AdditionalAttributes = @MergeAttribute(\"class\", \"TextArea form-control\", \" \", AdditionalAttributes)\xFE";
 z+="   AdditionalAttributes = @MergeAttribute(\"style\", \"resize:none\", \";\", AdditionalAttributes)\xFE";
 z+="   \xFE";
 z+="   HTML = CHR(28):\"<textarea id='\":ID:\"' name='\":ID:\"'\":JoinAttributes(AdditionalAttributes, \" \")\xFE";
 z+="   HTML := ` onfocus='if (isMobile() && !$(this).attr(\"readonly\")) $(this).keypad({ layout: \"full\" })'`\xFE";
 z+="   \xFE";
 z+="   if Rows Or Cols Then\xFE";
 z+="       Html := ' type=\"text\" rows=\"':ROWS:'\" cols=\"':COLS:'\">':@jsb_bf.HtmlEncode(DEFAULTTEXT):'</textarea>':CHR(29)\xFE";
 z+="   Else\xFE";
 z+="       Html := ' type=\"text\" style=\"width:100%; height: initial; resize:none;\">':@jsb_bf.HtmlEncode(DEFAULTTEXT):'</textarea>':CHR(29)\xFE";
 z+="       Html := @Script(`\xFE";
 z+="            $('#`:ID:`').on({\xFE";
 z+="              keyup: function() { autoSizeTextarea(this) }\xFE";
 z+="            });\xFE";
 z+="        `)\xFE";
 z+="   End If\xFE";
 z+="  \xFE";
 z+="   RETURN HTML"
window.cached_jsb_html["textarea"]=z;
var z="***************** HTML *****************************\xFE";
 z+="*\xFE";
 z+="* For multi-line text boxes use TEXTAREA\xFE";
 z+="*\xFE";
 z+="*  To use BootStrap add a \"form-control\" class:  \xFE";
 z+="*     print @TextBox('id', '', false, { class: \"form-control\" }):\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="* added keyPadType for mobile: 'hex', 'hex+', 'integer', 'integer+', 'real', 'full'\xFE";
 z+="*   or define your own: `[['1','Accept'],['5','<span style=\"width:9.2em\">0</span>','7','8','Cancel'],['9','0','A','B','Clear'],['C','D','E','F','Delete']]`\xFE";
 z+="*\xFE";
 z+="FUNCTION TextBox(ByVal ID As String, optional ByVal DefaultValue As Object, optional byval ReadOnly As Object, optional byval AdditionalAttributes As Object, optional byval KeyPadType As String) As StRiNg\xFE";
 z+="   $options async-\xFE";
 z+="   \xFE";
 z+="    Dim CT As String\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim AA As String\xFE";
 z+="\xFE";
 z+="   if isJson(DefaultValue) Or IsArray(DefaultValue) Then\xFE";
 z+="       KeyPadType = Readonly\xFE";
 z+="       AdditionalAttributes = DefaultValue\xFE";
 z+="       ReadOnly = False\xFE";
 z+="       \xFE";
 z+="   ElseIf isJson(ReadOnly) Or IsArray(DefaultValue) Then\xFE";
 z+="       KeyPadType = AdditionalAttributes\xFE";
 z+="       AdditionalAttributes = ReadOnly\xFE";
 z+="       ReadOnly = False\xFE";
 z+="   End If\xFE";
 z+="   \xFE";
 z+="   If ReadOnly Then CT = \"TextBox_ReadOnly\" Else CT = \"TextBox\"\xFE";
 z+="   AA = @MergeAttribute(\"class\", \"clearable form-control\", \" \", AdditionalAttributes)\xFE";
 z+="   AA = JoinAttributes(@MergeAttribute(\"class\", CT, \" \", AA))\xFE";
 z+="   if InStr(AA, `type=`) = 0 Then AA = AA:` type='text'`\xFE";
 z+="   \xFE";
 z+="   HTML = CHR(28):`<input`\xFE";
 z+="   IF ID THEN Html := ` id='`:ID:`' name='`:ID:`'`\xFE";
 z+="   If ReadOnly Then HTML := ` tabindex='-1' readonly `\xFE";
 z+="   If Len(DEFAULTVALUE) Then Html := ` value=\"`:@jsb_bf.HtmlEncode(DEFAULTVALUE):`\"`\xFE";
 z+="   Html := ` `:AA\xFE";
 z+="   \xFE";
 z+="    if KeyPadType then\xFE";
 z+="        if left(KeyPadType,1) <> '[' Then KeyPadType = '\"':lcase(KeyPadType):'\"'\xFE";
 z+="        if KeyPadType = '\"full\"' then \xFE";
 z+="            HTML := ` onfocus=`:jsEscapeAttr(`if (isMobile() && !$(this).attr(\"readonly\") && $(window).width() > 700) $(this).keypad({layout: `:KeyPadType:` })`)\xFE";
 z+="        else\xFE";
 z+="            HTML := ` onfocus=`:jsEscapeAttr(`if (!$(this).attr(\"readonly\") && $(window).width() > 300) $(this).keypad({layout: `:KeyPadType:` })`)\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="   \xFE";
 z+="   HTML := `/>`:CHR(29)\xFE";
 z+="   RETURN HTML"
window.cached_jsb_html["textbox"]=z;
window.cached_jsb_html["textcenter"]="FUNCTION TextCenter(ByVal Content As StRiNg, optional byval AdditionalAttributes As Object) As StRiNg\xFE* $options async-\xFE    Dim HTML As String\xFE\xFE    AdditionalAttributes = MergeAttribute('class', 'text-center', ' ', AdditionalAttributes)\xFE    \xFE    HTML = CHR(28):\"<p\":joinAttributes(AdditionalAttributes):\">\":CHR(29):CONTENT:CHR(28):\"</p>\":CHR(29)\xFE    RETURN HTML\xFEEND FUNCTION";
window.cached_jsb_html["textjustify"]="FUNCTION TextJustify(ByVal Content As StRiNg, optional byval AdditionalAttributes As Object) As StRiNg\xFE* $options async-\xFE    Dim HTML As String\xFE\xFE    AdditionalAttributes = MergeAttribute('class', 'text-justify', ' ', AdditionalAttributes)\xFE    HTML = CHR(28):\"<p\":joinAttributes(AdditionalAttributes):\">\":CHR(29):CONTENT:CHR(28):\"</p>\":CHR(29)\xFE    RETURN HTML\xFEEND FUNCTION";
window.cached_jsb_html["textleft"]="FUNCTION TextLeft(ByVal Content As StRiNg, optional byval AdditionalAttributes As Object) As StRiNg\xFE* $options async-\xFE    Dim HTML As String\xFE\xFE    AdditionalAttributes = MergeAttribute('class', 'text-left', ' ', AdditionalAttributes)\xFE    HTML = CHR(28):\"<p\":joinAttributes(AdditionalAttributes):\">\":CHR(29):CONTENT:CHR(28):\"</p>\":CHR(29)\xFE    RETURN HTML\xFEEND FUNCTION";
window.cached_jsb_html["textnowrap"]="FUNCTION TextNoWrap(ByVal Content As StRiNg, optional byval AdditionalAttributes As Object) As StRiNg\xFE* $options async-\xFE    Dim HTML As String\xFE\xFE    AdditionalAttributes = MergeAttribute('class', 'text-nowrap', ' ', AdditionalAttributes)\xFE    HTML = CHR(28):\"<p\":joinAttributes(AdditionalAttributes):\">\":CHR(29):CONTENT:CHR(28):\"</p>\":CHR(29)\xFE    RETURN HTML\xFEEND FUNCTION";
window.cached_jsb_html["textright"]="FUNCTION TextRight(ByVal Content As StRiNg, optional byval AdditionalAttributes As Object) As StRiNg\xFE* $options async-\xFE    Dim HTML As String\xFE\xFE    AdditionalAttributes = MergeAttribute('class', 'text-right', ' ', AdditionalAttributes)\xFE    HTML = CHR(28):\"<p\":joinAttributes(AdditionalAttributes):\">\":CHR(29):CONTENT:CHR(28):\"</p>\":CHR(29)\xFE    RETURN HTML\xFEEND FUNCTION";
window.cached_jsb_html["th"]="function TH(Byval innerHeaderCell As String, Optional Byval classNameOrAttributes As Object) As String\xFE    $options async-\xFE\xFE    If classNameOrAttributes Then\xFE        Return Chr(28):\"<th\":classOrAtttributes(classNameOrAttributes):\">\":Chr(29):innerHeaderCell:Chr(28):\"</th>\":Chr(29)\xFE    Else\xFE        Return Chr(28):`<th data-sortable=\"true\">`:Chr(29):innerHeaderCell:Chr(28):\"</th>\":Chr(29)\xFE    End If\xFEEnd function\xFE\xFE";
var z="* PRINT TimeBox('id', '14:30:02')\xFE";
 z+="\xFE";
 z+="function TimeBox(ByVal ID As String, Optional Byval Defaultvalue As Object, Optional Byval ReadOnly As Object, Optional Byval AdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim HTML As String\xFE";
 z+="\xFE";
 z+="    Html =  @Head(@JSLink(@jsbRoot:`js/timepicker.js`))\xFE";
 z+="    Html := @Head(@CssLink(@jsbRoot:`css/timepicker.css`))\xFE";
 z+="\xFE";
 z+="    If IsMissing(AdditionalAttributes) Then\xFE";
 z+="        If IsMissing(ReadOnly) Then\xFE";
 z+="            If isJson(Defaultvalue) Or IsArray(Defaultvalue) Then\xFE";
 z+="                AdditionalAttributes = Defaultvalue\xFE";
 z+="                Defaultvalue = ''\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            If isJson(ReadOnly) Or IsArray(ReadOnly) Then\xFE";
 z+="                AdditionalAttributes = ReadOnly\xFE";
 z+="                ReadOnly = False\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If DefaultValue Then\xFE";
 z+="        If Instr(DefaultValue, \":\") Then DefaultValue = Time(Time(DefaultValue)) Else DefaultValue = Time(Val(DefaultValue))\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If ReadOnly Then\xFE";
 z+="        Html := Chr(28):\"<input id='\":Id:\"' name='\":Id:\"' tabindex='-1' readonly \":Join(@MergeAttribute(\"class\", \"TimeBox_ReadOnly form-control\", \" \", AdditionalAttributes), \" \"):' value=\"':@Jsb_bf.HtmlEncode(DefaultValue):'\" />':Chr(29)\xFE";
 z+="    Else\xFE";
 z+="        If True Then\xFE";
 z+="            * Use jQuery timepicker\xFE";
 z+="            If !Id Then Id = \"TMB_\":Rnd(99999)\xFE";
 z+="            Html := Chr(28):\"<input id='\":Id:\"' name='\":Id:\"' \":Join(@MergeAttribute(\"class\", \"TimeBox form-control\", \" \", AdditionalAttributes), \" \"):' readonly value=\"':@Jsb_bf.HtmlEncode(DefaultValue):'\" />':Chr(29)\xFE";
 z+="            Html := @Jsb_html.SCRIPT(`$( \"#`:Id:`\" ).timepicker({ showLeadingZero: true, showNowButton: true, showDeselectButton: true, showCloseButton: true }); `)\xFE";
 z+="        Else\xFE";
 z+="            Html = Chr(28):\"<input id='\":Id:\"' name='\":Id:\"' type='time' \":Join(@MergeAttribute(\"class\", \"TimeBox form-control\", \" \", AdditionalAttributes), \" \"):' value=\"':@Jsb_bf.HtmlEncode(DefaultValue):'\" />':Chr(29)\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Return Html"
window.cached_jsb_html["timebox"]=z;
window.cached_jsb_html["tooltip"]="* print ToolTip(\"Horray!\", \"Hover over me\")\xFE\xFEFUNCTION ToolTip(byval Tip As String, byval Text As String) As String\xFE    $options async-\xFE\xFE    Dim HTML As String = CHR(28):`<a xhref=\"#\" data-toggle=\"tooltip\" title=`:jsEscapeAttr(Tip):`>`:CHR(29):Text:CHR(28):`</a>`:CHR(29)\xFE    Dim S As String = @Script(`$('[data-toggle=\"tooltip\"').tooltip()`)\xFE    return html:s\xFEEnd Function\xFE";
window.cached_jsb_html["tr"]="function TR(Byval innerTD As String, Optional Byval classNameOrAttributes As Object) As String\xFE    $options async-\xFE\xFE    If classNameOrAttributes Then\xFE        Return Chr(28):\"<tr\":classOrAtttributes(classNameOrAttributes):\">\":Chr(29):innerTD:Chr(28):\"</tr>\":Chr(29)\xFE    Else\xFE        Return Chr(28):\"<tr>\":Chr(29):innerTD:Chr(28):\"</tr>\":Chr(29)\xFE    End If\xFEEnd function\xFE";
window.cached_jsb_html["underline"]="* see also boldface, h1, h2, h3, h4, italics, monospace, subscript, center, font, style, underline, mark\xFE\xFEfunction underline(byval text As StRiNg, optional byval AdditionalAttributes As String) As String\xFE    $options async-\xFE    return Chr(28):\"<u\":joinAttributes(AdditionalAttributes):\">\":Chr(29):text:Chr(28):\"</u>\":Chr(29)\xFEend function";
var z="function updateProgressBar(ByVal ID As String, byval ValueNow As String, byval ValueMin As Integer, ByVal ValueMax As Single, optional ByVal Animate As StRiNg) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    Dim I As Integer\xFE";
 z+="    Dim PERCENTDONE As Single\xFE";
 z+="    Dim C As String\xFE";
 z+="    Dim V As StriNg\xFE";
 z+="\xFE";
 z+="    If !ValueMax Then ValueMax = 100\xFE";
 z+="    \xFE";
 z+="    If CStr(Val(ValueNow)) <> CStr(ValueNow) Then \xFE";
 z+="        V = \"\"\xFE";
 z+="        For I = 1 To Len(ValueNow)\xFE";
 z+="           C = Mid(ValueNow, I, 1)\xFE";
 z+="           if IsNumeric(C) Or C = \".\" Then \xFE";
 z+="               V := C\xFE";
 z+="            else\xFE";
 z+="               if Len(V) Then Break\xFE";
 z+="            end if\xFE";
 z+="        Next\xFE";
 z+="    Else\xFE";
 z+="       V = ValueNow\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    V = Val(V)\xFE";
 z+="    \xFE";
 z+="    If V < ValueMin Then V = ValueMin\xFE";
 z+="    If V > ValueMax Then V = ValueMax\xFE";
 z+="    \xFE";
 z+="    V -= ValueMin\xFE";
 z+="    ValueMax -= ValueMin\xFE";
 z+="    \xFE";
 z+="    If ValueMax Then percentDone = CInt(V / ValueMax * 10000) / 100 Else ValueMax = 100\xFE";
 z+="\xFE";
 z+="    If System(1) = \"js\" Then\xFE";
 z+="        If !Animate Then\xFE";
 z+="            $('#':Id:'_bar').hide()\xFE";
 z+="            $('#':Id:'_bar').width(percentDone:\"%\")\xFE";
 z+="            $('#':Id:'_bar').show()\xFE";
 z+="            $('#':Id:'_text').text(ValueNow)\xFE";
 z+="        Else\xFE";
 z+="            $('#':Id:'_bar').width(percentDone:\"%\")\xFE";
 z+="            $('#':Id:'_text').text(ValueNow)\xFE";
 z+="        End If\xFE";
 z+="        Return \"\"\xFE";
 z+="    Else\xFE";
 z+="        Return @Script(`\xFE";
 z+="            $('#`:Id:`_bar').hide().width(\"`:percentDone:`%\").show();\xFE";
 z+="            $('#`:Id:`_text').text(\"`:ValueNow:`\")\xFE";
 z+="        `)\xFE";
 z+="    End If\xFE";
 z+="End function"
window.cached_jsb_html["updateprogressbar"]=z;
var z="// acceptableMimeTypes = \"audio/*,video/*,image/*\"\xFE";
 z+="Function Uploadbox(ByVal ID As String, optional byval DefaultValue As Object, optional byval AutoPostBack As Object, optional byval allowMultipleFiles As Object, optional byval acceptableMimeTypes As StRiNg, optional byval lblAdditionalAttributes As Object, optional byval ctlAdditionalAttributes As Object) As StRiNg\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    * To work correctly, this must be inside a <form method=\"post\" enctype=\"multipart/form-data\">\xFE";
 z+="    Dim HTML As String\xFE";
 z+="    Dim AA As StRiNg\xFE";
 z+="\xFE";
 z+="    If isJson(DefaultValue) Or IsArray(DefaultValue) Then\xFE";
 z+="         lblAdditionalAttributes = DefaultValue\xFE";
 z+="         DefaultValue = ''\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    If isJson(AutoPostBack) Or IsArray(AutoPostBack) Then\xFE";
 z+="         lblAdditionalAttributes = AutoPostBack\xFE";
 z+="         AutoPostBack = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    If isJson(allowMultipleFiles) Or IsArray(allowMultipleFiles) Then\xFE";
 z+="         lblAdditionalAttributes = allowMultipleFiles\xFE";
 z+="         allowMultipleFiles = False\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Html = Chr(28)\xFE";
 z+="    If DefaultValue Or Len(lblAdditionalAttributes) Or Len(ctlAdditionalAttributes) Then\xFE";
 z+="        Aa  = @MergeAttribute(\"class\", \"form-control\", \" \", lblAdditionalAttributes)\xFE";
 z+="        \xFE";
 z+="        if true then\xFE";
 z+="             AA = Replace(AA, \"text:\", \"href:\")\xFE";
 z+="             Html := \"<a class='Anchor form-control' target='_blank' href='\":@HtmlRoot:'uploads/':DefaultValue:\"'\"\xFE";
 z+="        else\xFE";
 z+="             Html := \"<label class='CtlLabel form-control'\"\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        if Id Then Html := \" id='ctllbl_\":ID:\"'\"\xFE";
 z+="        \xFE";
 z+="        Html := JoinAttributes(@MergeAttribute(\"class\", \"UploadBoxLbl\", \" \", Aa)):\">\"\xFE";
 z+="        Html := Replace(@HtmlEncode(DefaultValue), Chr(13), \"<br />\")\xFE";
 z+="        \xFE";
 z+="        if true then Html := \"</a>\" else Html := \"</label>\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Html := `<input type=\"file\"`\xFE";
 z+="    If Id Then Html := ` name=\"`:Id:`\" id=\"`:Id:`\"`\xFE";
 z+="    if allowMultipleFiles then HTML := ` multiple`\xFE";
 z+="    if acceptableMimeTypes then HTML := ` accept='`:acceptableMimeTypes:`'`\xFE";
 z+="    Aa  = @MergeAttribute(\"class\", \"form-control\", \" \", ctlAdditionalAttributes)\xFE";
 z+="    Html := JoinAttributes(@MergeAttribute(\"class\", \"UploadBoxInput\", \" \", Aa))\xFE";
 z+="    HTML := `/>`:CHR(29)\xFE";
 z+="    \xFE";
 z+="    If AutoPostBack And ID <> \"\" Then Html := @Script(` $(\"#`:ID:`\").change(function() { doJsbSubmit(true) } );`)\xFE";
 z+="\xFE";
 z+="    RETURN HTML\xFE";
 z+="end function"
window.cached_jsb_html["uploadbox"]=z;
var z="FUNCTION VSplitter(ByVal ID As String, byval lhDIV As String, byval rhDIV As String, optional byval startpixeloffset As Integer) As String\xFE";
 z+="    $options async-\xFE";
 z+="    \xFE";
 z+="    if !startpixeloffset And IsNum(rhDIV) then\xFE";
 z+="        startpixeloffset = rhDIV\xFE";
 z+="        rhDIV = lhDIV\xFE";
 z+="        lhDIV = ID\xFE";
 z+="        ID = ''\xFE";
 z+="    end if\xFE";
 z+="        \xFE";
 z+="    if !ID Then ID = 'Splitter_':Rnd(99999)\xFE";
 z+="    if !startpixeloffset then startpixeloffset = 150\xFE";
 z+="\xFE";
 z+="    Dim HTML As String = CHR(28):`\xFE";
 z+="      <div id=\"`:ID:`\" class=\"vsplitter\">\xFE";
 z+="          <div id=\"`:ID:`_LFT\" class=\"vsplitterleft\" style=\"width:`:startpixeloffset:`px\">`:CHR(29):lhDIV:CHR(28):`</div>\xFE";
 z+="          <div id=\"`:ID:`_SEP\" class=\"vsplitterseperator\" ></div>\xFE";
 z+="          <div id=\"`:ID:`_RGT\" class=\"vsplitterright\">`:CHR(29):rhDIV:CHR(28):`</div>\xFE";
 z+="       </div>\xFE";
 z+="       <script>\xFE";
 z+="            vSplitterDragElement(\"`:ID:`\");\xFE";
 z+="        </script>\xFE";
 z+="    `:Chr(29)\xFE";
 z+="\xFE";
 z+="    Return HTML\xFE";
 z+="end function"
window.cached_jsb_html["vsplitter"]=z;
window.cached_jsb_html["windowclose"]="function WindowClose() As StRiNg\xFE    $options async-\xFE    Return closeWindow()\xFEend function";
var z="/*\xFE";
 z+=" \xFE";
 z+="    Select \"*\" From fHandle(\"democustomers.json\") To Ss Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    userSettings = {}\xFE";
 z+="    // userSettings.devXGridLayout = ...\xFE";
 z+="    // userSettings.latColumnName\xFE";
 z+="    // userSettings.lngColumnName\xFE";
 z+="    // userSettings.hideExportBtns\xFE";
 z+="    // userSettings.primaryKeyField \xFE";
 z+="    // userSettings.additionalButtons = [@Submitbtn(\"BtnReset\", \"Reset Layout\"), ...]\xFE";
 z+="    \xFE";
 z+="    // userSettings.latColumnName\xFE";
 z+="    Html = @devXGrid('devXGrid', Ss, userSettings)\xFE";
 z+="    \xFE";
 z+="    // On aspxGrid page now\xFE";
 z+="    print @devxGrid_additionalSettings()\xFE";
 z+="    \xFE";
 z+="    // Client-Side Event Examples:\xFE";
 z+="    devXGrid = System(29).getControl('devXGrid')\xFE";
 z+="    devXGrid.ClientSideEvents.BeginCallback = 'devXGrid':\"_BeginCallback\"\xFE";
 z+="    Html := @Script(`function devXGrid_BeginCallback(s, e) { window.cbName = e.command }`)\xFE";
 z+="    \xFE";
 z+="    // Force server side code to run after a callback (a Save)\xFE";
 z+="    devXGrid.ClientSideEvents.EndCallback = 'devXGrid':\"_EndCallback\"\xFE";
 z+="    Html := @Script(`function devXGrid_EndCallback(s, e) { if (window.cbName) { alert(window.cbName); window.cbName = ''  }}`) \xFE";
 z+="\xFE";
 z+="    devXGrid.ClientSideEvents.Init = 'devXGrid':\"_onInit\"\xFE";
 z+="    Html := @Script(`function devXGrid_onInit(s, e) { alert('Grid Ready!') }`)\xFE";
 z+="    \xFE";
 z+="    Print Html:\xFE";
 z+="    \xFE";
 z+="    @Server.Pause\xFE";
 z+="    \xFE";
 z+="    // Get layout\xFE";
 z+="    devXGrid = System(29).getControl('devXGrid')\xFE";
 z+="    devXGrid.LoadClientLayout(devXGridLayout)\xFE";
 z+="    GridFilter = devXGrid.FilterExpression\xFE";
 z+="\xFE";
 z+="*/\xFE";
 z+="    \xFE";
 z+="function devXGrid(ByVal gridID As String, ByVal SelectList As Object, ByVal userSettings As JSON) As String\xFE";
 z+="    *$options aspx\xFE";
 z+="    *$options internal devXGrid, myPage, Ds\xFE";
 z+="    \xFE";
 z+="    Dim I As Integer\xFE";
 z+="    Dim TOOLBAR As Object\xFE";
 z+="    Dim HTML As String = \"\"\xFE";
 z+="    Dim devXGrid As Object\xFE";
 z+="    Dim myPage As Object\xFE";
 z+="\xFE";
 z+="    Dim Ds As Object\xFE";
 z+="    Dim M As Object\xFE";
 z+="    Dim devXGridLayout As String\xFE";
 z+="    Dim isAspxPage As Boolean\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    myPage = System(29)\xFE";
 z+="    if myPage Then devXGrid = myPage.getControl('devXGrid')\xFE";
 z+="    if !devXGrid Then\xFE";
 z+="        // force ourselves to go to the devXPage\xFE";
 z+="        myParams = Field(@Url, \"?\", 2)\xFE";
 z+="        if Len(myParams) Then\xFE";
 z+="            myParams = \"?\":MyParams\xFE";
 z+="            Sep = \"&\"\xFE";
 z+="        Else\xFE";
 z+="            Sep = \"?\"\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        if InStr(myParams, \"basePage=\") = 0 then \xFE";
 z+="            myParams := Sep:\"basePage=\":@UrlEncode(Field(@Url, \"?\", 1)) \xFE";
 z+="            Sep = \"&\"\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        if false and InStr(myParams, \"_SID_=\") = 0 then \xFE";
 z+="            myParams := Sep:\"_SID_=\":@UrlEncode(@UserNo) \xFE";
 z+="            Sep = \"&\"\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        toUrl = @jsbRootAct():'aspxGrid.aspx':myParams\xFE";
 z+="        reDirectPost(toUrl)\xFE";
 z+="\xFE";
 z+="        myPage = System(29)\xFE";
 z+="        if myPage Then devXGrid = myPage.getControl('devXGrid')\xFE";
 z+="        if !devXGrid Then Stop \"We should have redirected to devXGrid.aspx! and I can't find the devxGrid control!\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    devXGridLayout = userSettings.devXGridLayout\xFE";
 z+="    \xFE";
 z+="    // filename given?\xFE";
 z+="    if isString(SelectList) Then\xFE";
 z+="        open SelectList to SelectList else return @Errors\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // fileHandle given?\xFE";
 z+="    if typeOfFile(SelectList) Then\xFE";
 z+="        select \"*\" from s to SelectList else return @Errors\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // Must be SelectList\xFE";
 z+="    if SelectList.RowHandle then\xFE";
 z+="        ds = SelectList.RowHandle.Table\xFE";
 z+="    Else\xFE";
 z+="        ds = []\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    //  Any break points after this will cause the aspx page to be recreated - an lose the myPage Handle!\xFE";
 z+="    devXGrid = System(29).getControl('devXGrid')\xFE";
 z+="    devXGrid.AutoGenerateColumns = True\xFE";
 z+="    \xFE";
 z+="    devXGrid = System(29).getControl('devXGrid')\xFE";
 z+="    devXGrid.DataSource = ds\xFE";
 z+="    \xFE";
 z+="    devXGrid.Settings.ColumnMaxWidth = 2000\xFE";
 z+="    \xFE";
 z+="    devXGrid.Settings.ShowFooter = True\xFE";
 z+="    devXGrid.Settings.ShowGroupPanel = True\xFE";
 z+="    devXGrid.Settings.ShowHeaderFilterButton = True\xFE";
 z+="    devXGrid.Settings.ShowTitlePanel = True\xFE";
 z+="    devXGrid.SettingsContextMenu.Enabled = True\xFE";
 z+="    devXGrid.SettingsContextMenu.EnableRowMenu = True\xFE";
 z+="    \xFE";
 z+="    devXGrid.AutoGenerateColumns = True\xFE";
 z+="    devXGrid.Width = CreateObject(\"Unit(Percentage,100)\")\xFE";
 z+="    \xFE";
 z+="    devXGrid.SettingsResizing.ColumnResizeMode = 1 ;* Allow user to resize individual columns\xFE";
 z+="    devXGrid.SettingsResizing.Visualization = 1 ;* Live\xFE";
 z+="    devXGrid.Settings.ShowGroupPanel = true\xFE";
 z+="    devXGrid.SettingsBehavior.ColumnMoveMode = 0 ;* AmongSiblings\xFE";
 z+="    devXGrid.SettingsBehavior.EnableCustomizationWindow = True\xFE";
 z+="    // devXGrid.SettingsBehavior.ProcessColumnMoveOnClient = True\xFE";
 z+="    devXGrid.SettingsBehavior.AllowFocusedRow = True\xFE";
 z+="    devXGrid.SettingsPager.PageSize = 15\xFE";
 z+="    devXGrid.SettingsPager.PageSizeItemSettings.ShowAllItem = False\xFE";
 z+="    devXGrid.SettingsPager.PageSizeItemSettings.Items = [\"15\",\"30\",\"100\",\"500\"]\xFE";
 z+="    devXGrid.SettingsPager.AlwaysShowPager = True               \xFE";
 z+="    devXGrid.SettingsPager.PageSizeItemSettings.Visible = True \xFE";
 z+="    devXGrid.SettingsPager.PageSizeItemSettings.Position = 0 ;* Left(0), Right(1)\xFE";
 z+="    // devXGrid.SettingsPager.Position = 0\xFE";
 z+="    devXGrid.SettingsPager.ShowSeparators = False\xFE";
 z+="    devXGrid.SettingsPager.Summary.Visible = True\xFE";
 z+="    devXGrid.SettingsPager.Position = 2 ; // 0 (Bottom), 1(Top), 2(Top and Bottom)\xFE";
 z+="\xFE";
 z+="    devXGrid.SettingsPager.ShowNumericButtons = True\xFE";
 z+="        \xFE";
 z+="    if Ds.Rows.Count > 100 Then\xFE";
 z+="        devXGrid.Settings.ShowFilterRow = True\xFE";
 z+="        devXGrid.Settings.ShowFilterBar = True\xFE";
 z+="    Else\xFE";
 z+="        devXGrid.Settings.ShowFilterRow = False\xFE";
 z+="        devXGrid.Settings.ShowFilterBar = False\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    devXGrid.DataBind()  // will AutoGenerateColumns\xFE";
 z+="    \xFE";
 z+="    if userSettings.latColumnName = \"\" then\xFE";
 z+="        dim grdColumns = devXGrid.Columns\xFE";
 z+="        grdColumnCnt = UBound(grdColumns)\xFE";
 z+="        for i = 1 to grdColumnCnt\xFE";
 z+="            grdColumn = grdColumns(i)\xFE";
 z+="            if Lcase(grdColumn.FieldName) = \"latitude\" then \xFE";
 z+="                userSettings.latColumnName = grdColumn.FieldName\xFE";
 z+="                break\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="        for i = 1 to grdColumnCnt\xFE";
 z+="            grdColumn = grdColumns(i)\xFE";
 z+="            if Lcase(grdColumn.FieldName) = \"longitude\" then \xFE";
 z+="                userSettings.lngColumnName = grdColumn.FieldName\xFE";
 z+="                break\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Dim showMap As Boolean = userSettings.latColumnName <> \"\" And userSettings.lngColumnName <> \"\"\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    If devXGrid.Toolbars.Count = 0 Then\xFE";
 z+="        devXGrid.SettingsExport.EnableClientSideExportAPI = True\xFE";
 z+="        toolBar = CreateObject(\"GridViewToolbar\")\xFE";
 z+="        toolBar.Position = 1 // 0 (Top), 1(Bottom)\xFE";
 z+="        devXGrid.Toolbars.Add(toolBar)\xFE";
 z+="        toolBar.EnableAdaptivity = True\xFE";
 z+="        \xFE";
 z+="        if showMap then\xFE";
 z+="            // Show MAP\xFE";
 z+="            Btn = CreateObject(\"GridViewToolbarItem\")\xFE";
 z+="            Btn.Text = \"Show Map\"\xFE";
 z+="            Btn.name = \"ShowMap\"\xFE";
 z+="            if userSettings.primaryKeyField Then\xFE";
 z+="                Btn.NavigateUrl = `javascript: HideShowMap(this, '`:userSettings.lngColumnName:`','`:userSettings.latColumnName:`',['`:userSettings.primaryKeyField:`']); `\xFE";
 z+="            Else\xFE";
 z+="                Btn.NavigateUrl = `javascript: HideShowMap(this, '`:userSettings.lngColumnName:`','`:userSettings.latColumnName:`'); `\xFE";
 z+="            End If\xFE";
 z+="            toolBar.Items.Add(Btn)\xFE";
 z+="        end if\xFE";
 z+="                \xFE";
 z+="        Btns = [10,6,1,2,4,8] // see Button Command #'s below\xFE";
 z+="        \xFE";
 z+="        moreBtns = userSettings.additionalButtons ;* = [ {name:'btn', text:'click me', onclick: 'xxx'}, ... ]\xFE";
 z+="        for each BtnDef in moreBtns\xFE";
 z+="            Btn = CreateObject(\"GridViewToolbarItem\")\xFE";
 z+="            Btn.Text = BtnDef.text\xFE";
 z+="            Btn.name = BtnDef.name\xFE";
 z+="            oc = BtnDef.onclick\xFE";
 z+="            if !oc then oc = `assignBtn(`:jsEscapeString(BtnDef.name):`, `:jsEscapeString(BtnDef.text):`); preventTheDefault(); doJsbSubmit(false);`\xFE";
 z+="            if left(oc, 4) = \"http\" then Btn.NavigateUrl = oc else Btn.NavigateUrl = `javascript: `:oc\xFE";
 z+="            toolBar.Items.Add(Btn)\xFE";
 z+="        next\xFE";
 z+="        \xFE";
 z+="        if !userSettings.hideExportBtns Then     \xFE";
 z+="            Btns[-1] = 28\xFE";
 z+="            Btns[-1] = 29\xFE";
 z+="            Btns[-1] = 30\xFE";
 z+="            Btns[-1] = 32\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        for each Btn in Btns\xFE";
 z+="            m = CreateObject(\"GridViewToolbarItem\")\xFE";
 z+="            toolBar.Items.Add(m)\xFE";
 z+="            m.Command = Btn\xFE";
 z+="        Next\xFE";
 z+="  \xFE";
 z+="        if showMap then\xFE";
 z+="            Btn = CreateObject(\"GridViewToolbarItem\")\xFE";
 z+="            Btn.Text = \"Export KML\"\xFE";
 z+="            Btn.name = \"ExportKML\"\xFE";
 z+="            //if @isAdmin then Btn.Image.Url = \"~/jsb/pics/run.png\"\xFE";
 z+="            Btn.NavigateUrl = `javascript: $('#jsb').append('<input id=\"Btn\" name=\"Btn\" type=\"hidden\" value=\"Export KML\" />'); doJsbSubmit(false); `\xFE";
 z+="            toolBar.Items.Add(Btn)\xFE";
 z+="        end if\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    // Enabling HorizontalScrollBarMode means that the width of the ASPxGridView and Columns should be specified. \xFE";
 z+="    if IsMissing(userSettings.HorizontalScrollBarMode) Then\xFE";
 z+="        if !devXGridLayout Then \xFE";
 z+="            devXGrid.Settings.HorizontalScrollBarMode = 2 ' // 0-Hidden, 1-Visible (Allows user to change columns), 2-Auto\xFE";
 z+="        Else\xFE";
 z+="            devXGrid.Settings.HorizontalScrollBarMode = 1 // 0-Hidden, 1-Visible (Allows user to change columns), 2-Auto\xFE";
 z+="        End If\xFE";
 z+="    Else\xFE";
 z+="        devXGrid.Settings.HorizontalScrollBarMode = userSettings.HorizontalScrollBarMode\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if userSettings.devXGridFilter Then\xFE";
 z+="        devXGrid.FilterExpression = userSettings.devXGridFilter\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    Html = \"{{\":\"marker}}\"\xFE";
 z+="    \xFE";
 z+="    if devXGridLayout Then \xFE";
 z+="        on error goto skipLayout\xFE";
 z+="        devXGrid.LoadClientLayout(devXGridLayout)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If !devXGrid.TotalSummary.Count Then\xFE";
 z+="        totalRowCnt = CreateObject(\"ASPxSummaryItem\")\xFE";
 z+="        dim grdColumns = devXGrid.Columns\xFE";
 z+="        grdColumnCnt = UBound(grdColumns)\xFE";
 z+="        grdColumn = grdColumns(1)\xFE";
 z+="        totalRowCnt.FieldName = grdColumn.FieldName\xFE";
 z+="        totalRowCnt.ShowInColumn = grdColumn.FieldName\xFE";
 z+="        totalRowCnt.DisplayFormat = \"{0} Total Visible Rows.\"\xFE";
 z+="        totalRowCnt.SummaryType = 3 ; // Count\xFE";
 z+="        devXGrid.TotalSummary.Add(totalRowCnt)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="skipLayout:\xFE";
 z+="    return html\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function devxGrid_additionalSettings()\xFE";
 z+="    *$options internal devXGrid, myPage, tc, b\xFE";
 z+="    *$options aspx\xFE";
 z+="    \xFE";
 z+="    myPage = System(29)\xFE";
 z+="    if myPage Then devXGrid = myPage.getControl('devXGrid')\xFE";
 z+="    if !devXGrid Then return \"\"\xFE";
 z+="\xFE";
 z+="    sb = []\xFE";
 z+="    sb[-1] = `{`\xFE";
 z+="    tcSep = \"\"\xFE";
 z+="    For i As Integer = 1 To 2\xFE";
 z+="        Dim tc As Object // ASPxSummaryItemCollection\xFE";
 z+="        If i = 1 Then\xFE";
 z+="            tc = devXGrid.TotalSummary\xFE";
 z+="            if tc.Count then sb[-1] = tcSep:`TotalSummary:[`\xFE";
 z+="        Else\xFE";
 z+="            tc = devXGrid.GroupSummary\xFE";
 z+="            if tc.Count then sb[-1] = tcSep:`GroupSummary:[`\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        For bi = 1 to tc.Count\xFE";
 z+="            b = tc[bi]\xFE";
 z+="            If bi > 1 Then sb[-1] = `,`\xFE";
 z+="            sb[-1] = `{`\xFE";
 z+="            sb[-1] = `FieldName:\"` : b.FieldName : `\"`\xFE";
 z+="            ' sb[-1] = `,Index:` : b.Index\xFE";
 z+="            sb[-1] = `,SummaryType:\"` : b.SummaryType : `\"`\xFE";
 z+="            If Len(b.Tag) Then sb[-1] = `,Tag:\"` : b.Tag : `\"`\xFE";
 z+="            If Len(b.ShowInColumn) Then sb[-1] = `,ShowInColumn:\"` : b.ShowInColumn : `\"`\xFE";
 z+="            If Len(b.ShowInGroupFooterColumn) Then sb[-1] = `,ShowInGroupFooterColumn:\"` : b.ShowInGroupFooterColumn : `\"`\xFE";
 z+="            If Len(b.DisplayFormat) Then sb[-1] = `,DisplayFormat:\"` : b.DisplayFormat : `\"`\xFE";
 z+="            If Len(b.ValueDisplayFormat) Then sb[-1] = `,ValueDisplayFormat:\"` : b.ValueDisplayFormat : `\"`\xFE";
 z+="            sb[-1] = `}`\xFE";
 z+="        Next\xFE";
 z+="        if tc.Count then \xFE";
 z+="            sb[-1] = `]`\xFE";
 z+="            tcSep = \",\"\xFE";
 z+="        end if\xFE";
 z+="    Next\xFE";
 z+="    sb[-1] = `}`\xFE";
 z+="    return join(sb, \"\")\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="function devxGrid_downloadKML(byVal gridID As String, ByVal userSettings As JSON, optional byval noQuestions As Boolean)\xFE";
 z+="    *$options aspx\xFE";
 z+="    \xFE";
 z+="    devXGrid = System(29).getControl(gridID)   // Don't set breakpoints until done using\xFE";
 z+="    \xFE";
 z+="    VisibleRowCount = devXGrid.VisibleRowCount\xFE";
 z+="    doIt = True\xFE";
 z+="    If VisibleRowCount > 10000 and !noQuestions Then\xFE";
 z+="        doIt = Msgbox(\"You have \":VisibleRowCount:\" records, proceed with export?\", \"Yes,No\") = \"Yes\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If doIt Then\xFE";
 z+="        Kml = ['<?xml version=\"1.0\" encoding=\"UTF-8\"?><kml xmlns=\"http://www.opengis.net/kml/2.2\"><Document>']\xFE";
 z+="        devXGrid = System(29).getControl(gridID)   // Don't set breakpoints until done using\xFE";
 z+="        \xFE";
 z+="        // Make each group into a KML folder\xFE";
 z+="        dim grdColumns = devXGrid.Columns\xFE";
 z+="        grdColumnCnt = UBound(grdColumns)\xFE";
 z+="        \xFE";
 z+="        groupColumns = []\xFE";
 z+="        for i = 1 to grdColumnCnt\xFE";
 z+="            grdColumn = grdColumns(i)\xFE";
 z+="            GroupIndex = grdColumn.GroupIndex\xFE";
 z+="            if GroupIndex <> -1 Then\xFE";
 z+="                groupColumns[GroupIndex+1] = grdColumn.FieldName\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="        grpColumnCnt = UBound(groupColumns)\xFE";
 z+="        groupValues = []\xFE";
 z+="        nestedInFolder = false\xFE";
 z+="        GotDetails = False\xFE";
 z+="        \xFE";
 z+="        For VisibleRowNo = 0 To VisibleRowCount - 1\xFE";
 z+="            Row = devXGrid.GetDataRow(VisibleRowNo)\xFE";
 z+="            \xFE";
 z+="            If !devXGrid.IsGroupRow(VisibleRowNo) Then\xFE";
 z+="                if grpColumnCnt Then\xFE";
 z+="                    startANewGroup = False\xFE";
 z+="                    for i = 1 to grpColumnCnt\xFE";
 z+="                        grpCName = groupColumns[i]\xFE";
 z+="                        pVal = groupValues[i]\xFE";
 z+="                        cVal = Row[grpCName]\xFE";
 z+="                        if pVal <> cVal Then \xFE";
 z+="                            startANewGroup = True\xFE";
 z+="                            break\xFE";
 z+="                        end if\xFE";
 z+="                    next\xFE";
 z+="                    \xFE";
 z+="                    if startANewGroup then\xFE";
 z+="                        if nestedInFolder Then Kml[-1] = \"</Folder>\"\xFE";
 z+="                        \xFE";
 z+="                        for i = 1 to grpColumnCnt\xFE";
 z+="                            grpCName = groupColumns[i]\xFE";
 z+="                            cVal = Row[grpCName]\xFE";
 z+="                            groupValues[i] = cVal\xFE";
 z+="                        next\xFE";
 z+="                        \xFE";
 z+="                        Kml[-1] = \"<Folder>\"\xFE";
 z+="                        Kml[-1] = \"<name>\":@HtmlEncode(Join(groupValues, \" \")):\"</name>\"\xFE";
 z+="                        nestedInFolder = true\xFE";
 z+="                    end if\xFE";
 z+="                end if\xFE";
 z+="                   \xFE";
 z+="                Point = '<Point><coordinates>':Row(userSettings.lngColumnName):',':Row(userSettings.latColumnName):'</coordinates></Point>'\xFE";
 z+="                \xFE";
 z+="                desc = []\xFE";
 z+="                for i = 1 to grdColumnCnt\xFE";
 z+="                    grdColumn = grdColumns(i)\xFE";
 z+="                    cName = grdColumn.FieldName\xFE";
 z+="                    val = CStr(Row(cName))\xFE";
 z+="                    if Left(val, 4) = \"http\" Then\xFE";
 z+="                        desc[-1] = @HtmlEncode(cName:\": \"):'<a href=\"':val:'\">':Val:'</a>' \xFE";
 z+="                    Else\xFE";
 z+="                        desc[-1] = @HtmlEncode(cName:\": \":Val) \xFE";
 z+="                    End If\xFE";
 z+="                next\xFE";
 z+="                \xFE";
 z+="                KML[-1] = \"<Placemark><description>\":Join(Desc, \"<br />\"):\"</description>\":Point:\"</Placemark>\"\xFE";
 z+="                GotDetails = True\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        if nestedInFolder Then Kml[-1] = \"</Folder>\"\xFE";
 z+="        KML[-1] = \"</Document></kml>\"\xFE";
 z+="        \xFE";
 z+="        if !GotDetails Then\xFE";
 z+="            Print @Script('alert(\"Please expand at least one group\")'):\xFE";
 z+="        else\xFE";
 z+="            ReportName = userSettings.reportName\xFE";
 z+="            if !ReportName Then ReportName = userSettings.tableName\xFE";
 z+="            if !ReportName Then ReportName = userSettings.databaseName\xFE";
 z+="            if !ReportName Then ReportName = gridID\xFE";
 z+="            \xFE";
 z+="            Print @Script('saveFile(\"':reportName:'.kml\", \"application/vnd.google-earth.kmz\", ':jsEscapeString(Join(KML, \"\\n\")):')'):\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="function devxGrid_VisibleRows(byVal gridID As String) As Array\xFE";
 z+="    *$options aspx\xFE";
 z+="    \xFE";
 z+="    devXGrid = System(29).getControl(gridID)   // Don't set breakpoints until done using\xFE";
 z+="    dim grdColumns = devXGrid.Columns\xFE";
 z+="    grdColumnCnt = UBound(grdColumns)\xFE";
 z+="    VisibleRowCount = devXGrid.VisibleRowCount\xFE";
 z+="    \xFE";
 z+="    Points = []\xFE";
 z+="    For VisibleRowNo = 0 To VisibleRowCount - 1\xFE";
 z+="        Row = devXGrid.GetDataRow(VisibleRowNo)\xFE";
 z+="        oRow = {}\xFE";
 z+="        for i = 1 to grdColumnCnt\xFE";
 z+="            grdColumn = grdColumns(i)\xFE";
 z+="            cName = grdColumn.FieldName\xFE";
 z+="            val = Row(cName)\xFE";
 z+="            if Len(val) then oRow(grdColumn.FieldName) = val\xFE";
 z+="        next\xFE";
 z+="        Points[-1] = CStr(oRow)\xFE";
 z+="    Next\xFE";
 z+="    return Points\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="/* \xFE";
 z+="    \xFE";
 z+="    // Setup an individual column\xFE";
 z+="    devXGrid.Columns[#].Visible = True / False\xFE";
 z+="    devXGrid.Columns[#].groupIndex = 0...n (or -1)\xFE";
 z+="    devXGrid.Columns[#].VisibleIndex = 0...n (or -1)\xFE";
 z+="    devXGrid.Columns[#].ReadOnly = True / False\xFE";
 z+="    devXGrid.Columns[#].Width = \xFE";
 z+="    devXGrid.Columns[#].ToolTip =\xFE";
 z+="    devXGrid.Columns[#].Caption =\xFE";
 z+="    \xFE";
 z+="    // events\xFE";
 z+="    devXGrid.ClientSideEvents.BeginCallback = \"aspxGridView_BeginCallback\"\xFE";
 z+="    devXGrid.ClientSideEvents.CallbackError = \"aspxGridView_CallbackError\"\xFE";
 z+="    devXGrid.ClientSideEvents.ColumnGrouping = \"aspxGridView_ColumnGrouping\"\xFE";
 z+="    devXGrid.ClientSideEvents.ColumnMoving = \"aspxGridView_ColumnMoving\"\xFE";
 z+="    devXGrid.ClientSideEvents.ColumnResized = \"aspxGridView_ColumnResized\"\xFE";
 z+="    devXGrid.ClientSideEvents.ColumnResizing = \"aspxGridView_ColumnResizing\"\xFE";
 z+="    devXGrid.ClientSideEvents.ColumnSorting = \"aspxGridView_ColumnSorting\"\xFE";
 z+="    devXGrid.ClientSideEvents.ColumnStartDragging = \"aspxGridView_xxxx\"\xFE";
 z+="    devXGrid.ClientSideEvents.ContextMenu = \"aspxGridView_ContextMenu\"\xFE";
 z+="    devXGrid.ClientSideEvents.ContextMenuItemClick = \"aspxGridView_ContextMenuItemClick\"\xFE";
 z+="    devXGrid.ClientSideEvents.CustomButtonClick = \"aspxGridView_CustomButtonClick\"\xFE";
 z+="    devXGrid.ClientSideEvents.CustomizationWindowCloseUp = \"aspxGridView_CustomizationWindowCloseUp\"\xFE";
 z+="    devXGrid.ClientSideEvents.DetailRowCollapsing = \"aspxGridView_DetailRowCollapsing\"\xFE";
 z+="    devXGrid.ClientSideEvents.DetailRowExpanding = \"aspxGridView_DetailRowExpanding\"\xFE";
 z+="    devXGrid.ClientSideEvents.EndCallback = \"aspxGridView_EndCallback\"\xFE";
 z+="    devXGrid.ClientSideEvents.FocusedCellChanging = \"aspxGridView_FocusedCellChanging\"\xFE";
 z+="    devXGrid.ClientSideEvents.FocusedRowChanged = \"aspxGridView_FocusedRowChanged\"\xFE";
 z+="    devXGrid.ClientSideEvents.RowClick = \"aspxGridView_RowClick\"\xFE";
 z+="    devXGrid.ClientSideEvents.RowCollapsing = \"aspxGridView_RowCollapsing\"\xFE";
 z+="    devXGrid.ClientSideEvents.RowDblClick = \"aspxGridView_RowDblClick\"\xFE";
 z+="    devXGrid.ClientSideEvents.RowExpanding = \"aspxGridView_RowExpanding\"\xFE";
 z+="    devXGrid.ClientSideEvents.RowFocusing = \"aspxGridView_RowFocusing\"\xFE";
 z+="    devXGrid.ClientSideEvents.SelectionChanged = \"aspxGridView_SelectionChanged\"\xFE";
 z+="    devXGrid.ClientSideEvents.ToolbarItemClick = \"aspxGridView_ToolbarItemClick\"\xFE";
 z+="    \xFE";
 z+="    Button Command #'s\xFE";
 z+="    0   Custom\xFE";
 z+="    1 FullExpand A command that expands all rows.\xFE";
 z+="    2 FullCollapse A command that collapses all rows.\xFE";
 z+="    3 ClearSorting A command that clears sorting by the current column.\xFE";
 z+="    4 ClearFilter A command that clears the filter applied to the current column.\xFE";
 z+="    5 ShowFilterEditor A command that controls the filter control visibility.\xFE";
 z+="    6 ShowFilterRow A command that controls the filter row visibility.\xFE";
 z+="    7 ShowFilterRowMenu A command that controls the filter row menu visibility.\xFE";
 z+="    8 ClearGrouping A command that clears the grouping in the grid's group panel.\xFE";
 z+="    9 ShowGroupPanel A command that controls the group panel visibility.\xFE";
 z+="    10 ShowSearchPanel A command that controls the search panel visibility.\xFE";
 z+="    11 ShowCustomizationWindow A command that controls the Column Chooser visibility.\xFE";
 z+="    12 ShowFooter A command that controls the footer visibility.\xFE";
 z+="    13 ShowCustomizationDialog A command that controls the Customization Dialog visibility.\xFE";
 z+="    14 Refresh A command that refreshes grid data.\xFE";
 z+="    15 New A command that creates a new row.\xFE";
 z+="    16 Edit A command that allows editing the current row.\xFE";
 z+="    17 Delete A command that deletes the current row.\xFE";
 z+="    18 DeleteSelectedRowsOnPage A command that deletes the selected rows on the page.\xFE";
 z+="    19 Update A command that saves all the changes made to the current data row and switches the ASPxGridView to browse mode.\xFE";
 z+="    20 Cancel A command that discards any changes made to the current row and switches the ASPxGridView to browse mode.\xFE";
 z+="    21 PreviewChanges A command that displays the changed preview information when the control is in batch edit mode.\xFE";
 z+="    22 HidePreview A command that hides the preview when the control is in batch edit mode.\xFE";
 z+="    23 UpdateSummaries A command that recalculates total and group summaries on the client in batch edit mode.\xFE";
 z+="    24 ExpandRow A command that expands the row.\xFE";
 z+="    25 CollapseRow A command that collapses the row.\xFE";
 z+="    26 ExpandDetailRow A command that expands the detail row.\xFE";
 z+="    27 CollapseDetailRow A command that collapses the detail row.\xFE";
 z+="    28 ExportToPdf A command that exports the grid's data to a file in PDF format.\xFE";
 z+="    29 ExportToDocx A command that exports the grid's data to a file in DOCX format.\xFE";
 z+="    30 ExportToRtf A command that exports the grid's data to a file in RTF format.\xFE";
 z+="    31 ExportToCsv A command that exports the grid's data to a file in CSV format.\xFE";
 z+="    32 ExportToXls A command that exports the grid's data to a file in XLS format.\xFE";
 z+="    33 ExportToXlsx A command that exports the grid's data to a file in XLSX format.\xFE";
 z+="    \xFE";
 z+="*/\xFE";
 z+=""
window.cached_jsb_html["__devxgrid.old"]=z;
}
anonymousFunc()
anonymousFunc = null