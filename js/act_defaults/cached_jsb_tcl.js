anonymousFunc = function () {
window.cachedFileNames["jsb_tcl"] = "jsb_tcl"
if (!window.cached_jsb_tcl) window.cached_jsb_tcl = {}
window.cached_jsb_tcl["add"]="Program ADD\xFE    Args = Split(Mid(@Sentence, Index(@Sentence, ' ') + 1), ' ')\xFE    Sum = 0\xFE    For Each Arg in Args\xFE       Sum += Val(Arg)\xFE    Next\xFE    Print Sum\xFE    ClearSelect\xFEEnd Program\xFE\xFEProgram ADDD\xFE    Args = Split(Mid(@Sentence, Index(@Sentence, ' ') + 1), ' ')\xFE    Sum = 0\xFE    For Each Arg in Args\xFE       Sum += Val(Arg)\xFE    Next\xFE    Print Sum\xFE    ClearSelect\xFEEnd Program\xFE\xFE";
window.cached_jsb_tcl["addx"]="Program ADDX\xFE    Args = Split(Mid(@Sentence, Index(@Sentence, ' ') + 1), ' ')\xFE    Sum = 0\xFE    For Each Arg in Args\xFE       Sum += XTD(Arg)\xFE    Next\xFE    Print DTX(Sum)\xFE    ClearSelect\xFEEnd Program\xFE";
var z="// Will by default run @jsbRootDir:`\\archive.bat`\xFE";
 z+="\xFE";
 z+="Program Backup\xFE";
 z+="*$options aspx, aspxc-\xFE";
 z+="    preventTimeOut = System(56)\xFE";
 z+="\xFE";
 z+="    logInfo(\"Nightly backup started\")\xFE";
 z+="    \xFE";
 z+="    ' Elevate permissions\xFE";
 z+="    On Error Goto lowerPermissions\xFE";
 z+="    call elevateToAdmin\xFE";
 z+="\xFE";
 z+="    adminRec = freadjson('jsb_users', 'admin')\xFE";
 z+="    if !adminRec then logErr(\"Unable to find adminRec\")\xFE";
 z+="    \xFE";
 z+="    if adminRec then \xFE";
 z+="        emailTo = adminRec.email\xFE";
 z+="        emailFrom = adminRec.emailFrom\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if !emailTo then logErr(\"Unable to find admin emailTo\")\xFE";
 z+="    \xFE";
 z+="    bytesFree = @@dosExecute(@jsbrootdir, \"dir a*.*\", Errs)\xFE";
 z+="    if bytesFree Then\xFE";
 z+="        bytesFree = trim(field(field(bytesFree, \"(s)\", 3), \"bytes\", 1))\xFE";
 z+="        nBytesFree = CNum(replace(bytesFree, \",\", \"\"))\xFE";
 z+="        if nBytesFree < 200000000 then \xFE";
 z+="            LogErr(\"Nightly backup aborted.  Not enough disk space. \":bytesFree:\" bytes free\")\xFE";
 z+="            @Email.send emailFrom, emailTo, \"\", \"\", \"Backup2 (open archives failed)  (\":@domain:\") at \":DateTime():' ':@Who, @Errors else LogErr(\"2 email failed: \":@Errors)\xFE";
 z+="            goto lowerPermissions\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    open `tmp` to fTmp else goto openErr\xFE";
 z+="    open `archives` to fArchives else goto openErr\xFE";
 z+="\xFE";
 z+="    delete fArchives, 'archive.txt' else null\xFE";
 z+="    \xFE";
 z+="    // Remove week old entries except 1st and 15th\xFE";
 z+="    fstats = filestats(fArchives)\xFE";
 z+="    if !fstats then stop\xFE";
 z+="    delBefore = CInt(Now() - 7)\xFE";
 z+="    \xFE";
 z+="    for each dirEntry in fstats.stats\xFE";
 z+="        theDay = CInt(field(dirEntry.date, \"/\", 2))\xFE";
 z+="        if (Right(dirEntry.name, 3) = \".7z\" Or right(dirEntry.name, 4) = \".zip\") and theDay <> 1 and theDay <> 15 then\xFE";
 z+="            if dirEntry.timeStamp  < delBefore Then \xFE";
 z+="               delete fArchives, dirEntry.name else Null\xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="    next\xFE";
 z+="\xFE";
 z+="    Cmd = \"archive.bat\"\xFE";
 z+="    Result = @@dosExecute(@jsbRootDir, Cmd, Errs)\xFE";
 z+="    \xFE";
 z+="    If Errs Then\xFE";
 z+="        LogErr(\"Nightly backup failed with \":Errs)\xFE";
 z+="        @Email.send emailFrom, emailTo, \"\", \"\", \"Failed archive.bat (\":@domain:\") at \":DateTime():' ':@Who, Errs Else LogErr(\"1 email errors \":@Errors)\xFE";
 z+="        goto lowerPermissions\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    open `archives` to fArchives else\xFE";
 z+="        LogErr(\"Nightly backup failed (open archives failed) \":TimeDate():am():@Errors)\xFE";
 z+="        @Email.send emailFrom, emailTo, \"\", \"\", \"Backup2 (open archives failed)  (\":@domain:\") at \":DateTime():' ':@Who, @Errors else LogErr(\"2 email failed: \":@Errors)\xFE";
 z+="        goto lowerPermissions\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    read note from fArchives, 'archive.txt' else note = @errors\xFE";
 z+="    if !InStr(note, 'Everything is Ok') Then\xFE";
 z+="        LogErr(\"Nightly backup failed with \":@Errors)\xFE";
 z+="        @Email.send emailFrom, emailTo, \"\", \"\", \"Backup failed (\":@domain:\") at \":DateTime():' ':@Who, note else LogErr(\"2 email failed: \":@Errors)\xFE";
 z+="        goto lowerPermissions\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // Show archive.txt\xFE";
 z+="    logInfo(\"Nightly backup finished\")\xFE";
 z+="    \xFE";
 z+="    errorsOnly = @queryvar('onlyerrors') \xFE";
 z+="    if @queryvar('errorsonly') then errorsOnly = true\xFE";
 z+="    \xFE";
 z+="    if !errorsOnly then\xFE";
 z+="        select fArchives to sl else stop @errors\xFE";
 z+="        content = Join(getlist(sl), crlf())\xFE";
 z+="        content := crlf():note\xFE";
 z+="        @Email.send emailFrom, emailTo, \"\", \"\", \"Successful JSB backup (\":@domain:\") on \":Field(DateTime(), ' ', 1), content Else LogErr(\"3 email failed: \":@Errors)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    goto lowerPermissions\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="openerr:\xFE";
 z+="    LogErr(\"Nightly backup failed with \":@Errors)\xFE";
 z+="    @Email.send emailFrom, emailTo, \"\", \"\", \"Backup2 (open file failed)  (\":@domain:\") at \":DateTime():' ':@Who, @Errors else LogErr(\"4 email failed: \":@Errors)\xFE";
 z+="\xFE";
 z+="lowerPermissions:\xFE";
 z+="    call restoreUserPrivileges\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["backup"]=z;
var z="Program Build\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    If !@IsAdmin Then Stop \"You must be an Admin to run this command\"\xFE";
 z+="    Dim Help As Array = [\"Update <file|*> (options: (l)ink only, (e)rase first force re-compile, (q)uick or (c)heck only for previous errors.\":crlf():\" This program will check edit times against last compile times, and compile and link if necessary.\"]\xFE";
 z+="    \xFE";
 z+="    Options = LCase(Field(@Sentence, \"(\", 2))\xFE";
 z+="    linkOnly = Instr(Options, \"l\") > 0\xFE";
 z+="    eraseFirst = Instr(Options, \"e\")\xFE";
 z+="    beQuiet = Instr(Options, \"s\")\xFE";
 z+="    quickOnly = InStr(Options, \"q\")\xFE";
 z+="    Onefile = lcase(Field(Field(@Sentence, \"(\", 1), \" \", 2))\xFE";
 z+="    onlyErrChk = Instr(Options, \"c\")\xFE";
 z+="    \xFE";
 z+="    if (!quickOnly and !OneFile and !eraseFirst) or InStr(options, \"?\") then Stop Help\xFE";
 z+="    \xFE";
 z+="    if onefile = \"*\" then \xFE";
 z+="        onefile = \"\"\xFE";
 z+="        if !eraseFirst then eraseFirst = MsgBox(\"Erase old pcd and javascript code first?\", \"Yes,No\")\xFE";
 z+="        if !eraseFirst or eraseFirst = Chr(27) Then Stop\xFE";
 z+="        eraseFirst = eraseFirst = \"Yes\"\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    IsJsb = @Domain = \"jsbwinforms.azurewebsites.net\"\xFE";
 z+="    \xFE";
 z+="    if quickOnly then \xFE";
 z+="       CoreJsb = Split(\"jsb_html,jsb_bf,jsb_tcl,jsb2js\", \",\")\xFE";
 z+="    else\xFE";
 z+="        Corejsb = Split(LCase(@Jsb_bf.jsbconfig(\"core.jsb\")), am())\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    fMD = fHandle('md')\xFE";
 z+="    fHTAMD = fHandle('htamd')\xFE";
 z+="    \xFE";
 z+="    If Onefile Then \xFE";
 z+="        Onefile = Truefilename(Onefile)\xFE";
 z+="        locate onefile in Corejsb else if onefile <> \"cs\" then stop Onefile:\" doesn't build\"\xFE";
 z+="        Flist = [Onefile]\xFE";
 z+="    Else\xFE";
 z+="        Flist = Corejsb \xFE";
 z+="        i_Open \"cs\" To Fcs Then \xFE";
 z+="            doAppend = True\xFE";
 z+="            For Each Fname, FI In Flist\xFE";
 z+="                If Left(Fname, 1) = \"*\" Then \xFE";
 z+="                    flist.Insert(FI, \"cs\")\xFE";
 z+="                    doAppend = False\xFE";
 z+="                    break\xFE";
 z+="                end if\xFE";
 z+="            next\xFE";
 z+="            if doAppend then flist[-1] = \"cs\"\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    If onlyErrChk Then\xFE";
 z+="        Print @(-1):\xFE";
 z+="        For Each Fname In Flist\xFE";
 z+="            If Left(Fname, 1) = \"*\" Then Exit For\xFE";
 z+="            i_Open 'dict', Fname To F Then\xFE";
 z+="                Select From F Where \"ItemID Like '%.ERR' Or ItemID Like '%.WRN'\" To Ss Then\xFE";
 z+="                    Idlist = GetList(Ss)\xFE";
 z+="                    For Each Id In Idlist\xFE";
 z+="                        Pid = Left(Id, Len(Id)-4)\xFE";
 z+="                        Pid = Left(Pid:Space(20), 20)\xFE";
 z+="                        Read Item From F, Id Then Print Fname,Pid,Item\xFE";
 z+="                    Next\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="        Stop 'done'\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    myAccount = LCase(@JSBAccount)\xFE";
 z+="    Progress = ''\xFE";
 z+="    \xFE";
 z+="    Write Progress On fHandle('tmp'), 'BuildStatus'\xFE";
 z+="    \xFE";
 z+="    If !linkOnly Then\xFE";
 z+="        compileCnt = 0\xFE";
 z+="        noChanges = []\xFE";
 z+="        /////////////////       /////////////////      /////////////////      /////////////////      \xFE";
 z+="        if !oneFile and !beQuiet Then Print @Bold(\"Checking for time-stamped updated items: \"):\xFE";
 z+="        For Each Fname In Flist\xFE";
 z+="            If Left(Fname, 1) = \"*\" Then Exit For\xFE";
 z+="            Fname = Truefilename(Fname)\xFE";
 z+="\xFE";
 z+="            If eraseFirst Then\xFE";
 z+="                Execute \"delete dict \":Fname:\" [.js [.basic.time [.pc.time [.compile.time (i\"\xFE";
 z+="                Execute \"delete md with *a2 = '\":Fname:\"' (i\"\xFE";
 z+="            Else\xFE";
 z+="                if !oneFile and !beQuiet Then Print Fname:\" \":\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            ' Get last edit times for each item in fname\xFE";
 z+="            i_Open Fname To F2 Else Stop @Errors\xFE";
 z+="            Fstats = Filestats(F2)\xFE";
 z+="            If !Fstats Then Stop @Errors\xFE";
 z+="            Fstats = Fstats.stats\xFE";
 z+="            \xFE";
 z+="            If Fname = \"jsb_odb\" Then\xFE";
 z+="                i_Open \"rests\" To X Else\xFE";
 z+="                    For Each dirEntry, I In Fstats\xFE";
 z+="                        If dirEntry.name = \"rpc_server\" Then\xFE";
 z+="                            Fstats.Delete(I)\xFE";
 z+="                            Break\xFE";
 z+="                        End If\xFE";
 z+="                    Next\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            NoChange = True\xFE";
 z+="            fdict_Handle = fHandle('dict', Fname)\xFE";
 z+="            Errors = \"\"\xFE";
 z+="            CCnt = 0\xFE";
 z+="            reLink = False\xFE";
 z+="            \xFE";
 z+="            If Fname = \"jsb_docs\" Then\xFE";
 z+="                Compilecmds = [\"compile\"]\xFE";
 z+="            Else\xFE";
 z+="                Compilecmds = [\"basic\", \"pc\"]\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            For Each dirEntry In Fstats\xFE";
 z+="                Iname = dirEntry.name\xFE";
 z+="                Idate = dirEntry.date\xFE";
 z+="                Itime = dirEntry.time\xFE";
 z+="                \xFE";
 z+="                iEditTimeStamp = Date(Idate:' ':Itime)\xFE";
 z+="                \xFE";
 z+="                For Each Cmd In Compilecmds\xFE";
 z+="                    Read CompileTimeStamp From fdict_Handle, Iname:\".\":Cmd:'.time' Else CompileTimeStamp = '1961-01-24 00:00:01'\xFE";
 z+="                    iCompileTimeStamp = Date(CompileTimeStamp)\xFE";
 z+="                    \xFE";
 z+="                    If iCompileTimeStamp < iEditTimeStamp And Left(Iname, 1) <> \"$\" And Left(Iname, 1) <> \"_\" Then\xFE";
 z+="                        Print anchorEdit(FName, IName, \" <\":Cmd:' ':Iname:\">\"):\xFE";
 z+="                        \xFE";
 z+="                        If Cmd = \"compile\" Then\xFE";
 z+="                            Execute Cmd:\" \":Fname:\" '\":Iname:\"' (S\" capturing xMsg\xFE";
 z+="                            CCnt += .2\xFE";
 z+="\xFE";
 z+="                            If Instr(XMsg, \"^\") Then\xFE";
 z+="                                Print crlf():Replace(XMsg, am(), crlf())\xFE";
 z+="                            Else\xFE";
 z+="                                // Itime = theTime(Now())\xFE";
 z+="                                // Write Idate:' ':Itime On fdict_Handle, Iname:\".\":Cmd:'.time' Else Msgbox(@Errors)\xFE";
 z+="                                Print anchorEdit(FName, IName, \" <\":Cmd:' ':Iname:\">\"):\xFE";
 z+="                                NoChange = False\xFE";
 z+="                            End If\xFE";
 z+="                        Else\xFE";
 z+="                            Execute Cmd:\" \":Fname:\" \":Iname capturing xMsg\xFE";
 z+="                            CCnt += 1\xFE";
 z+="                            \xFE";
 z+="                            Read X From fHandle('dict', Fname), Iname:'.err' Then\xFE";
 z+="                                Errors[-1] = am():@HtmlDecode(X):am()\xFE";
 z+="                                Progress<-1> = Cmd:\" \":Fname:\" (Errors)\"\xFE";
 z+="                                print crlf():Replace(X, am(), crlf())\xFE";
 z+="                            Else\xFE";
 z+="                                Read X From fHandle('dict', Fname), Iname:'.wrn' Then\xFE";
 z+="                                    Errors[-1] = am():@HtmlDecode(X):am()\xFE";
 z+="                                    Progress<-1> = Cmd:\" \":Fname:\" (Warnings)\"\xFE";
 z+="                                    print crlf():Replace(X, am(), crlf())\xFE";
 z+="                                Else\xFE";
 z+="                                    // Write Idate:' ':Itime On fdict_Handle, Iname:\".\":Cmd:'.time' Else Msgbox(@Errors)\xFE";
 z+="                                    NoChange = False\xFE";
 z+="                                    If Cmd = \"pc\" Then reLink = True\xFE";
 z+="                                End If\xFE";
 z+="                            End If\xFE";
 z+="                        End If\xFE";
 z+="                        \xFE";
 z+="                        compileCnt += 1\xFE";
 z+="                        If CCnt Mod 3 = 1 Then @Server.Flush\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="            Next\xFE";
 z+="            \xFE";
 z+="            If NoChange Then\xFE";
 z+="                noChanges[-1] = Fname\xFE";
 z+="                \xFE";
 z+="            ElseIf reLink Then\xFE";
 z+="                Select From fMD Where \"*a2 = '\":Fname:\"'\" To Sl Else Stop @Errors\xFE";
 z+="                Inames = GetList(Sl)\xFE";
 z+="                Catcnt = 0\xFE";
 z+="                For Each Iname In Inames\xFE";
 z+="                    Read Item From fMD, Iname Then\xFE";
 z+="                        Read Item2 From fHTAMD, Iname Else Item2 = ''\xFE";
 z+="                        If Item <> Item2 Then\xFE";
 z+="                            Write Item On fHTAMD, Iname Else Stop @Errors\xFE";
 z+="                            Catcnt += 1\xFE";
 z+="                        End If\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="                if OneFile Then\xFE";
 z+="                    If Catcnt Then Print Catcnt:\" items cataloged in htamd\"\xFE";
 z+="                    Execute \"Link \":Fname; @Server.Flush\xFE";
 z+="                    Execute \"cache \":Fname:\" (no\"; @Server.Flush\xFE";
 z+="                    If Catcnt Then Execute \"cache htamd (no\"; @Server.Flush\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="        Write Progress On fHandle('tmp'), 'BuildStatus'\xFE";
 z+="    End If\xFE";
 z+="    Print \xFE";
 z+="    \xFE";
 z+="    If Onefile And Catcnt Then\xFE";
 z+="        // already done\xFE";
 z+="    else\xFE";
 z+="        /////////////////      Get timestamps for JS directory     ///////////////// \xFE";
 z+="        i_Open \"js\" To Fjs Else Stop @Errors\xFE";
 z+="        jsStats = Filestats(Fjs)\xFE";
 z+="        If !jsStats Then Stop @Errors\xFE";
 z+="        jsStats = jsStats.stats\xFE";
 z+="        \xFE";
 z+="        /////////////////      /////////////////      /////////////////      /////////////////      \xFE";
 z+="        if !oneFile and !beQuiet Then Print @Bold(\"Checking for necessary LINKs: \"):\xFE";
 z+="        For Each Fname, FNameI In Flist\xFE";
 z+="            If Trim(Fname) <> \"\" and fname <> \"jsb_examples\" Then\xFE";
 z+="                If Left(Fname, 1) = \"*\" Then Break\xFE";
 z+="\xFE";
 z+="                lastTimeStamp = 0\xFE";
 z+="                Foundit = False\xFE";
 z+="                \xFE";
 z+="                if fname = \"cs\" then name = @JsbAccount:\"_\":FName Else Name = fName\xFE";
 z+="                For Each jsEntry In jsStats\xFE";
 z+="                    If LCase(jsEntry.name) = name:\".js\" Then\xFE";
 z+="                        Foundit = True\xFE";
 z+="                        Exit For\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="                \xFE";
 z+="                PrintIt = !oneFile and !beQuiet\xFE";
 z+="                \xFE";
 z+="                If Foundit Then\xFE";
 z+="                    i_Open 'dict', Fname To F Then\xFE";
 z+="                        Fstats = Filestats(F)\xFE";
 z+="                        If !Fstats Then Stop @Errors\xFE";
 z+="                        Fstats = Fstats.stats\xFE";
 z+="                        \xFE";
 z+="                        For Each dirEntry In Fstats\xFE";
 z+="                            If Right(dirEntry.name, 3) = \".js\" Then\xFE";
 z+="                                If dirEntry.timeStamp > lastTimeStamp Then lastTimeStamp = dirEntry.timeStamp\xFE";
 z+="                            End If\xFE";
 z+="                        Next\xFE";
 z+="                        \xFE";
 z+="                        If jsEntry.timeStamp + .0001 < lastTimeStamp Then\xFE";
 z+="                            if !oneFile and !beQuiet Then Print @Bold(fName):\" \":; PrintIt = False\xFE";
 z+="                            Execute \"link \":Fname; @Server.Flush\xFE";
 z+="                        End If\xFE";
 z+="                    End If\xFE";
 z+="                Else\xFE";
 z+="                    if !oneFile and !beQuiet Then Print @Bold(fName):\" \":; PrintIt = False\xFE";
 z+="                    Execute \"link \":Fname; @Server.Flush\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                if PrintIt Then Print FName:\" \":\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="                    \xFE";
 z+="       /////////////////      Do necessary Caching      /////////////////  \xFE";
 z+="       If Onefile Then Flist = [Onefile] Else Flist = Split(LCase(@Jsb_bf.jsbconfig(\"js_cachefiles\")), am())\xFE";
 z+="        ActPrefix = \"\"\xFE";
 z+="        Print\xFE";
 z+="        if !oneFile and !beQuiet Then Print @Bold(\"Cache checks: \"):\xFE";
 z+="        For Each Fname, FNameI In Flist\xFE";
 z+="            If Trim(Fname) <> \"\" Then\xFE";
 z+="                If Left(Fname, 1) = \"*\" Then \xFE";
 z+="                    ActPrefix = @JSBAccount:\"_\"\xFE";
 z+="                else\xFE";
 z+="                    lastTimeStamp = 0\xFE";
 z+="                    Foundit = False\xFE";
 z+="\xFE";
 z+="                    // Create output cached filename (Cfname)\xFE";
 z+="                    Cfname = Fname\xFE";
 z+="                    \xFE";
 z+="                    If CFName = \"htamd\" Then CFName = \"md\"\xFE";
 z+="                    If CFName = \"htausers\" Then CFName = \"jsb_users\"\xFE";
 z+="                    If CFName = \"htaconfig\" Then CFName = \"jsb_config\"\xFE";
 z+="                    If CFName = \"htasystem\" Then CFName = \"system\"\xFE";
 z+="                    If Left(Cfname, 5) = \"dict \" Then Cfname = Mid(Cfname, 6):\"_dct\"\xFE";
 z+="                    Cfname = \"cached_\":ActPrefix:Cfname\xFE";
 z+="                    Cfname := \".js\"\xFE";
 z+="                    \xFE";
 z+="                    // Does this file already exists? and do we have anything to make it update?\xFE";
 z+="                    For Each jsEntry In jsStats\xFE";
 z+="                        If LCase(jsEntry.name) = CFname Then\xFE";
 z+="                            Foundit = True\xFE";
 z+="                            Exit For\xFE";
 z+="                        End If\xFE";
 z+="                    Next\xFE";
 z+="                    \xFE";
 z+="                    PrintIt = !oneFile and !beQuiet\xFE";
 z+="                    If Foundit Then\xFE";
 z+="                        i_Open '', Fname To F Then\xFE";
 z+="                            Fstats = Filestats(F)\xFE";
 z+="                            If !Fstats Then Stop @Errors\xFE";
 z+="                            Fstats = Fstats.stats\xFE";
 z+="                            For Each dirEntry In Fstats\xFE";
 z+="                                If dirEntry.timeStamp > lastTimeStamp Then lastTimeStamp = dirEntry.timeStamp\xFE";
 z+="                            Next\xFE";
 z+="                            \xFE";
 z+="                            If jsEntry.timeStamp + + .0001 < lastTimeStamp Then\xFE";
 z+="                                if !oneFile and !beQuiet Then Print @Bold(fName); PrintIt = False\xFE";
 z+="                                Execute \"cache \":Fname:\" (no\"; @Server.Flush\xFE";
 z+="                            End If\xFE";
 z+="                        End If\xFE";
 z+="                        \xFE";
 z+="                    Else\xFE";
 z+="                        if !oneFile and !beQuiet Then Print @Bold(fName); PrintIt = False\xFE";
 z+="                        Execute \"cache \":Fname:\" (no\"; @Server.Flush\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    if PrintIt Then Print FName:\"  \":\xFE";
 z+="                end if\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Print \xFE";
 z+="    If !beQuiet Then Print \"New bump version # \":bumpJsbVersion(\"tcl.html\")\xFE";
 z+="    Progress<-1> = \"Done\"\xFE";
 z+="    Write Progress On fHandle('tmp'), 'BuildStatus'\xFE";
 z+="    \xFE";
 z+="    If !oneFile Then \xFE";
 z+="        Print \"Report logged to TMP BuildStatus\"\xFE";
 z+="        Execute \"CT TMP BuildStatus (N\"\xFE";
 z+="    End If\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["build"]=z;
var z="program cache \xFE";
 z+="*$options aspx\xFE";
 z+="    if !isadmin() then stop \"you must be an admin to run this command\"\xFE";
 z+="\xFE";
 z+="    // Parse sentence\xFE";
 z+="    sentence = @sentence\xFE";
 z+="    S  = field(sentence, \"(\", 1)\xFE";
 z+="    ddata = \"\"\xFE";
 z+="    fname = lcase(field(S, \" \", 2))\xFE";
 z+="    if fname = \"dict\" then \xFE";
 z+="        ddata = \"dict\"\xFE";
 z+="        fname = lcase(field(S, \" \", 3))\xFE";
 z+="    end if\xFE";
 z+="     \xFE";
 z+="    // Parse Options\xFE";
 z+="    options = lcase(field(field(sentence, \"(\", 2), \"[\", 1))\xFE";
 z+="    actToUse = lcase(field(field(sentence, \"[\", 2), \"(\", 1))\xFE";
 z+="    if !actToUse then actToUse = lcase(@JsbAccount)\xFE";
 z+="    shortDesc = instr(options, \"l\") \xFE";
 z+="    beQuiet = Instr(options, 's')\xFE";
 z+="    noBump = Instr(options, 'n')\xFE";
 z+="    cacheAll = instr(options, \"a\") or fname = \"*\"\xFE";
 z+="    overRideFileNameCheck = instr(options, \"o\") \xFE";
 z+="    jsfilesOK = instr(options, \"j\")\xFE";
 z+="    \xFE";
 z+="    // Verify parsing\xFE";
 z+="    if !fName and !options Then Stop \"Cache filename (options: a)ll s)hort-verbose j) javascript-ok o)verride-filename-checks n)o-bumping-revision [accountName\"\xFE";
 z+="    tfname = @trueFileName(fname)\xFE";
 z+="    if !InStr(tfName, `\\`) and !InStr(tfName, `/`) then fname = tfname\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    cacheControljs = actToUse:\"_cachecontrol.js\"\xFE";
 z+="    jsp = `.\\jsb\\js` ;* js path\xFE";
 z+="    corejsb = @jsbConfig(\"core.jsb\")\xFE";
 z+="    cachedFileNames = LCase(Join(jsbConfig('js_cachefiles'), am()))\xFE";
 z+="    cachedFileNames = Split(cachedFileNames, am())\xFE";
 z+="    if !cachedFileNames then Stop \"You are missing the configuration file: \":@AnchorEdit(\"jsb_config\", \"js_cachefiles\")\xFE";
 z+="\xFE";
 z+="    ccanchor = @AnchorEdit(jsp, cachecontroljs, cachecontroljs)\xFE";
 z+="    \xFE";
 z+="    // Open files\xFE";
 z+="    OPEN jsp TO FJS ELSE STOP @Errors\xFE";
 z+="    \xFE";
 z+="    if cacheAll then\xFE";
 z+="        if !beQuiet Then print \"Deleting old cached files\"; @Server.Flush\xFE";
 z+="        ActPrefix = ''\xFE";
 z+="        for each cname in cachedFileNames\xFE";
 z+="            if cName = \"*eof*\" then break\xFE";
 z+="            if left(cname, 1) = \"*\" then \xFE";
 z+="                ActPrefix = actToUse:\"_\"\xFE";
 z+="                cycle\xFE";
 z+="            end if\xFE";
 z+="            delete FJS, \"cached_\":actPrefix:cname:\".js\" else null\xFE";
 z+="        next\xFE";
 z+="        delete FJS, cacheControljs else stop @Errors\xFE";
 z+="    \xFE";
 z+="        if !beQuiet Then print \"Caching new cached files\";\xFE";
 z+="        for each cName in cachedFileNames\xFE";
 z+="            if left(cName, 1) = \"*\" Or left(cname, 1) = \"/\" then Cycle\xFE";
 z+="            if cName = \"jsb_docs\" then execute \"compile jsb_docs (bs\"; @Server.Flush ;* rebuild index\xFE";
 z+="            execute \"cache \":cName:\" (loj\"; @Server.Flush\xFE";
 z+="        next\xFE";
 z+="        \xFE";
 z+="        stop ccanchor\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if fname = \"\" then stop \"cache <filename> (a\"\xFE";
 z+="    if fname = \"md\" then fname = \"htamd\"\xFE";
 z+="    if fname = \"system\" then fname = \"htasystem\"\xFE";
 z+="    if fname = \"jsb_users\" then fname = \"htausers\"\xFE";
 z+="    if fname = \"jsb_config\" then fname = \"htaconfig\"\xFE";
 z+="\xFE";
 z+="    for each cname in cachedFileNames\xFE";
 z+="        if cname = fname then break\xFE";
 z+="        if left(cname, 1) = \"*\" then \xFE";
 z+="            ActPrefix = actToUse:\"_\"\xFE";
 z+="            break\xFE";
 z+="        end if\xFE";
 z+="    next\xFE";
 z+="    \xFE";
 z+="    fFile = ''\xFE";
 z+="    if  fname = \"htausers\" Or fname = \"htaconfig\" then\xFE";
 z+="        i_open ddata, fname to fFile else stop @errors\xFE";
 z+="        fname = \"jsb_\":Mid(fname, 4)\xFE";
 z+="        ActPrefix = actToUse:\"_\"\xFE";
 z+="        \xFE";
 z+="    elseif fname = \"htamd\" Or fname = \"htasystem\" then\xFE";
 z+="        i_open fname to fFile else stop @errors\xFE";
 z+="        fname = Mid(fname, 4) ;* drop hta\xFE";
 z+="        ActPrefix = actToUse:\"_\"\xFE";
 z+="        \xFE";
 z+="    elseif fname = \"jsb_bf\" or fname = \"jsb_html\" or fname = \"jsb_docs\" or fname = \"jsb_examples\" or fname = \"jsb_tcl\" or fname = \"jsb_mdl\" or fname = \"jsb_ctls\" or fname = \"jsb_themes\" or fname = \"jsb2js\" then\xFE";
 z+="        i_open ddata, fname to fFile else stop @errors\xFE";
 z+="\xFE";
 z+="    elseif fname = \"jsb_pagetemplates\" or fname = \"jsb_viewtemplates\" or fname = \"jsb_jsondefs\" or fname = \"jsb_odb\" or fname = \"jsb_jsxrefs\" or fname = \"democustomers.json\" or fname = \"democustomers.text\" then\xFE";
 z+="        i_open ddata, fname to fFile else stop @errors\xFE";
 z+="        \xFE";
 z+="    elseIf overRideFileNameCheck Or fname = \"cs\" then\xFE";
 z+="        i_open ddata, fname to fFile else stop @errors\xFE";
 z+="        ActPrefix = actToUse:\"_\"\xFE";
 z+="        \xFE";
 z+="    elseif ddata = \"dict\" then\xFE";
 z+="        if fname = \"jsb_themes\" then\xFE";
 z+="            i_open 'dict', fname to fFile else stop @errors\xFE";
 z+="\xFE";
 z+="        elseif fname = \"jsb_odb\" or fname = \"jsb_html\" or fname = \"jsb_bf\" or fname = \"jsb_ctls\" or fname = \"jsb_mdl\" or fname = \"jsb2js\"  then \xFE";
 z+="            stop \"use link instead\"\xFE";
 z+="            \xFE";
 z+="        else\xFE";
 z+="            locate 'dict ':fname in cachedFileNames setting spot else\xFE";
 z+="                Stop 'dict ':fname:\" isn't a program I normally cache.  Use T-Dump or option O, or add this file to \":@AnchorEdit(\"jsb_config\", \"js_cachefiles\")\xFE";
 z+="            end if\xFE";
 z+="            i_open 'dict', fname to fFile else stop @errors\xFE";
 z+="        end if\xFE";
 z+="    else\xFE";
 z+="        locate fname in cachedFileNames setting spot else\xFE";
 z+="             Stop fname:\" isn't a program I normally cache.  Use T-Dump or option O, or add this file to \":@AnchorEdit(\"jsb_config\", \"js_cachefiles\")\xFE";
 z+="        end if\xFE";
 z+="        i_open ddata, fname to fFile else stop @errors\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    if ddata then fname = fname:\"_dct\"\xFE";
 z+="    if Left(fname, 2) = `.\\` or left(fname, 2) = \"./\" then fname = Mid(FName, 3)\xFE";
 z+="    cached_file = ['anonymousFunc = function () {']\xFE";
 z+="    \xFE";
 z+="    * Determine if we are using the account prefix (Anything in jsb_config\xFE";
 z+="    ActPrefix = ''\xFE";
 z+="    for each cname in cachedFileNames\xFE";
 z+="        if cname = fname then break\xFE";
 z+="        if left(cname, 1) = \"*\" then \xFE";
 z+="            ActPrefix = actToUse:\"_\"\xFE";
 z+="            break\xFE";
 z+="        end if\xFE";
 z+="    next\xFE";
 z+="    \xFE";
 z+="    * cacheControl determines which files have javascript static caches\xFE";
 z+="    *   any filename placed in cache control will read it's cache over the network if not already\xFE";
 z+="    *   loaded in the html document header\xFE";
 z+="    *\xFE";
 z+="    *   example:\xFE";
 z+="    *       cachedFileNames = []\xFE";
 z+="    *       cachedFileNames[\"aliasName\"] = \"cachefilename(without .js)\" \xFE";
 z+="    *\xFE";
 z+="    \xFE";
 z+="    read cacheControl from FJS, cacheControljs else cacheControl = \"cachedFileNames = []\"\xFE";
 z+="    cacheControl = Replace(cacheControl, crlf(), am())\xFE";
 z+="\xFE";
 z+="    cf = `window.cachedFileNames[\"`:fname:`\"] = \"`:ActPrefix:fname:`\"`\xFE";
 z+="    if !InStr(cacheControl, cf) Then cacheControl<-1> = am():cf\xFE";
 z+="    cached_file[-1] = cf\xFE";
 z+="    \xFE";
 z+="    if NiceName(fName) = fname then shortHandle = \"window.cached_\":fname else shortHandle = \"window['cached_\":fname:\"']\"\xFE";
 z+="    cf = \"if (!\":shortHandle:\") \":shortHandle:\" = {}\"\xFE";
 z+="    if !InStr(cacheControl, cf) Then cacheControl<-1> = cf\xFE";
 z+="    cached_file[-1] = cf\xFE";
 z+="    \xFE";
 z+="    isDict = ddata = \"dict\"\xFE";
 z+="    Select fFile to ss else stop @errors\xFE";
 z+="    inames = []\xFE";
 z+="    iCnt = 0\xFE";
 z+="    jCnt = 0\xFE";
 z+="    loop\xFE";
 z+="        readnext iname from ss else break\xFE";
 z+="        iname = lcase(iname)\xFE";
 z+="\xFE";
 z+="    while 1 do\xFE";
 z+="        cacheit = true\xFE";
 z+="        \xFE";
 z+="        if isDict then \xFE";
 z+="            r4 = field(lcase(right(iname, 5)), '.', 2)\xFE";
 z+="            if r4 = \"js\" then\xFE";
 z+="                cacheIt = true\xFE";
 z+="                \xFE";
 z+="            else if r4 = \"time\" then \xFE";
 z+="                cacheit = jsfilesOK\xFE";
 z+="                \xFE";
 z+="            elseif r4 = \"pcd\" or r4 = \"pcs\" or r4 = \"pcf\" or r4 = \"sub\" or r4 = \"def\" or r4 = \"err\" or r4 = \"wrn\" or r4 = \"aspx\" or r4 = \"vb\" or r4 = \"bak\" then \xFE";
 z+="                cacheit = false\xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        if cacheit then\xFE";
 z+="            read x from fFile, iname then\xFE";
 z+="                inames[-1] = iname\xFE";
 z+="                iCnt += 1\xFE";
 z+="                \xFE";
 z+="                xx = CJson(x)\xFE";
 z+="                if xx <> NUll then\xFE";
 z+="                    if isArray(XX) Then\xFE";
 z+="                        cached_file[-1] = shortHandle:'[\"':iname:'\"] = [':Join(XX, \",\":crlf()):'];'\xFE";
 z+="                    else\xFE";
 z+="                        cached_file[-1] = shortHandle:'[\"':iname:'\"] = ':XX:';'\xFE";
 z+="                    end if\xFE";
 z+="                    jCnt += 1\xFE";
 z+="                else\xFE";
 z+="                    x = replace(x, `\\`, `\\\\`)\xFE";
 z+="                    x = replace(x, `\"`, `\\\"`)\xFE";
 z+="    \xFE";
 z+="                    x = replace(x, chr(253), `\\xFD`)\xFE";
 z+="                    x = replace(x, chr(252), `\\xFE`)\xFE";
 z+="                    x = replace(x, chr(146), \"'\")\xFE";
 z+="    \xFE";
 z+="                    x = replace(x, crlf(), chr(254))\xFE";
 z+="                    x = replace(x, Chr(13), chr(254))\xFE";
 z+="                    x = replace(x, Chr(10), chr(254))\xFE";
 z+="    \xFE";
 z+="                    if isDict And LCase(Right(iname, 3)) = \".js\" then\xFE";
 z+="                        x = split(x, Chr(254))\xFE";
 z+="                        newX = []\xFE";
 z+="                        for each line in X\xFE";
 z+="                            Line = LTrim(Line)\xFE";
 z+="                            if Line then newX[-1] = Line\xFE";
 z+="                        next\xFE";
 z+="                        X = Join(newX, Chr(254))\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    x = replace(x, `*\x20EDITOR-OPTION: AUTOFORMAT`, `*\\x20EDITOR-OPTION: AUTOFORMAT`)\xFE";
 z+="                    if len(x) > 800 then\xFE";
 z+="                        x2 = replace(x, chr(254), `\\xFE\";`:crlf():' z+=\"')\xFE";
 z+="                        cached_file[-1] = 'var z=\"':x2:'\"'\xFE";
 z+="                        cached_file[-1] = shortHandle:'[\"':iname:'\"]=z;'\xFE";
 z+="                        \xFE";
 z+="                    else\xFE";
 z+="                        x2 = replace(x, chr(254), `\\xFE`)\xFE";
 z+="                        cached_file[-1] = shortHandle:'[\"':iname:'\"]=\"':x2:'\";'\xFE";
 z+="                    end if\xFE";
 z+="                end if\xFE";
 z+="                \xFE";
 z+="            else\xFE";
 z+="                print \"no read \":Iname\xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="    repeat\xFE";
 z+="\xFE";
 z+="    I = InStr(cacheControl, cf)\xFE";
 z+="    if I Then LineNo = DCount(left(cacheControl, I), am()) Else LineNo = -1\xFE";
 z+="    cacheControl<LineNo> = newLine\xFE";
 z+="\xFE";
 z+="    WRITE Replace(cacheControl, am(), crlf()) ON FJS, cacheControljs ELSE STOP @ERRORS\xFE";
 z+="    \xFE";
 z+="    cached_file[-1] = '}'\xFE";
 z+="    cached_file[-1] = 'anonymousFunc()'\xFE";
 z+="    cached_file[-1] = 'anonymousFunc = null'\xFE";
 z+="\xFE";
 z+="    outputName = \"cached_\":ActPrefix:fname:\".js\"\xFE";
 z+="    WRITE Join(cached_file, crlf()) ON FJS, outputName ELSE STOP @ERRORS\xFE";
 z+="\xFE";
 z+="    fAnchor = @AnchorEdit(jsp, outputName, \"Successfully cached \":iCnt:\" items in \":outputName:iff(jCnt, \" (\":jCnt:\" json items)\", \"\"))\xFE";
 z+="    // ('', @jsbRootAccount:\"?\":@UrlEncode(\"ed \":jsp:\" '\":outputName:\"'\"), \"ed \":jsp:\" \":outputName, { target: \"_blank\" })\xFE";
 z+="    \xFE";
 z+="    if shortDesc then Stop fAnchor\xFE";
 z+="    \xFE";
 z+="    if !beQuiet Then Print fAnchor:Space(8):ccAnchor:\" \"\xFE";
 z+="    If !noBump Then \xFE";
 z+="        if beQuiet Then @bumpJsbVersion(\"tcl.html\") Else Print \"Revision set to \":@bumpJsbVersion(\"tcl.html\")\xFE";
 z+="    End If\xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["cache"]=z;
var z="Program Catalog\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = True\xFE";
 z+="    Dim Help As Array = ['CT <TableName> <itemnames>']\xFE";
 z+="    \xFE";
 z+="    $Include __shell\xFE";
 z+="\xFE";
 z+="    Fname = UCase(TrueTableName(TableName))\xFE";
 z+="    Open 'DICT', Fname To F_dict Else F_dict = \"\"\xFE";
 z+="    I_open '', 'MD' To Fmd Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    for each iName As String In INames\xFE";
 z+="        If System(1) = \"js\" Then\xFE";
 z+="            Cname = UCase(TrueTableName(TableName)):\"_\":UCase(Iname)\xFE";
 z+="            If !window[Cname] Then\xFE";
 z+="                If !F_dict Then Stop \"File \":FName:\" not found\"\xFE";
 z+="                Read Item From F_dict, FName:'.js' Else\xFE";
 z+="                    If Len(@Errors) Then Errors[-1] = @Errors Else Errors[-1] = 'Item ':Iname:' not found.'\xFE";
 z+="                    Cycle\xFE";
 z+="                End\xFE";
 z+="            End If\xFE";
 z+="        End Else\xFE";
 z+="            Read Item From F_dict, Iname:'.pcd' Else\xFE";
 z+="                Read Item From F_dict, Iname:'.pcd' Then\xFE";
 z+="                    Errors[-1] = 'Item ':Iname:' not a PROGRAM file, or is not compiled.'\xFE";
 z+="                Else\xFE";
 z+="                    Errors[-1] = 'Item ':Iname:' not found.'\xFE";
 z+="                End If\xFE";
 z+="                Cycle\xFE";
 z+="            End\xFE";
 z+="        End If\xFE";
 z+="        Read Pdef From Fmd, IName Else PDef = \"\"\xFE";
 z+="        L1 = LCase(PDef<1>)\xFE";
 z+="        Locate \"cv\" In L1<1> Setting Spot Else Null\xFE";
 z+="    \xFE";
 z+="        PDef<1, Spot> = \"cv\"\xFE";
 z+="        PDef<2, Spot> = FName\xFE";
 z+="        PDef<3, Spot> = IName\xFE";
 z+="    \xFE";
 z+="        Write PDef On Fmd,IName Else Stop @Errors\xFE";
 z+="        Print \"Cataloged \":FName:' ':IName\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors # '' Then Print MonoSpace(Replace(Errors, am(), crlf()))\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["catalog"]=z;
var z="Program Cc\xFE";
 z+="    If System(1) <> \"js\" And !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    I_AttachDB \"\" Else Print @Errors\xFE";
 z+="    \xFE";
 z+="    @Session.CachedAccounts = \"\"\xFE";
 z+="    @Session.rpc_cached_opens = {}\xFE";
 z+="    @Session.last_rpc_Address = \"\"\xFE";
 z+="    @Session.rpc_cached_logins = {}\xFE";
 z+="    @Session.rpc_cached_items = {}\xFE";
 z+="    @Session.rpc_cached_timer = {}\xFE";
 z+="    @Session.RefCache = {}\xFE";
 z+="    @Session.CachedConvCachedTranslates = {}\xFE";
 z+="    @Session.dropbox_cached_folders = {}\xFE";
 z+="    @Session.dropbox_cached_items = {}\xFE";
 z+="    @Session.dropbox_cached_timer = {}\xFE";
 z+="    UserVars = @Session[@UserNo]\xFE";
 z+="    \xFE";
 z+="    rmlist = []\xFE";
 z+="    for each tag in UserVars\xFE";
 z+="        if left(tag, 7) = \"config \" then rmList[-1] = tag\xFE";
 z+="    next\xFE";
 z+="    for each tag in rmList\xFE";
 z+="        remove UserVars, tag\xFE";
 z+="    next\xFE";
 z+="    @Session[@UserNo] = UserVars\xFE";
 z+="    \xFE";
 z+="    delete fHandle('jsb_config'), 'cachebuster' else null\xFE";
 z+="    \xFE";
 z+="    If System(1) = \"js\" Then\xFE";
 z+="        window.clearCaches()\xFE";
 z+="        window.clearAllSessions()\xFE";
 z+="        if window.fileSystem Then\xFE";
 z+="            If Msgbox(\"Do you wish to reset your database (delete all tables)?\", \"Yes,*No\") = \"Yes\" Then\xFE";
 z+="                If Msgbox('Are you absolutely sure', 'Yes,*No') = 'Yes' Then\xFE";
 z+="                    \xFE";
 z+="                    I_delete fHandle('jsb_cache'), 'postloads' Else Null\xFE";
 z+="                    I_deletefile 'F/account_':LCase(JSBAccount()) Else null\xFE";
 z+="                    I_deletefile 'F/account_jsb' Else null\xFE";
 z+="                    \xFE";
 z+="                    window.localStorage.clear();\xFE";
 z+="                    window.location.reload()\xFE";
 z+="                    @Server.pause\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        /*\xFE";
 z+="            if window.dotNetObj Then\xFE";
 z+="                pwd = Replace(Replace(@jsbRoot, \"file:///\", \"\"), \"/\", \"\\\\\") : `App_Data\\_database\\sysprog\\`\xFE";
 z+="                If Msgbox(\"Do you wish to reset your \":pwd:\" files?\", \"Yes,*No\") = \"Yes\" Then\xFE";
 z+="                    If Msgbox('Are you absolutely sure', 'Yes,*No') = 'Yes' Then\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_tcl /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_bf /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_html /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_mdl /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_ctls /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_themes /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_pagetemplates /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_viewtemplates /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_jsondefs /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb2js /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_odb /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_docs /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_examples /S/Q\")\xFE";
 z+="                        \xFE";
 z+="                        pwd := `JSB_Dictionaries\\`\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_tcl.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_bf.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_html.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_mdl.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_ctls.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_themes.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_pagetemplates.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_viewtemplates.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_jsondefs.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb2js.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_odb.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_docs.DCT /S/Q\")\xFE";
 z+="                        ExecuteDos(\"del \":pwd:\"jsb_examples.DCT /S/Q\")\xFE";
 z+="                        \xFE";
 z+="                    End If\xFE";
 z+="                End If\xFE";
 z+="            end if\xFE";
 z+="        */\xFE";
 z+="        \xFE";
 z+="        fCache = fHandle('', 'jsb_cache', True)\xFE";
 z+="        select fCache else Stop @Errors\xFE";
 z+="        readnext ID Then\xFE";
 z+="            If Msgbox(\"Do you wish to clear the jsb_cache (postloads and deleted items)?\", \"Yes,*No\") = \"Yes\" Then\xFE";
 z+="                clearfile fHandle('jsb_cache') Else Msgbox(@Errors)\xFE";
 z+="                window.location.reload()\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            Print \"No postloads exist in the cache and \":\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    For Each Key In @Application.keys\xFE";
 z+="        If Left(Key, 7) = 'config ' Then @Application[Key] = Nothing\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    if system(1) = \"aspx\" then\xFE";
 z+="        AttachDB @Session.AttachedDatabase Else Print @Errors ;* Clears table caches\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Print \"Caches cleared\"\xFE";
 z+="End Program"
window.cached_jsb_tcl["cc"]=z;
window.cached_jsb_tcl["cd"]="program cd\xFE* $options aspx\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE\xFE    cd = @session['curdir']\xFE    if !cd or Mid(cd, 2, 1) <> \":\" then cd = @jsbRootDir\xFE\xFE    cmd = `cd `:DropLeft(Field(@Sentence,'(', 1), ' ')\xFE\xFE    s = executedos(Left(cd, 2):' & cd \"':cd:'\" & echo -!-begin-!- & ':cmd:' & echo -!-newcd-!- & cd')\xFE\xFE    i = instr(s, \"-!-newcd-!\")\xFE    result = field(s, \"-!-newcd-!-\", 1)\xFE    ncd = field(s, \"-!-newcd-!-\", 2)\xFE    errs = trimws(ncd<2>)\xFE    ncd = trimws(ncd<1>)\xFE    result = trimws(field(result, \"-!-begin-!-\", 2))\xFE    if errs then stop errs\xFE    \xFE    print ncd\xFE    @session['curdir'] = ncd\xFE\xFE";
window.cached_jsb_tcl["cl"]="Program CL\xFE         CLEARSELECT \xFE         PRINT \"ACTIVE LIST CLEARED\"";
window.cached_jsb_tcl["clearfile"]="Program ClearFile\xFE   If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE   S = TRIM(@SENTENCE)\xFE   FNAME = FIELD(S, \" \", 2)\xFE   INAME = FIELD(S, \" \", 3)\xFE\xFE   DICTDATA = \"\"\xFE   IF UCASE(FNAME) = \"DICT\" OR UCASE(FNAME) = \"DATA\" THEN\xFE      DICTDATA = UCASE(FNAME)\xFE      FNAME = INAME\xFE      INAME = FIELD(S, \" \", 4)\xFE   END IF\xFE   \xFE   OPEN DICTDATA, FNAME TO FHANDLE THEN \xFE       CLEARFILE FHANDLE THEN STOP ltrim(DICTDATA:\" \"):FNAME:\" cleared.\" ELSE STOP @ERRORS\xFE   END ELSE\xFE       STOP FNAME:\" doesn't exist.\"\xFE   END IF";
window.cached_jsb_tcl["cloneaccount"]="program cloneAccount\xFE*\xFE* options aspx\xFE*\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE    \xFE    clonedFrom = field(field(@sentence, \"(\", 1), \" \", 2)\xFE    if !clonedFrom then Stop \"cloneAccount {fromAccount} toAccount\"\xFE    \xFE    toAccount = field(field(@sentence, \"(\", 1), \" \", 3)\xFE    if !toAccount Then\xFE        toAccount = clonedFrom\xFE        clonedFrom = @jsbAccount\xFE    end if\xFE\xFE    if !@jsb_bf.cloneAccount(toAccount, clonedFrom) Then Stop @Errors\xFE    \xFE    stop \"Account \":toAccount:\" created and cloned from \":clonedFrom\xFEend program\xFE";
window.cached_jsb_tcl["close_html"]="PROGRAM CLOSE_HTML\xFE*$OPTIONS JS\xFE@response.redirect(@jsbrootact:\"#close_html?ans=\":DropLeft(@Url, \"=\"))";
window.cached_jsb_tcl["cls"]="Program CLS\xFEprint @(-1):\xFECLEARSELECT\xFE' randy was here!";
var z="Program Compare\xFE";
 z+="* Compare two files program\xFE";
 z+="* \xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="*\xFE";
 z+="    PROMPT ''\xFE";
 z+="*\xFE";
 z+="    SENTENCE = TRIM(@SENTENCE)\xFE";
 z+="    SENTENCE = DropLeft(SENTENCE, ' ') ;* Drop Compare\xFE";
 z+="    PTableName = FIELDLeft(SENTENCE,' ')\xFE";
 z+="    SENTENCE = DropLeft(SENTENCE, ' ') ;* Drop PTableName\xFE";
 z+="    IF UCASE(PTableName) = 'DICT' THEN\xFE";
 z+="        PDICTDATA = 'DICT'\xFE";
 z+="        PTableName = FieldLeft(SENTENCE,' ')\xFE";
 z+="        SENTENCE = DropLeft(SENTENCE, ' ') ;* Drop PTableName\xFE";
 z+="    END\xFE";
 z+="    \xFE";
 z+="    IF PTableName = \"\" THEN\xFE";
 z+="        PRINT \"COMPARE TableName Itemname(s) (Options,AutoInputResponse\"\xFE";
 z+="        PRINT \"   Options:\"\xFE";
 z+="        PRINT \"     Z)  output only changes\"\xFE";
 z+="        PRINT \"     T)  trim ALL spaces (excluding strings)\"\xFE";
 z+="        PRINT \"     I)  Ignore differences in comments\"\xFE";
 z+="        PRINT \"     R)  Remove comments (alters line numbering)\"\xFE";
 z+="        PRINT \"     W)  output tp 132 column wide paper\"\xFE";
 z+="        PRINT \"     C)  single column, changes shown\"\xFE";
 z+="        PRINT \"         TableName is base code, With File is new code\"\xFE";
 z+="        PRINT \"     D)  combines options TCIZ\"\xFE";
 z+="        Print \"     AutoInputResponse = list of ids, or (filename listofids\"\xFE";
 z+="        STOP \xFE";
 z+="    END\xFE";
 z+="*\xFE";
 z+="    PPOS = INDEX(SENTENCE,'(',1)\xFE";
 z+="    IF NOT(PPOS) THEN PPOS = INDEX(SENTENCE,'[',1)\xFE";
 z+="    IF PPOS THEN OPTIONS = UCASE(SENTENCE[PPOS+1, 9999]) ELSE OPTIONS = ''\xFE";
 z+="    OPTIONS2 = FIELD(OPTIONS,',',2)\xFE";
 z+="    OPTIONS = FIELD(OPTIONS,',',1)\xFE";
 z+="    SENTENCE = FIELD(SENTENCE,'(',1)\xFE";
 z+="    SENTENCE = FIELD(SENTENCE,'[',1)\xFE";
 z+="    SENTENCE = RTrim(SENTENCE)\xFE";
 z+="    \xFE";
 z+="    OPEN PDICTDATA,PTableName TO F_PFILE ELSE\xFE";
 z+="        PRINT \"Primary file \":PTableName:\" not found\"\xFE";
 z+="        STOP\xFE";
 z+="    END\xFE";
 z+="    \xFE";
 z+="    IF FieldLeft(SENTENCE,' ') = '*' THEN \xFE";
 z+="        SELECT F_PFILE\xFE";
 z+="        SENTENCE = DropLeft(SENTENCE, ' ')\xFE";
 z+="    END\xFE";
 z+="\xFE";
 z+="    Loop\xFE";
 z+="        READNEXT ID Else Break\xFE";
 z+="    While True Do\xFE";
 z+="        SENTENCE = SENTENCE:' ':ID\xFE";
 z+="    Repeat\xFE";
 z+="\xFE";
 z+="    IF OPTIONS2 = '' THEN\xFE";
 z+="        Prompt \"With: \"\xFE";
 z+="        INPUT SENTENCE2\xFE";
 z+="    END ELSE\xFE";
 z+="        SENTENCE2 = Trim(OPTIONS2)\xFE";
 z+="    END\xFE";
 z+="    \xFE";
 z+="    IF SENTENCE2[1,1] = '(' THEN\xFE";
 z+="        SENTENCE2 = LTrim(Mid(SENTENCE2, 2))\xFE";
 z+="        STableName = FieldLeft(SENTENCE2,' ')\xFE";
 z+="        SENTENCE2 = DropLeft(SENTENCE2, ' ')\xFE";
 z+="\xFE";
 z+="        IF UCASE(STableName) = 'DICT' THEN\xFE";
 z+="            STableName = FieldLeft(SENTENCE2,' ')\xFE";
 z+="            SENTENCE2 = DropLeft(SENTENCE2, ' ')\xFE";
 z+="            SDICTDATA = 'DICT'\xFE";
 z+="        END\xFE";
 z+="    END ELSE\xFE";
 z+="        STableName = PTableName\xFE";
 z+="        SDICTDATA = PDICTDATA\xFE";
 z+="    END\xFE";
 z+="    \xFE";
 z+="    OPEN SDICTDATA,STableName TO F_SFILE ELSE\xFE";
 z+="        PRINT \"Secondary file \":STableName:\" not found\"\xFE";
 z+="        STOP\xFE";
 z+="    END\xFE";
 z+="\xFE";
 z+="    IF INDEX(OPTIONS,'D',1) THEN OPTIONS='TCIFZ':OPTIONS\xFE";
 z+="    TRIMSPC = INDEX(OPTIONS,'T',1)\xFE";
 z+="    IGNORECOMMENTS = INDEX(OPTIONS,'I',1)\xFE";
 z+="    REMOVECOMMENTS = INDEX(OPTIONS,'R',1)\xFE";
 z+="    SHOWCHANGES = INDEX(OPTIONS,'C',1)\xFE";
 z+="    SHOWONLYDIFS = INDEX(OPTIONS,'Z',1)\xFE";
 z+="    BINARY = INDEX(OPTIONS,'B',1)\xFE";
 z+="    IF INDEX(OPTIONS,'S',1) THEN WIDTH = 80 Else WIDTH = 123\xFE";
 z+="    HOWMUCH = 2\xFE";
 z+="    CMP = ''\xFE";
 z+="    OUTMETHOD = 1\xFE";
 z+="    IF INDEX(OPTIONS,'A',1) THEN OUTMETHOD = 2\xFE";
 z+="    SENTENCE = Split(SENTENCE, ' ')\xFE";
 z+="    NoChanges = 1\xFE";
 z+="    \xFE";
 z+="40: For Each PIName, ItemIdx In Sentence\xFE";
 z+="        lastId = ItemIdx = UBound(Sentence)\xFE";
 z+="        \xFE";
 z+="        SINAME = FIELD(SENTENCE2,' ',ITEMIDX)\xFE";
 z+="        IF SINAME = '' THEN SINAME = PINAME\xFE";
 z+="\xFE";
 z+="        READ PITEM FROM F_PFILE, PINAME ELSE\xFE";
 z+="            PRINT PINAME:' not found in ':PDICTDATA:\" \":PTableName\xFE";
 z+="            Cycle\xFE";
 z+="        END\xFE";
 z+="        READ SITEM FROM F_SFILE, SINAME ELSE\xFE";
 z+="            PRINT SINAME:' not found in ':SDICTDATA:\" \":STableName\xFE";
 z+="            Cycle\xFE";
 z+="        END\xFE";
 z+="\xFE";
 z+="        doBinary = Binary\xFE";
 z+="        if !doBinary Then\xFE";
 z+="            For I = 1 to 9\xFE";
 z+="                if index(PITEM, chr(i)) or Index(SITEM, Chr(i)) Then\xFE";
 z+="                     Ans = msgbox(PINAME:\" appears to be a binary.  Do a binary compare?\", \"*Yes,No\")\xFE";
 z+="                     If Ans = Chr(27) Or Ans = \"\" Then stop\xFE";
 z+="                     if Ans = \"Yes\" Then doBinary = True\xFE";
 z+="                     break\xFE";
 z+="                end if\xFE";
 z+="            next\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        if doBinary then\xFE";
 z+="            BPITEM = STX(PITEM)\xFE";
 z+="            BSITEM = STX(SITEM)\xFE";
 z+="            PITEM = \"\"\xFE";
 z+="            SITEM = \"\"\xFE";
 z+="            if Len(BPITEM) > Len(BSITEM) Then Z = Len(BPITEM) ELse Z = Len(BSITEM)\xFE";
 z+="            \xFE";
 z+="            for i = 1 to Z STEP 32\xFE";
 z+="                P := Mid(BPITEM, I, 32)\xFE";
 z+="                S := Mid(BSITEM, I, 32)\xFE";
 z+="                PL = \"\"\xFE";
 z+="                SL = \"\"\xFE";
 z+="                for j = 1 to 31 step 2\xFE";
 z+="                   PL := Mid(P, J, 2):\" \"\xFE";
 z+="                   SL := Mid(S, J, 2):\" \"\xFE";
 z+="                Next\xFE";
 z+="                PITEM := PL:am()\xFE";
 z+="                SITEM := SL:am()\xFE";
 z+="            next\xFE";
 z+="        End If       \xFE";
 z+="        pHdr = anchorEdit(PTableName, PINAME, PTableName:\" \":PINAME)\xFE";
 z+="        sHdr = anchorEdit(STableName, SINAME, STableName:\" \":SINAME)\xFE";
 z+="        Call doCompare([pHdr, sHdr], PITEM, SITEM, REMOVECOMMENTS, TRIMSPC, IGNORECOMMENTS, SHOWCHANGES, SHOWONLYDIFS, HOWMUCH, OUTMETHOD, WIDTH, NoChanges)\xFE";
 z+="        PRINT pHdr:Space(20):sHdr\xFE";
 z+="        if NoChanges Then Cycle\xFE";
 z+="        \xFE";
 z+="        if !lastId Then \xFE";
 z+="            Prompt \"Press return to continue\"\xFE";
 z+="            input Pau\xFE";
 z+="            print @(-1):\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="end program\xFE";
 z+="\xFE";
 z+="* MAIN COMPARE ROUTINE\xFE";
 z+="subroutine doCompare(HEADER, PITEM, SITEM, REMOVECOMMENTS, TRIMSPC, IGNORECOMMENTS, SHOWCHANGES, SHOWONLYDIFS, HOWMUCH, OUTMETHOD, WIDTH, NoChanges)\xFE";
 z+="    PROJECT = \"\"\xFE";
 z+="    NoChanges = False\xFE";
 z+="    \xFE";
 z+="    If InStr(SItem, cr()) Or InStr(SItem, lf()) Then\xFE";
 z+="        SItem = Replace(SItem, crlf(), am())\xFE";
 z+="        SItem = Replace(SItem, cr(), am())\xFE";
 z+="        SItem = Replace(SItem, lf(), am())\xFE";
 z+="    End If\xFE";
 z+="    If InStr(PItem, cr()) Or InStr(PItem, lf()) Then\xFE";
 z+="        PItem = Replace(PItem, crlf(), am())\xFE";
 z+="        PItem = Replace(PItem, cr(), am())\xFE";
 z+="        PItem = Replace(PItem, lf(), am())\xFE";
 z+="    End If\xFE";
 z+="    PITEM = Replace(PITEM, Chr(160), ' ')\xFE";
 z+="    SITEM = Replace(SITEM, Chr(160), ' ')\xFE";
 z+="    \xFE";
 z+="    PITEM = Split(PItem, am())\xFE";
 z+="    SITEM = Split(SITEM, am())\xFE";
 z+="    \xFE";
 z+="************************************************\xFE";
 z+="* REMOVE COMMENTS IF NECESSARY\xFE";
 z+="************************************************\xFE";
 z+="    IF REMOVECOMMENTS THEN\xFE";
 z+="        PNUMATT = UBOUND(PITEM)\xFE";
 z+="        FOR I = 1 TO PNUMATT\xFE";
 z+="            IF INDEX('!*',TRIM(PITEM[I])[1,1],1) THEN\xFE";
 z+="                PITEM = PITEM.Delete(I)\xFE";
 z+="                PNUMATT = PNUMATT - 1\xFE";
 z+="                I = I - 1\xFE";
 z+="            END\xFE";
 z+="        NEXT I\xFE";
 z+="        SNUMATT = UBOUND(SITEM)\xFE";
 z+="        FOR I = 1 TO SNUMATT\xFE";
 z+="            IF INDEX('!*',TRIM(SITEM[I])[1,1],1) THEN\xFE";
 z+="                SITEM = SITEM.Delete(I)\xFE";
 z+="                SNUMATT = SNUMATT - 1\xFE";
 z+="                I = I - 1\xFE";
 z+="            END\xFE";
 z+="        NEXT I\xFE";
 z+="    END\xFE";
 z+="***********************************\xFE";
 z+="* Check for equality first\xFE";
 z+="***********************************\xFE";
 z+="    IF PITEM = SITEM THEN\xFE";
 z+="        PRINT HEADER[1]:', ':HEADER[2]:'  Items are equal'\xFE";
 z+="        NoChanges = True\xFE";
 z+="        RETURN\xFE";
 z+="    END\xFE";
 z+="    IF TRIMSPC THEN\xFE";
 z+="\xFE";
 z+="        IF TRIM(PITEM) = TRIM(SITEM) THEN\xFE";
 z+="            PRINT HEADER[1]:', ':HEADER[2]:'  Items are equal'\xFE";
 z+="            NoChanges = True\xFE";
 z+="            RETURN\xFE";
 z+="        END\xFE";
 z+="    END\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    PNUMATT = UBOUND(PITEM) \xFE";
 z+="    SNUMATT = UBOUND(SITEM)\xFE";
 z+="    \xFE";
 z+="100: * |-restart point for next checksum algorithm\xFE";
 z+="***********************************\xFE";
 z+="* Reduce each line to a checksum for faster comparisons\xFE";
 z+="***********************************\xFE";
 z+="*\xFE";
 z+="    PRINT 'Pass 1 primary': ; @Server.Flush\xFE";
 z+="    PTOKENS = []\xFE";
 z+="    FOR ATT = 1 TO PNUMATT\xFE";
 z+="        PLINE = PITEM[ATT]\xFE";
 z+="        IF IGNORECOMMENTS THEN\xFE";
 z+="            TPLINE = TRIM(PLINE)\xFE";
 z+="            IF TPLINE[1,1] = '*' OR TPLINE[1,1] = '!' THEN PLINE = '*'\xFE";
 z+="            TLINE = INDEX(PLINE,';*',1)\xFE";
 z+="            IF TLINE THEN PLINE = PLINE[1,TLINE]\xFE";
 z+="            TLINE = INDEX(PLINE,'; *',1)\xFE";
 z+="            IF TLINE THEN PLINE = PLINE[1,TLINE]\xFE";
 z+="            TLINE = INDEX(PLINE,';!',1)\xFE";
 z+="            IF TLINE THEN PLINE = PLINE[1,TLINE]\xFE";
 z+="            TLINE = INDEX(PLINE,'; !',1)\xFE";
 z+="            IF TLINE THEN PLINE = PLINE[1,TLINE]\xFE";
 z+="        END\xFE";
 z+="        SUM = 0\xFE";
 z+="        LNLEN = LEN(PLINE)\xFE";
 z+="        IF TRIMSPC THEN\xFE";
 z+="            LNCNT = 0\xFE";
 z+="            QT = ''\xFE";
 z+="            FOR CH = 1 TO LNLEN\xFE";
 z+="                C = PLINE[CH,1]\xFE";
 z+="                IF QT = '' THEN\xFE";
 z+="                    IF C # ' ' THEN\xFE";
 z+="                        LNCNT = LNCNT + 1\xFE";
 z+="                        SUM = SUM + SEQ(C) * LNCNT\xFE";
 z+="                    END\xFE";
 z+="                    IF INDEX('\"':\"'\",C,1) THEN QT = C\xFE";
 z+="                END ELSE\xFE";
 z+="                    IF C = QT THEN QT = ''\xFE";
 z+="                    LNCNT = LNCNT + 1\xFE";
 z+="                    SUM = SUM + SEQ(C) * LNCNT\xFE";
 z+="                END\xFE";
 z+="            NEXT CH\xFE";
 z+="            SUM = SUM + LNCNT\xFE";
 z+="        END ELSE\xFE";
 z+="            FOR CH = 1 TO LNLEN\xFE";
 z+="                SUM = SUM + SEQ(PLINE[CH,1]) * CH\xFE";
 z+="            NEXT CH\xFE";
 z+="            SUM=SUM+LNLEN\xFE";
 z+="        END\xFE";
 z+="        PTOKENS[ATT] = SUM\xFE";
 z+="    NEXT ATT\xFE";
 z+="    PRINT 'secondary':\xFE";
 z+="    STOKENS = []\xFE";
 z+="    FOR ATT = 1 TO SNUMATT\xFE";
 z+="        SLINE = SITEM[ATT]\xFE";
 z+="        IF IGNORECOMMENTS THEN\xFE";
 z+="            TPLINE = TRIM(SLINE)\xFE";
 z+="            IF TPLINE[1,1] = '*' OR TPLINE[1,1] = '!' THEN SLINE = '*'\xFE";
 z+="            TLINE = INDEX(SLINE,';*',1)\xFE";
 z+="            IF TLINE THEN SLINE = SLINE[1,TLINE]\xFE";
 z+="            TLINE = INDEX(SLINE,'; *',1)\xFE";
 z+="            IF TLINE THEN SLINE = SLINE[1,TLINE]\xFE";
 z+="            TLINE = INDEX(SLINE,';!',1)\xFE";
 z+="            IF TLINE THEN SLINE = SLINE[1,TLINE]\xFE";
 z+="            TLINE = INDEX(SLINE,'; !',1)\xFE";
 z+="            IF TLINE THEN SLINE = SLINE[1,TLINE]\xFE";
 z+="        END\xFE";
 z+="        LNLEN = LEN(SLINE)\xFE";
 z+="        SUM = 0\xFE";
 z+="        IF TRIMSPC THEN\xFE";
 z+="            LNCNT = 0\xFE";
 z+="            QT = ''\xFE";
 z+="            FOR CH = 1 TO LNLEN\xFE";
 z+="                C = SLINE[CH,1]\xFE";
 z+="                IF QT = '' THEN\xFE";
 z+="                    IF C # ' ' THEN\xFE";
 z+="                        LNCNT = LNCNT + 1\xFE";
 z+="                        SUM = SUM + SEQ(C) * LNCNT\xFE";
 z+="                    END\xFE";
 z+="                    IF INDEX('\"':\"'\",C,1) THEN QT = C\xFE";
 z+="                END ELSE\xFE";
 z+="                    IF C = QT THEN QT = ''\xFE";
 z+="                    LNCNT = LNCNT + 1\xFE";
 z+="                    SUM = SUM + SEQ(C) * LNCNT\xFE";
 z+="                END\xFE";
 z+="            NEXT CH\xFE";
 z+="            SUM = SUM + LNCNT\xFE";
 z+="        END ELSE\xFE";
 z+="            FOR CH = 1 TO LNLEN\xFE";
 z+="                SUM = SUM + SEQ(SLINE[CH,1]) * CH\xFE";
 z+="            NEXT CH\xFE";
 z+="            SUM=SUM+LNLEN\xFE";
 z+="        END\xFE";
 z+="        STOKENS[ATT] = SUM\xFE";
 z+="    NEXT ATT\xFE";
 z+="***********************************\xFE";
 z+="* Make a list of lines that occur exactly once in both items\xFE";
 z+="***********************************\xFE";
 z+="110: *\xFE";
 z+="    PRINT '. Pass 2': ; @Server.Flush\xFE";
 z+="    \xFE";
 z+="    // MAP is matching lines between primary and secondary source\xFE";
 z+="    // \xFE";
 z+="    MAP = [] // of [ PStartLineNo:am():PEndLineNo: am() (matches) :SStartLineNo:am():SEndLineNo]\xFE";
 z+="    FOR ATT = 1 TO PNUMATT\xFE";
 z+="        LINE = PTOKENS[ATT]\xFE";
 z+="        PTOKENS[ATT] = '*':LINE\xFE";
 z+="        LOCATE(LINE,PTOKENS ; POS) ELSE\xFE";
 z+="            LOCATE(LINE,STOKENS ; POS) ELSE POS = 0\xFE";
 z+="            IF POS THEN\xFE";
 z+="                STOKENS[POS] = '*':LINE\xFE";
 z+="                LOCATE(LINE, STOKENS ; DUM) ELSE MAP[-1] = [ATT, ATT, POS, POS] // Matching LineNo in both places\xFE";
 z+="                STOKENS[POS] = LINE\xFE";
 z+="            END\xFE";
 z+="        END\xFE";
 z+="        PTOKENS[ATT] = LINE\xFE";
 z+="    NEXT ATT\xFE";
 z+="***********************************\xFE";
 z+="* Scan forward from each match point, including lines that are\xFE";
 z+="* equal (but not unique)\xFE";
 z+="***********************************\xFE";
 z+="    PRINT '. Pass 3': ; @Server.Flush\xFE";
 z+="    ATT = 1\xFE";
 z+="    LOOP\xFE";
 z+="    UNTIL ATT > UBOUND(Map) DO\xFE";
 z+="        PSTART = MAP[ATT][1]\xFE";
 z+="        SSTART = MAP[ATT][3]\xFE";
 z+="        PEND = PSTART\xFE";
 z+="        SEND = SSTART\xFE";
 z+="        LOOP WHILE PEND < PNUMATT AND SEND < SNUMATT AND PTOKENS[PEND+1] = STOKENS[SEND+1] DO\xFE";
 z+="            PEND += 1\xFE";
 z+="            SEND += 1\xFE";
 z+="        REPEAT\xFE";
 z+="        \xFE";
 z+="        MAP[ATT] = [PSTART, PEND, SSTART, SEND]\xFE";
 z+="        ATT += 1\xFE";
 z+="        LOOP\xFE";
 z+="        WHILE ATT <= UBOUND(Map) Do\xFE";
 z+="            IF MAP[ATT][1] <= PEND THEN MAP.DELETE(ATT) ELSE BREAK\xFE";
 z+="        REPEAT\xFE";
 z+="    REPEAT\xFE";
 z+="***********************************\xFE";
 z+="* Scan backwards (same procedure as above)\xFE";
 z+="***********************************\xFE";
 z+="    PRINT '. Pass 4': ; @Server.Flush\xFE";
 z+="    ReSortMapping = ''\xFE";
 z+="    FOR ATT = 1 TO UBOUND(Map)\xFE";
 z+="        LOCATE(MAP[ATT][4], ReSortMapping, 1 ; POS ; \"AR\") ELSE NULL\xFE";
 z+="        ReSortMapping = INSERT(ReSortMapping,1,POS,0,MAP[ATT][4])\xFE";
 z+="        ReSortMapping = INSERT(ReSortMapping,2,POS,0,ATT)\xFE";
 z+="    NEXT ATT\xFE";
 z+="    FOR ATT = 1 TO UBOUND(Map)\xFE";
 z+="        A = CInt(ReSortMapping<2, ATT>)\xFE";
 z+="        MAP[A][5] = ATT\xFE";
 z+="    NEXT ATT\xFE";
 z+="    PEND = 0\xFE";
 z+="    SEND = 0\xFE";
 z+="    FOR ATT = 1 TO UBOUND(Map)\xFE";
 z+="        PSTART = MAP[ATT][1]\xFE";
 z+="        SSTART = MAP[ATT][3]\xFE";
 z+="        LOOP\xFE";
 z+="        WHILE PSTART > PEND+1 AND SSTART > SEND+1 AND PTOKENS[PSTART-1] = STOKENS[SSTART-1] DO\xFE";
 z+="            PSTART = PSTART - 1\xFE";
 z+="            SSTART = SSTART - 1\xFE";
 z+="        REPEAT\xFE";
 z+="        MAP[ATT][1] = PSTART\xFE";
 z+="        MAP[ATT][3] = SSTART\xFE";
 z+="        PEND = MAP[ATT][2]\xFE";
 z+="        SEND = ReSortMapping<1, MAP[ATT][5]>\xFE";
 z+="    NEXT ATT\xFE";
 z+="***********************************\xFE";
 z+="* Where sections of text were swapped, treat smallest of the two sections\xFE";
 z+="* as differences (remove it from the match-up list)\xFE";
 z+="***********************************\xFE";
 z+="    PRINT '. Pass 5'; @Server.Flush\xFE";
 z+="    ATT = 1\xFE";
 z+="    LOOP\xFE";
 z+="    WHILE ATT < UBOUND(Map) DO\xFE";
 z+="        IF MAP[ATT][3] >= MAP[ATT+1][3] THEN\xFE";
 z+="            IF (MAP[ATT][4] - MAP[ATT][3]) > (MAP[ATT+1][4] - MAP[ATT+1][3]) THEN\xFE";
 z+="               Map.Delete(ATT+1)\xFE";
 z+="            END ELSE\xFE";
 z+="               Map.Delete(ATT)\xFE";
 z+="                IF ATT > 1 THEN ATT = ATT - 1\xFE";
 z+="            END\xFE";
 z+="        END ELSE\xFE";
 z+="            ATT = ATT + 1\xFE";
 z+="        END\xFE";
 z+="    REPEAT\xFE";
 z+="***********************************\xFE";
 z+="* Test if there are non-white space differences\xFE";
 z+="***********************************\xFE";
 z+="    IF TRIMSPC THEN\xFE";
 z+="        IF UBOUND(MAP) = 1 THEN\xFE";
 z+="            IF MAP[1][1] = 1 AND MAP[1][2] = PNUMATT AND MAP[1][3] = 1 AND SNUMATT = PNUMATT THEN\xFE";
 z+="                PRINT\xFE";
 z+="                PRINT 'White space differences only'\xFE";
 z+="                NoChanges = True\xFE";
 z+="                RETURN                   ;* To calling program\xFE";
 z+="            END\xFE";
 z+="        END\xFE";
 z+="    END\xFE";
 z+="***********************************\xFE";
 z+="* Setup for printer, screen, etc\xFE";
 z+="***********************************\xFE";
 z+="     /*\xFE";
 z+="     PRINT @(-1):\xFE";
 z+="     BEGIN CASE\xFE";
 z+="        CASE OUTMETHOD = 2 ; PRINT CHAR(18):\xFE";
 z+="        CASE OUTMETHOD = 4 ; PRINT CHAR(27):'ZZ':\xFE";
 z+="     END CASE\xFE";
 z+="     */\xFE";
 z+="\xFE";
 z+="    print @Html(\"<span style='font-family:monospace'>\"):\xFE";
 z+="\xFE";
 z+="***********************************\xFE";
 z+="* Init variables and print header\xFE";
 z+="***********************************\xFE";
 z+="    WRAPLEN = WIDTH/2 - 6\xFE";
 z+="    EQUALLINE = '*':STR('=',WIDTH-10)\xFE";
 z+="    REMOVEDLINE = '*':STR('=',WIDTH/2 - 12):' %% ':PROJECT:' Removed %% ':STR('=',WIDTH/2 - 10)\xFE";
 z+="    ADDEDLINE = '*':STR('=',WIDTH/2 - 12):' %% ':PROJECT:' Added %% ':STR('=',WIDTH/2 - 10)\xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="    OUTPUTLN = 1\xFE";
 z+="    LineBreak = @Html('<br>')\xFE";
 z+="    \xFE";
 z+="    IF NOT(SHOWCHANGES) THEN\xFE";
 z+="        PRINT LineBreak:\xFE";
 z+="        PRINT HEADER[1]:Space(20):HEADER[2]\xFE";
 z+="        PRINT LineBreak:\xFE";
 z+="        NUMHLINES = UBOUND(HEADER)\xFE";
 z+="        FOR HLIN = 3 TO NUMHLINES\xFE";
 z+="            PRINT HEADER[HLIN][1,WIDTH-1]\xFE";
 z+="            OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="        NEXT HLIN\xFE";
 z+="        IF NUMHLINES > 2 THEN\xFE";
 z+="            PRINT EQUALLINE\xFE";
 z+="            OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="        END\xFE";
 z+="\xFE";
 z+="        OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="        PRINT EQUALLINE\xFE";
 z+="\xFE";
 z+="        OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="    END\xFE";
 z+="    MAP.INSERT(1, [0,0,0,0])\xFE";
 z+="    MAP[-1] = [PNUMATT+1, PNUMATT+1, SNUMATT+1, SNUMATT+1]\xFE";
 z+="\xFE";
 z+="    FOR ATT = 1 TO UBOUND(Map) - 1        ;* Loops thru each item in match-up list\xFE";
 z+="        *****\xFE";
 z+="        ***********************************\xFE";
 z+="        * Prints out a section of text common to both items (if whole item was selected)\xFE";
 z+="        ***********************************\xFE";
 z+="        LNDIFF = MAP[ATT][3] - MAP[ATT][1]\xFE";
 z+="        LEADER = STR( ' ', WIDTH/4 - 5 )\xFE";
 z+="        MSTART = MAP[ATT][1] + (MAP[ATT][1]=0)\xFE";
 z+="        MEND = MAP[ATT][2]\xFE";
 z+="        MIDFLAG = 0\xFE";
 z+="        IF SHOWONLYDIFS AND MSTART = 1 AND MEND > HOWMUCH THEN MSTART = MEND-HOWMUCH\xFE";
 z+="\xFE";
 z+="        FOR LN = MSTART TO MEND\xFE";
 z+="            IF SHOWONLYDIFS AND LN >= MSTART+HOWMUCH AND LN <= MEND-HOWMUCH THEN\xFE";
 z+="                IF NOT(MIDFLAG) THEN\xFE";
 z+="                    PRINT LEADER:'      [identical text omitted]     '\xFE";
 z+="                    OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="                    IF OUTMETHOD = 3 AND REM(OUTPUTLN,60) = 0 THEN PRINT CHAR(12):\xFE";
 z+="                    MIDFLAG = 1\xFE";
 z+="                END\xFE";
 z+="            END ELSE\xFE";
 z+="                TMPLN = '000':LN\xFE";
 z+="                TMPLN2 = '000':LN+LNDIFF\xFE";
 z+="                PRINTLN = PITEM[LN]\xFE";
 z+="                IF SHOWCHANGES THEN\xFE";
 z+="                    FULLLN = PRINTLN\xFE";
 z+="                    PRINTLN = ''\xFE";
 z+="                END ELSE\xFE";
 z+="                    FULLLN = LEADER:Right(TMPLN, 3):' ':Right(TMPLN2, 3):' ':PRINTLN ;*[1,WRAPLEN]\xFE";
 z+="                END\xFE";
 z+="                PRINT FULLLN\xFE";
 z+="\xFE";
 z+="                OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="                IF OUTMETHOD = 3 AND REM(OUTPUTLN,60) = 0 THEN PRINT CHAR(12):\xFE";
 z+="                *\xFE";
 z+="                /*\xFE";
 z+="                LOOP\xFE";
 z+="                   PRINTLN = PRINTLN[WRAPLEN+1,9999]\xFE";
 z+="                UNTIL PRINTLN = '' DO\xFE";
 z+="                   PRINT LEADER:'        ':PRINTLN[1,WRAPLEN]\xFE";
 z+="                   OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="                   IF OUTMETHOD = 3 AND REM(OUTPUTLN,60) = 0 THEN PRINT CHAR(12):\xFE";
 z+="                REPEAT\xFE";
 z+="                */\xFE";
 z+="            END\xFE";
 z+="        NEXT LN\xFE";
 z+="        ***************************\xFE";
 z+="        * Build image of first column\xFE";
 z+="        ***************************\xFE";
 z+="        PSTART = MAP[ATT][2] + 1\xFE";
 z+="        PEND = MAP[ATT+1][1] - 1\xFE";
 z+="        SSTART = MAP[ATT][4] + 1\xFE";
 z+="        SEND = MAP[ATT+1][3] - 1\xFE";
 z+="        OUTREC = []\xFE";
 z+="        PLNCNT = 0\xFE";
 z+="        IF PEND >= PSTART THEN\xFE";
 z+="            IF SHOWCHANGES THEN\xFE";
 z+="                OUTREC[-1] = REMOVEDLINE\xFE";
 z+="                FOR LN = PSTART TO PEND\xFE";
 z+="                    OUTREC[-1] = PITEM[LN]\xFE";
 z+="                NEXT LN\xFE";
 z+="                PLNCNT = PEND - PSTART + 1\xFE";
 z+="            END ELSE\xFE";
 z+="                *\xFE";
 z+="                PRINT EQUALLINE\xFE";
 z+="                OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="                IF OUTMETHOD = 3 AND REM(OUTPUTLN,60) = 0 THEN PRINT CHAR(12):\xFE";
 z+="                FOR LN = PSTART TO PEND\xFE";
 z+="                    PRINTLN = PITEM[LN]\xFE";
 z+="                    TMPLN = '000':LN\xFE";
 z+="                    TMPLN = Right(TMPLN, 3):' ':PRINTLN[1,WRAPLEN]\xFE";
 z+="                    LOOP\xFE";
 z+="                        OUTREC[-1] = TMPLN:STR(' ',WRAPLEN - LEN(TMPLN) + 4)\xFE";
 z+="                        PLNCNT = PLNCNT + 1\xFE";
 z+="                        PRINTLN = PRINTLN[WRAPLEN+1, 9999]\xFE";
 z+="                    UNTIL PRINTLN = '' DO\xFE";
 z+="                        TMPLN = '    ':PRINTLN[1,WRAPLEN]\xFE";
 z+="                    REPEAT\xFE";
 z+="                NEXT LN\xFE";
 z+="            END\xFE";
 z+="        END\xFE";
 z+="        ***********************************\xFE";
 z+="        * Build image of second column\xFE";
 z+="        ***********************************\xFE";
 z+="        SLNCNT = 0\xFE";
 z+="        *\xFE";
 z+="        IF SEND >= SSTART THEN\xFE";
 z+="            IF SHOWCHANGES THEN\xFE";
 z+="                OUTREC[-1] = ADDEDLINE\xFE";
 z+="                FOR LN = SSTART TO SEND\xFE";
 z+="                    OUTREC[-1] = SITEM[LN]\xFE";
 z+="                NEXT LN\xFE";
 z+="                SLNCNT = SEND - SSTART + 1\xFE";
 z+="            END ELSE\xFE";
 z+="                *\xFE";
 z+="                PRINT EQUALLINE\xFE";
 z+="                OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="                IF OUTMETHOD = 3 AND REM(OUTPUTLN,60) = 0 THEN PRINT CHAR(12):\xFE";
 z+="                FOR LN = SSTART TO SEND\xFE";
 z+="                    PRINTLN = SITEM[LN]\xFE";
 z+="                    TMPLN = '000':LN\xFE";
 z+="                    TMPLN = Right(TMPLN, 3):' ':PRINTLN[1,WRAPLEN]\xFE";
 z+="                    LOOP\xFE";
 z+="                        SLNCNT = SLNCNT + 1\xFE";
 z+="                        IF SLNCNT > PLNCNT THEN\xFE";
 z+="                            OUTREC[SLNCNT] = STR(' ',WRAPLEN+6):TMPLN\xFE";
 z+="                        END ELSE\xFE";
 z+="                            OUTREC[SLNCNT] = OUTREC[SLNCNT]:'  ':TMPLN\xFE";
 z+="                        END\xFE";
 z+="                        PRINTLN = PRINTLN[WRAPLEN+1, 9999]\xFE";
 z+="                    UNTIL PRINTLN = '' DO\xFE";
 z+="                        TMPLN = '    ':PRINTLN[1,WRAPLEN]\xFE";
 z+="                    REPEAT\xFE";
 z+="                NEXT LN\xFE";
 z+="            END\xFE";
 z+="        END\xFE";
 z+="        ***********************************\xFE";
 z+="        * Print out differences in side by side columns\xFE";
 z+="        ***********************************\xFE";
 z+="        \xFE";
 z+="        PLNCNT = UBOUND(OUTREC)\xFE";
 z+="        FOR LN = 1 TO PLNCNT\xFE";
 z+="            PRINT OUTREC[LN]\xFE";
 z+="            OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="            IF OUTMETHOD = 3 AND REM(OUTPUTLN,60) = 0 THEN PRINT CHAR(12):\xFE";
 z+="        NEXT LN\xFE";
 z+="        IF PEND-PSTART >= 0 OR SEND-SSTART >= 0 THEN\xFE";
 z+="            PRINT EQUALLINE\xFE";
 z+="            OUTPUTLN = OUTPUTLN + 1\xFE";
 z+="            IF OUTMETHOD = 3 AND REM(OUTPUTLN,60) = 0 THEN PRINT CHAR(12):\xFE";
 z+="        END\xFE";
 z+="        *****\xFE";
 z+="    NEXT ATT                          ;* End of loop thru each item in match-up list\xFE";
 z+="\xFE";
 z+="    PRINT @Html(\"</span>\"):\xFE";
 z+="\xFE";
 z+="    RETURN\xFE";
 z+="End subroutine\xFE";
 z+="\xFE";
 z+=""
window.cached_jsb_tcl["compare"]=z;
var z="Program Convert\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="* \xFE";
 z+="* Replaces a string with a string\xFE";
 z+="*\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = True\xFE";
 z+="    Dim Help As Array = [\"CONVERT FILE ITEMLIST (T - TOKEN SEARCH, C - CASE SENSITIVE)\"]\xFE";
 z+="    \xFE";
 z+="$Include __shell\xFE";
 z+=" \xFE";
 z+="    TOKENSEARCH = INDEX(UCASE(OPTIONS),\"T\",1) Or INDEX(UCASE(OPTIONS),\"W\",1)\xFE";
 z+="    CASESENSITIVE = INDEX(UCASE(OPTIONS),\"C\",1)\xFE";
 z+="    R83 = INDEX(UCASE(OPTIONS),\"R\",1)\xFE";
 z+="    IDENTIFIERCHARS = \"0123456789_ABCDEFGHIJKLMNOPQRSTUVWXYZ$@\"\xFE";
 z+="    IF R83 THEN IDENTIFIERCHARS := \".\"\xFE";
 z+="    \xFE";
 z+="    SSTR = []\xFE";
 z+="    RSTR = []\xFE";
 z+="    SLEN = []\xFE";
 z+="    RLEN = []\xFE";
 z+="    SCNT = 0\xFE";
 z+="    List = []\xFE";
 z+="    \xFE";
 z+="    PRINT Help\xFE";
 z+="    PRINT \"Enter Search & Replace strings as STRING, or $HH (Hex)\":\xFE";
 z+="    Print\xFE";
 z+="    \xFE";
 z+="    if CASESENSITIVE then print \" Case Sensitive\":\xFE";
 z+="    IF TokenSearch Then Print \" by Tokens\":\xFE";
 z+="    PRINT\xFE";
 z+="    \xFE";
 z+="    LOOP\xFE";
 z+="        if CASESENSITIVE then\xFE";
 z+="            if TOKENSEARCH Then P = \"C)ase-sensitive W)ord to search for : \" Else P = \"C)ase-sensitive S)tring to search for : \"\xFE";
 z+="        else\xFE";
 z+="            if TOKENSEARCH Then P = \"N)on-case-sensitive W)ORD to search for : \" Else P = \"N)on-case-sensitive S)tring to search for : \"\xFE";
 z+="        end if\xFE";
 z+="        P := \"(!! to abort this): \"\xFE";
 z+="        Prompt P\xFE";
 z+="        INPUT SS\xFE";
 z+="        IF SS = \"!!\" Or InStr(SS, \"(!!\") Then Stop\xFE";
 z+="        ss = unescapeString(ss)\xFE";
 z+="        If !CASESENSITIVE Then SS = LCase(SS)\xFE";
 z+="    WHILE SS # '' DO\xFE";
 z+="        Prompt \"String to replace with (!! to abort this): \"\xFE";
 z+="        INPUT RS\xFE";
 z+="        RS = unescapeString(RS)\xFE";
 z+="        If RS = \"!!\" Or InStr(RS, \"(!!\")  Then STOP \xFE";
 z+="        SCNT = SCNT + 1\xFE";
 z+="        SSTR[SCNT] = SS\xFE";
 z+="        RSTR[SCNT] = RS\xFE";
 z+="    REPEAT\xFE";
 z+="\xFE";
 z+="    IF SCNT = 0 THEN STOP\xFE";
 z+="    \xFE";
 z+="    for each iName As String In INames\xFE";
 z+="        FOR SC = 1 TO SCNT\xFE";
 z+="            SLEN(SC) = LEN(SSTR[SC])\xFE";
 z+="            RLEN(SC) = LEN(RSTR[SC])\xFE";
 z+="        NEXT SC\xFE";
 z+="    \xFE";
 z+="        READ ITEM FROM F_FILE, INAME ELSE\xFE";
 z+="            Errors[-1] = 'Item ':INAME:' not found.'\xFE";
 z+="            Cycle\xFE";
 z+="        END\xFE";
 z+="    \xFE";
 z+="        CHANGED = 0\xFE";
 z+="        FOR SC = 1 TO SCNT\xFE";
 z+="            SPOS = 1\xFE";
 z+="            LOOP\xFE";
 z+="                If CASESENSITIVE Then\xFE";
 z+="                    I = INDEX(Mid(ITEM, SPOS),SSTR[SC],1)\xFE";
 z+="                Else\xFE";
 z+="                    I = INDEX(LCase(Mid(ITEM, SPOS)),SSTR[SC],1)\xFE";
 z+="                End If\xFE";
 z+="            WHILE I DO\xFE";
 z+="                I = I + SPOS - 1\xFE";
 z+="                IF TOKENSEARCH THEN\xFE";
 z+="                    OK = 1\xFE";
 z+="                    IF I > 1 THEN\xFE";
 z+="                        C = UCase(ITEM[I-1,1])\xFE";
 z+="                        IF INDEX(IDENTIFIERCHARS, C, 1) THEN OK=0\xFE";
 z+="                    END\xFE";
 z+="                    C = UCase(ITEM[I+LEN(SSTR[SC]),1])\xFE";
 z+="                    IF INDEX(IDENTIFIERCHARS, C, 1) AND C# \"\" THEN OK=0\xFE";
 z+="                END ELSE\xFE";
 z+="                    OK = 1\xFE";
 z+="                END\xFE";
 z+="                *\xFE";
 z+="                IF OK THEN\xFE";
 z+="                    CHANGED = 1\xFE";
 z+="                    ITEM = Left(ITEM, I-1):RSTR[SC]:Mid(ITEM, I+SLEN(SC))\xFE";
 z+="                    SPOS = I + RLEN(SC)\xFE";
 z+="                END ELSE\xFE";
 z+="                    SPOS = I + 1\xFE";
 z+="                END\xFE";
 z+="            REPEAT\xFE";
 z+="        NEXT SC\xFE";
 z+="        IF CHANGED THEN\xFE";
 z+="            LIST[-1] = INAME\xFE";
 z+="            Print anchorEdit(FNAME, INAME)\xFE";
 z+="            TrashIt(FName, IName)\xFE";
 z+="            WRITE ITEM ON F_FILE, INAME\xFE";
 z+="        END\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    IF LIST Then\xFE";
 z+="        WRITELIST LIST ON TableName Else Stop @Errors\xFE";
 z+="        print \"Change list saved to \":@InputButton(TableName, \"gl \":TableName:cr())\xFE";
 z+="    End If\xFE";
 z+=""
window.cached_jsb_tcl["convert"]=z;
var z="Program Copy\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    Dim Help As Array = ['COPY TableName <ITEMNAMES> {(options)}']\xFE";
 z+="    Help[-1] = '    D) Delete source item after copying'\xFE";
 z+="    Help[-1] = '    I) Item ID suppress'\xFE";
 z+="    Help[-1] = '    O) Overwrite destination'\xFE";
 z+="    Help[-1] = '    J) JSON - use JSON read and WRITE'\xFE";
 z+="    Help[-1] = '    -J) not JSON copy'\xFE";
 z+="    Help[-1] = '    -TableName) specify destination'\xFE";
 z+="    Help[-1] = '    T) Terminal copy'\xFE";
 z+="    Help[-1] = '       S or N) Suppress line numbers'\xFE";
 z+="    Help[-1] = '       H) HTML Data'\xFE";
 z+="    Help[-1] = '       M) Monospace'\xFE";
 z+="    Help[-1] = '    B) BASIC compile items after copying'    \xFE";
 z+="    \xFE";
 z+="    $include __shell\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    Dim fTrashCan As FileHandle = Nothing\xFE";
 z+="    Dim sendToFile As Boolean = False\xFE";
 z+="    Dim dstFNameWithDD As String = \"\"\xFE";
 z+="    Dim Iname As String = \"\"\xFE";
 z+="    Dim Copycnt As Integer = 0\xFE";
 z+="    Dim NotCopiedCnt As Integer = 0\xFE";
 z+="    Dim AskToOverWrite As Boolean = True\xFE";
 z+="    Dim dstFName As String = Trim(Field(Options, \"-\", 2))\xFE";
 z+="    Options = UCase(Trim(Field(Options, \"-\", 1)))\xFE";
 z+="    Dim Dodelete As Boolean = Index(Options,'D',1)\xFE";
 z+="    Dim SuppressIID As Boolean = Index(Options,'I',1)\xFE";
 z+="    Dim Overwrite As Boolean = Index(Options,'O',1)\xFE";
 z+="    Dim Suppressno As Boolean = Index(Options,'S',1) Or Index(Options,'N',1)\xFE";
 z+="    Dim Toterm As Boolean = Index(Options,'T',1)\xFE";
 z+="    Dim JSonCopy As Boolean = Index(Options,'J',1) And Index(Options,'-J',1) = 0\xFE";
 z+="    Dim HtmlItems As Boolean = Index(Options,'H',1)\xFE";
 z+="    Dim MonoSpacePrint As Boolean = Index(Options,'M',1)\xFE";
 z+="    Dim CompileAfterCopy As Boolean = Index(Options,'B',1)\xFE";
 z+="    Dim RenameNotCopy As Boolean = LCase(Left(@Sentence, 7)) = \"rename \"\xFE";
 z+="    Dim AskedJson As Boolean = Index(Options,'-J',1)\xFE";
 z+="    Dim userSuppliedDestID As String = \"\"\xFE";
 z+="    Dim Copies As Integer = -1\xFE";
 z+="    Dim isSqlConnection As Boolean = False\xFE";
 z+="    Dim FileID As String\xFE";
 z+="    Dim Ddata As String\xFE";
 z+="    Dim F_dfile As FileHandle\xFE";
 z+="    Dim CachedItems As Json\xFE";
 z+="    Dim ConnectionType As String\xFE";
 z+="    Dim Item As Variable\xFE";
 z+="    Dim Ans As String\xFE";
 z+="       \xFE";
 z+="    ConnectionType = UCase(@ConnectionType)\xFE";
 z+="    isSqlConnection = typeOfFile(F_file) = \"ado\"\xFE";
 z+="    \xFE";
 z+="    If Num(Options) And Options # '' Then\xFE";
 z+="        Copies = Options\xFE";
 z+="        Options = ''\xFE";
 z+="    End Else\xFE";
 z+="        Copies = -1\xFE";
 z+="    End\xFE";
 z+="    \xFE";
 z+="    CachedItems = {}\xFE";
 z+="    if !AllItems then\xFE";
 z+="        For Each IdTest As String, Idi As Integer In INames\xFE";
 z+="            If JSonCopy Then\xFE";
 z+="                Readjson Item From F_file, IdTest Else Stop 'Item ':IdTest:' not found.'\xFE";
 z+="            Else\xFE";
 z+="                Read Item From F_file, IdTest Else Stop 'Item ':IdTest:' not found.'\xFE";
 z+="            End\xFE";
 z+="            CachedItems[idTest:\"x\"] = Item\xFE";
 z+="            If Idi > 10 Then Break\xFE";
 z+="        Next\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    If Not(Toterm) Then\xFE";
 z+="        userSuppliedDestID = \"\"\xFE";
 z+="        If dstFName = \"\" Then\xFE";
 z+="            Prompt \"To (use !! to abort): \"\xFE";
 z+="            Input Fileid\xFE";
 z+="            if FileID = \"!!\" Then Stop\xFE";
 z+="            \xFE";
 z+="            If RenameNotCopy Then\xFE";
 z+="                If Fileid = '' Then Stop\xFE";
 z+="                If Dcount(userSuppliedDestID, ' ') <> UBound(INames) Then Stop 'Item ID count mismatch'\xFE";
 z+="            Else\xFE";
 z+="                If Fileid = '' Then\xFE";
 z+="                    Toterm = 1\xFE";
 z+="                    If RenameNotCopy Then Stop\xFE";
 z+="                Else\xFE";
 z+="                    Fileid = Trim(Fileid)\xFE";
 z+="                    If Fileid[1,1] = '(' Then\xFE";
 z+="                        dstFName = Field(Fileid,' ',1)[2,99]\xFE";
 z+="                        If Mcu(dstFName) = 'DICT' Then\xFE";
 z+="                            Ddata = 'DICT'\xFE";
 z+="                            dstFName = Field(Fileid,' ',2)\xFE";
 z+="                        End Else\xFE";
 z+="                            Ddata = ''\xFE";
 z+="                        End\xFE";
 z+="                        userSuppliedDestID = Fileid[Col2()+1, 9999]\xFE";
 z+="                    End Else\xFE";
 z+="                        Ddata = Dictdata\xFE";
 z+="                        dstFName = TableName\xFE";
 z+="                        userSuppliedDestID = Fileid\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="            End\xFE";
 z+="        End\xFE";
 z+="\xFE";
 z+="        If dstFName <> \"\" Then\xFE";
 z+="            sendToFile = True\xFE";
 z+="            Open Ddata, dstFName To F_dfile Else Stop \"Unable to open \":Ddata:\" \":dstFName\xFE";
 z+="            dstFNameWithDD = LTrim(Ddata:\" \"):dstFName\xFE";
 z+="            \xFE";
 z+="        End If\xFE";
 z+="    End\xFE";
 z+="    \xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        Dim Ext As String = @FieldRight(UCase(Iname), \".\")\xFE";
 z+="        Dim HDoc As Boolean = Ext = \"HTM\" Or Ext = \"HTML\"\xFE";
 z+="\xFE";
 z+="        Item = CachedItems[Iname:\"x\"]\xFE";
 z+="        \xFE";
 z+="        Dim itemIsJSON As Boolean = JSonCopy\xFE";
 z+="        \xFE";
 z+="        If IsNothing(Item) Then\xFE";
 z+="            If JSonCopy Then\xFE";
 z+="                Readjson Item From F_file, Iname Else\xFE";
 z+="                    Read Item From F_file, Iname Then itemIsJSON = False Else\xFE";
 z+="                        Errors[-1] = 'Item ':Iname:' not found. '\xFE";
 z+="                        Cycle\xFE";
 z+="                    End If\xFE";
 z+="                End\xFE";
 z+="            Else\xFE";
 z+="                Read Item From F_file, Iname Else\xFE";
 z+="                    Errors[-1] = 'Item ':Iname:' not found. '\xFE";
 z+="                    Cycle\xFE";
 z+="                End\xFE";
 z+="                itemIsJSON = false\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        if !itemIsJSON And !AskedJson And !Toterm Then\xFE";
 z+="            if isValidJson(Item) Or isSqlConnection Then\xFE";
 z+="                Readjson tJson As Json From F_file, Iname Then\xFE";
 z+="                    if !HasTag(tJson, \"ItemContent\") Then\xFE";
 z+="                        Ans = MsgBox(\"JSON Data\", \"You seem to have JSON data, do a JSON copy?\", \"Yes,*No,Yes-All,No-All,Cancel\")\xFE";
 z+="                        If Ans = \"Cancel\" Or Ans = \"\" Then Stop\xFE";
 z+="                        If Ans = \"No\" Or Ans = \"No-All\" Then AskedJson = true\xFE";
 z+="                        if Ans = \"Yes-All\" Then JSonCopy = True; itemIsJSON = True\xFE";
 z+="                        if Ans = \"Yes-All\" Or Ans = \"Yes\" Then Item = tJson; itemIsJSON = True\xFE";
 z+="                    End If\xFE";
 z+="                Else\xFE";
 z+="                    AskedJson = True\xFE";
 z+="                end if\xFE";
 z+="            Else\xFE";
 z+="                AskedJson = True\xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="    \xFE";
 z+="        If isCrlfFile(Iname) Then\xFE";
 z+="            If Instr(Item, Chr(13)) Or Instr(Item, Chr(10)) Then\xFE";
 z+="                Item = Replace(Item, Chr(13):Chr(10), Chr(254))\xFE";
 z+="                Item = Replace(Item, Chr(13), Chr(254))\xFE";
 z+="                Item = Replace(Item, Chr(10), Chr(254))\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    \xFE";
 z+="        If Toterm Then\xFE";
 z+="            If Not(Suppressiid) Then\xFE";
 z+="                Print anchorEdit(FName, IName)\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            If Hdoc Or HtmlItems Then\xFE";
 z+="                Item = Replace(Item, am(), crlf())\xFE";
 z+="                Print @Html(Item)\xFE";
 z+="            Else\xFE";
 z+="                If isValidJSon(Item) Then\xFE";
 z+="                    Item = CJson(Item)\xFE";
 z+="                    if isArray(Item) Then \xFE";
 z+="                        Item = CStr({ format: item })\xFE";
 z+="                        Item = \"[\":DropLeft(Item, \"[\")\xFE";
 z+="                        Item = DropRight(Item, \"]\"):\"]\"\xFE";
 z+="                    Else\xFE";
 z+="                        Item = CStr(Item)\xFE";
 z+="                    End If\xFE";
 z+="                    Item = Replace(Item, am(), `\\r\\n`) \xFE";
 z+="                    Item = Replace(Item, crlf(), am())\xFE";
 z+="                Endif\xFE";
 z+="    \xFE";
 z+="                Item = Split(Item, am())\xFE";
 z+="                For Each L As String, I As Integer In Item\xFE";
 z+="                    if MonoSpacePrint Then\xFE";
 z+="                        If Not(Suppressno) Then Print monoSpace(Fmt(I, 'R%4 ')):\xFE";
 z+="                        Print monoSpace(L)\xFE";
 z+="                    else\xFE";
 z+="                       If Not(Suppressno) Then Print Fmt(I, 'R%4 '):\xFE";
 z+="                        Print L\xFE";
 z+="                    end if\xFE";
 z+="                Next I\xFE";
 z+="            end if\xFE";
 z+="            Print\xFE";
 z+="            * PRINTER OFF\xFE";
 z+="        End\xFE";
 z+="    *\xFE";
 z+="        If Dodelete Then\xFE";
 z+="            Delete F_file, Iname\xFE";
 z+="        End If\xFE";
 z+="    *\xFE";
 z+="        If sendToFile Then\xFE";
 z+="            Dim destIID As String = Field(userSuppliedDestID,' ',1)\xFE";
 z+="            userSuppliedDestID = userSuppliedDestID[Col2()+1,9999]\xFE";
 z+="            If destIID = '' Then destIID = Iname\xFE";
 z+="            *\xFE";
 z+="            If Not(Overwrite) Then\xFE";
 z+="                Dim Tstitem As String\xFE";
 z+="                Readv Tstitem From F_dfile, destIID, 1 Then\xFE";
 z+="                    If AskToOverWrite Then\xFE";
 z+="                        Ans = MsgBox(\"Overwrite\", destIID:\" exists on file, overwrite?\", \"Yes,*No,Yes-All,No-All,Cancel\")\xFE";
 z+="                        If Ans = \"Cancel\" Or Ans = \"\" Then Stop\xFE";
 z+="                        If Ans = \"No\" Or Ans = \"No-All\" Then\xFE";
 z+="                            if NotCopiedCnt < 30 then Print destIID:\" exists on file, item not copied.\"\xFE";
 z+="                            NotCopiedCnt += 1\xFE";
 z+="                            If Ans = \"No-All\" Then AskToOverWrite = False\xFE";
 z+="                            Cycle\xFE";
 z+="                        End If\xFE";
 z+="                        If Ans = \"Yes-All\" Then Overwrite = True\xFE";
 z+="                    Else\xFE";
 z+="                        if NotCopiedCnt < 30 then Print destIID:\" exists on file, item not copied.\"\xFE";
 z+="                        NotCopiedCnt += 1\xFE";
 z+="                        Cycle ;* no-all\xFE";
 z+="                    End If\xFE";
 z+="                End\xFE";
 z+="            End\xFE";
 z+="    \xFE";
 z+="            Read Xx As String From F_dfile, destIID Then \xFE";
 z+="                if !fTrashCan Then fTrashCan = fHandle(\"\", \"TrashCan\", True)\xFE";
 z+="                Write Xx On fTrashCan, Trim(Ddata:\" \":dstFName):\" \":destIID\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            If itemIsJSON Then\xFE";
 z+="                Writejson Item On F_dfile, destIID Else Stop @Errors\xFE";
 z+="            Else\xFE";
 z+="                Write Item On F_dfile, destIID Else Stop @Errors\xFE";
 z+="            End\xFE";
 z+="    \xFE";
 z+="            if CompileAfterCopy Then \xFE";
 z+="                Execute 'BASIC ':dstFName:' ':destIID \xFE";
 z+="            else\xFE";
 z+="                If Not(Suppressiid) Then Print AnchorEdit(Fname, Iname) :' copied to ': AnchorEdit(dstFNameWithDD, destIID)\xFE";
 z+="            end if\xFE";
 z+="        End\xFE";
 z+="        \xFE";
 z+="        Copycnt = Copycnt + 1\xFE";
 z+="        If Copycnt = Copies Then Clearselect ; Break\xFE";
 z+="        if System(1) = \"js\" Then @Server.Flush\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    if NotCopiedCnt Then\xFE";
 z+="        if NotCopiedCnt = 1 Then \xFE";
 z+="            print \"One item NOT copied. \":\xFE";
 z+="        else\xFE";
 z+="            if NotCopiedCnt >= 30 then Print \"... more items NOT copied\"\xFE";
 z+="            print NotCopiedCnt:\" item(s) NOT copied. \":\xFE";
 z+="        end if\xFE";
 z+="        If Copycnt Then Print\xFE";
 z+="    end If\xFE";
 z+="    \xFE";
 z+="    If Copycnt Then\xFE";
 z+="        If Copycnt = 1 Then\xFE";
 z+="            Print 'One item copied.'\xFE";
 z+="        End Else\xFE";
 z+="            Print Copycnt:\" items copied.\"\xFE";
 z+="        End\xFE";
 z+="    End If\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Program Rename\xFE";
 z+="    Dim S As String = @Sentence\xFE";
 z+="    S = LTrim(DropLeft(S, ' '))\xFE";
 z+="    Dim Opts As String = UCase(Field(S, '(', 2))\xFE";
 z+="    S = RTRim(Field(S, '(', 1))\xFE";
 z+="    If Dcount(S, ' ') < 2 Then Stop 'Rename FileName ItemName(s)'\xFE";
 z+="    Dim CMD As String = \"Copy \":S:\" (DOI\"\xFE";
 z+="    Chain CMD\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Program Ct\xFE";
 z+="    Dim S As String = @Sentence\xFE";
 z+="    S = LTrim(DropLeft(S, ' '))\xFE";
 z+="    Dim Opts As String = UCase(Field(S, '(', 2))\xFE";
 z+="    S = RTRim(Field(S, '(', 1))\xFE";
 z+="    \xFE";
 z+="    If Dcount(S, ' ') < 1 Then Stop 'CT FileName ItemName(s) (M-Monospace, H-Html, I-Supress ID, N-No Line numbers, J-JSON'\xFE";
 z+="    \xFE";
 z+="    Dim CMD As String = \"Copy \":S:\" (T\"\xFE";
 z+="    If Instr(Opts, \"J\") Then CMD := \"JN\"\xFE";
 z+="    If Instr(Opts, \"S\") Or Instr(Opts, \"N\") Then CMD := \"S\"\xFE";
 z+="    If Instr(Opts, \"H\") Then CMD := \"H\"\xFE";
 z+="    If Instr(Opts, \"I\") Then CMD := \"I\"\xFE";
 z+="    If Instr(Opts, \"M\") Then CMD := \"M\"\xFE";
 z+="    Chain CMd\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["copy"]=z;
var z="Program Count\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    If !@ParseSelect(@Sentence, \"\", Top, Columns, dict, fname, FilterBy, OrderBY, Options, AllItems, f) Then Stop @Errors\xFE";
 z+="    if len(Options) and num(Options) then cols = cint(Options) else cols = 4\xFE";
 z+="\xFE";
 z+="    cnt = -1\xFE";
 z+="    if typeoffile(f) = \"ado\" And !System(11) Then\xFE";
 z+="        cnt = f.Execute(\"Select Count(*) From [\":fName:\"]\":iff(FilterBy, \" Where \":FilterBy, \"\"))\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If cnt = -1 Then\xFE";
 z+="        select LTrim(Top:' '):Join(Columns, \" \") from f where FilterBy:OrderBy to sl else stop @Errors\xFE";
 z+="    \xFE";
 z+="        x = CStr(getlist(sl, true))\xFE";
 z+="        ClearSelect\xFE";
 z+="        \xFE";
 z+="        cnt = dcount(x, am())\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if !Cnt then Stop \"No Items\"\xFE";
 z+="    if Cnt = 1 then Stop \"One Item\"\xFE";
 z+="    stop Cnt:\" items\""
window.cached_jsb_tcl["count"]=z;
window.cached_jsb_tcl["createaccount"]="program createAccount\xFE*$options aspx\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE    ActName = field(field(@sentence, \"(\", 1), \" \", 2)\xFE    if !ActName then Stop \"createAccount <accountName>\"\xFE    if accountExists(ActName) Then Stop @Bold(ActName):\" already exists.\"\xFE    if msgbox(\"Are you sure you want to create account \":@Bold(ActName):\"?\", \"Yes,*No\") <> \"Yes\" Then Stop \"No action taken\"\xFE    \xFE    if createAccount(ActName) = false then stop @errors\xFE    stop \"Account \":ActName:\" created.\"\xFEend program\xFE";
var z="Program CreateFile\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    Sent = RTrim(Field(DropLeft(Trim(@Sentence), \" \"), \"(\", 1))\xFE";
 z+="    Opts = LCase(Trim(Field(@Sentence, \"(\", 2)))\xFE";
 z+="   \xFE";
 z+="    Fname = Field(Sent, \" \", 1)\xFE";
 z+="    If UCase(Fname) = \"DICT\" Or UCase(Fname) = \"DATA\" Then\xFE";
 z+="        Ddata = UCase(FName)\xFE";
 z+="        FName = DropLeft(Sent, \" \")\xFE";
 z+="    End If\xFE";
 z+="    If FName = \"\" Then\xFE";
 z+="        Stop \"createfile filename (options - ls, dsk, js)\"\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    I_open Ddata, FName To Fhandle Then Stop FName:\" already exists.\"\xFE";
 z+="    Protocol = \"\"\xFE";
 z+="    \xFE";
 z+="    if System(1) = \"js\" And (@Session.AttachedDatabase = '' Or LCase(@Session.AttachedDatabase = 'jsb')) Then\xFE";
 z+="        if isHta() Then \xFE";
 z+="            Choices = [\"ls:\",\"js:\"] \xFE";
 z+="            \xFE";
 z+="        Else if window.dotNetObj Then\xFE";
 z+="           Choices = [\"ls:\",\"dsk:\",\"js:\"]\xFE";
 z+="           \xFE";
 z+="        Else if window.fileSystem then\xFE";
 z+="            Choices = [\"ls:\",\"dsk:\",\"js:\"]\xFE";
 z+="            \xFE";
 z+="        Else\xFE";
 z+="            Choices = [\"ls:\"]\xFE";
 z+="            Protocol = \" \"\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        If InStr(FName, \":\") Then \xFE";
 z+="            Protocol = LCase(Field(FName, \":\", 1)):\":\"\xFE";
 z+="            FName = DropLeft(FName, \":\")\xFE";
 z+="            Locate Protocol in Choices else stop \"Valid protocols: \":Join(Choices, \",\")\xFE";
 z+="        Else \xFE";
 z+="            If Opts = LCase('LocalStorage') Or Opts = \"ls\" Then Protocol = 'ls:'\xFE";
 z+="            If Opts = LCase('Large Table') Or Opts = \"dsk\" Then Protocol = 'dsk:'\xFE";
 z+="            If Opts = LCase('Small Table') Or Opts = \"js\" Then Protocol = 'js:'\xFE";
 z+="        End If\xFE";
 z+="       \xFE";
 z+="        If (DData = '' Or DData = 'DATA') And !Protocol Then\xFE";
 z+="            Choices = \"Small Table(single JSON record),*Large Table(dsk),LocalStorage\"\xFE";
 z+="            Protocol = MsgBox(\"Create File \":FName, \"File Type?\", Choices)\xFE";
 z+="            If Protocol = '' Or Protocol = Chr(27) Then Stop\xFE";
 z+="            Protocol = Field(Protocol, \"(\", 1)\xFE";
 z+="            If Protocol = 'LocalStorage' Then Protocol = 'ls:'\xFE";
 z+="            If Protocol = 'Large Table' Then Protocol = 'dsk:' ;* File System\xFE";
 z+="            If Protocol = 'Small Table' Then Protocol = 'js:'  ;* Single JSON record for table\xFE";
 z+="        End If\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    CreateFile LTrim(Protocol):LTrim(DData:\" \":FName) Else Stop @Errors\xFE";
 z+="\xFE";
 z+="    If System(1) = \"js\" And !DData Then\xFE";
 z+="        CreateFile \"dict \":FName Else Stop @Errors\xFE";
 z+="        Print \"DICT \":FName:\" created in \":@Account\xFE";
 z+="    End If\xFE";
 z+="   \xFE";
 z+="    Print LTrim(DData:\" \":FName):\" created in \":@Account\xFE";
 z+="End Program"
window.cached_jsb_tcl["createfile"]=z;
window.cached_jsb_tcl["decode"]="Program Decode\xFE*\xFE* decode string - default to base64\xFE* \xFE    S = DropLeft(@Sentence, ' ')\xFE    O = FieldIfRight(S, ' (', 1)\xFE    If O Then S = DropRight(S, ' (')\xFE    if !O Then o = 64\xFE    S = Decode(S, o)\xFE    Print S\xFE    Clearselect\xFEEnd Program";
var z="Program Delete\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    If !@ParseSelect(@Sentence, \"\", Top, Columns, Dict, Fname, FilterBy, OrderBY, Options, AllItems, F) Then Stop\xFE";
 z+="    \xFE";
 z+="    // P) Do not send to TRASHCAN\xFE";
 z+="    // I) Supress Item-ID\xFE";
 z+="    \xFE";
 z+="    if !allItems And !FilterBy And !System(11) then stop 'Delete Table <ItemNames | *>'\xFE";
 z+="    Select LTrim(Top:' '):Join(Columns, \" \") From F Where FilterBy:OrderBY Else Stop @Errors\xFE";
 z+="\xFE";
 z+="    Readnext iName Else Stop\xFE";
 z+="    \xFE";
 z+="    isDosFile = typeoffile(F) = \"dos\"\xFE";
 z+="    \xFE";
 z+="    fTrashCan = fHandle(\"\", \"TrashCan\", True)\xFE";
 z+="    fdTrashCan = fHandle(\"dict\", \"TrashCan\", True)\xFE";
 z+="    \xFE";
 z+="    dCnt = 0\xFE";
 z+="    Quiet = Instr(Options, 'I')\xFE";
 z+="    \xFE";
 z+="    tFName = LCase(TrueFileName(fname))\xFE";
 z+="    okToTrash = tFName <> \"tmp\" And tFName <> \"trashcan\" And Instr(Options, \"P\") = 0 \xFE";
 z+="    tFName = ltrim(dict:\" \"):tfname\xFE";
 z+="    \xFE";
 z+="    Kilo = 1024\xFE";
 z+="    Mega = Kilo * Kilo\xFE";
 z+="    tooBig = 10 * Mega\xFE";
 z+="    NotTrashed = []\xFE";
 z+="    \xFE";
 z+="    For Cnt = 1 To 100000 While iName <> \"\"\xFE";
 z+="        if Cnt > 1 Then ReadNext iName Else Break\xFE";
 z+="        If Cnt > 100 And !Quiet Then Quiet = True; Print \"... more items\"\xFE";
 z+="        If Cnt = 500 And okToTrash Then\xFE";
 z+="            Ans = MsgBox(\"500 items deleted so far, do you want to continue to send items to the trashcan?\", \"Yes,No\")\xFE";
 z+="            if Ans = \"\" Or Ans = Chr(27) Then Stop \"Stopped\"\xFE";
 z+="            if Ans <> \"Yes\" Then okToTrash = False\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        trashThisOne = okToTrash\xFE";
 z+="        if trashThisOne Then\xFE";
 z+="            if isDosFile Then\xFE";
 z+="                // Limit to 10 megabytes\xFE";
 z+="                I_readblk LastByte From F, iName, tooBig, 1 Then trashThisOne = false\xFE";
 z+="            Else\xFE";
 z+="                if IsBinaryFile(iName) Then trashThisOne = false\xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="                \xFE";
 z+="        if trashThisOne then\xFE";
 z+="            Read oldItem From F, iName Else\xFE";
 z+="                if @Errors Then Print @Errors Else Print iName:\" not on file\"\xFE";
 z+="                Cycle\xFE";
 z+="            End If\xFE";
 z+="                \xFE";
 z+="            // put a 2MB size limit on trashcan items\xFE";
 z+="            if len(oldItem) < 2097152 then \xFE";
 z+="                i_read cntr from fdTrashCan, tFName:\" \":INAME else cntr = 0\xFE";
 z+="                cntr += 1\xFE";
 z+="                write cntr on fdTrashCan, tFName:\" \":INAME else Stop @Errors\xFE";
 z+="                Write oldItem on fTrashCan, iName:\".\":cntr Else Stop @Errors\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            if okToTrash then NotTrashed[-1] = iName\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        Delete F, iName Then\xFE";
 z+="            If !Quiet Then Print iName:\" deleted\"\xFE";
 z+="            dCnt += 1\xFE";
 z+="        End Else\xFE";
 z+="            Errs<-1> = @Errors\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errs Then Print Replace(Errs, am(), crlf())\xFE";
 z+="    If okToTrash Then Msg = \"sent to trash can\" Else Msg = \"deleted\"\xFE";
 z+="    If dCnt > 1 Then Print dCnt:\" items \":Msg\xFE";
 z+="    If dCnt = 1 Then Print \"One item \":Msg\xFE";
 z+="    If !dCnt Then Print \"No items deleted\"\xFE";
 z+="    if NotTrashed Then Print \"Items not sent to Trash: \":Join(NotTrashed, \", \")\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["delete"]=z;
window.cached_jsb_tcl["deleteaccount"]="Program deleteAccount\xFE*$options aspx\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE    ActName = field(field(@sentence, \"(\", 1), \" \", 2)\xFE    Options = LCase(Field(@Sentence, \"(\", 2))\xFE    If !ActName Then Stop \"deleteAccount <accountName>\"\xFE    If !accountExists(ActName) Then Stop @Bold(ActName):\" does not exist.\"\xFE    If Instr(Options, \"q\") = 0 Then\xFE        If Msgbox(\"Are you sure you want to delete account \":@Bold(ActName):\"?\", \"Yes,*No\") <> \"Yes\" Then Stop \"No action taken\"\xFE    End If\xFE    If deleteAccount(ActName) = False Then Stop @Errors\xFE    if lcase(ActName) = lcase(@jsbaccount) Then @Response.Redirect(@HtmlRoot:\"sysprog\")\xFE    Stop \"Account \":ActName:\" deleted.\"\xFEEnd Program\xFE";
var z="Program DeleteFile\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    Dim Sent As String = LTrim(RTrim(DropIfRight(DropLeft(@Sentence, ' '), ' (')))\xFE";
 z+="    dim fileList As Array = Split(Sent, ' ', 4) ;* Split on spaces, but not inside strings (4)\xFE";
 z+="    dim Options As String = LCase(LTrim(RightField(@Sentence, ' (')))\xFE";
 z+="    Dim Quietly As Boolean = InStr(Options, 'q')\xFE";
 z+="    Dim suppressPrinting As Boolean = InStr(Options, 's')\xFE";
 z+="    \xFE";
 z+="    Dim listAccount As String = \"\"\xFE";
 z+="    Dim mustContain As String = \"\"\xFE";
 z+="    Dim mustEndWith As String = \"\"\xFE";
 z+="    Dim LenMustEndWith As Integer = 0\xFE";
 z+="    Dim MustStartWith As String = \"\"\xFE";
 z+="    Dim LenMustStartWith As Integer = 0\xFE";
 z+="    \xFE";
 z+="    if !fileList Then\xFE";
 z+="        if !System(11) Then Stop 'DeleteFile FileName ... (options':crlf():'    option S - suppress showing filenames':crlf():'    option Q - quietly (no prompting)'\xFE";
 z+="        fileList = getList(0)  \xFE";
 z+="    End if\xFE";
 z+="    \xFE";
 z+="    ' Combine Dict & Data with file name\xFE";
 z+="    newFileList = []\xFE";
 z+="    ddata = ''\xFE";
 z+="    for each fname in fileList\xFE";
 z+="        fname = lcase(fname)\xFE";
 z+="        if fname = 'dict' then\xFE";
 z+="            ddata = 'dict '\xFE";
 z+="            cycle\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        if fname = 'dict' then\xFE";
 z+="            ddata = ''\xFE";
 z+="            cycle\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        newFileList[-1] = ddata:fname\xFE";
 z+="        ddata = ''\xFE";
 z+="    next\xFE";
 z+="    fileList = newFileList   \xFE";
 z+="        \xFE";
 z+="    ' check for filter's\xFE";
 z+="    newFileList = []\xFE";
 z+="    for each FilterBy in fileList\xFE";
 z+="        if left(FilterBy, 1) = \"[\" Or Right(FilterBy, 1) = \"]\" Then \xFE";
 z+="            If Left(filterBy, 1) = \"[\" Then\xFE";
 z+="                If Right(filterBy, 1) = \"]\" Then\xFE";
 z+="                    mustContain = LCase(Mid(filterBy, 2, Len(filterBy)-2))\xFE";
 z+="                Else\xFE";
 z+="                    mustEndWith = LCase(Mid(filterBy, 2))\xFE";
 z+="                    LenMustEndWith = Len(mustEndWith)\xFE";
 z+="                End If\xFE";
 z+="            Else\xFE";
 z+="                MustStartWith = LCase(Left(filterBy, Len(filterBy) - 1))\xFE";
 z+="                LenMustStartWith = Len(MustStartWith)\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            listfiles to allfileList Else stop @errors\xFE";
 z+="            for each fileName In allfileList\xFE";
 z+="                Dim LCFileName As String = LCase(FileName)\xFE";
 z+="                \xFE";
 z+="                If mustContain Then\xFE";
 z+="                    If !Instri(FileName, mustContain) Then FileName = \"\"\xFE";
 z+="                    \xFE";
 z+="                ElseIf mustEndWith Then\xFE";
 z+="                    If LCase(Right(FileName, LenMustEndWith)) <> mustEndWith Then FileName = \"\"\xFE";
 z+="                    \xFE";
 z+="                ElseIf MustStartWith Then\xFE";
 z+="                    If LCase(Left(FileName, LenMustStartWith)) <> MustStartWith Then FileName = \"\"\xFE";
 z+="                Endif\xFE";
 z+="                \xFE";
 z+="                if FileName Then newFileList[-1] = fileName\xFE";
 z+="            Next\xFE";
 z+="        Else\xFE";
 z+="            newFileList[-1] = FilterBy\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    fileList = newFileList \xFE";
 z+="    \xFE";
 z+="    if Len(fileList) > 1 Then\xFE";
 z+="        if !Quietly Then\xFE";
 z+="            if MsgBox('Delete these files?':crlf():\"    \":Join(fileList, crlf():\"    \"), 'Yes,*No') <> 'Yes' Then stop\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    cnt = 0\xFE";
 z+="    for each displayFName In fileList\xFE";
 z+="        q = left(displayFName, 1)\xFE";
 z+="        If Instr(`\"'`:\"`\", q) And Right(displayFName, 1) = q Then fileName = Mid(displayFName, 2, len(displayFName) - 2) Else fileName = displayFName\xFE";
 z+="        \xFE";
 z+="        DData = Field(UCase(fileName), ' ', 1)\xFE";
 z+="        Dim partialDelete As Boolean = DData = \"DICT\" Or DData = \"DATA\"\xFE";
 z+="        If partialDelete Then fileName = LTrim(Mid(fileName, 6)) Else dData = \"\"\xFE";
 z+="    \xFE";
 z+="        if @Session.AttachedDatabase Then\xFE";
 z+="            // don't allow deletion via a QPTR\xFE";
 z+="            i_Open DData, fileName To Fhandle Then Stop \"You have a local copy of \":fileName:\".  Delete your local copy first\"            \xFE";
 z+="            Open DData, fileName To Fhandle Then foundIt = True else foundIt = False\xFE";
 z+="        Else\xFE";
 z+="            i_Open DData, fileName To Fhandle Then \xFE";
 z+="                foundIt = True \xFE";
 z+="            else \xFE";
 z+="                i_Open \"data\", DData : \" \" : fileName To Fhandle Then \xFE";
 z+="                    foundIt = True \xFE";
 z+="                else \xFE";
 z+="                    foundIt = False\xFE";
 z+="                end if\xFE";
 z+="            end if\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        if foundIt Then\xFE";
 z+="            DeleteFile Fhandle Else Stop @Errors\xFE";
 z+="            Cnt += 1\xFE";
 z+="            \xFE";
 z+="            If partialDelete Then \xFE";
 z+="                if !suppressPrinting Then Print displayFName:\" deleted.\" \xFE";
 z+="            Else\xFE";
 z+="                if DData = \"DICT\" Then DData = \"DATA\" Else DData = \"DICT\"\xFE";
 z+="                Open DData, fileName To Fhandle Then DeleteFile Fhandle Else Stop @Errors\xFE";
 z+="                if !suppressPrinting Then print \"Deleted \":displayFName\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            Print displayFName:\" NOT FOUND.\" \xFE";
 z+="        End If\xFE";
 z+="    next\xFE";
 z+="\xFE";
 z+="    if cnt > 1 Then print cnt:\" files deleted\"\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="/*\xFE";
 z+="Program DeleteFile\xFE";
 z+="* $options js\xFE";
 z+="\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    S = Trim(@Sentence)\xFE";
 z+="    Fname = Field(S, \" \", 2)\xFE";
 z+="    Iname = Field(S, \" \", 3)\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    partialDelete = False\xFE";
 z+="    ClearSelect\xFE";
 z+="    \xFE";
 z+="    DData = UCase(Fname)\xFE";
 z+="    IsDict = DData = \"DICT\"\xFE";
 z+="    \xFE";
 z+="    If IsDict Or DData = \"DATA\" Then\xFE";
 z+="        Fname = Iname\xFE";
 z+="        Iname = Field(S, \" \", 4)\xFE";
 z+="        partialDelete = True\xFE";
 z+="    Else\xFE";
 z+="        DData = ''\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Realdict = false\xFE";
 z+="    javascript {\xFE";
 z+="        // can we open the DICT with creating it?\xFE";
 z+="        Realdict = await JSB_ODB_OPEN(Ddata, Fname, Fhandle, function (_Fhandle) { Fhandle = _Fhandle });\xFE";
 z+="    }\xFE";
 z+="    \xFE";
 z+="SPECIALOPEN:\xFE";
 z+="    If IsDict And !RealDict Then Stop 'DICT ':Fname:\" doesn't exist.\"\xFE";
 z+="    \xFE";
 z+="    Open DData, Fname To Fhandle Then\xFE";
 z+="        DeleteFile Fhandle Then Print Fname:\" deleted.\" Else  Print @Errors\xFE";
 z+="        If partialDelete Or !RealDict Then Stop\xFE";
 z+="        \xFE";
 z+="        Open \"DICT\", Fname To Fhandle Else Stop\xFE";
 z+="        DeleteFile Fhandle Then Print \"DICT \":Fname:\" deleted.\" Else Print @Errors\xFE";
 z+="    End Else\xFE";
 z+="        Print Fname:\" doesn't exist.\"\xFE";
 z+="    End If\xFE";
 z+="End Program\xFE";
 z+="*/\xFE";
 z+=""
window.cached_jsb_tcl["deletefile"]=z;
var z="*\xFE";
 z+="Program Demos\xFE";
 z+="    Print @(-1):\"Fetching demo programs...\":\xFE";
 z+="    Nap 1\xFE";
 z+="    \xFE";
 z+="    Open \"jsb_demos\" To fDemos Else Stop @Errors:crlf():\"Unable to open jsb_demos.  This requires an internet connection\"\xFE";
 z+="    \xFE";
 z+="    fDemoBP = Fhandle(\"\", \"demo_bp\", True)\xFE";
 z+="    fdictDemoBP = Fhandle(\"dict\", \"demo_bp\", True)\xFE";
 z+="    Write \"r-\" On fdictDemoBP, \"options.txt\" Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    If Cordova() Then\xFE";
 z+="        Select From fDemos Where \"*a1 like '[phonegap]'\" To Sl\xFE";
 z+="    Else\xFE";
 z+="        Select From fDemos Where \"*a1 like '[\":System(1):\"]'\" To Sl\xFE";
 z+="    End If\xFE";
 z+="    Demos = GetList(Sl)\xFE";
 z+="    cacheIsGood = {}\xFE";
 z+="    Colors = [\"#70a559\", \"#a55978\", \"#daa962\", \"#6f9286\", \"#796a86\", \"blue\", \"green\",\"#887b6a\", \"#5a4141\", \"darkblue\"]\xFE";
 z+="\xFE";
 z+="    Loop\xFE";
 z+="        Print @(-1):Center(H3(\"Click on a DEMO program to run (may need to compile, be patient)\"))\xFE";
 z+="        Print\xFE";
 z+="        Print @Html('<div class=\"container\">'):\xFE";
 z+="        Print @Html('<div class=\"form-group row\">'):\xFE";
 z+="\xFE";
 z+="        For Each ItemId,ItemI In Demos\xFE";
 z+="            Bg = Colors[ItemI Mod UBound(Colors) + 1]\xFE";
 z+="            Print @Html('<div class=\"col-xs-12 col-sm-5 col-md-4 col-lg-3\" style=\"margin-bottom: 4px\">'):\xFE";
 z+="            Print @Jsb_html.SubmitBtn('btn', ItemId, ItemId, { style: 'width: 99%; height: 50px; display: inline-block; margin: auto; background-color: ':BG:'; color: white; min-width: 160px;' } ):\xFE";
 z+="            Print @Html('</div>'):\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        Print @Html('</div></div>'):\xFE";
 z+="        \xFE";
 z+="\xFE";
 z+="        Print\xFE";
 z+="        Print\xFE";
 z+="        Print @Jsb_html.SubmitBtn('btn', 'Quit'):\xFE";
 z+="\xFE";
 z+="        @Server.Pause\xFE";
 z+="        Btn = FormVar('btn')\xFE";
 z+="\xFE";
 z+="    While Btn <> \"Quit\" Do\xFE";
 z+="        If !cacheIsGood[Btn] Then\xFE";
 z+="            Read srcItem From fDemos, Btn Else\xFE";
 z+="                MsgBox(\"I was unable to get the source code \":@Errors)\xFE";
 z+="                Cycle\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            // Already have a local compiled copy? If not, compile one\xFE";
 z+="            Read localItem From fDemoBP, Btn Else localItem = \"\"\xFE";
 z+="            If localItem <> srcItem Then\xFE";
 z+="                Write srcItem On fDemoBP, Btn Else Stop @Errors\xFE";
 z+="                Execute \"basic demo_bp \":Btn\xFE";
 z+="            End If\xFE";
 z+="            cacheIsGood[Btn] = True\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        Print @(-1):\xFE";
 z+="        Write \"cv\":am():\"demo_bp\":am():Btn On Fhandle('md'), 'demopgm' Else Stop @Errors\xFE";
 z+="        \xFE";
 z+="        Execute \"demopgm\"\xFE";
 z+="        Print\xFE";
 z+="        Print @Jsb_html.SubmitBtn('btnDemo', 'Back'):@Jsb_html.SubmitBtn('btnDemo', 'view source'):\xFE";
 z+="        @Server.Pause\xFE";
 z+="        \xFE";
 z+="        WhatElse = FormVar('btnDemo')\xFE";
 z+="\xFE";
 z+="        If WhatElse = \"view source\" Then\xFE";
 z+="            Read Item From fDemoBP, Btn Else Stop @Errors\xFE";
 z+="            Item = Replace(Item, am(), crlf())\xFE";
 z+="            Print @(-1):Monospace(Item)\xFE";
 z+="            Print\xFE";
 z+="            Print @Jsb_html.SubmitBtn('btn', 'Back')\xFE";
 z+="            @Server.Pause\xFE";
 z+="        End If\xFE";
 z+="    Repeat\xFE";
 z+="    \xFE";
 z+="    Print @(-1):\xFE";
 z+="    \xFE";
 z+="    Chain \"jsb\"\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["demos"]=z;
var z="program dir\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    if !IsAdmin() Then Stop 'You are not an administator'\xFE";
 z+="    \xFE";
 z+="    path = DropLeft(@Sentence,' ')\xFE";
 z+="    opts = lcase(field(@Sentence, \"(\", 2))\xFE";
 z+="    if !opts or opts = \"!\" then opts = trim(field(lcase(field(@Sentence, \"/\", 2)), '(', 1))\xFE";
 z+="    \xFE";
 z+="    path = rtrim(DropIfRight(path, \"(\"))\xFE";
 z+="    path = rtrim(DropIfRight(path, \"/\"))\xFE";
 z+="    if path = \"?\" or instr(opts, \"?\") then stop \"dir . /od/tw or (m)\"\xFE";
 z+="    \xFE";
 z+="    if system(1) = \"js\" then\xFE";
 z+="        if !window.dotNetObj Then Stop \"Not available in the version of JSB \":System(1)\xFE";
 z+="        // Also avaliable window.dotNetObj.dnoValidPath(\"C:\\\\\")\xFE";
 z+="    else \xFE";
 z+="        if system(1) <> \"aspx\" then Stop \"Not available in the version of JSB \":System(1)\xFE";
 z+="        realpath = fhandle(path)\xFE";
 z+="        if left(realpath, 4) = \"dos:\" then path = mid(realpath, 5)\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    if path = \"/d\" then path = \"/od/tw\"\xFE";
 z+="    \xFE";
 z+="    if left(path, 1) <> '.' and left(path, 1) <> \"\\\\\" and mid(path, 2, 2) <> `:\\` then\xFE";
 z+="        open path to f then            \xFE";
 z+="            if typeoffile(f) = \"dos\" then path = FilePath(f)\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    if opts = \"m\" then opts = \"tw/od\"\xFE";
 z+="    if opts then path := ' /':opts\xFE";
 z+="    \xFE";
 z+="    cd = @session['curdir']\xFE";
 z+="    if !cd or Mid(cd, 2, 1) <> \":\" then cd = @JSBRootDir\xFE";
 z+="\xFE";
 z+="    cmd = `dir `:Path\xFE";
 z+="    \xFE";
 z+="    s = executedos(left(cd, 2):' & cd \"':cd:'\" & echo -!-begin-!- & ':cmd:' & echo -!-newcd-!- & cd')\xFE";
 z+="\xFE";
 z+="    i = instr(s, \"-!-newcd-!\")\xFE";
 z+="    result = field(s, \"-!-newcd-!-\", 1)\xFE";
 z+="    result = trimws(field(result, \"-!-begin-!-\", 2))\xFE";
 z+="\xFE";
 z+="    result = Replace(result, Chr(13):Chr(10), Chr(254))\xFE";
 z+="    result = Replace(result, Chr(13), Chr(254))\xFE";
 z+="    result = Replace(result, Chr(10), Chr(254))\xFE";
 z+="    Print monospace(Replace(Result, Chr(254), Chr(13):Chr(10)))\xFE";
 z+="\xFE";
 z+=""
window.cached_jsb_tcl["dir"]=z;
var z="* Show disk stats and dir usage and files sizes\xFE";
 z+="Program Diskuse\xFE";
 z+="    * $options aspx\xFE";
 z+="    Call Diskuse\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Program Diruse\xFE";
 z+="    * $options aspx\xFE";
 z+="    Call Diskuse\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Program Windirstat\xFE";
 z+="    * $options aspx\xFE";
 z+="    Call Diskuse\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Subroutine Diskuse\xFE";
 z+="    * $options aspx\xFE";
 z+="    \xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    If S Then\xFE";
 z+="        S = Field(@Sentence, ' (', 1)\xFE";
 z+="        S = LTrim(Dropleft(S, ' '))\xFE";
 z+="        Cd = Field(S, \";\", 1)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    cd = @session['curdir']\xFE";
 z+="    if !cd or Mid(cd, 2, 1) <> \":\" then cd = @JSBRootDir\xFE";
 z+="   \xFE";
 z+="    Cmd = @jsbRootDir:`\\bin\\diruse /s /m /q:1.5 `:CD\xFE";
 z+="    S = Executedos(left(cd, 2):' & cd \"':Cd:'\" & echo -!-begin-!- & ':Cmd:' & echo -!-newcd-!- & cd')\xFE";
 z+="\xFE";
 z+="    I = Instr(S, \"-!-newcd-!\")\xFE";
 z+="    Result = Field(S, \"-!-newcd-!-\", 1)\xFE";
 z+="    Result = Trimws(Field(Result, \"-!-begin-!-\", 2))\xFE";
 z+="\xFE";
 z+="    Result = Replace(Result, Chr(13):Chr(10), Chr(254))\xFE";
 z+="    Result = Replace(Result, Chr(13), Chr(254))\xFE";
 z+="    Result = Replace(Result, Chr(10), Chr(254))\xFE";
 z+="    L = Split(Result, Chr(254))\xFE";
 z+="\xFE";
 z+="    Print @(-1):@Center(@H1(Cd))\xFE";
 z+="    Results = []\xFE";
 z+="    Suffix = []\xFE";
 z+="    \xFE";
 z+="    For Each Line, I In L\xFE";
 z+="        If I <= 2 Then Print Monospace(Line) Else\xFE";
 z+="            If Left(Line, 1) = \"!\" Then\xFE";
 z+="                Tline = Trim(Line)\xFE";
 z+="                Tline = Dropleft(Tline, ' ')\xFE";
 z+="                Size = FieldLeft(Tline, ' ')\xFE";
 z+="                Tline = Dropleft(Tline, ' ')\xFE";
 z+="                Files = FieldLeft(Tline, ' ')\xFE";
 z+="                Tline = Dropleft(Tline, ' ')\xFE";
 z+="            \xFE";
 z+="                If Mid(Tline, 2, 1) = \":\" Or Left(Tline, 1) = \".\" Then\xFE";
 z+="                    Size = Fmt(Size, 'r#13')\xFE";
 z+="                    Files = Fmt(Files, 'r#6')\xFE";
 z+="                    Results[-1] = { Size: Size, Files: Files, tline: Tline }\xFE";
 z+="                Else\xFE";
 z+="                    Suffix[-1] = Monospace(Line)\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    Results = @Sort(Results, \"#<Size\")\xFE";
 z+="\xFE";
 z+="    For Each R In Results\xFE";
 z+="        Print @Html(`<a style='font-family:monospace' target=\"_blank\" href='`:@jsbRootExecuteTclCmd(\"diskuse \":R.tline):`'>`):R.Size:@Html(`</a>`):\xFE";
 z+="        Print @Monospace(' ':R.Files:'  '):\xFE";
 z+="        Print @Html(`<a style='font-family:monospace' target=\"_blank\" href='`:@jsbRootExecuteTclCmd(\"dos \":R.tline:\";dir /os\"):`'>`):R.tline:@Html(`</a>`)\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    Print Join(Suffix, crlf())\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["diskuse"]=z;
window.cached_jsb_tcl["divd"]="Program Divd\xFE* Divide decimal\xFE* \xFE      A = FIELD(@SENTENCE,' ',2)\xFE      B = FIELD(@SENTENCE,' ',3)\xFE      IF NOT(NUM(A)) OR NOT(NUM(B)) THEN STOP\xFE      PRINT INT(A/B):\" Remainder \":MOD(A,B)\xFE      ClearSelect\xFE      \xFEProgram Div\xFE* Divide and show decimal places\xFE* \xFE      A = FIELD(@SENTENCE,' ',2)\xFE      B = FIELD(@SENTENCE,' ',3)\xFE      IF NOT(NUM(A)) OR NOT(NUM(B)) THEN STOP\xFE      PRINT A/B\xFE      ClearSelect";
window.cached_jsb_tcl["divx"]="Program DivX\xFE* Divide hex\xFE* \xFE      A = XTD(FIELD(@SENTENCE,' ',2))\xFE      B = XTD(FIELD(@SENTENCE,' ',3))\xFE      IF NOT(NUM(A)) OR NOT(NUM(B)) THEN STOP\xFE      PRINT DTX(INT(A/B)):\" Remainder \":DTX(MOD(A,B))\xFE      ClearSelect";
var z="// See also HELP where ExtractExamples is located\xFE";
 z+="\xFE";
 z+="Program DOCS\xFE";
 z+="*\xFE";
 z+="* Category: ThisProgram; Title: Docs Page\xFE";
 z+="*\xFE";
 z+="    // TABS doesn't work in the js version (requires iframe to work)\xFE";
 z+="    if isPhoneGap() Or maxwidth() < 800 then Chain \"Help\"\xFE";
 z+="   \xFE";
 z+="    Call treeDoc(\"JSB_DOCS\", \"\")\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Subroutine treeDoc(TableName, OneGroup)\xFE";
 z+="*\xFE";
 z+="* Category: ThisProgram; Title: treeDoc\xFE";
 z+="*\xFE";
 z+="* This routine reads all the items in the given table, looking for the Category word in the 1st 1000 characters, and extracting a title.\xFE";
 z+="*\xFE";
 z+="* It then builds an R83 style Attribute, Value, Sub-Value structure for the @jsb_html.jsTree function.\xFE";
 z+="* The result is output to the display, and intermixed with javascript code to open/close new tabs with child IFRAMES\xFE";
 z+="*\xFE";
 z+="    IsDocsFile = UCase(TableName) = \"JSB_DOCS\" \xFE";
 z+="    Open \"\", TableName To F_FILE else Stop @Errors\xFE";
 z+="    ReadJson Catagories From F_FILE, \"__treeCatagories\" Else Catagories = @jsb_tcl.BuildCatagories(F_FILE, IsDocsFile, OneGroup)\xFE";
 z+="    \xFE";
 z+="    containerName = \"Tabs_\":Rnd(9999)\xFE";
 z+="    Equ TTableName To \"testPremissions\"\xFE";
 z+="    write \"temp\" on F_File, TTableName then\xFE";
 z+="        Url = @jsbRootExecuteTclCmd(\"ed \":TableName:\" '{id}'\") \xFE";
 z+="        delete F_File, TTableName Else Stop @Errors\xFE";
 z+="    Else\xFE";
 z+="       Url = @jsbRootExecuteTclCmd(\"view \":TableName:\" '{id}'\")\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    * Note that the tree already has setup: selectedNode,  selectedID, selectedText\xFE";
 z+="    OnSelect = @genEventHandler(\"leafSelected\", Url, 3, containerName)\xFE";
 z+="\xFE";
 z+="    Tree = @jsonTree(Catagories)\xFE";
 z+="    \xFE";
 z+="    Tabs = @jsb_html.TABS(containerName, \"Hint\", \"<br /><br />Click on a document from the tree structure on the left.\", \"\", \"\", \"\", \"\")\xFE";
 z+="    Html = @jsb_html.LAYOUT(Tabs, \"North\", \"\", \"South\", \"\", \"East\", \"\", Tree, \"startsize:240, minSize:60\")\xFE";
 z+="    Html = Html:OnSelect\xFE";
 z+="    Html = @DocsTheme(Html)\xFE";
 z+="    print @(-1):Html:\xFE";
 z+="\xFE";
 z+="    If @HasParentProcess then @server.pause else Stop ;* pause program\xFE";
 z+="End Sub\xFE";
 z+="\xFE";
 z+="Function DocsTheme(Form)\xFE";
 z+="*\xFE";
 z+="* Category: ThisProgram; Title: Theme\xFE";
 z+="*\xFE";
 z+="    Pages = \"\" ;* Home,Home;Examples,Examples;Docs,Docs;Blog,Blog\xFE";
 z+="    if system(1) = \"js\" Then \xFE";
 z+="        TCL = '' ;* if window.isPhoneGap() Then TCL = \"jsb.html\" Else TCL = \"tcl.html\" \xFE";
 z+="    Else\xFE";
 z+="        TCL = @jsbRootAccount\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If @IsAdmin Or System(1) = \"js\" Then Pages = Pages:\";\":TCL:\",TCL;ResetExamples,Reset Examples\"\xFE";
 z+="    If @IsAdmin And System(1) <> \"js\" Then Pages = Pages:\";RebuildDocsTree,Rebuild Tree\"\xFE";
 z+="    if @IsAuthenticated And System(1) <> \"js\" then Pages = Pages:\";\":@LOGOUTURL:\",Logout\" Else Pages = Pages:\";\":@LOGINURL:\",Login\"\xFE";
 z+="*\xFE";
 z+="    PageHeader = \"JSON Basic (JSB)\"\xFE";
 z+="*\xFE";
 z+="    Html = Chr(28):`\xFE";
 z+="            <head>\xFE";
 z+="               <title>JSon Basic</title>\xFE";
 z+="               <style type=\"text/css\">\xFE";
 z+="                    .folders { background-color: #bbb; list-style-type: none; padding: 0; margin: 0; border-radius: 7px; \xFE";
 z+="                        background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #d6d6d6), color-stop(0.4, #c0c0c0), color-stop(1,#a4a4a4)); \xFE";
 z+="                        /* margin: 10px 0 16px 0; */\xFE";
 z+="                        font-size: 0px;\xFE";
 z+="                        text-align:center;\xFE";
 z+="                        width:650px;\xFE";
 z+="                        margin-left:auto;\xFE";
 z+="                        margin-right:auto\xFE";
 z+="                    }\xFE";
 z+="                    body { background-color: lightgray; }\xFE";
 z+="                    .folders li:hover { background-color: #ddd; }    \xFE";
 z+="                    .folders li { font-size: 13px; font-weight: bold; display: inline-block; padding: 0.5em 1.5em; cursor: pointer; color: white; text-shadow: #f7f7f7 0 1px 1px; border-left: 1px solid #888; border-right: 1px solid #888; }\xFE";
 z+="                    .folders li { *display: inline !important; } /* IE7 only */\xFE";
 z+="                    .folders .selected { background-color: #444 !important; color: white; text-shadow:none; border-right-color: #aaa; border-left: none; box-shadow:inset 1px 2px 6px #070707; }  \xFE";
 z+="                </style>\xFE";
 z+="            </head>\xFE";
 z+="            <div style=\"position: relative; height: 100%; widht: 100%; background-color: lightgray\">\xFE";
 z+="               <div id=\"header\" style=\"font-size: large; height:18px; font-family: 'Brush Script MT'; vertical-align: middle; text-align: center; color: darkblue; padding: 1px;\">\xFE";
 z+="                   `:PageHeader:`\xFE";
 z+="               </div>\xFE";
 z+="               <div id=\"navcontainer\" style=\"position: relative; display: block; vertical-align: top; height:40px; padding: 2px; margin: 0px; \">\xFE";
 z+="                   <ul class=\"folders\" >`:Chr(10)\xFE";
 z+="    P = Split(Pages, \";\")\xFE";
 z+="    For I = LBound(P) to UBound(P)\xFE";
 z+="        L = Split(P[I], \",\")\xFE";
 z+="        if L[2] Then\xFE";
 z+="            Url = L[1]\xFE";
 z+="            If !InStr(Url, \"//\") Then Url = @jsbRootExecuteTclCmd(Url)\xFE";
 z+="            html = html:`<li>`:Chr(29):@jsb_html.Anchor(Url, L[2], { target: \"_self\" }):Chr(28):`</li>`:Chr(10)\xFE";
 z+="        end if\xFE";
 z+="    next i\xFE";
 z+="    html = html:`\xFE";
 z+="                   </ul>\xFE";
 z+="               </div>\xFE";
 z+="               <div style=\"position:absolute; left:0; width:100%; top:62px; bottom:0; background-color: lightgray;\">\xFE";
 z+="                  `:Form:`\xFE";
 z+="               </div>\xFE";
 z+="            </div>\xFE";
 z+="        `:Chr(29)\xFE";
 z+="    Return Html\xFE";
 z+="\xFE";
 z+="Program RebuildDocsTree\xFE";
 z+="*\xFE";
 z+="* Category: ThisProgram; Title: Example Page\xFE";
 z+="*\xFE";
 z+="    If !@IsAdmin Then Stop \"You must have admin permissions to rebuild the docs tree\"\xFE";
 z+="    Open \"JSB_DOCS\" to fx else Stop @Errors\xFE";
 z+="    delete fx, \"_treeCatagories\" else stop @Errors\xFE";
 z+="    Tree = @jsb_tcl.BuildCatagories(fx, true, False) ;* IsDocsFile, OneGroup\xFE";
 z+="\xFE";
 z+="    Open \"JSB_EXAMPLES\" to fx else Stop @Errors\xFE";
 z+="    delete fx, \"_treeCatagories\" else stop @Errors\xFE";
 z+="    Tree = @jsb_tcl.BuildCatagories(fx, false, False) ;* IsDocsFile, OneGroup\xFE";
 z+="\xFE";
 z+="    @Response.Redirect(\"DOCS\")\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Program ResetExamples\xFE";
 z+="    If !@IsAdmin And System(1) <> \"js\" Then Stop \"You must have admin permissions to rebuild the docs tree\"\xFE";
 z+="    Open \"dict\", \"JSB_DOCS\" to dfx else Stop @Errors\xFE";
 z+="    clearfile dfx else stop @errors\xFE";
 z+="    @Response.Redirect(\"DOCS\")\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["docs"]=z;
var z="Program Dos\xFE";
 z+="    \xFE";
 z+="    Dim roleMsg As String = Iif(@@IsAuthenticated, \"\", \"You must be logged in to view this page. \":@Anchor(@@LoginUrl(), \"Click here to login\"))\xFE";
 z+="    if !@@IsAdmin() Then Stop Iif(roleMsg, roleMsg,  @@userName:\": You must be an admin of \":@Domain:\" to use this program.\")\xFE";
 z+="\xFE";
 z+="    Cd = @@JSBRootDir\xFE";
 z+="    Cd = Replace(Cd, \"file:///\", \"\")\xFE";
 z+="    Cd = Replace(Cd, `/`, `\\`)\xFE";
 z+="    Bindir = Cd:`bin\\`\xFE";
 z+="    \xFE";
 z+="    S = @Sentence\xFE";
 z+="    S = LTrim(Field(Dropleft(S, ' '), \"(\", 1))\xFE";
 z+="    If S Then\xFE";
 z+="        Cd = Field(S, \";\", 1)\xFE";
 z+="        Cmd =  LTrim(Dropleft(S, \";\"))\xFE";
 z+="    Else\xFE";
 z+="        Ans = Msgbox(\"Which dir\", \".,_database,js,css,archives,bin,\":@Account:\",jsb_dictionaries\")\xFE";
 z+="        Select Case Ans\xFE";
 z+="            Case '': Stop\xFE";
 z+="            Case Chr(27): Stop\xFE";
 z+="            \xFE";
 z+="            Case `.`\xFE";
 z+="                \xFE";
 z+="            Case `bin`\xFE";
 z+="                Cd := `bin\\`\xFE";
 z+="                \xFE";
 z+="            Case `app_data`\xFE";
 z+="                Cd := `app_data\\`\xFE";
 z+="                \xFE";
 z+="            Case `_database`\xFE";
 z+="                Cd := `app_data\\_database\\`\xFE";
 z+="                \xFE";
 z+="            Case @Account\xFE";
 z+="                Cd := `app_data\\_database\\`:@Account:`\\`\xFE";
 z+="                \xFE";
 z+="            Case `jsb_dictionaries`\xFE";
 z+="                Cd := `app_data\\_database\\`:@Account:`\\jsb_dictionaries\\`\xFE";
 z+="                \xFE";
 z+="            Case `js`\xFE";
 z+="                Cd := `jsb\\js\\`\xFE";
 z+="                \xFE";
 z+="            Case `css`\xFE";
 z+="                Cd := `jsb\\css\\`\xFE";
 z+="                \xFE";
 z+="            Case `archives`\xFE";
 z+="                Path = Truefilename('archives')\xFE";
 z+="                If Left(Path, 2) =`.\\` Then\xFE";
 z+="                    Cd := Mid(Path, 3)\xFE";
 z+="                ElseIf Mid(Path, 2, 1) = \":\" Then\xFE";
 z+="                    Cd = Path\xFE";
 z+="                Else\xFE";
 z+="                    Cd := `app_data\\_database\\`:@Account:`\\`:Path\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="            Case `jsb`\xFE";
 z+="                Cd := `jsb\\`\xFE";
 z+="        End Select\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If System(1) = \"js\" Then \xFE";
 z+="       If window.dotNetObj then\xFE";
 z+="            if !window.dotNetObj.dnoValidPath(Cd) Then\xFE";
 z+="                Cd = System(26)\xFE";
 z+="                Cd = Replace(Cd, \"file:///\", \"\")\xFE";
 z+="                Cd = Replace(Cd, `/`, `\\`)\xFE";
 z+="                Cd = Dropright(Cd, `\\`)\xFE";
 z+="            end If\xFE";
 z+="        end If\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    ' get a list of bin \"exes\"\xFE";
 z+="    Result = @@dosExecute(Cd, `dir bin\\*.exe /b`, Errs)\xFE";
 z+="\xFE";
 z+="    Bins = []\xFE";
 z+="    For Each Exe In Result\xFE";
 z+="        Bins[-1] = LCase(Left(Exe, Len(Exe) - 4))\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    Print @Hidden(\"_historyName_\", \"dos\"):\xFE";
 z+="    Loop\xFE";
 z+="        If Cmd = \"\" Then\xFE";
 z+="            Print @Script(\"atTcl = true\"):\xFE";
 z+="            // Print @Hilight(@monoSpace(Cd):\">\"):\" \":\xFE";
 z+="            //Prompt \"\"\xFE";
 z+="            prompt cd:\"> \"\xFE";
 z+="            Input Cmd\xFE";
 z+="        End If\xFE";
 z+="        Lcmd = Field(LCase(Trimws(Cmd)), \" \", 1)\xFE";
 z+="    Until Lcmd = \"q\" Or Lcmd = \"end\" Or Lcmd = \"quit\" Or Lcmd = \"exit\" Do\xFE";
 z+="        If Lcmd = \"cls\" Then\xFE";
 z+="            Print @(-1):@Hidden(\"_historyName_\", \"dos\"):\xFE";
 z+="        Else If Lcmd = \"dirs\" Then\xFE";
 z+="            Result = getSubDirectories(Cd, Cd, Instr(LCase(Cmd), \"/s\"), 0)\xFE";
 z+="            If Result Then Print @monoSpace(Replace(Result, am(), crlf()))\xFE";
 z+="        Else\xFE";
 z+="            Locate Lcmd In Bins Then Cmd = Bindir:Cmd\xFE";
 z+="            Result = @@dosExecute(Cd, Cmd, Errs)\xFE";
 z+="            If Result Then Print @monoSpace(Replace(Result, am(), crlf()))\xFE";
 z+="            If Errs Then Print @monoSpace(Errs)\xFE";
 z+="        End If\xFE";
 z+="        Cmd = \"\"\xFE";
 z+="    Repeat\xFE";
 z+="    Stop\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="// return array of sub directories  \xFE";
 z+="function getSubDirectories(Byval Cd, Byval Dir, Recurse, Cnt)\xFE";
 z+="    If System(1) = \"js\" Then\xFE";
 z+="        If !window.dotNetObj Then Return []\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Right(Dir, 1) <> `\\` Then Dir = Dir:`\\`\xFE";
 z+="    Cmd = `dir `:Dir:` /ad/b`\xFE";
 z+="    Result = @@dosExecute(Cd, `dir `:Dir:` /ad/b`, Errs)\xFE";
 z+="\xFE";
 z+="    Dirs = []\xFE";
 z+="    For Each Sdir In Result\xFE";
 z+="        If Recurse Then\xFE";
 z+="            Sdirs = getSubDirectories(Cd, Dir:Sdir, Recurse, Cnt + 1)\xFE";
 z+="            Dirs[-1] = Sdir:`\\`\xFE";
 z+="            For Each Line In Sdirs\xFE";
 z+="                Dirs[-1] = \"   \":Line\xFE";
 z+="            Next\xFE";
 z+="        Else\xFE";
 z+="            Dirs[-1] = Dir:Sdir:`\\`\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    Return Dirs\xFE";
 z+="End function\xFE";
 z+=""
window.cached_jsb_tcl["dos"]=z;
var z="program download\xFE";
 z+="    *$options aspx\xFE";
 z+="    \xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    Dim Help As Array = ['download <TableName> <itemnames>' ]\xFE";
 z+="    \xFE";
 z+="    $include __shell\xFE";
 z+="    \xFE";
 z+="    b = @response.buffer()\xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        read ITEM FROM F_FILE, INAME ELSE \xFE";
 z+="            If Len(@Errors) Then Errors[-1] = @Errors Else Errors[-1] = 'Item ':INAME:' not found.'\xFE";
 z+="            Cycle \xFE";
 z+="        END \xFE";
 z+="    \xFE";
 z+="        Src = @jsbRootAct:`_download?TableName=`:@UrlEncode(FNAME):`&itemname=`:@UrlEncode(INAME)\xFE";
 z+="        b = @response.buffer()\xFE";
 z+="    \xFE";
 z+="        if true then\xFE";
 z+="            print @script(`\xFE";
 z+="                debugger;\xFE";
 z+="                window.open(\"`:Src:`\", \"_blank\");\xFE";
 z+="                window.setTimeout(doJsbSubmit, 400);\xFE";
 z+="            `);\xFE";
 z+="        Else\xFE";
 z+="            Print @html(`<iframe id=\"iframe_`:INAME:`\" style=\"display:none;\"></iframe>`):\xFE";
 z+="            print @Script(`\xFE";
 z+="               document.getElementById(\"iframe_`:INAME:`\").src = \"`:Src:`\";\xFE";
 z+="               window.setTimeout(doJsbSubmit, 400);\xFE";
 z+="            `):\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        @Server.Pause\xFE";
 z+="        x = @response.buffer(b)\xFE";
 z+="    \xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors # '' Then Print MonoSpace(Join(Errors, crlf()))\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="program _download\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    FName = @QueryVar('TableName')\xFE";
 z+="    IName = @QueryVar('itemname')\xFE";
 z+="\xFE";
 z+="    read ITEM FROM fHandle(FName), INAME ELSE Stop @Errors\xFE";
 z+="\xFE";
 z+="    if instr(iname, \".\") then mimeType = @mimeType(FieldRight(IName, \".\")) Else mimeType = @mimeType(\"txt\")    \xFE";
 z+="    if Left(mimeType, 4) = \"text\" or instr(mimeType, \"/json\") or InStr(mimeType, \"/xml\") or InStr(mimeType, \"/java\") then Item = Replace(Item, am(), crlf())\xFE";
 z+="\xFE";
 z+="    print @(-1): \xFE";
 z+="    @Response.Buffer(\"\") \xFE";
 z+="    @Response.Header.Set(\"Content-Disposition\", \"attachment; filename=\" : INAME);\xFE";
 z+="    @Response.Header.Set(\"Content-Type\", mimeType) \xFE";
 z+="    @Response.BinaryWrite(Item)  \xFE";
 z+="    @Server.End \xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="program upload\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    S = Trim(Field(@Sentence, \"(\", 1))\xFE";
 z+="    DData = \"\"\xFE";
 z+="    FName = LCase(Field(s, \" \", 2))\xFE";
 z+="    IName = \"\"\xFE";
 z+="    if FName = \"dict\" or FName = \"data\" then\xFE";
 z+="        DData = FName\xFE";
 z+="        FName = LCase(Field(s, \" \", 3))\xFE";
 z+="        IName = LCase(Field(s, \" \", 4))\xFE";
 z+="    else\xFE";
 z+="        IName = LCase(Field(s, \" \", 3))\xFE";
 z+="    end if\xFE";
 z+="    if fname = \"\" then fname = \"uploads\"\xFE";
 z+="    open ddata, fname to fFile else stop @Errors\xFE";
 z+="    \xFE";
 z+="    b = @response.buffer()\xFE";
 z+="    print @(-1):\xFE";
 z+="    print @UploadBox(\"upLoadID\")\xFE";
 z+="    print @SubmitBtn('Upload')\xFE";
 z+="\xFE";
 z+="    @server.pause\xFE";
 z+="\xFE";
 z+="    ItemName = @REQUEST.FileName('upLoadID')\xFE";
 z+="    If ItemName Then Item = @REQUESTFILE(\"upLoadID\")\xFE";
 z+="    x = @response.buffer(b)\xFE";
 z+="    \xFE";
 z+="    If !ItemName then Stop \"Canceled\"\xFE";
 z+="    \xFE";
 z+="    if IName then ItemName = IName ELse ItemName = Field(ItemName, `\\`, DCount(ItemName, `\\`))\xFE";
 z+="    \xFE";
 z+="    if LCase(ItemName) = \"jsonbasic.dll\" Then\xFE";
 z+="       ' copy .\\uploads\\jsonbasic.dll .\\bin /y\xFE";
 z+="       i_write Item On fhandle(`.\\bin`), \"jsonbasic.dll\" Else Stop @Errors\xFE";
 z+="    else\xFE";
 z+="       write Item on fFile, ItemName Else Stop @Errors\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Print @(-1):len(Item):\" bytes written to \":ddata:\" \":FName:\" \":ItemName\xFE";
 z+="    if Right(LCase(ItemName), 4) = \".zip\" Then\xFE";
 z+="        toDir = LCase(Field(Field(ItemName, \".\", 1), \" (\", 1))\xFE";
 z+="        if msgbox(\"Unzip \":ItemName:` to .\\`:toDir:\"?\", \"Yes,*No\") = \"Yes\" Then\xFE";
 z+="            Execute \"unzip \":FName:\" \":ItemName:` (.\\`:toDir\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["download"]=z;
window.cached_jsb_tcl["dtx"]="Program DTX\xFE   I = 2\xFE   loop\xFE      A = FIELD(@SENTENCE,' ',I)\xFE   while A do\xFE      PRINT DTX(Val(A)):\" \":\xFE      I += 1\xFE   repeat\xFE   PRINT\xFE   CLEARSELECT";
var z="Program Dump\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    Dim Help As Array = [\"DUMP TableName <ITEMNAMES> {(options)}\"]\xFE";
 z+="    Help[-1] = \"   Option S: Source CPP\"\xFE";
 z+="    Help[-1] = \"   Option P: Pcode for CPP\"\xFE";
 z+="    Help[-1] = \"   Option T: text string for CPP split on 120 characters\"\xFE";
 z+="    Help[-1] = \"   Option B: binary Pcode for CPP split on 120 characters\"\xFE";
 z+="    \xFE";
 z+="    $include __shell\xFE";
 z+="    \xFE";
 z+="    Externs = []\xFE";
 z+="    Funcs = []\xFE";
 z+="    \xFE";
 z+="    tfn = TrueFileName(TableName)\xFE";
 z+="    firsttime = false\xFE";
 z+="    isJsbFile = left(lcase(tfn), 4) = \"jsb_\"\xFE";
 z+="\xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        Dim Ext As String = @FieldRight(UCase(Iname), \".\")\xFE";
 z+="        Dim HDoc As Boolean = Ext = \"HTM\" Or Ext = \"HTML\"\xFE";
 z+="    \xFE";
 z+="        Read Item From F_file, Iname Else\xFE";
 z+="            Errors[-1] = 'Item ':Iname:' not found.'\xFE";
 z+="            Cycle\xFE";
 z+="        End\xFE";
 z+="        \xFE";
 z+="        WhichDict = TrueFileName(TableName)\xFE";
 z+="        if Left(WhichDict, 2) = `.\\` then WhichDict = \"\" Else WhichDict := \"_\"\xFE";
 z+="        Iname = LCase(Iname)\xFE";
 z+="        NiceIName = Replace(WhichDict:Iname, \".\", \"_\")\xFE";
 z+="    \xFE";
 z+="        If Index(Options, \"R\") = 0 And (Index(Options, 'T') Or Index(Options, 'S') Or Ext = \"JS\" Or Ext = \"CPP\" Or Ext = \"CSS\") Then\xFE";
 z+="            Item = Replace(Item, crlf(), am())\xFE";
 z+="            Item = Replace(Item, Cr(), am())\xFE";
 z+="            Item = Replace(Item, Lf(), am())\xFE";
 z+="            Item = Split(Item, am())\xFE";
 z+="            Print `const char `:NiceIName:`[] PROGMEM = `:\xFE";
 z+="            \xFE";
 z+="            Funcs[-1] = `  if (!strcmp(id, \"`:Iname:`\")) return `:NiceIName:`;`\xFE";
 z+="            Externs[-1] = `extern const char `:NiceIName:`[];`\xFE";
 z+="            \xFE";
 z+="            For Each longLine In Item\xFE";
 z+="                Loop\xFE";
 z+="                    Print\xFE";
 z+="                    If Index(Options, 'T') Then\xFE";
 z+="                        Line = Left(longLine, 120)\xFE";
 z+="                        longLine = Mid(longLine, 120 + 1)\xFE";
 z+="                    Else\xFE";
 z+="                        Line = Left(longLine, 1024)\xFE";
 z+="                        longLine = Mid(longLine, 1024 + 1)\xFE";
 z+="                    End If\xFE";
 z+="                    Line = Replace(Line, `\\`, `\\\\`)\xFE";
 z+="                    Line = Replace(Line, `\"`, `\\\"`)\xFE";
 z+="                    If longLine Then\xFE";
 z+="                        Print `\"`:Line:`\"`:\xFE";
 z+="                    Else\xFE";
 z+="                        Print `\"`:Line:`\\n\"`:\xFE";
 z+="                    End If\xFE";
 z+="                 While Len(longLine) Do Repeat\xFE";
 z+="            Next\xFE";
 z+="            Print \";\"\xFE";
 z+="            Print\xFE";
 z+="            \xFE";
 z+="        ElseIf Index(Options, 'P') Or Index(Options, 'B') Then\xFE";
 z+="            Item = Stx(Item)\xFE";
 z+="            Li = Len(Item)\xFE";
 z+="            If Index(Options, 'B') Then Size = 80 Else Size = 1024\xFE";
 z+="            Print `const char `:NiceIName:`[] PROGMEM = `:\xFE";
 z+="            Funcs[-1] = `  if (!strcmp(id, \"`:Iname:`\")) return `:NiceIName:`;`\xFE";
 z+="            Externs[-1] = `extern const char `:NiceIName:`[];`\xFE";
 z+="        \xFE";
 z+="            For I = 1 To Li Step Size\xFE";
 z+="                L = Mid(Item, I, Size)\xFE";
 z+="                X = ''\xFE";
 z+="                For J = 1 To Len(L) Step 2\xFE";
 z+="                    X := `\\x`:Mid(L, J, 2)\xFE";
 z+="                Next\xFE";
 z+="                If I + Size - 1  >= Li Then\xFE";
 z+="                    Print `\"`:X:`\";`\xFE";
 z+="                Else\xFE";
 z+="                    Print `\"`:X:`\"`\xFE";
 z+="                End If\xFE";
 z+="            Next\xFE";
 z+="            \xFE";
 z+="            Print\xFE";
 z+="        Else\xFE";
 z+="            Print 'Dump of ':Iname\xFE";
 z+="            Print\xFE";
 z+="            \xFE";
 z+="            A = 1\xFE";
 z+="            L = Len(Item)\xFE";
 z+="            For Y = 0 To 3100\xFE";
 z+="                Line = Fmt(Dtx(A - 1), 'R%4: ')\xFE";
 z+="                Chars = ''\xFE";
 z+="                For I = 0 To 15\xFE";
 z+="                    If A > L Then\xFE";
 z+="                        Line := '   '\xFE";
 z+="                    End Else\xFE";
 z+="                        Byte = Seq(Item[A,1])\xFE";
 z+="                        Line := Fmt(Dtx(Byte), 'R%2 ')\xFE";
 z+="                        If Byte < 32 Or Byte > 122 Then\xFE";
 z+="                            If Byte > 250 Then\xFE";
 z+="                                Byte = Char(Byte-255+Seq('_'))\xFE";
 z+="                            End Else Byte = '.'\xFE";
 z+="                        End Else\xFE";
 z+="                            Byte = Char(Byte)\xFE";
 z+="                        End\xFE";
 z+="                        Chars = Chars:Byte\xFE";
 z+="                    End\xFE";
 z+="                    A = A + 1\xFE";
 z+="                    If I = 7 Then Line := ' '\xFE";
 z+="                Next I\xFE";
 z+="                \xFE";
 z+="                Print @MonoSpace(Line:' ':Chars)\xFE";
 z+="                \xFE";
 z+="                If A >= L Then Exit For\xFE";
 z+="            Next Y\xFE";
 z+="            \xFE";
 z+="            if (Ext = \"PCD\" Or Ext = \"PCS\" Or Ext = \"PCF\") then Print \"Use option P or R to dump as CPP source code\"\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors # '' Then Print MonoSpace(Join(Errors, crlf()))\xFE";
 z+="    \xFE";
 z+="    If Externs Then Print; Print Join(Externs, crlf())\xFE";
 z+="    If Funcs Then Print; Print Join(Funcs, crlf())\xFE";
 z+=""
window.cached_jsb_tcl["dump"]=z;
window.cached_jsb_tcl["echo"]="program echo\xFE    s = @sentence\xFE    if lcase(left(s, 4)) = \"echo\" then s = mid(s, 5)\xFE    print s";
var z="Program Ed\xFE";
 z+="    Admin = IsAdmin()\xFE";
 z+="\xFE";
 z+="    If !Admin Then Chain \"view \":DropLeft(mySentence, \" \")\xFE";
 z+="    \xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    Dim Help As Array = ['ED TableName <ITEMNAMES> {(options)}']\xFE";
 z+="    Help[-1] = '   (N - use nic editor'\xFE";
 z+="    Help[-1] = '   (C - use codemirror'\xFE";
 z+="    Help[-1] = '   (A - use aceeditor'\xFE";
 z+="    Help[-1] = '   (I - use input html box'\xFE";
 z+="    Help[-1] = '   (W - open in another tab or window'\xFE";
 z+="    \xFE";
 z+="    $include __shell\xFE";
 z+="    \xFE";
 z+="    mySentence = @Sentence\xFE";
 z+="    edtName = \"TA\"\xFE";
 z+="    \xFE";
 z+="    If Index(Field(@Sentence,' ',1),'LIST',1) Then Fname = 'JSB_SelectLists'\xFE";
 z+="    Msg = \"\"\xFE";
 z+="    saveScreen = @Response.buffer()\xFE";
 z+="    searchFor = @Session('searchFor'):''\xFE";
 z+="    replaceWith = @Session('replaceWith'):''\xFE";
 z+="    regExpSearch = @Session('regExpSearch'):''\xFE";
 z+="    caseSensitiveSearch = @Session('caseSensitiveSearch'):''\xFE";
 z+="    wholeWordSearch = @Session('wholeWordSearch'):''\xFE";
 z+="    findOpen = @Session('findOpen'):''\xFE";
 z+="    replaceOpen = @Session('replaceOpen'):''\xFE";
 z+="    doReload = True\xFE";
 z+="\xFE";
 z+="    Options = Trim(Replace(Options, \"!\", \"\"))\xFE";
 z+="    Options = UCase(Options)\xFE";
 z+="    Firsttime = 0\xFE";
 z+="    Lists = Index(Options,'LIST',1)\xFE";
 z+="    If Lists Then\xFE";
 z+="        Options = Options[1,Lists-1]:Options[Lists+1, 9999]\xFE";
 z+="    End\xFE";
 z+="    If Val(Options) Then fromLineNo = Val(Options)\xFE";
 z+="    trueTblName = trueTableName(TableName)\xFE";
 z+="    fName = trueTableName(fName)\xFE";
 z+="    \xFE";
 z+="    *\xFE";
 z+="    * Build Menu Bar\xFE";
 z+="    *\xFE";
 z+="    sFile = \"File\"\xFE";
 z+="    sEdit = \"Edit\"\xFE";
 z+="    sBuild = \"Build\"\xFE";
 z+="    \xFE";
 z+="    MenuBar= {}\xFE";
 z+="    IConStyle = \"padding: 2px; margin: 1px; background-color: lightgray; border-radius: 4px;\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile] = {}\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Save\"] = {}\xFE";
 z+="    MenuBar[sFile][\"Save\"].id = \"Save\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Save & Exit\"] = {}\xFE";
 z+="    MenuBar[sFile][\"Save & Exit\"].id = \"Save>\"\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    MenuBar[sFile][\"Save As\"] = {}\xFE";
 z+="    MenuBar[sFile][\"Save As\"].id = \"Save As\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Rename\"] = {}\xFE";
 z+="    MenuBar[sFile][\"Rename\"].id = \"Rename\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Reload\"] = {}\xFE";
 z+="    MenuBar[sFile][\"Reload\"].id = \"Reload\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Exit\"] = {}\xFE";
 z+="    MenuBar[sFile][\"Exit\"].id = \"Exit\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Delete\"] = {}\xFE";
 z+="    MenuBar[sFile][\"Delete\"].id = \"Delete\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Exit All\"] = {}\xFE";
 z+="    MenuBar[sFile][\"Exit All\"].id = \"Exit!\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Detach\"]= {}\xFE";
 z+="    MenuBar[sFile][\"Detach\"].id = \"Detach\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Who\"]= {}\xFE";
 z+="    MenuBar[sFile][\"Who\"].id = \"Who\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sFile][\"Restore Previous Version\"]= {}\xFE";
 z+="    MenuBar[sFile][\"Restore Previous Version\"].id = \"Restore\"\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    MenuBar[sEdit] = {}\xFE";
 z+="    If UseAceEditor Then\xFE";
 z+="        MenuBar[sEdit].Undo = `CheckUnDoReDo(\"Undo\")`\xFE";
 z+="        MenuBar[sEdit].Redo = `CheckUnDoReDo(\"Redo\")`\xFE";
 z+="        MenuBar[sEdit].seperator1 = True\xFE";
 z+="        MenuBar[sEdit].Find = `aceEditor.execCommand(\"find\")`  \xFE";
 z+="        MenuBar[sEdit].Replace = `aceEditor.execCommand(\"replace\")`\xFE";
 z+="        MenuBar[sEdit][\"Find Next\"] = `aceEditor.execCommand(\"findnext\")`\xFE";
 z+="        MenuBar[sEdit][\"Find Previous\"] = `aceEditor.execCommand(\"findprevious\")`\xFE";
 z+="        MenuBar[sEdit].seperator2 = True\xFE";
 z+="        MenuBar[sEdit].Goto = `var lineNo = prompt(\"Goto Line #\"); if (aceEditor && lineNo != null) aceEditor.gotoLine(lineNo, 0, false);`\xFE";
 z+="        MenuBar[sEdit].seperator3 = True\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    MenuBar[sEdit][\"Format\"] = {}\xFE";
 z+="    MenuBar[sEdit][\"Format\"].id = \"Format\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sEdit][\"Sort\"] = {}\xFE";
 z+="    MenuBar[sEdit][\"Sort\"].id = \"Sort\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sEdit].seperator4 = True\xFE";
 z+="    MenuBar[sEdit][\"Help\"] = {}\xFE";
 z+="    MenuBar[sEdit][\"Help\"].id = \"Help\"\xFE";
 z+="\xFE";
 z+="    // MenuBar[\"collaspable\"] = true\xFE";
 z+="    \xFE";
 z+="    MenuBar[sBuild] = {}\xFE";
 z+="\xFE";
 z+="    MenuBar[sBuild][\"Compile & Exit\"]= {}\xFE";
 z+="    MenuBar[sBuild][\"Compile & Exit\"].id = \"Compile>\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sBuild][\"Compile\"]= {}\xFE";
 z+="    MenuBar[sBuild][\"Compile\"].id = \"Compile\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sBuild][\"Run\"]= {}\xFE";
 z+="    MenuBar[sBuild][\"Run\"].id = \"Run\"\xFE";
 z+="\xFE";
 z+="    MenuBar[sBuild][\"Debug\"]= {}\xFE";
 z+="    MenuBar[sBuild][\"Debug\"].id = \"Debug\"\xFE";
 z+="    \xFE";
 z+="    // Glyphicon RUN\xFE";
 z+="    MenuBar[\"Run\"]= {}\xFE";
 z+="    MenuBar[\"Run\"].id = \"Run\"\xFE";
 z+="    //MenuBar[\"Run\"].glyphicon = 'play-circle'\xFE";
 z+="    RunPng = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAX+/AAF/vwFTP+0nAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAwBQTFRF////AwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEAwEEtRVHvgAAAP90Uk5TAAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8gISIjJCUmJygpKissLS4vMDEyMzQ1Njc4OTo7PD0+P0BBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltcXV5fYGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6e3x9fn+AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq+wsbKztLW2t7i5uru8vb6/wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t/g4eLj5OXm5+jp6uvs7e7v8PHy8/T19vf4+fr7/P3+6wjZNQAAGjpJREFUGBntwQmAVuP+B/Dv+76zNFuLSVTaJMqWpUVIpZJsSSGy5OK6riXZhUp2JWu5ZQ8lXZQta9kiS6tcoaZVqpnWabZm3vf7//vfv3ulaeY573nOc55z5vf5AMKsRl0ve3D6Zwvy8kvLCpYv/PzNhy7v3iQCURNEDr/u7a2sxPb3b2ofgwi19H5TC1iFza+fkwERVp2e2MRqbX36uAhECPX9nop+PicCETLHzKYDc7tDhEnr1+nQu20hwqLh+Ao6Fp/YFCIMcu4sYlJKR9WDCLzDVjJp6zpBBFy/7XSh9EKIIIsMT9Cd0VGIwMqcStfeqQMRUE3mUYMfWkEE0tHrqMWmHhABdEYZNam4ECJw2hVTmx3HQQRMwzXUKL85RKDU+opaLcqGCJKXqNm0CERwDKV2d0MExukJ6jcAIiAOLaQHittBBELaUnpiZQZEEFxDj9wCEQC18+mRLbkQ9rubnnkIwnoNi+iZshYQthtPD02CsNwB5fRQ4ggIu71GT30IYbWj6LFeEDZ7mx6bDWGxvSvotVYQ9rqWnhsJYa/59FxeBMJWh9CAzhC2GkEDHoaw1Wc04DsIS2XtoAGJBhB2OpFGnA1hpwdoxAQIO31GI76DsNMGGlEShbBRXRrSHMJGHWjICRA2Op+GXAVho+E05CEIG42hIc9A2OhJGjIVwkZTaMh7EDZ6h4Z8AWGjz2jIdxA2mklD5kHYaDoN+QTCRi/SkLcgbDSOhkyCsNH9NGQ8hI2upyF3QdioDw25EMJGbWhIJwgbpVXQjFwIKy2lEQUQdnqDRnwKYafraMSdEHY6nEZ0g7BTpIAGlKRDWOqfNOBDCFtdRgNugnAgo+uw9xfl5W/99vkbetaCx3LL6LlEUwhlbV8q438VvzukDTz1Gj03E0LV8e9yF6ue7FcXnjmdnhsEoSQ24FtWrmL27R2i8ERqAT1WlA2h4sTlrErB5EEN4YFR9NiTEApSRyVYrYUPdE+DZrlb6KnifSCq1+Rrqtn+1lWtoNVQeuo+iOrV/Z4O5I3rkwNtMn+hhzbWgahW2iw6tOPjW46IQI9L6aFrIar3ApOx/oXzGkCD2A/0zPJ0iGp1Y7ISc+85LhVu9aVnBkJUbw7d2Dbtby3gzhf0yLwIRLVOp2s/PXpyFpJ3LD3SE6J6i6hD2Yc3HIpkTaQnXoGoXidqs/bZAblIRq2v6YEFWRDVe5o6xb8aeXQMjjVcQ+02NIOoXnYhddv8z0uawKF2xdSs7FgIBZfQE/8a0ysDTpxNzS6GUPElvVLy7pADoe5OavUwhIqD6KlVT/avCzWRV6nRezEIFWPotYrZwzpEoSBrPrX5sS6EirR8mlDw8qBGqFbDb6jJ4uYQSs6kMYse6J6OqmVMphZv5kCoeY8mFb111f6o0m0Jund/FEJNszhNy3vi9BzsXt/tdKn0fAhVI+iHHZ8MPSKC3Wi7kq6sOwpCVXQl/bJ+4hGoXIPZdGFeEwhlvein1w5GpdLGxZmkxPOZEOqm0lfxD+4d0CaGXR38FpPyUTsIB+qX0X/FX0+44jD82XFz6Nj8XhCOXEtbLBnWCn/S70c6snxgBMKZ72mRb65tjJ2kXPYrleVfkwbhUCfaJT6rN3aSdeMSKll2e20Ix56idd5qhZ11HLuR1djyZOcIhHPZhbRP2f052FnayWMWJrg73z/apxZEUi6mlX69MII/q3/mYx+u4Z+snTXu3L0hkvYlLTWnAyqTfeQ5f79x5IPjJ4wZeeMV57avDeHKgbRWYnQUwmtjaLHXMyG8lZZPm321F4SnzqTdlreB8NK7VJPf+u/TC+mDzd0gvNM0TjUPAkjteu+8BE0rOx/CM8Op6ED8217nv7iBhv0dwiPRlVTzBf4rcuTQT8ppUHlXCG+cQEV/wc5qn/7EchqzoSmEJ16hmsJs7Gr/q94uohlzMyA8UL+Map5E5dK7j1pEE16A8MAQKuqI3Wt00csb6blrIPRbTDWLUbVox2GzK+ip8uMhdDuKiq5B9er2f3IVPZRfH0Kzp6imLBdqDhzybgm98iiEXtmFVDMF6jJ6jSmhJ3a0gtDqYirqCSe60yOvQWj1BdWsiMKB1H/RK8dCaHQgFQ2DE9fTM3MgNHqQauJN4ECjQnrnbAht0vKpZgaceIkeykuD0KU/FfWDA/vH6aURELq8SzUbUuHABHoq3gtCj6ZxqhkNB/YupbcKmkFoMZyK2sCBe+i16RA6RFdQzWw4kLOZnusAocEJVHQRHLiW3nsPQoMpVLMtC+pSV9OAwyFcyy2jmglw4AKaMB7CtWuoqAPURb6jCYU5EG4tpppFcOAkmnEZhEsdqWgwHPiYZsyDcOlJqinNhboONKU9hCtZhVTzMhz4J015GsKVv1BRD6hrFacpRXUg3JhNNcsjUPcPmnMFhAttqOh2qNurhOYsgnBhNNXE94G6u2lSJ4ikpW6gmnegLnsTTXoeeqUefsktt95+y2lNUAP0p6IzoG4IjSquB31qXzmnlP8v/4XjEHYzqGZ9KpSlrKJZg6FL83GF3MmPV8QQZk3iVDMK6s6nYf+CJpds4y6+aYsQG0ZFraFuEU3rDB32fpuVKR+B0IqsoJrPoK43jXsJGhy5hrvxeAQh1ZOKBkHdLBpXmgvX+hVxt8ZHEE5TqGZrJpS1pw+ug1u3JliFuxBKuWVUMx7qptIHP8Kd9BdYpfIjEEbXUFF7KNsvTj90gxsNZrMaC1IRQt9RzUKoe4K+mAIXDl7Bat2O8OlIRVdDWYMS+qKsAZJ28jZWr+wghM4EqindA8rupE9uQrKGxKniqxhCJmsb1UyCsqyN9MmyCJKSOoGKrkXIXERF3aFsMH3TE8nYYyZVrUtFuMymmrwIVKWspG9eRRIO+Inq+iNU2lDRrVA2kP4pbwjHum+mAx8gVEZTTUVjKFtIH90Kp/5WTicSjREiqRuo5i0o60U/rYjCkdgjdOgchEg/KuoLZR/RV73hRO0ZdOpxhMg7VLMuBara0V/T4UCL7+nYAoRHkzjV3A9lr9BfFY2h7Nh8OleE8LidivaHqpYV9NlwqLqwjElIRBAWkeVU8ymUjaPfVsegJHIfk5OFsOhJRRdA1Z7F9N2pUJH1OpO0B8LiZarZmglVI+m/t6Fgn/lM0kaERW4p1TwBVVkb6b94M1Sr/VomaybCYjAVtYOqq2mDO1Gds4qZtIcQFp9SzQKoSllBG6xNQdWGJ5i8TgiJ2uVUcyVUnUs7nIGq1JpMFz5AWPSlmpJ6UDWfdngPVdh7Dt04DmHxONW8BFUn0BKJfbFbbVfRjfEIjdepphtUfUhb3IvdOa2QbkyLITQ+ppJlESg6gtZYn4rK3RCnG59nIDwWUclQqHqZ9jgLlUl7hq5My0KI/EAVFY2gaN8K2uMjVCL3E7oyKooweZcq3oSqx2mRRCvsos0yulF+KcLlCaroA0X1i2mTUfizXlvoxubuCJkbqeDXFCgaQavkp2NnV1bQjaWtETZHUcF9UJRZQLuciz9KGUtXPquP0ImsZvVaQdGVtMwn+IO679OViWkIoUdYrZlQFFtO27TBf7T8gW4kbkMoHZlgdbpC0Tm0zkP4XZcCulFyNkJqMqvxEVTNo3U21cK/XbyDbqzriLBqVsqqHQ1FPWmhC/Cb6Gi68l0zhNcdrNJjUPUBLTQb/yv7DboyozZCLDqNVfg8FYoOp5UOBpoupCuPxxBqWXO5W2sbQtVkWukxHLWOblRchbBrOJ+7sWQ/qGpRQSttuaSEbmzrjfDLnMRKfVQPyh5nKK08BDXC9UXcRdGIFCirX8ww+mov1BB7PVTCnSQm7gMHRjCMXslAzdFo5Jw4fzd36P5wIrOAIXRXBDVLvX5DRz39yqPX9GkGh66kaZvotbILIBTF8mjaBcvprYLOEKoG0LSVKSPoqSX7QSibR9Ouwb4JeuijehDKetC0TdnAx/TOU6kQ6t6naXcCGESvxG+AcOBwmlbSAED2dnqjqC+EE5No2hP4zXP0xC9HQjjRvIKGxffDb7rSC/MbQzjyKE2biv8TWU79pmdBOJJbRNPa499GULsHoxDODKNpM/H/WiSoV/lfIRzKyKdpJ+J3H1OrzT0gnLqCpi3EfwyiTsvaQDgVW0bTBuI/srdTn8/rQzh2Nk1bmYL/eo7avJgO4dy3NG0w/qArNUkMg0hCd5q2MQt/EMmjFiUDIJLxHk27EzsZTh3WHwWRjLY0rXhP7KRFgu4tbg6RlJdo2jj8ySy69m5tiKQ0K6dhFS3xJxfSrbExiOQ8QtNewZ9lFdKViqshkrTHdprWDrt4lm4UngyRrNtp2kfYVRe6sOpQiGRlbKBpvbCrSB6T9vXeEEm7nKYtQGWGM1lTMyCSFl1K0waiMs0TTM49EYjknUnTVqSgUrOYjLJBEG58Q9OuRuUuZBI2doFwoxtN25iFymUV0rEfW0G4MoOmjcTuPEunZtWDcOVQmla8J3anCx16OhXCnRdo2ljsVmQZnUjcBOFS03IaVrEvdm84HSg6A8Kth2jaFFSheYLK1raDcKteIU07ElWZS1UL9oFw7Vaa9iGqdA8VvZEN4Vqt9TTtBFTpOKoZE4Vw7zKaNh9VS91GBeV/g9Ag+jNNOxfVeInV29ITQod+NG15CqrRrIjVyTsQQouvaNpVqNZQVmP2nhBadKFpBZmoVtqPrNJL6RB6vE3T7oCC48tZheEQmhxM04rrQ0Xv7dyd+N8gdHmOpj0ONe3Ws3LlAyF0ydhOwyr2haKWC1mZ0j4Q2vSjaS9DWfT8PO7ijdYQ+kyhaUfAgdQrfuRO5naD0ChzOw37AA7td9OcUv4mvmTSTSdGIHQ6k6b1hHOxVj2O79wuG0K32HwaNh/CIlfQtHMg7LHnJhq2PAZhj6do2pUQ9uiYoGEFmRDWiH5D00ZA2OOvNK2oPoQ19iigaY9B2OMJmlbRAsIaR8Zp2mQIa0S+pHGHQ1jjLzTuAwhr1N1A43pAWOMxGjcPwhptK2jcAAhrfEbj8mIQtjif5l0BYYvav9K4/EwIW4yhecMhbHFQOY0ryoWwxSya9xiELQbQvIrmEJbIXkPzJkHY4gH64DAIS7TeQfPeh7DFB/RBdwhL9KcP5kJYInMVfXA2hCXupg+WxSDs0KqUPrgCwhLv0Af5GRB26EM/DIOwQ63l9EFRLoQdRtAPj0LYoUUJfVDeHMIOb9APL0HY4ST64jAIK6T/TD+8B2GH2+iHRCcIKzQtoh8mQtjhVfphW0MIK5xAX9wAYYW0JfTDklQIK9xEX5wIYYXG2+mH6RB2eJl+KN0Xwgrd6IsREFZI+Z5+eC0KYYVr6YcvMiCs0HAbffBTfQg7vEgfbGgJYYfO9EFRRwg7xBbSvHgfCEtcTR9cBWGJBlvog7dzIOzwLH2xsAmEDTol6I+17SD8F51LvxT1hfDd5fRP/AYIn9XfSD9NSIHw1QT664M6ED5qH6fP/tUCwjeRr+m7DZ0g/HIJLVAyAMIf9fJpg8TtEL4YR0tMTIMw7/A4bfFJLoRpkS9oj5/3hzBsEG2ysQuEUXXW0yplF0KY9Ahtc3cEwphDKmidKbUgTPmUFvqyAYQZA+nSr2X0wPKDIEzIWUuXTjq2gB7YcgKEAaPp0nSg5RJ6oPwyCM8dWE53SloAqDeTXngwCuGxj+jSCPwm9Wl6YVoWhKfOokt5tfBvNyfogbmNIDyUtZounYbf9S+mB1YfBuGd++jSO/ivDr/SA4WnQHjlgDK6U7of/qDpInogPhjCI+/Rpbuwk5wZ9MLYGIQXzqBLKzOxs9jj9MKMHAj9MlbQpX7YxdVxemBRUwjt7qRL76MSJxfSA7+2h9CsZSnd2XEAKtN2NT1Q3A9Cr7fo0n2oXMNv6YHETRA6nUqX1mRjNzJfpxeeSoXQptYyunQ2dis6il74qC6ELsPo0kxU5dJyeuCHfSH0aF5Md8oPRJV6bKEH8o+B0GIaXXoQ1WiTRw+UnguhwYl0aW0OqrPnbHphOIRraT/RpYGoXvokeuHFdAiXhtKlT6HkDnrhs/oQrjQpojsVh0LNeWX0wNIDINyYSpcegapjC+iBTd0gkteDLq2vA2Utl9ADO/4CkazUH+jSIDhQbya9cG8EIjk30KUvInAi9Rl6YWoGRDIaFdKd+OFw6OYEPfDVXhBJmESXxsGx/sX0wIqDIRzrSpfy68G5Dr/SA1t7QTiU8h1dugTJaLqIHqi4HMKZa+jS1xEkJWcGvfBQFMKBvbfSnXh7JCn2OL3wRhaEuol0aQKSd3WcHpjfGELVMQm6s7E+XDilkB5Y0wpCTeYCunQ5XGm7mh5Y1RSiepn9XymiS3OjcKfht/TAz3tDVC2j35TtdC3RCW5lvk4PLM6F2L2MM17eTh2egXvRUfTAN5kQlavVd3Ih9djcADpcWk79RkJUotbpkwqpzVXQo8cWaleyL8SfpPd5aRs1WhiDJm3yqN10iD9KP+3FbdTrWGiz52xq1xvid+mnvrCVur0AjdInUbcfoxC/STtl4lbqt3Vv6BQZSd26QSDtlOe30BNDoNl5ZdTrH6jp0k5+bjM9sjgFunUuoFb5KajJUk96djO90xX6tVxCrXqhxkrt/cwmemkyvFBvJnV6BjVT6olPb6K3ChvDE6nPUKM81EApvZ7aSM/dCK/cnKA25THUMCknPFlAA35IhWf6F1ObZqhJUno+WUAzesJDHdZRly6oMWI9JuTTlH/CU00XUZNBqBli3cdvoDlFTeGtnBnUYxhqgNjx/9hAo4bCa7Gx1OJ6hF2s2xPradhP6fDe4Dg1OBehFu06bh3N6w0TTimke90QXtEuY9fRD9NgRttCunYQQip63OO/0h/FzWHGtXRvb4RRtPNja+mb4TDj7ATdS0XoRI59dC19tKwWjOhSSvd+QchEjnnkF/rrVBhx8GZq8CbCJHL0w2vot7dgxD6rqcMdCI3I0Q+tpv9KW8KEOouoRU+EQ6TTmNW0whCYkDaTWqyIIgQiRz24ipaYDBMik6nHbQi+jqNX0hrfZsKE0dSjohECrsOoFbTInLowYTA1mYZAa//AclplTg5M6B+nJichuNrdn0fLbN8XJnQupSYzIwioI+/Po32uhgkHbqImW5shkNLvWkYbfRaFAY1WUpeLEEi1Z9FKJfvDgNoLqMsbCKQGc2mna2BA2ofUJX8vBFHzn2in22FA5EXqsuMEBNE+v9BOQ2DC/dTmQgRR7BNaKX4pTLiS2tyKQBpBK5WfCxPOiFOXJxBIXSpooW+uawITjimhLtNjCKI91tA6i2/bD2a03khdvsxAIN1Dyyy962CY0nAFdfmpPgIpZzNtsnp0O5iTM4+6rNsXwXQ97bF+bOcIDEp9n7psPxLBlLaGltj8dM8YzHqeupT3RkANohW2Tzo1DabdQ20uQlBNo/9KXzsrE+ZdTm2GIaiim+iz8ncuqA0/9KmgLhMQWIfTV/FZl+XCH52KqcubMQTWEProy8EN4Zf9C6jLV5kIrun0y4Kbm8M/e+VRl5/3RID9QF8sGdEafsr+lrpsaIkgW0PzVtx3GPyVMoO6bG+PQNtKw9Y+0gm+e5a6VJyMQIvEaVLB+G5R+G8ktbkEwZZNc7ZO7J0KG/yV2oxAwNWhIcWvnFELdjilgro8hcDbRAPK3jg3G7boWERd3k5B4H1Nr1V8cHE92GO/DdTlmywE3yR6KvHZFQ1gkwZLqcuyBgiBkfTQt9c1gV2yvqYu+a0QBufRK4tv2w+2SXmbuhR1RCjUL6cXlt51MCz0FHWpOBUh8Ta1W/1ge1hpOLX5K8LiPOq1fmznCOx0MbW5E6GRXUx9Nj/TMwZbnVROXZ5FiEyhJtsnnZYGe7XbTl3eTUGIHFJBDUpfOysTNmu5nrrMzUaoPEq3ymdcWBt2q/8zdcnbC+FSdwPdiM+6rD5slzmHuhTsj7C5hMmbM7gR7Bd7g7oUd0LoRL9ichbc3ByBMJ66VPRBCDVcTueWjGiNgLiN2lyOUGq1gc6suP8wBMYganMPQurIbVS39pFOEQRHr3Lq8jxCq3sZ1RSM7xZFkBxRSF3eT0V4dcxj9bZNPCkVwdJiHXWZl4MwqzOF1XjzjFoImtwfqcuKhgi5S4tZhSU9ETwZX1CXja0Req2eL+duFN6YiuCJTaMuJcegJmj2aDErsWVCYwTROOoS74saYs/bPy/jTopfOT0dgXQLtbkSNUjG8XfM/HlDKclNX08aeXYOAup8anMfaqD0BnsgyHruoC4vRiCC5rBt1OXDVIigabaWuiyoDRE0e/xAXVY2ggiaWp9Tl01tIIIm+ip1KekMETiPUZd4f4jAuZHaXA0ROAMT1GUUROB0L6MukyIQQXPoVuoyMw0iaJr+Ql0W1YEImnrfU5dVjSGCJv1T6rL5IIigiU6lLqVdIALnYeqSOAsicK6jNkMgAmdAgrqMgQicrmXUZUoEImhabaEuH6dDBE3qt9RlcV2IwHmAuqzZByJweiSoyZZDIAKn/lpqUtYNIngeoSaJARDBU7eQmlwPEUA3UpOHIQIodTX1mBqFCKCB1OPTdIggepNafF8PIogiG6nDL00hAqkNddjaFiKYLqEGZd0hAuo5upcYCBFU8+nejRCBtZSuPQYRXGvp1qtRiODaSpc+rwURYOV054c9IAIsRnfWNoMItLV0Y9thEME2ky7s6AkRcGPpwvkQQXclk3cLROD1YNLGQQRfdhGT9HoUIgReZHK+yIAIgxOYlCW5EKEQW8sk/NoCIiRG07nCIyDComkRnSrvBREeQ+nUIIgQSfuRztwGESo96cg/IEJmCh14IwYRMtlfUdmcTIjQyf2eir6vDxFCjVdQyde5EKHUaj0VzMyBCKkmn7Ba09IhQit6azmrVD4qBSLMOi5lFT49BCLkcoZt4G6sOx+iBqh12U+sxNwhdSBqhmjfyau4k1X3HghRozQZ8NjH3yxe9kv+ty/cekabCGqq/wFprrvuz1TvxAAAAABJRU5ErkJggg==`\xFE";
 z+="    MenuBar[\"Run\"].iconurl = RunPng ;* @jsbRoot:\"pics/run2.png\"\xFE";
 z+="    MenuBar[\"Run\"].style = IConStyle\xFE";
 z+="    \xFE";
 z+="    // // Glyphicon COMPILE & Exit\xFE";
 z+="    MenuBar[\"C>\"]= {}\xFE";
 z+="    MenuBar[\"C>\"].id = \"Compile>\"\xFE";
 z+="    CompilePng = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAB2klEQVR4XtWVQU/qQBDHp9uSCOHgXQ4k8jBEookHQ3p/FzHxE3jkO3gz3jx69Er8AnwCbu/wosZ4UGn70JcmGEhNMGiBALLONpNK1gJVe9BJfuxuh5n/zE7Swo83JWQA/2y8BiHtwXn0ZC7OTO/8e2szVJz2keqNGxvO/xqSb3YXDEJYr9sH49qGWOytnsP9E3//VYGdeGIB1jcyMByOfMfewa7n++yQs4ghOx7bT3B8VKHkILOM3M4XoOScc6jVaqCqqke1WoVSqQTCyuUyFItF39dsNiGbFWGwhNxPF6Dktm1DvV73ghljYg3cI/7ecRzQdR3Q8shVkEAauROVm6YJg8FABPskk0lJ5D2NRgNSqZR/XbJABrEgGvuF/Js5A9GyZVlSxcEdtFotKBQKIWdAAzYMI+gagsVo0Ol02r+eeTMISvj9ZiC/i/4jq8iV67pBXUyfB80hl8sB2grlUhAufpiAVK8juqI8YiIjhbpYQNaQPxCN6cglMtBIII4kEIiogzgV/aLQYRHZRCoQjW0jp0hHo4/GCDEQnQSZUKeAMZ3J/GeK5GOUp4+0ac/ViSBOzh7yjDwRLp3fVvLRuTvx/87Ec5eGDIyIESRKFc43TvGcGFP1Q7G+AlUAxPwogt6sAAAAAElFTkSuQmCC`\xFE";
 z+="    MenuBar[\"C>\"].iconurl = @jsbRoot:\"pics/compile.png\"\xFE";
 z+="    MenuBar[\"C>\"].style = IConStyle\xFE";
 z+="    \xFE";
 z+="    MenuBar[\"Save>\"] = {}\xFE";
 z+="    MenuBar[\"Save>\"].id = \"Save>\"\xFE";
 z+="    SavePng = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAjzSURBVHja7VtfbBRFGP9mbu/2elcotmD/xVIIUIOgiP/e1JgoEh5IDIGYgL7oAyroo/HV+GY0YgwoIeCLIokJTxKj8ZEHo4mRPxU10tIWaOn/9q7Xu+ut30x3dmf2/y5IrpaB6e7Ozs7O75vv933fzOwRwzBgOScKyzxp4qS9u3sbHljOLmE8Jcy/3ejr+y3qA6Rt7do0Hr/E/DIryDY0QGNj45JDPlcsQqFQEJdfY34VBVGJogHvMvAdHR2wZ98+KJXmYGZqGkWD/wmBUrnCG25pbhYys6XnJVFYtCkGe57XYHmxjLXHrw35GqxrpUF2D4upWccw22DXo+Pj8EBXF6TTGn8Hq5HJ6pBJZ+Cb06fhzytX2GD2Yn4/igb8kc/ne944dAhOnToJ5fkS7xillB9b2jvgqcefhEe3P2b1kXccMzuKPlNxTYkCjoq6Zpn8vHhG1KfKOZjPmc9Qu70z334LE5OToKUoXlN+j+BR01Kwfduj8PmxYzA0NHQFNeDBKEZw44s7d8K5c9+5wLNGrVGqt0RAAU/xyDzapd5eeGnPHlZjY1QvQNs7O2FsZAR2vfAi7Hh+BzSval4ETwnUKXwFvFGtwsbu9bB+7TqYnZkRNoxG9gIUVUnPZODAKwegXAX4+++/YGp22lLfulQAamtoPp+D3bt3Q7UGcOTTTyCVSsV3gzPFAhx++x1+PosWldY5Bbht4HQlUJgrwYcff8TLjJj91URjLE1MT3HJWuDrmAJggmf9TKMHUAYshhCo3R6xLLEAX88UoBIFZPDMgMePBDlOajdK1UaNhRp0dnRa2iC7JKGQVIwKc9/Evna6SsvdE1voxCojqkuVy8Q72Z9aTaGADD6uBmgWAC/wJgVq+MLND262BUDUuEUG6XXPjh/87zmfDbrHJ3Au8EQRaAIK0KVLAZqcAlSWuB8F6tMGUn8KJNGAIArUaSDoS4GEXoDaHFoCFCABFIhvA4RF5qCXIQW4S/ECT4nPpLceKWBrcDIb4EGBxcah7ilAJPAkEQXATQEeGCWQ6N2mAANMJfA0sRH0BV+vAvAGn4wCyuICURqtWwo4+imfJ7ABRJoM0duS6F3VAD8tgJgUIDIFXOCXIAVIAiNog1+WFHB4gSVOgWQC+D9RILEXMLWAOChQbxuorD9BFCAkthEkEnizManRawPX+KJIPaRyuQzXR0bs6O82KaA5Q0sFPNtsWFiAip6GQ2+/CR2tbQojiLRASZxlPvG7U40D1jxdz9Zw5AeuXweazUJO130oQBMKQAKvzAlw5GmlApW0Bv3DN6S1OnM1mUhxhCwMa5tL1HOWE3U5LVI5gcaWFljd1AQpTXOpvT2BSyAAGbx6jkejBgSFoESLpn1gy5/2YoTXOfVfbVIMr7cRlkfWetY5+SFE6RuJvygK/uApcZ9LEo8FntwB8CS8nyLt2Lv3WT87inkW86AG0vK1WwuCwJP44OkdAE/DB0lKmYDB19l9KxQOpAB1zBMiacGdAE9CwHsPUow0Su8+BeKAT0aBiEJgfr2fumLrOBQgcSngAT4goLkDFAhKQ9+fOVOO5gXMF5QKRahgXGBteVnZdlPOcmeZiDqVeN7xxYmznNVuWb0GVjatdPeTJKIAM4L96t5gCPjCbAE29PTAlk2bQEuleDjKMosQRagsXztzWL1KtQpjhQLoK1Z4k/XmTf4FS2tbu7c38fACAWkYR7+o7A06wRNHo1o6Dc888QRsfegh3nk5C0BBZVHqDAwNQd/UFFCPDxxWt7XBcH8/tNFg8BE3c/qUOMDpBWROi0arqPrru7stlWMdvnD5MtSwnAHRMDLbtGGDxXV2X/YY8rVf2QOdnXB5cBAaV63ynrg4Rp4odkSiQDANxnD0p30DIS/wgpvs0xPxwq/OnoUFXbdNKgrir2vXYNdzz7mAOfnuVcYEssCEGTwHVsBT10p2JApc9V8QMcFXWOxfqUqhJVUEwO5Pzs2po4P3JmZmXEC9MlXmG3YOm3aLDRwBnn3TOF+aV/sZ7AWmcPTHfbbG7JFvYhYXJx2yUMCx9eTVWcNjpP3AetWJsh0kj/xVpMs/gwMu9xswJ+3zXRVmDzPVnSvOQRpVm+Uiuj3DsNVZpkDgMlWC0bdoEbCmJwx1pVqBsdExSGcy3DiP3hrFqXJNsgmejzOrP+I5GbJ8L03Bus2bIWd+K8xeMDl805pjhwnAi9dh9kCuw1d6QtYTiDlQJQTchFrK0nSxCKulCNGHSldR/Y3A7fG0loLJ0VHr5vTYGP/+llJ3x6MIIAkdAi24qer5XB6ABWRmyqIHSov1AW8Nmsd8I2RZXER7BVhgRrBchur8vBLKCg2gIWoal/txjKDgf2NDDgzUhAr28b6VTYob90j9OPq10FVhBlTPpPlns2PDw5DLNShhLRNAmMG6rdGPYgTNft6/Zg0fLAxQYFVTkys8llKVzfuDF0QcXqA4Pc0BN2Sz0ofIwEGIFdlAQxWT+1EpYFl7UwvyehZ09sk8VSNZRxrA0a8GCqCGUsznclDiX4svaoHXzI441u38OnlbxjBEBai0et2O4bGuZ1zrmWBTqSYmPUHL4rUTx4/D1oe3QjbbwAEzVU+lNPU7HIcal0slKKH1lTOzG0m4r1AgZKVYDoS8wHMNtoM0PuUNWxN8bWJi4sRnRz4lbx0+DL9fvAALqBHynJ0JRZNekEVqvLl/vzKZMaRfgcQdfTm4mh0egQW0PcoPKswd37bWVoUCXuBTWP7TDz+wsuGw0ecCuNHXd7K9u7vx1q1bR744ehReP3gQBocGgQKxv8bEf9mMrnS8FTvjN+NLMg8Qz2/ZuoXHIYvgxK9LqNUPawMH1N0rVr9Snodff/kVzp8/z2KYH8WUN5BUYuRQCO/h4YOuri54ZNs2VR3ZfB1d44Z165Q5vey2nOXEvsHbserL5+I585y9g80n1O/9w7a7Fz3UxPg4XL50CXAgmUAvYiT7dF9v70RkAZhCOIiHHg87QaxZM6U6vkCXwn9DOo9y/C83DYv4kp9xZno6yi/GXAJYjmnZ/3L0ngDuCeCeAJZ3+hd0gyDgPfYKaAAAAABJRU5ErkJggg==`\xFE";
 z+="    MenuBar[\"Save>\"].iconurl = SavePng ;* @jsbRoot:\"pics/save.png\"\xFE";
 z+="    MenuBar[\"Save>\"].style = IConStyle\xFE";
 z+="    \xFE";
 z+="    // Glyphicon Exit\xFE";
 z+="    MenuBar[\"X>\"]= {}\xFE";
 z+="    MenuBar[\"X>\"].id = \"Exit\"\xFE";
 z+="    ExitPng = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAlklEQVR4Xu3XQQqFIBRGYRMX2ltJuZLeTk2Q+AdyhSg9A7vQ+HyoIbrpZ8nfnr+tcyeWTj1+QNy1Gt6xwwOCcS46zIRbcNCAVQgEIAQIEAIECGECSES4EUivIMr8qhUAVkIACjH1ZfS/zoEn4+2/4Pktmaw4tAWKAwDFAYDiAEBxAKA4BVC8DeBfRmlU63uYWIDYP2M3TlI3GAOjS6m4AAAAAElFTkSuQmCC`\xFE";
 z+="    MenuBar[\"X>\"].iconurl = ExitPng ;* @jsbRoot:\"pics/exit.png\"\xFE";
 z+="    MenuBar[\"X>\"].style = IConStyle\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    MenuHeight = 33\xFE";
 z+="    HTMLMenuBar = @Jsb_html.MenuBar(MenuBar, \"ED\", False, False, MenuHeight)\xFE";
 z+="    Externalopen = Instr(F_File, \"@rpc.\") Or Instr(F_File, \"@\")\xFE";
 z+="    \xFE";
 z+="    If !F_File Then\xFE";
 z+="        Call editor_removeFromRecentList(trueTblName, \"\")\xFE";
 z+="        Stop \"File not found: \":Fname\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        Dim Ext As String = @FieldRight(UCase(Iname), \".\")\xFE";
 z+="        Dim HDoc As Boolean = Ext = \"HTM\" Or Ext = \"HTML\"\xFE";
 z+="\xFE";
 z+="        \xFE";
 z+="        HDoc = HDoc Or LCase(trueTblName) = \"jsb_docs\"\xFE";
 z+="    \xFE";
 z+="        If Instr(Options, 'W') Then\xFE";
 z+="            Print @Script(`\xFE";
 z+="             window.top.open(\"`:@JSBRootAct:`?`:@UrlEncode('ED ':fname:' ':INAME:' (':fromLineNo):`\", \"_blank\");\xFE";
 z+="          `):\xFE";
 z+="            Inames = []\xFE";
 z+="            Cycle\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If UCase(FNAME) <> \"SYSTEM\" And isBinaryFile(IName) Then\xFE";
 z+="            Ans = MsgBox(IName:' appears to be a binary file, continue to edit?', 'Yes,*No')\xFE";
 z+="            If Ans <> 'Yes' Then Cycle\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        ' Loop on redislay\xFE";
 z+="        loadItem = True\xFE";
 z+="        Loop While True Do\xFE";
 z+="            if loadItem Then\xFE";
 z+="                loadItem = False\xFE";
 z+="                NewItem = False\xFE";
 z+="      \xFE";
 z+="                Item = \"\"\xFE";
 z+="                If Externalopen Then\xFE";
 z+="                    Readjson Item From F_File, IName Then\xFE";
 z+="                        If hasTag(Item, \"ItemContent\") And UBound(Item) = 2 Then Item = Item.ItemContent\xFE";
 z+="                        if !Len(Item) Then Item = \"\"\xFE";
 z+="                    Else\xFE";
 z+="                        Read Item From F_File, IName Else NewItem = True\xFE";
 z+="                    End If\xFE";
 z+="                End Else\xFE";
 z+="                    i_ReadJson Item From F_File, IName Then\xFE";
 z+="                        If hasTag(Item, \"ItemContent\") And UBound(Item) = 2 Then Item = Item.ItemContent\xFE";
 z+="                        if !Len(Item) Then Item = \"\"\xFE";
 z+="                    Else\xFE";
 z+="                        i_Read Item From F_File, IName Else NewItem = True\xFE";
 z+="                    End If\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                If NewItem Then\xFE";
 z+="                    Call editor_removeFromRecentList(trueTblName, IName)\xFE";
 z+="                Else\xFE";
 z+="                    Call editor_updateRecentList(trueTblName, IName)\xFE";
 z+="                    If isValidJSON(Item) Then Item = CJSon(Item)\xFE";
 z+="                    If isArray(Item) Then Item = \"[\" : Join(Item, \",\":am()) : \"]\"\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                If NewItem And HDoc And Ext <> \"HTM\" And Ext <> \"HTML\" Then\xFE";
 z+="                    IName = IName:\".HTM\"\xFE";
 z+="                    \xFE";
 z+="                    Read Item From F_File, IName Then\xFE";
 z+="                        NewItem = False\xFE";
 z+="                    Else\xFE";
 z+="                        Item     = `* Category: BASIC Language|New Docs<br><br>`\xFE";
 z+="                        Item<-1> = `The XXXXX function will <br>`\xFE";
 z+="                        Item<-1> = `<br>`\xFE";
 z+="                        Item<-1> = `&lt;example&gt;<br>`\xFE";
 z+="                        If Instr(IName, \"tcl\") Then\xFE";
 z+="                            Item<-1> = `&nbsp;&nbsp;&nbsp;TCL&gt; Echo Hi`\xFE";
 z+="                        Else\xFE";
 z+="                            Item<-1> = `&nbsp;&nbsp;&nbsp;Print @cols2(\"90px\", \"here is one\", \"100px\", \"here is another\")`\xFE";
 z+="                        End If\xFE";
 z+="                        Item<-1> = `<br><br>&lt;/example&gt;<br>`\xFE";
 z+="                    End If\xFE";
 z+="                End If\xFE";
 z+="            \xFE";
 z+="                If NewItem Then Msg = \"New item\"\xFE";
 z+="            \xFE";
 z+="                UseNicEditor = 0\xFE";
 z+="                useAceEditor = 0\xFE";
 z+="                useTextArea = 0\xFE";
 z+="                \xFE";
 z+="                If Instr(UCase(Options), 'I') Then\xFE";
 z+="                    UseTextArea = True\xFE";
 z+="                \xFE";
 z+="                ElseIf Instr(UCase(Options), 'C') Then\xFE";
 z+="                    UseCodeMirror = True\xFE";
 z+="                \xFE";
 z+="                ElseIf Instr(Options, 'A') Then\xFE";
 z+="                    UseAceEditor = True\xFE";
 z+="                   \xFE";
 z+="                ElseIf Instr(Item, \"<head\") Or Instr(Item, \"<html\") Then\xFE";
 z+="                    UseNicEditor = Instr(Options, 'N')\xFE";
 z+="                    useAceEditor = !useNicEditor\xFE";
 z+="                Else\xFE";
 z+="                    UseNicEditor = HDoc Or isHtmlDoc(Dictdata, TableName, IName) Or Instr(Options, 'N') \xFE";
 z+="                    useAceEditor = !useNicEditor\xFE";
 z+="                End If\xFE";
 z+="        \xFE";
 z+="                Item = CleanUpText(Item)\xFE";
 z+="                Item = Change(Item, Chr(28), am())\xFE";
 z+="                Item = Change(Item, Chr(29), am()) \xFE";
 z+="                \xFE";
 z+="                If UseNicEditor Then\xFE";
 z+="                    Item = Change(Item, \"<br />\", \"<br>\")\xFE";
 z+="                    Item = Change(Item, \"<br/>\", \"<br>\")\xFE";
 z+="                    Item = Change(Item, \"</div >\", \"</div>\")\xFE";
 z+="                    If Instr(Item, \"<br>\") = 0 Then Item = Change(Item, am(), \"<br>\") Else Item = Change(Item, am(), Chr(10))\xFE";
 z+="                    Item = Change(Item, \"< \", \"&lt; \") ;* If It's not a tag\xFE";
 z+="                    \xFE";
 z+="                    ' Change > to &gt; if it's not part of a tag\xFE";
 z+="                    P = 1\xFE";
 z+="                    Loop\xFE";
 z+="                        Np = Instr(P, Item, \"<\")\xFE";
 z+="                        If !Np Then Np = Len(Item) + 1\xFE";
 z+="                        Loop\xFE";
 z+="                            Nc = Instr(P, Item, \">\")\xFE";
 z+="                        While Nc > 0 And Nc < Np Do\xFE";
 z+="                            Item = Left(Item, Nc-1):\"&gt;\":Mid(Item, Nc+1)\xFE";
 z+="                        Repeat\xFE";
 z+="                        \xFE";
 z+="                    While Np <= Len(Item) Do\xFE";
 z+="                        ' move p to next <tag\xFE";
 z+="                        P = Np + 1\xFE";
 z+="            \xFE";
 z+="                        Tag = Mid(Item, P, 50)\xFE";
 z+="                        Tag = Field(Tag, \"/>\", 1)\xFE";
 z+="                        Tag = Field(Tag, \">\", 1)\xFE";
 z+="                        Tag = Field(Tag, \" \", 1)\xFE";
 z+="                        If Left(Tag, 1) = \"/\" Or Tag = \"blockquote\" Or Tag = \"br\" Or Tag = \"span\" Or Tag = \"font\" Or Tag = \"div\" Or Tag = \"input\" Then\xFE";
 z+="                            P = Instr(P, Item, \">\") + 1\xFE";
 z+="                        End If\xFE";
 z+="                    Repeat\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                // Auto format?\xFE";
 z+="                Af = Instr(Item, \"*\x20EDITOR-OPTION: AUTOFORMAT\")\xFE";
 z+="                If Af > 0 And Af < 3000 Then \xFE";
 z+="                    Item = CStr(FormatCode(Item, 4, false))\xFE";
 z+="                    \xFE";
 z+="                ElseIf isValidJSON(Item) Then\xFE";
 z+="                    J = CJSon(Item)\xFE";
 z+="                    If TypeOf(J) = \"Array\" Then\xFE";
 z+="                        Pp = { pp: J }\xFE";
 z+="                        Item = CStr(Pp)\xFE";
 z+="                        Item = \"[{\":DropLeft(DropLeft(Item, \"[\"), \"{\")\xFE";
 z+="                        Item = DropRight(Item, \"}\")\xFE";
 z+="                        Item = Replace(Item, am(), crlf())\xFE";
 z+="                        Item = Replace(Item, crlf():Chr(9):Chr(9), crlf())\xFE";
 z+="                        Item = Replace(Item, crlf():Space(8), crlf())\xFE";
 z+="                    Else\xFE";
 z+="                        Item = CStr(J)\xFE";
 z+="                    End If\xFE";
 z+="                    item = cleanuptext(item) // convert crlf() back to am()\xFE";
 z+="                End If\xFE";
 z+="                    \xFE";
 z+="                PreRun = \"\"\xFE";
 z+="                Rawitem = Item\xFE";
 z+="            end if\xFE";
 z+="     \xFE";
 z+="            Print @(-1):PreRun: ;* // @jsb_bf.theme('flatly'):\xFE";
 z+="            PreRun = \"\"\xFE";
 z+="        \xFE";
 z+="            // Force PostBack into btn\xFE";
 z+="            // HTMLMenuBar = HTMLMenuBar:@genEventHandler(\"SelectMenu\", Null, 7, 'btn')\xFE";
 z+="            \xFE";
 z+="            If UseAceEditor Then\xFE";
 z+="                HTMLMenuBar := @Script(`\xFE";
 z+="                   function CheckUnDoReDo(preform) {\xFE";
 z+="                        if (!aceEditor) {\xFE";
 z+="                            clearInterval(undoRedoTimer)\xFE";
 z+="                            return\xFE";
 z+="                        }\xFE";
 z+="                        \xFE";
 z+="                        var um = aceEditor.getSession().getUndoManager();\xFE";
 z+="                        \xFE";
 z+="                        if (preform) {\xFE";
 z+="                            if (preform == 'Undo') {\xFE";
 z+="                                if (um.hasUndo()) um.undo(); else alert('no more undos');\xFE";
 z+="                                \xFE";
 z+="                            } else if (preform == 'Redo') {\xFE";
 z+="                                 if (um.hasRedo()) um.redo(); else alert('no more redos');\xFE";
 z+="                            }\xFE";
 z+="                        }\xFE";
 z+="                        \xFE";
 z+="                        var hasUndo = um.hasUndo();\xFE";
 z+="                        var hasRedo = um.hasRedo();\xFE";
 z+="                        \xFE";
 z+="                        $('#Undo').css('pointer-events', hasUndo?'all':'none').css('opacity', hasUndo?1:0.6);\xFE";
 z+="                        $('#Redo').css('pointer-events', hasRedo?'all':'none').css('opacity', hasRedo?1:0.6);\xFE";
 z+="                   }\xFE";
 z+="                   \xFE";
 z+="                   var undoRedoTimer = setInterval(CheckUnDoReDo, 500);\xFE";
 z+="                `)\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="        *\xFE";
 z+="        * Display Text Area\xFE";
 z+="        *\xFE";
 z+="            Txt = Item\xFE";
 z+="            If UseNicEditor Then\xFE";
 z+="                // If Instr(Txt, \"<br>\") = 0 Then Txt = Change(Txt, am(), \"<br>\") Else Txt = Change(Txt, am(), crlf())\xFE";
 z+="                Cm = @Jsb_html.nicEditor(edtName, Txt)\xFE";
 z+="            End Else\xFE";
 z+="                Txt = Change(Txt, am(), crlf())\xFE";
 z+="                If Instr(UCase(Options), 'I') Then\xFE";
 z+="                    Cm = @Jsb_html.TEXTAREA(edtName, Txt, 25, 120)\xFE";
 z+="        \xFE";
 z+="                ElseIf Instr(UCase(Options), 'C') Then\xFE";
 z+="                    Txt = @Htmlencode(Txt)\xFE";
 z+="                    Cm = @Jsb_html.codemirror(edtName, Txt)\xFE";
 z+="                Else\xFE";
 z+="                    Txt = @Htmlencode(Txt)\xFE";
 z+="                    Cm = @Jsb_html.aceEditor(edtName, Txt, fromLineNo)\xFE";
 z+="                    \xFE";
 z+="                    Cm := @Hidden(edtName:'_searchFor', searchFor)\xFE";
 z+="                    Cm := @Hidden(edtName:'_replaceWith', replaceWith)\xFE";
 z+="                    Cm := @Hidden(edtName:'_regExpSearch', regExpSearch)\xFE";
 z+="                    Cm := @Hidden(edtName:'_caseSensitiveSearch', caseSensitiveSearch)\xFE";
 z+="                    Cm := @Hidden(edtName:'_wholeWordSearch', wholeWordSearch)\xFE";
 z+="                    Cm := @Hidden(edtName:'_replaceOpen', replaceOpen)\xFE";
 z+="                    Cm := @Hidden(edtName:'_findOpen', findOpen)\xFE";
 z+="        \xFE";
 z+="                    * Cm = CM:@addAceCompletetions()\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            Cmds = \" ed \":Fname:\" \":IName:\" (\":Dcount(Item, am()):\" Lines) \":Chr(28):\" \":Chr(29)\xFE";
 z+="            If isSqlServer(F_File) Then Cmds := ' *SQL*'\xFE";
 z+="        \xFE";
 z+="            If Instr(Msg, \"!\") Then\xFE";
 z+="                If Left(Msg, 1) = \"!\" Then Msg=Mid(Msg, 2)\xFE";
 z+="                @MsgBox(\"Message\", Msg, \"OK\");\xFE";
 z+="                Msg = \"\"\xFE";
 z+="            Else If Msg Then\xFE";
 z+="                Cmds = Cmds:\" *\":Msg:\"*\"\xFE";
 z+="            End If\xFE";
 z+="        \xFE";
 z+="            * Options: Fixed (!resizable, !slidable, !closable),  minSize:int, maxSize:int, startsize:int, initClosed, initHidden, allowOverFlow\xFE";
 z+="            Print @Layout(Cm, HTMLMenuBar, \"startsize:\":MenuHeight + 2:\", allowoverflow, Fixed\", Cmds, \"startsize:26, Fixed\", '', '', '', ''):\xFE";
 z+="        \xFE";
 z+="            Print @Script(`\xFE";
 z+="                function doEditorPostBack(event, command) {\xFE";
 z+="                   if (!event) event = window,event;\xFE";
 z+="                   preventTheDefault(event);\xFE";
 z+="                   $(window).unbind('keydown', window.editorKeyDown);\xFE";
 z+="                   assignBtn('btn', command)\xFE";
 z+="                   doJsbSubmit();\xFE";
 z+="                }\xFE";
 z+="            `):\xFE";
 z+="            \xFE";
 z+="            * Capture Control-S, make it postback\xFE";
 z+="            Print @Script(`\xFE";
 z+="                function editorKeyDown(event) {\xFE";
 z+="                   if (event.ctrlKey || event.metaKey) {\xFE";
 z+="                       switch (String.fromCharCode(event.which).toLowerCase()) {\xFE";
 z+="                           case 's':\xFE";
 z+="                               doEditorPostBack(event, 'Save'); break\xFE";
 z+="                           case 'k':\xFE";
 z+="                               doEditorPostBack(event, 'Format'); break\xFE";
 z+="                           case 'b':\xFE";
 z+="                               doEditorPostBack(event, 'Build'); break\xFE";
 z+="                           case 'r':\xFE";
 z+="                               doEditorPostBack(event, 'Run'); break\xFE";
 z+="                           case 'd':\xFE";
 z+="                               doEditorPostBack(event, 'Debug'); break\xFE";
 z+="                       }\xFE";
 z+="                   } else {\xFE";
 z+="                       if (event.key == \"F5\") doEditorPostBack(event, 'Run');\xFE";
 z+="                   }\xFE";
 z+="                }\xFE";
 z+="                \xFE";
 z+="                $(window).bind('keydown', editorKeyDown);\xFE";
 z+="            `):\xFE";
 z+="        \xFE";
 z+="            @Server.pause\xFE";
 z+="        *\xFE";
 z+="            fromLineNo = @FormVar(edtName:'_lineNo')\xFE";
 z+="            searchFor = @FormVar(edtName:'_searchFor')\xFE";
 z+="            replaceWith = @FormVar(edtName:'_replaceWith')\xFE";
 z+="            regExpSearch = Val(@FormVar(edtName:'_regExpSearch'))\xFE";
 z+="            caseSensitiveSearch = Val(@FormVar(edtName:'_caseSensitiveSearch'))\xFE";
 z+="            wholeWordSearch = Val(@FormVar(edtName:'_wholeWordSearch'))\xFE";
 z+="            replaceOpen = Val(@FormVar(edtName:'_replaceOpen'))\xFE";
 z+="            findOpen = Val(@FormVar(edtName:'_findOpen'))\xFE";
 z+="        \xFE";
 z+="            Txt = @FormVar(edtName)\xFE";
 z+="            Btn = @FormVar(\"btn\"):@FormVar(\"SelectedMenu\")\xFE";
 z+="            If Txt <> Chr(27) Then Item = Txt \xFE";
 z+="        *\xFE";
 z+="            Item = CleanupText(Item, True)\xFE";
 z+="            \xFE";
 z+="            \xFE";
 z+="            Item = Change(Item, Chr(13):Chr(10), Chr(10))\xFE";
 z+="            \xFE";
 z+="            If UseNicEditor Then\xFE";
 z+="                Item = Change(Item, \"<br />\", \"<br>\")\xFE";
 z+="                Item = Change(Item, \"<br/>\", \"<br>\")\xFE";
 z+="                Item = Change(Item, \"</div >\", \"</div>\")\xFE";
 z+="                Item = Change(Item, \"< \", \"&lt; \") ;* If It's not a tag\xFE";
 z+="                \xFE";
 z+="                // Get rid of nested DIV's - they come from cutting and pasting\xFE";
 z+="                docDIV = '<div class=\"docExample\">'\xFE";
 z+="                Item = Change(Item, `</div>`:docDIV, `<br>`)\xFE";
 z+="                \xFE";
 z+="                Di = 0\xFE";
 z+="                Loop\xFE";
 z+="                    Di = Instr(Di+1, Item, docDIV)\xFE";
 z+="                While Di Do\xFE";
 z+="                    Ndd = Instr(Di+1, Item, docDIV)\xFE";
 z+="                    If !Ndd Then Break\xFE";
 z+="                    \xFE";
 z+="                    Ned = Instr(Di, Item, \"</div>\")\xFE";
 z+="                    If !Ned Then Break\xFE";
 z+="                    \xFE";
 z+="                    If Ndd < Ned Then\xFE";
 z+="                        ' Example DIV embedded in another - remove inner one\xFE";
 z+="                        Item = Left(Item, Ndd-1): Mid(Item, Ndd + Len(docDIV))\xFE";
 z+="                        Ned = Instr(Di, Item, \"</div>\")\xFE";
 z+="                        Item = Left(Item, Ned-1): \"<br>\" : Mid(Item, Ned + Len('</div>'))\xFE";
 z+="                    End If\xFE";
 z+="                Repeat\xFE";
 z+="            \xFE";
 z+="            ElseIf isValidJSON(Item) Then\xFE";
 z+="                Item = Change(Item, Chr(13):Chr(10), Chr(10))\xFE";
 z+="                \xFE";
 z+="            Else\xFE";
 z+="                Item = Change(Item, Chr(13), am())\xFE";
 z+="                Item = Change(Item, Chr(10), am())\xFE";
 z+="            End If\xFE";
 z+="        *\xFE";
 z+="        * Exit (ALL)\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Exit!\" Then\xFE";
 z+="                Inames = []\xFE";
 z+="                Stop\xFE";
 z+="            End If\xFE";
 z+="        \xFE";
 z+="            If Btn = \"Detach\" Then\xFE";
 z+="                If Item <> Rawitem Then\xFE";
 z+="                    TrashIt(Fname, IName) ;* Fname Contains Dict If Necessary\xFE";
 z+="                    If Externalopen Then\xFE";
 z+="                        If isValidJSON(Item) Then\xFE";
 z+="                            Writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        Else\xFE";
 z+="                            Write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        End If\xFE";
 z+="                    Else If isValidJSON(Item) Then\xFE";
 z+="                        I_writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    Else\xFE";
 z+="                        I_write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    End If\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                Print @Script(`\xFE";
 z+="                        window.top.open(\"`:@JSBRootAct:`?`:@UrlEncode('ED ':fname:' ':INAME:' (':fromLineNo):`\", \"_blank\");\xFE";
 z+="                    `):\xFE";
 z+="                @Server.Flush\xFE";
 z+="                Break\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            If Btn = \"Who\" Then Msg = Who()\xFE";
 z+="        *\xFE";
 z+="        * Exit\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Exit\" Then\xFE";
 z+="                If Item <> Rawitem Then\xFE";
 z+="                    If Len(Item) > 100000 And System(1) <> \"js\" Then Print @(-1): ;* Save Some Bandwidth\xFE";
 z+="                    Ans = @MsgBox(\"Confirm Exit\", IName:\" has changed, save before exiting? \", \"*Yes,No,Cancel,Compare\")\xFE";
 z+="                    If Ans = \"No\" Then Break\xFE";
 z+="                    If Ans = \"Yes\" Then Btn = \"Save>\"\xFE";
 z+="                    \xFE";
 z+="                    If Ans = \"Compare\" Then\xFE";
 z+="                        Print @(-1):\xFE";
 z+="                        Call @jsb_Tcl.doCompare([IName:\" Edited Version\", IName:\" Original\"], Item, Rawitem,  False /* REMOVECOMMENTS */,  False /* Trim */, False /* IgnoreComments */, False /* Show Changes */, False /* show only Difs */,  2 /* how much */, 1 /* out method */, 132 /* Width */, NoChanges)\xFE";
 z+="        \xFE";
 z+="                        Print @Submitbtn(\"Btn\", \"Back to editor\"):\" \":@Submitbtn(\"Btn\", \"Save Edits\"):\" \":@Submitbtn(\"Btn\", \"Exit\"):\" \":\xFE";
 z+="                        @Server.Pause\xFE";
 z+="                        If FormVar('Btn') = \"Exit\" Then Break\xFE";
 z+="                        If FormVar('Btn') = \"Save Edits\" Then Btn = \"Save>\"\xFE";
 z+="                    End If\xFE";
 z+="                End Else\xFE";
 z+="                    Break\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        \xFE";
 z+="            If Btn = \"Reload\" Then\xFE";
 z+="                If Item <> Rawitem Then\xFE";
 z+="                    If Len(Item) > 100000 And System(1) <> \"js\" Then Print @(-1): ;* Save Some Bandwidth\xFE";
 z+="                    Ans = @MsgBox(\"Confirm Reload\", IName:\" has changed, do you want to save first? \", \"*Yes,No,Cancel\")\xFE";
 z+="                    If Ans = \"Yes\" Then\xFE";
 z+="                        TrashIt(Fname, IName) ;* Fname Contains Dict If Necessary\xFE";
 z+="                        If Externalopen Then\xFE";
 z+="                            If isValidJSON(Item) Then\xFE";
 z+="                                Writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                            Else\xFE";
 z+="                                Write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                            End If\xFE";
 z+="                        Else If isValidJSON(Item) Then \xFE";
 z+="                            I_writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        Else\xFE";
 z+="                            I_write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        End If\xFE";
 z+="                        Rawitem = Item\xFE";
 z+="                        Msg = IName:\" Saved\"\xFE";
 z+="                        Call editor_updateRecentList(trueTblName, IName)\xFE";
 z+="                    End If\xFE";
 z+="                    If Ans = \"Cancel\" Or Ans = \"\" Then Cycle ; // Redisplay\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                loadItem = True\xFE";
 z+="                Break\xFE";
 z+="            End If\xFE";
 z+="        *\xFE";
 z+="        * Delete\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Delete\" Then\xFE";
 z+="                If Len(Item) > 100000 And System(1) <> \"js\" Then Print @(-1): ;* Save Some Bandwidth\xFE";
 z+="                Ans = @MsgBox(\"Confirm Delete\", \"Are you sure you want to Delete \":IName:\"?\", \"Yes,*Cancel\")\xFE";
 z+="                If Ans = \"Yes\" Then\xFE";
 z+="                    TrashIt(Fname, IName) ;* Fname Contains Dict If Necessary\xFE";
 z+="                    Delete F_File, IName Then\xFE";
 z+="                        Print @(-1):\xFE";
 z+="                        Call editor_removeFromRecentList(trueTblName, IName)\xFE";
 z+="                        Break\xFE";
 z+="                    End Else\xFE";
 z+="                        Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    End If\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        *\xFE";
 z+="        * Restore\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Restore\" Then\xFE";
 z+="                If Len(Item) > 100000 And System(1) <> \"js\" Then Print @(-1): ;* Save Some Bandwidth\xFE";
 z+="                if !previousVersionNumber(Fname, IName) Then\xFE";
 z+="                    msgbox(\"Sorry, I couln't find a previous version\")\xFE";
 z+="                else\xFE";
 z+="                    Ans = @MsgBox(\"Confirm Restore\", \"Restore the previous version of \":IName:\"?\", \"Yes,*Cancel\")\xFE";
 z+="                    If Ans = \"Yes\" Then\xFE";
 z+="                        unTrashIt(Fname, IName) ;* Fname Contains Dict If Necessary\xFE";
 z+="                        loadItem = True\xFE";
 z+="                        Break\xFE";
 z+="                    End If\xFE";
 z+="                end if\xFE";
 z+="            End If\xFE";
 z+="        *\xFE";
 z+="        * Save As\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Save As\" Then\xFE";
 z+="                Ans = @InputBox(\"Item \":IName, \"Save a copy as: \")\xFE";
 z+="                If Ans = \"\" Or Ans = Chr(27) Then Cycle ; // Redisplay\xFE";
 z+="                Read Exists From F_File, Ans Then\xFE";
 z+="                    If Len(Item) > 100000 And System(1) <> \"js\" Then Print @(-1): ;* Save Some Bandwidth\xFE";
 z+="                    If @MsgBox(\"Confirm\", Ans:\" already exists on file, overwrite?\", \"Yes,*Cancel\") <> \"Yes\" Then Cycle ; // Redisplay\xFE";
 z+="                End If\xFE";
 z+="                TrashIt(Fname, Ans) ;* Fname Contains Dict If Necessary\xFE";
 z+="                \xFE";
 z+="                If Externalopen Then\xFE";
 z+="                    If isValidJSON(Item) Then\xFE";
 z+="                        Writejson Item On F_File, Ans Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    Else\xFE";
 z+="                        Write Item On F_File, Ans Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    End If\xFE";
 z+="                Else If isValidJSON(Item) Then\xFE";
 z+="                    I_writejson Item On F_File, Ans Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                Else\xFE";
 z+="                    I_write Item On F_File, Ans Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                Rawitem = Item\xFE";
 z+="                IName = Ans\xFE";
 z+="                Msg = IName:\" Saved\"\xFE";
 z+="                Call editor_updateRecentList(trueTblName, IName)\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            If  Btn = \"Rename\" Then\xFE";
 z+="                Ans = @InputBox(\"Item \":IName, \"Rename as: \", IName)\xFE";
 z+="                If Ans = \"\" Or Ans = Chr(27) Then Cycle ; // Redisplay\xFE";
 z+="                Read Exists From F_File, Ans Then\xFE";
 z+="                    If Len(Item) > 100000 And System(1) <> \"js\" Then Print @(-1): ;* Save Some Bandwidth\xFE";
 z+="                    If @MsgBox(\"Confirm\", Ans:\" already exists on file, overwrite?\", \"Yes,*Cancel\") <> \"Yes\" Then Cycle ; // Redisplay\xFE";
 z+="                    TrashIt(Fname, Ans) ;* Fname Contains Dict If Necessary\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                If Externalopen Then\xFE";
 z+="                    If isValidJSON(Item) Then\xFE";
 z+="                        Writejson Item On F_File, Ans Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    Else\xFE";
 z+="                        Write Item On F_File, Ans Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    End If\xFE";
 z+="                    Delete F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                Else If isValidJSON(Item) Then\xFE";
 z+="                    I_writejson Item On F_File, Ans Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    i_DELETE F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                Else\xFE";
 z+="                    I_write Item On F_File, Ans Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    i_DELETE F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                End If\xFE";
 z+="                Rawitem = Item\xFE";
 z+="                \xFE";
 z+="                Call editor_removeFromRecentList(trueTblName, IName)\xFE";
 z+="                Call editor_updateRecentList(trueTblName, Ans)\xFE";
 z+="        \xFE";
 z+="                IName = Ans\xFE";
 z+="                Msg = Ans:\" Renamed\"\xFE";
 z+="            End If\xFE";
 z+="        *\xFE";
 z+="        * Save>\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Save\" Or Btn = \"Save>\" Then\xFE";
 z+="                TrashIt(Fname, IName) ;* Fname Contains Dict If Necessary\xFE";
 z+="                Msg = IName:\" Saved\"\xFE";
 z+="                If Externalopen Then\xFE";
 z+="                    If isValidJSON(Item) Then\xFE";
 z+="                        Writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        Msg := \" as JSON\"\xFE";
 z+="                    Else\xFE";
 z+="                        Write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    End If\xFE";
 z+="                Else If isValidJSON(Item) Then\xFE";
 z+="                    I_writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                    Msg := \" as JSON\"\xFE";
 z+="                Else\xFE";
 z+="                    I_write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                End If\xFE";
 z+="                Rawitem = Item\xFE";
 z+="                \xFE";
 z+="                Call editor_updateRecentList(trueTblName, IName)\xFE";
 z+="                \xFE";
 z+="                If Btn = \"Save>\" Then Print @(-1):; Break\xFE";
 z+="            End If\xFE";
 z+="        *\xFE";
 z+="        * Compile\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Compile\" Or Btn = \"Compile>\" Or Btn = \"Run\" Or Btn = \"Debug\" Or Btn = \"PC\" Or Btn = \"PC>\" Then\xFE";
 z+="                If Right(LCase(IName), 3) = \".js\" Then Msg = \"!I don't compile javascript\"; Cycle ; // Redisplay\xFE";
 z+="                \xFE";
 z+="                If System(1) = \"js\" Then\xFE";
 z+="                    ActRun = \"run\"\xFE";
 z+="                    window.Commons_JSB_BF.Dbg_Lastfname = \"\"\xFE";
 z+="                Else\xFE";
 z+="                    ActRun = \"aexecute\"\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                If HDoc Then\xFE";
 z+="                    ErrCnt = @ExtractExamples(IName, Item, ExampleName)\xFE";
 z+="                    If ErrCnt = 0 Then\xFE";
 z+="                        TrashIt(Fname, IName) ;* Fname Contains Dict If Necessary\xFE";
 z+="                        If Externalopen Then\xFE";
 z+="                            If isValidJSON(Item) Then\xFE";
 z+="                                Writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                            Else\xFE";
 z+="                                Write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                            End If\xFE";
 z+="                        Else If isValidJSON(Item) Then\xFE";
 z+="                            I_writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        Else\xFE";
 z+="                            I_write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        End If\xFE";
 z+="                        Rawitem = Item\xFE";
 z+="                        \xFE";
 z+="                        Call editor_updateRecentList(trueTblName, IName)\xFE";
 z+="                        \xFE";
 z+="                        If Btn = \"Run\" Then\xFE";
 z+="                            Print @popoutWindow(\"example\",  jsbRootExecuteTclCmd(ActRun:\" examples \":ExampleName), True, \"80%\", \"60%\"):\xFE";
 z+="                        End If\xFE";
 z+="                    End If\xFE";
 z+="                Else\xFE";
 z+="                    If Item <> Rawitem Then\xFE";
 z+="                        TrashIt(Fname, IName) ;* Fname Contains Dict If Necessary\xFE";
 z+="                        If Externalopen Then\xFE";
 z+="                            If isValidJSON(Item) Then\xFE";
 z+="                                Writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                            Else\xFE";
 z+="                                Write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                            End If\xFE";
 z+="                        Else If isValidJSON(Item) Then\xFE";
 z+="                            I_writejson Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        Else\xFE";
 z+="                            I_write Item On F_File, IName Else Msg = \"!\":@Errors; Cycle ; // Redisplay\xFE";
 z+="                        End If\xFE";
 z+="                        \xFE";
 z+="                        Call editor_updateRecentList(trueTblName, IName)\xFE";
 z+="                        Rawitem = Item\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    If Btn = \"PC\" Or Btn = \"PC>\" Then\xFE";
 z+="                        Execute \"PC \":Fname:\" \":IName Capturing XMsg\xFE";
 z+="                    Else\xFE";
 z+="                        Execute \"BASIC \":Fname:\" \":IName Capturing XMsg\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    If Instr(XMsg, Chr(14)) Then ' Errors\xFE";
 z+="                        ELine = Field(XMsg, Chr(14), 2)\xFE";
 z+="                        fromLineNo = Field(ELine, ' ', 1)\xFE";
 z+="                        ELine = Mid(ELine, Col2()+1)\xFE";
 z+="                        ErrCnt = 1\xFE";
 z+="                        Msg = \"!Error: \":ELine\xFE";
 z+="                        \xFE";
 z+="                    ElseIf Instr(XMsg, Chr(15)) Then ' Warnings\xFE";
 z+="                        ELine = Field(XMsg, Chr(15), 2)\xFE";
 z+="                        fromLineNo = Field(ELine, ' ', 1)\xFE";
 z+="                        ELine = Mid(ELine, Col2()+1)\xFE";
 z+="                        ErrCnt = 1\xFE";
 z+="                        Msg = ELine\xFE";
 z+="                        If Btn = \"Compile>\" Then Print @(-1):\"Warnings: \":ELine; Break\xFE";
 z+="                        If Len(Item) > 100000 And System(1) <> \"js\" Then Print @(-1): ;* Save Some Bandwidth\xFE";
 z+="                        @MsgBox(ELine)\xFE";
 z+="                        \xFE";
 z+="                    ElseIf Instr(XMsg, \"^\") Then\xFE";
 z+="                        XMsg = Replace(XMsg, crlf(), am())\xFE";
 z+="                        XMsg = Replace(XMsg, Chr(13), am())\xFE";
 z+="                        XMsg = Replace(XMsg, Chr(10), am())\xFE";
 z+="                        XMsg = DropTags(XMsg)\xFE";
 z+="                        \xFE";
 z+="                        P = Instr(XMsg, \"^\")\xFE";
 z+="                        \xFE";
 z+="                        ErrCnt = 1\xFE";
 z+="                        \xFE";
 z+="                        LineNo = Dcount(XMsg[1, P], am())\xFE";
 z+="                        BLine = XMsg<LineNo-1>\xFE";
 z+="                        ELine = XMsg<LineNo>\xFE";
 z+="                        ALine = XMsg<LineNo+1>\xFE";
 z+="                        \xFE";
 z+="                        fromLineNo = Val(ELine)\xFE";
 z+="                        If !fromLineNo Then fromLineNo = Val(BLine)\xFE";
 z+="                        \xFE";
 z+="                        Msg = \"!\":BLine:crlf():ELine:crlf():ALine\xFE";
 z+="                    Else\xFE";
 z+="                        ErrCnt = 0\xFE";
 z+="                        Msg = \"Sucessful compile\"\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    If (Btn = \"Compile>\" Or Btn = \"PC>\") And ErrCnt = 0 Then Print @(-1):\"SUCCESSFUL Compile>\":; Break\xFE";
 z+="                    \xFE";
 z+="                    XMsg = LCase(XMsg)\xFE";
 z+="                    if system(1) = \"js\" then\xFE";
 z+="                        OKToRun = InStrI(XMsg, Chr(29):IName:\".js\":Chr(28))\xFE";
 z+="                    else\xFE";
 z+="                        OKToRun = InStrI(XMsg, LCase(Fname:\" \":IName:\".pcd\"))\xFE";
 z+="                    end if\xFE";
 z+="                    \xFE";
 z+="                    if OKToRun And ErrCnt = 0 Then\xFE";
 z+="                        If Btn = \"Run\" Then\xFE";
 z+="                            Print @popoutWindow(\"example\",  jsbRootExecuteTclCmd(ActRun:\" \":Fname:\" \":IName), True, \"90%\", \"80%\"):\xFE";
 z+="                        ElseIf Btn = \"Debug\"Then\xFE";
 z+="                            Print @popoutWindow(\"example\",  jsbRootExecuteTclCmd(ActRun:\" \":Fname:\" \":IName:\" ($$\"), True, \"90%\", \"80%\"):\xFE";
 z+="                        End If\xFE";
 z+="                        \xFE";
 z+="                    Elseif ErrCnt = 0 And (Btn = \"Run\" Or Btn = \"Debug\") Then\xFE";
 z+="                        MsgBox(\"No PROGRAM code was compiled to run. \":XMsg:\"; '\":LCase(Fname:\" \":IName):\".js\":\"'\" )\xFE";
 z+="                    end if\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        *\xFE";
 z+="        * Format\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Format\" Then\xFE";
 z+="                If isValidJSON(Item) Then\xFE";
 z+="                    J = CJSon(Item)\xFE";
 z+="                    If TypeOf(J) = \"Array\" Then\xFE";
 z+="                        Pp = { pp: J }\xFE";
 z+="                        Item = CStr(Pp)\xFE";
 z+="                        Item = \"[{\":DropLeft(DropLeft(Item, \"[\"), \"{\")\xFE";
 z+="                        Item = DropRight(Item, \"}\")\xFE";
 z+="                        Item = Replace(Item, am(), crlf())\xFE";
 z+="                        Item = Replace(Item, crlf():Chr(9):Chr(9), crlf())\xFE";
 z+="                        Item = Replace(Item, crlf():Space(8), crlf())\xFE";
 z+="                    Else\xFE";
 z+="                        Item = CStr(J)\xFE";
 z+="                    End If\xFE";
 z+="                Else\xFE";
 z+="                    Item = @FormatCode(Item, 4, false)\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        *\xFE";
 z+="        * Sort\xFE";
 z+="        *\xFE";
 z+="            If Btn = \"Sort\" Then \xFE";
 z+="                if MsgBox(\"Sort?\", \"Yes,*No\") = \"Yes\" Then Item = @Sort(Item)\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            If Btn = \"Help\" Then\xFE";
 z+="                Print @Jsb_bf.Dialog('Editor Keyboard Short-Cuts', @jsb_tcl.Editor_HtmlHelp(), True, '80%', '80%')\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="        Repeat // Redisplay same item\xFE";
 z+="        \xFE";
 z+="        // Move on to next item\xFE";
 z+="        reloadItem = True\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    @Session('searchFor') = searchFor\xFE";
 z+="    @Session('replaceWith') = replaceWith\xFE";
 z+="    @Session('regExpSearch') = regExpSearch\xFE";
 z+="    @Session('caseSensitiveSearch') = caseSensitiveSearch\xFE";
 z+="    @Session('wholeWordSearch') = wholeWordSearch\xFE";
 z+="    @Session('replaceOpen') = replaceOpen\xFE";
 z+="    @Session('findOpen') = findOpen\xFE";
 z+="            \xFE";
 z+="    If @ParamVar('fromPage') Then @Response.Redirect(@ParamVar('fromPage'))\xFE";
 z+="    @Response.buffer(saveScreen)\xFE";
 z+="    \xFE";
 z+="    If Errors # '' Then Print Monospace(Replace(Errors, am(), crlf()))\xFE";
 z+="    \xFE";
 z+="    Print @Script(\"if (parent.refreshData) parent.refreshData();\"):Msg\xFE";
 z+="    \xFE";
 z+="    If @hasTclParent Or @hasParentProcess Or Errors Then Stop\xFE";
 z+="    \xFE";
 z+="    @Server.End // cause page close\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Program Aexecute\xFE";
 z+="    If !@IsAdmin Then Stop \"You must be an admnistrator to run this code\"\xFE";
 z+="    Execute Replacei(Replace(@Sentence, \"($$\", \"(!\"), 'aexecute', 'run')\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="* <1> comment\xFE";
 z+="* <2> tblname]itemid]itemid]...\xFE";
 z+="* <3> ...\xFE";
 z+="Sub editor_updateRecentList(TableName, Itemname)\xFE";
 z+="    If !TableName Then Return\xFE";
 z+="    \xFE";
 z+="    If System(1) = \"js\" Then Username = \"javascript\" Else Username = @Username\xFE";
 z+="    Read recentList From @fHandle(\"\", \"jsb_selectlists\", True), \"EdRecentList_\":UserName Else recentList = \"Recent\"\xFE";
 z+="\xFE";
 z+="    For Each tblName, I In Split(recentList, am())\xFE";
 z+="        tblName = tblName<1,1>\xFE";
 z+="        If I > 1 And LCase(tblName) = LCase(TableName) Then Spot = I; Break\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    If Spot Then\xFE";
 z+="        L = recentList<Spot>\xFE";
 z+="        recentList = Delete(recentList, Spot)\xFE";
 z+="        recentList<2> = L:am():recentList<2>\xFE";
 z+="    Else\xFE";
 z+="        recentList<2> = TableName:am():recentList<2>\xFE";
 z+="        \xFE";
 z+="        Loop While Dcount(recentList, am()) > 8 Do\xFE";
 z+="            recentList = Delete(recentList, 9)\xFE";
 z+="        Repeat\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    MyItemIDs = recentList<2>\xFE";
 z+="    MyItemIDs = Delete(MyItemIDs, 1, 1) ;* Drop TableName\xFE";
 z+="    Locate Itemname In MyItemIDs<1> Setting Spot2 Then\xFE";
 z+="        If Spot2 = 1 And Spot = 2 Then Return ;* No Change\xFE";
 z+="        MyItemIDs = Delete(MyItemIDs, 1, Spot2)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Len(MyItemIDs) Then MyItemIDs = Itemname:vm():MyItemIDs Else MyItemIDs = Itemname\xFE";
 z+="\xFE";
 z+="    recentList<2> = TableName:vm():MyItemIDs\xFE";
 z+="    Write recentList On @fHandle(\"\", \"jsb_selectlists\", True), \"EdRecentList_\":UserName Else Null\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="Sub editor_removeFromRecentList(TableName, Itemname)\xFE";
 z+="    If !TableName Then Return\xFE";
 z+="    Return\xFE";
 z+="    \xFE";
 z+="    If System(1) = \"js\" Then Username = \"javascript\" Else Username = @Username\xFE";
 z+="    Read recentList From @fHandle(\"\", \"jsb_selectlists\", True), \"EdRecentList_\":UserName Else Return\xFE";
 z+="    recentList = Lower(recentList)\xFE";
 z+="\xFE";
 z+="    For Each tblName, I In Split(recentList, vm())\xFE";
 z+="        tblName = tblName<1,1,1>\xFE";
 z+="        If I > 1 And LCase(tblName) = LCase(TableName) Then Spot = I; Break\xFE";
 z+="    Next\xFE";
 z+="    If !Spot Then Return\xFE";
 z+="\xFE";
 z+="    If !Itemname Then\xFE";
 z+="        recentList = Delete(recentList, 1, Spot)\xFE";
 z+="    Else\xFE";
 z+="        MyItemIDs = recentList<1, Spot>\xFE";
 z+="        MyItemIDs = Delete(MyItemIDs, 1, 1, 1)\xFE";
 z+="        Locate Itemname In MyItemIDs<1,1> Setting Spot2 Else Return\xFE";
 z+="\xFE";
 z+="        recentList = Delete(recentList, 1, Spot, Spot2 + 1)\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Write Raise(recentList) On @fHandle(\"\", \"jsb_selectlists\", True), \"EdRecentList_\":UserName Else Null\xFE";
 z+="End Sub\xFE";
 z+="\xFE";
 z+="function Editor_HtmlHelp()\xFE";
 z+="    Return  @Html(`<div style='overflow: auto; height: 98%; width: 99%;'>\xFE";
 z+="      <table> \xFE";
 z+="         <tr><td>Ctl-Space</td><td>Auto Complete</td></tr>\xFE";
 z+="         <tr><td>Ctl-Y</td><td>Cut Line</td></tr>\xFE";
 z+="         <tr><td>Ctl-S</td><td>Save</td></tr>\xFE";
 z+="         <tr><td>Ctl-U or Ctl-Z</td><td>Undo</td></tr>\xFE";
 z+="         <tr><td>Ctl-R</td><td>Redo</td></tr>\xFE";
 z+="         <tr><td>F5</td><td>Run</td></tr>\xFE";
 z+="         <tr><td>Ctl-D</td><td>Debug</td></tr>\xFE";
 z+="         <tr><td>Ctl-B</td><td>Build</td></tr>\xFE";
 z+="         <tr><td>Ctl-K</td><td>Format</td></tr>\xFE";
 z+="         <tr></tr>\xFE";
 z+="        \xFE";
 z+="         <tr><td>Ctrl-,</td><td>Show the settings menu</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Alt-Up</td><td>add multi-cursor above</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Alt-Down</td><td>add multi-cursor below</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Alt-Right</td><td>add next occurrence to multi-selection</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Alt-Left</td><td>add previous occurrence to multi-selection</td></tr>\xFE";
 z+="         <tr><td>Ctrl-L</td><td></td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-U</td><td>change to lower case</td></tr>\xFE";
 z+="         <tr><td>Ctrl-U</td><td>change to upper case</td></tr>\xFE";
 z+="         <tr><td>Alt-Shift-Down</td><td>copy lines down</td></tr>\xFE";
 z+="         <tr><td>Alt-Shift-Up</td><td>copy lines up</td></tr>\xFE";
 z+="         <tr><td>Delete</td><td>delete</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-D</td><td>duplicate selection</td></tr>\xFE";
 z+="         <tr><td>Ctrl-F</td><td>find</td></tr>\xFE";
 z+="         <tr><td>Ctrl-K</td><td>find next</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-K</td><td>find previous</td></tr>\xFE";
 z+="         <tr><td>Alt-0</td><td>fold all</td></tr>\xFE";
 z+="         <tr><td>Alt-L, Ctrl-F1</td><td>fold selection</td></tr>\xFE";
 z+="         <tr><td>Down</td><td>go line down</td></tr>\xFE";
 z+="         <tr><td>Up</td><td>go line up</td></tr>\xFE";
 z+="         <tr><td>Ctrl-End</td><td>go to end</td></tr>\xFE";
 z+="         <tr><td>Left</td><td>go to left</td></tr>\xFE";
 z+="         <tr><td>Ctrl-L</td><td>go to line</td></tr>\xFE";
 z+="         <tr><td>Alt-Right, End</td><td>go to line end</td></tr>\xFE";
 z+="         <tr><td>Alt-Left, Home</td><td>go to line start</td></tr>\xFE";
 z+="         <tr><td>Ctrl-P</td><td>go to matching bracket</td></tr>\xFE";
 z+="         <tr><td>PageDown</td><td>go to page down</td></tr>\xFE";
 z+="         <tr><td>PageUp</td><td>go to page up</td></tr>\xFE";
 z+="         <tr><td>Right</td><td>go to right</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Home</td><td>go to start</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Left</td><td>go to word left</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Right</td><td>go to word right</td></tr>\xFE";
 z+="         <tr><td>Tab</td><td>indent</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Alt-E</td><td>macros recording</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-E</td><td>macros replay</td></tr>\xFE";
 z+="         <tr><td>Alt-Down</td><td>move lines down</td></tr>\xFE";
 z+="         <tr><td>Alt-Up</td><td>move lines up</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Alt-Shift-Up</td><td>move multicursor from current line to the line ab<span style='display:none'>ove</span></td></tr>\xFE";
 z+="         <tr><td>Ctrl-Alt-Shift-Down</td><td>move multicursor from current line to the line be<span style='display:none'>low</span></td></tr>\xFE";
 z+="         <tr><td>Shift-Tab</td><td>outdent</td></tr>\xFE";
 z+="         <tr><td>Insert</td><td>overwrite</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-Z</td><td>redo</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Alt-Shift-Right</td><td>remove current occurrence from multi-selection <span style='display:none'>and move to next</span></td></tr>\xFE";
 z+="\xFE";
 z+="         <tr><td>Ctrl-Alt-Shift-Left</td><td>remove current occurrence from multi-selection <span style='display:none'>and move to previous</span></td></tr>\xFE";
 z+="         <tr><td>Ctrl-D</td><td>remove line</td></tr>\xFE";
 z+="         <tr><td>Alt-Delete</td><td>remove to line end</td></tr>\xFE";
 z+="         <tr><td>Alt-Backspace</td><td>remove to linestart</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Backspace</td><td>remove word left</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Delete</td><td>remove word right</td></tr>\xFE";
 z+="         <tr><td>Ctrl-R</td><td>replace</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-R</td><td>replace all</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Down</td><td>scroll line down</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Up</td><td>scroll line up</td></tr>\xFE";
 z+="         <tr><td>Option-PageDown</td><td></td></tr>\xFE";
 z+="         <tr><td>Option-PageUp</td><td></td></tr>\xFE";
 z+="         <tr><td>Ctrl-A</td><td>select all</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-L</td><td>select all from multi-selection</td></tr>\xFE";
 z+="         <tr><td>Shift-Down</td><td>select down</td></tr>\xFE";
 z+="         <tr><td>Shift-Left</td><td>select left</td></tr>\xFE";
 z+="         <tr><td>Shift-End</td><td>select line end</td></tr>\xFE";
 z+="         <tr><td>Shift-Home</td><td>select line start</td></tr>\xFE";
 z+="         <tr><td>Shift-PageDown</td><td>select page down</td></tr>\xFE";
 z+="         <tr><td>Shift-PageUp</td><td>select page up</td></tr>\xFE";
 z+="         <tr><td>Shift-Right</td><td>select right</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-End</td><td>select to end</td></tr>\xFE";
 z+="         <tr><td>Alt-Shift-Right</td><td>select to line end</td></tr>\xFE";
 z+="         <tr><td>Alt-Shift-Left</td><td>select to line start</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-P</td><td>select to matching bracket</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-Home</td><td>select to start</td></tr>\xFE";
 z+="         <tr><td>Shift-Up</td><td>select up</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-Left</td><td>select word left</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Shift-Right</td><td>select word right</td></tr>\xFE";
 z+="         <tr><td>Ctrl-O</td><td></td></tr>\xFE";
 z+="         <tr><td>Ctrl-/</td><td>toggle comment</td></tr>\xFE";
 z+="         <tr><td>Ctrl-T</td><td>transpose letters</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Z</td><td>undo</td></tr>\xFE";
 z+="         <tr><td>Alt-Shift-L, Ctrl-Shift-F1</td><td>unfold</td></tr>\xFE";
 z+="         <tr><td>Alt-Shift-0</td><td>unfold all</td></tr>\xFE";
 z+="         <tr><td>Ctrl-Enter</td><td>enter full screen</td> </tr>\xFE";
 z+="      </table>\xFE";
 z+="      </div>\xFE";
 z+="`)\xFE";
 z+="\xFE";
 z+="function addAceCompletetions\xFE";
 z+="    Read Js From @fHandle('dict tcl'), '_AceCompleations' Else Return ''\xFE";
 z+="    S = `\xFE";
 z+="       function getCompletions(editor, session, pos, prefix) {\xFE";
 z+="          if (pos.column - prefix.length - 1 >= 0) pchar = editor.session.getLine(pos.row).substr(pos.column - prefix.length - 1, 1);\xFE";
 z+="          if (pchar == \"@\") { prefix = \"@\" + prefix; }\xFE";
 z+="          prefix = prefix.toLowerCase();\xFE";
 z+="          var answers = []\xFE";
 z+="          var lib = library_funcs();\xFE";
 z+="          plen = prefix.length;\xFE";
 z+="          for (var i = 0; i < lib.length; i++) {\xFE";
 z+="             var l = lib[i];\xFE";
 z+="             var name = l.name;\xFE";
 z+="             var value = l.value;\xFE";
 z+="             if (prefix == name.substr(0, plen)) {\xFE";
 z+="                var r = {}\xFE";
 z+="                r.name = l.name;\xFE";
 z+="                r.value = l.value;\xFE";
 z+="                r.meta = l.meta;\xFE";
 z+="                r.score = 50;\xFE";
 z+="    \xFE";
 z+="                if (pchar == \"@\" && r.value.substr(0, 1) == \"@\") r.value = r.value.substr(1, 999)\xFE";
 z+="    \xFE";
 z+="                answers.push(r);\xFE";
 z+="             }\xFE";
 z+="          }\xFE";
 z+="          return answers;\xFE";
 z+="       }\xFE";
 z+="    \xFE";
 z+="      \xFE";
 z+="       function library_funcs() {\xFE";
 z+="           return [`:js:`]\xFE";
 z+="       }\xFE";
 z+="       `\xFE";
 z+="\xFE";
 z+="    Return @Script(S)\xFE";
 z+="End function"
window.cached_jsb_tcl["ed"]=z;
var z="program edl()\xFE";
 z+="    If !isAdmin() Then Stop \"You must be an admin to run this command\"\xFE";
 z+="\xFE";
 z+="    tabID = @urlParam(\"tabID\")\xFE";
 z+="    fileName = @urlParam(\"fileName\")\xFE";
 z+="    itemNames = Split(@urlParam(\"itemNames\"), am())\xFE";
 z+="    serverToUse = @jsbrootact\xFE";
 z+="    cb = 'nobust'\xFE";
 z+="    \xFE";
 z+="    ClearScreen = @(-1)\xFE";
 z+="\xFE";
 z+="    print ClearScreen:\xFE";
 z+="\xFE";
 z+="    if !fileName Or !itemNames And LCase(Left(@Sentence, 4)) <> \"run \" Then\xFE";
 z+="        If @ParseSelect(@Sentence, \"\", Top, Columns, Dictdata, TableName, FilterBy, OrderBY, Options, AllItems, F_file, False, 0 /* IgnoreFileNotFound */) Then\xFE";
 z+="            fileName = LTrim(Dictdata:\" \":TableName)\xFE";
 z+="        \xFE";
 z+="            // Get list of names to edit\xFE";
 z+="            itemNames = []\xFE";
 z+="            If AllItems Or FilterBy = \"*\" Then\xFE";
 z+="                FilterBy = \"\"\xFE";
 z+="                Select F_file To Sl Then itemNames = GetList(sl) Else Stop @Errors\xFE";
 z+="            Else\xFE";
 z+="                If FilterBy Then\xFE";
 z+="                    FilterBy = LTrim(RTrim(FilterBy:OrderBY))\xFE";
 z+="                    Select LTrim(Top:' '):Join(Columns, \" \") From F_file Where FilterBy To Sl Then itemNames = GetList(sl) Else Stop @Errors\xFE";
 z+="                Else\xFE";
 z+="                    Loop\xFE";
 z+="                        ReadNext ID Else break\xFE";
 z+="                        itemNames[-1] = ID\xFE";
 z+="                    While True Do Repeat\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if (!itemNames) Then\xFE";
 z+="        If TableName = '?' Then Stop 'ED TableName <ITEMNAMES> {(options)}'\xFE";
 z+="        chain \"edl_ide \":fileName\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    // Update recent list with current item names\xFE";
 z+="    i_readjson recentlist from fHandle('tmp'), \"edl_recentlist\" else recentlist = { \"cs\": [\"analogdemo\", \"serverdemo\"] }\xFE";
 z+="    lFName = LCase(fileName)\xFE";
 z+="    if !recentList[lFName] Then recentList[lFName] = []\xFE";
 z+="    recentItems = recentList[lFName]\xFE";
 z+="   \xFE";
 z+="    for each itemName in itemNames\xFE";
 z+="        locate LCase(itemName) in recentItems Else \xFE";
 z+="            //read x from F_file, itemName then\xFE";
 z+="                recentItems[-1] =  LCase(itemName)\xFE";
 z+="                changed = True\xFE";
 z+="            //    x = \"\"\xFE";
 z+="            //end if\xFE";
 z+="        end if\xFE";
 z+="    next\xFE";
 z+="    \xFE";
 z+="    if changed then\xFE";
 z+="        i_writejson recentlist on fHandle('tmp'), \"edl_recentlist\" else msgbox(@errors)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    itemNames = Join(itemNames, @am)\xFE";
 z+="    Print Html(`\xFE";
 z+="        <div id='tabMaster'></div>\xFE";
 z+="        <script>\xFE";
 z+="            function startEDL() {\xFE";
 z+="                if (rpcsid()) {\xFE";
 z+="                    EDL.txtArea_Setup(\"txtArea\", \"\", \"\", \"tabMaster\", \"`:fileName:`\", \"`:itemNames:`\")\xFE";
 z+="                } else {\xFE";
 z+="                    rpcLogin(\"guest\", \"guest\", function () { \xFE";
 z+="                        EDL.txtArea_Setup(\"txtArea\", \"\", \"\", \"tabMaster\", \"`:fileName:`\", \"`:itemNames:`\")\xFE";
 z+="                    }, function () { \xFE";
 z+="                        var password = prompt(\"Admin password\");\xFE";
 z+="                        rpcLogin(\"admin\", password, function () { \xFE";
 z+="                            EDL.txtArea_Setup(\"txtArea\", \"\", \"\", \"tabMaster\", \"`:fileName:`\", \"`:itemNames:`\")\xFE";
 z+="                        }, function () { alert(\"Failed to login\") }, \"`:serverToUse:`\" ); \xFE";
 z+="                    });\xFE";
 z+="                }\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            if (window.EDL && EDL.txtArea_Setup) {\xFE";
 z+="                startEDL();\xFE";
 z+="            } else {\xFE";
 z+="                loadFile('/jsb/js/edl_pics.js', function () {\xFE";
 z+="                    loadFile('/jsb/js/edl.js?cb=`:timer():`', function () {\xFE";
 z+="                        loadFile('/jsb/js/edl_format.js', function () {\xFE";
 z+="                            loadFile('/jsb/css/edl.css?cb=`:timer():`');\xFE";
 z+="                            startEDL();\xFE";
 z+="                        });\xFE";
 z+="                    });\xFE";
 z+="                });\xFE";
 z+="            };\xFE";
 z+="        </script>\xFE";
 z+="    `):\xFE";
 z+="   \xFE";
 z+="    if system(1) = \"aspx\" then \xFE";
 z+="       @Server.Pause\xFE";
 z+="       stop\xFE";
 z+="    end if\xFE";
 z+="    @Server.End\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="// Restful function to get a tree list of itemids\xFE";
 z+="Restful function edl_getItemNames(forFileName) \xFE";
 z+="    results = {}\xFE";
 z+="    eForFileName = jsEscapeString(ForFileName)\xFE";
 z+="    open forFileName to f then\xFE";
 z+="        select f to sl then\xFE";
 z+="            ids = getlist(sl)\xFE";
 z+="            for each iName in ids\xFE";
 z+="                results[iName] = { onclick: `edl_editItem(`:eForFileName:`,`:jsEscapeString(iName):`);` }\xFE";
 z+="            next\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    return results\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="function edl_simulateEsp()\xFE";
 z+="    cb = 'nobust'\xFE";
 z+="\xFE";
 z+="    return @(-1):@Html(`<!DOCTYPE HTML>\xFE";
 z+="    <html>\xFE";
 z+="    <`:`head>\xFE";
 z+="     <meta http-equiv='X-UA-Compatible' content='IE=9' /> \xFE";
 z+="     <meta http-equiv='pragma' content='no-cache' />\xFE";
 z+="     <meta name='viewport' content='width=device-width'>\xFE";
 z+="     <meta charset='utf-8' />\xFE";
 z+="     <meta http-equiv='Access-Control-Allow-Origin' content='*' />\xFE";
 z+="     <meta http-equiv='Access-Control-Allow-Headers' content='Content-Type, Accept, SOAPuserion, Origin' />\xFE";
 z+="     <meta http-equiv='Access-Control-Max-Age' content='1728000' />\xFE";
 z+="     <meta http-equiv='Content-Security-Policy' content=\"img-src * data:; default-src *; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'\" /> <meta http-equiv='cache-control' content='max-age=0' />\xFE";
 z+="     <meta http-equiv='expires' content='0' />\xFE";
 z+="     <meta http-equiv='expires' content='Tue, 01 Jan 1980 1:00:00 GMT' />\xFE";
 z+="     <meta http-equiv='pragma' content='no-cache' />\xFE";
 z+="    \xFE";
 z+="     <script src='https://jsbwinforms.azurewebsites.net/jsb/js/jsbjlite.js?cb=`:cb:`'></script>\xFE";
 z+="     <script src='https://jsbwinforms.azurewebsites.net/jsb/js/jsbesp.js?cb=`:cb:`'></script>\xFE";
 z+="     <link href='https://jsbwinforms.azurewebsites.net/jsb/css/jsbesp.css?cb=`:cb:`' type='text/css' rel='stylesheet'>\xFE";
 z+="     <script src='https://jsbwinforms.azurewebsites.net/jsb/js/tstcompile.js?cb=`:cb:`'></script>\xFE";
 z+="     <link type=\"text/css\" rel=\"stylesheet\" href=\"https://jsbwinforms.azurewebsites.net/jsb/css/edl.css?cb=`:cb:`\">\xFE";
 z+="     <script src=\"https://jsbwinforms.azurewebsites.net/jsb/js/edl.js?cb=`:cb:`\"></script>\xFE";
 z+="      \xFE";
 z+="     <title>EDL Test</title>\xFE";
 z+="     <link rel='shortcut icon' href='https://jsbwinforms.azurewebsites.net/jsb/pics/favicon.ico' />\xFE";
 z+="     <link type=\"text/css\" rel=\"stylesheet\" href=\"`:@Jsbroot:`css/edl.css?cb=`:Cb:`\">\xFE";
 z+="     <script src=\"`:@Jsbroot:`js/edl.js?cb=`:Cb:`\"></script>\xFE";
 z+="     <`:`/head>\xFE";
 z+="     <body>\xFE";
 z+="     <input name=\"_SID_\" type=\"hidden\" value=\"`:@userNo:`\">\xFE";
 z+="     `)\xFE";
 z+="end function\xFE";
 z+=""
window.cached_jsb_tcl["edl"]=z;
var z="program edl_ide()\xFE";
 z+="    *$options aspx\xFE";
 z+="    *\xFE";
 z+="    *  Make a Tree for opening files\xFE";
 z+="    *\xFE";
 z+="    Tree = { } \xFE";
 z+="\xFE";
 z+="    simulate = system(1) = \"aspx\"\xFE";
 z+="    ClearScreen = @(-1)\xFE";
 z+="    if simulate then ClearScreen := edl_simulateEsp()\xFE";
 z+="        \xFE";
 z+="    // Build recent tree\xFE";
 z+="    i_readjson recentlist from fJsbConfig(), \"edl_recentlist\" then\xFE";
 z+="       RecentTree = {}\xFE";
 z+="       for each fName in recentlist\xFE";
 z+="           recentItems = recentlist[fName]\xFE";
 z+="           subResults = {}\xFE";
 z+="           eFileName = jsEscapeString(fname)\xFE";
 z+="           for each iName in recentItems\xFE";
 z+="              subResults[iName] = { onclick: `edl_editItem(`:eFileName:`,`:jsEscapeString(iName):`);` }\xFE";
 z+="           next\xFE";
 z+="           RecentTree[fName] = subResults\xFE";
 z+="        next\xFE";
 z+="        Tree.Recent = RecentTree\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // Build file list tree\xFE";
 z+="    listfiles to fl then \xFE";
 z+="        fl = Split(fl, am()) \xFE";
 z+="        FileTree = {}\xFE";
 z+="        for each fname in fl \xFE";
 z+="           FileTree[fname] = { url: @jsbRestCall(`edl_getItemNames?forFileName=`:@urlEncode(fname)) }\xFE";
 z+="        next\xFE";
 z+="        Tree.Files = FileTree\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // Build the jsonTree\xFE";
 z+="    lh = @Div('', jsonTree(Tree), { style: 'height: 100%; width: 100%' }) \xFE";
 z+="\xFE";
 z+="    // Show the tree in a splitter\xFE";
 z+="    tabFrame = @jsb_Html.Rows2(\"32px\", @html(`<div id='tabMaster_tabHeader' class=\"tabHeader\"></div>`), \"%\", @html(`<div id='tabMaster_tabPanes' class='tabPanes'></div>`), \"overflow: hidden\")\xFE";
 z+="\xFE";
 z+="    print ClearScreen:@jsb_html.Vsplitter(\"edlSplitter\", lh, tabFrame, 150):\xFE";
 z+="    \xFE";
 z+="    // Tell EDL to open edl_editor in a new tab (under tabMaster)\xFE";
 z+="    print  @javaScript(`\xFE";
 z+="        function tabClosingCheck(e) {\xFE";
 z+="            if (checkUrlForClose(e.srcElement.contentDocument.location.href)) { \xFE";
 z+="               var tabID = $(e.srcElement).parent().attr('id');\xFE";
 z+="               removeTab(tabID, true);\xFE";
 z+="            }\xFE";
 z+="        }\xFE";
 z+="        \xFE";
 z+="        function edl_editItem(fileName, itemID) {\xFE";
 z+="            var tabID = 'tab_' + fileName + '_' + itemID;\xFE";
 z+="            \xFE";
 z+="            if (!$(\"#\" + tabID).length) {\xFE";
 z+="                var url = jsbRootAct() + 'edl?tabID=' + urlEncode(tabID) + '&fileName=' + urlEncode(fileName) + '&itemNames=' + urlEncode(itemID);\xFE";
 z+="                var content = '<iframe id=\"mf_' + itemID + '\" scrolling= \"no\" class=\"IFrame\" application=\"yes\" src=\"' + url + '\" onload=\"tabClosingCheck(event)\" />';\xFE";
 z+="                addTab('tabMaster', tabID, itemID, content);\xFE";
 z+="            } else {\xFE";
 z+="                openTab(tabID)\xFE";
 z+="            }\xFE";
 z+="            \xFE";
 z+="            // vsplitterHideLeftPane('edlSplitter');\xFE";
 z+="        }\xFE";
 z+="    `):\xFE";
 z+="\xFE";
 z+="     @Server.End\xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["edl_ide"]=z;
window.cached_jsb_tcl["el"]="Program EL\xFE   If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE   S = TRIM(@SENTENCE)\xFE   INAME = FIELD(S, \" \", 2)\xFE   @fHandle(\"\", \"JSB_SelectLists\", true)\xFE   EXECUTE \"ED JSB_SelectLists \":INAME";
window.cached_jsb_tcl["encode"]="Program Encode\xFE*\xFE* Convert string to encoded - default to base64\xFE* \xFE    S = DropLeft(@Sentence, ' ')\xFE    O = FieldIfRight(S, ' (', 1)\xFE    If O Then S = DropRight(S, ' (')\xFE    if !O Then o = 64\xFE    S = Encode(S, o)\xFE    Print S\xFE    Clearselect\xFEEnd Program\xFE";
window.cached_jsb_tcl["format"]="Program Format\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE\xFE    Dim IgnoreFileNotFound As Boolean = False\xFE    Dim DftAllItems As Boolean = False\xFE    Dim Help As Array = ['FORMAT <TableName> <itemnames>']\xFE    \xFE    $include __shell\xFE    \xFE    Fname = UCase(TrueTableName(TableName))\xFE    Firsttime = 0\xFE    \xFE    For each iName As String, ItemI As Integer In INames\xFE        Read Item From F_file, IName Then\xFE            Item = formatCode(Item, 4, false)\xFE            Write Item On f_File, IName Else Stop @Errors\xFE            Print \"Formatted \":Fname:' ':Iname\xFE        End If\xFE    Next\xFE    \xFE    If Errors Then Print MonoSpace(Join(Errors, crlf()))\xFEEnd Program";
var z="Program Get\xFE";
 z+="         \xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    adr = trim(field(@sentence, \"(\", 1))\xFE";
 z+="    i = index(adr, \" \", 1)\xFE";
 z+="    if i = 0 then \xFE";
 z+="        print \"GET http://addr\"\xFE";
 z+="        stop\xFE";
 z+="    end if\xFE";
 z+="*\xFE";
 z+="    URL = ltrim(mid(adr, i))\xFE";
 z+="    print url\xFE";
 z+="    doc = @jsb_bf.Get(URL, \"GET\", Header, \"\", \"\") ;* et(Url, method, header, body, opts)\xFE";
 z+="*\xFE";
 z+="    Header= replace(Header, chr(10), \"\")\xFE";
 z+="    \xFE";
 z+="    if InStr(Header, 'Content-Type=image/') Then\xFE";
 z+="         pType = field(Header, 'Content-Type=image/', 2)\xFE";
 z+="         pType = pType<1>\xFE";
 z+="         pic64encoded =  encode(doc, 64) \xFE";
 z+="         Print Image(`data:image/`:ptype:`;base64,`:pic64encoded) \xFE";
 z+="         stop\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    doc = replace(doc, chr(10), \"\")\xFE";
 z+="*\xFE";
 z+="    Print \"Length of \":Len(DOC)\xFE";
 z+="    print \"=========== Header ==================\"\xFE";
 z+="    print Replace(field(header, \"<html\", 1), Chr(254), crlf())\xFE";
 z+="    print \"============ Body ==================\"\xFE";
 z+="    if instr(doc, chr(13)) = 0 then doc = replace(doc, chr(10), chr(13))  \xFE";
 z+="    if doc = \"\" then stop @errors     \xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    result = doc\xFE";
 z+="    on error goto dostop\xFE";
 z+="\xFE";
 z+="    if Left(doc, 1) = \"{\" then\xFE";
 z+="        on error goto justText\xFE";
 z+="        result = json(doc)\xFE";
 z+="        stop result\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="justtext: \xFE";
 z+="    result = replace(result, chr(13):chr(10), chr(254))\xFE";
 z+="    result = replace(result, chr(13), chr(254))\xFE";
 z+="    result = replace(result, chr(10), chr(254))\xFE";
 z+="    result = replace(result, chr(254), \"$#254#$\")\xFE";
 z+="    result = oconv(result, \"MCP\")\xFE";
 z+="    result = replace(result, \"$#254#$\", crlf())\xFE";
 z+="\xFE";
 z+="doStop: \xFE";
 z+="    stop result\xFE";
 z+=""
window.cached_jsb_tcl["get"]=z;
window.cached_jsb_tcl["gl"]="Program GL\xFE    S = TRIM(@SENTENCE)\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE    FNAME = FIELD(S, \" \", 2)\xFE    INAME = FIELD(S, \" \", 3)\xFE    \xFE    \xFE    IF UCASE(FNAME) = \"DICT\" THEN\xFE        FNAME = FNAME:\" \":INAME\xFE        INAME = FIELD(S, \" \", 4)\xFE    END IF\xFE    CLEARSELECT\xFE    GETLIST FNAME THEN\xFE        PRINT \"LIST '\":FNAME:\"' ACTIVATED\"\xFE    END ELSE \xFE        PRINT @ERRORS\xFE    END IF\xFE    Stop";
var z="Program Header\xFE";
 z+="   If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="   \xFE";
 z+="   adr = field(field(@sentence, \"(\", 1), \" \", 2)\xFE";
 z+="   if left(adr, 4) <> \"http\" then adr = \"http://\":adr\xFE";
 z+="   url = adr\xFE";
 z+="   \xFE";
 z+="   if left(adr, 8) = \"https://\" then\xFE";
 z+="      adr = adr[9, 9999]\xFE";
 z+="      i_open \"https://\" to www else stop \"no open\"\xFE";
 z+="   End Else\xFE";
 z+="      adr = adr[8, 9999]\xFE";
 z+="      i_open \"http://\" to www else stop \"no open\"\xFE";
 z+="   End\xFE";
 z+="   www<2> = \"GET\"\xFE";
 z+="    doc = @jsb_bf.Get(URL, \"get\", Header, \"\", \"\") // Get(Url, method, header, body, opts)\xFE";
 z+="    \xFE";
 z+="*   i_read doc from www, adr else stop \"no \":adr:\" \":@Errors\xFE";
 z+="*\xFE";
 z+="   print \"=========== Header ==================\"\xFE";
 z+="   header = @errors\xFE";
 z+="   print replace(header, am(), crlf())\xFE";
 z+="   print\xFE";
 z+="   print \"========== Set-Cookie =================\"\xFE";
 z+="                              \xFE";
 z+="   for i = 1 to dcount(header, am())\xFE";
 z+="      hline = header<i>\xFE";
 z+="      if left(hline, 10) = \"Set-Cookie\" then\xFE";
 z+="         hline = mid(hline, 12) ;* Drop Set-Cookie\xFE";
 z+="         \xFE";
 z+="         \xFE";
 z+="         for j = 1 to dcount(hline, \";\")\xFE";
 z+="            hfield = field(hline, \";\", j)\xFE";
 z+="            hname = Trim(field(hfield , \"=\", 1))\xFE";
 z+="            select case 1=1\xFE";
 z+="               case hname = \"expires\"\xFE";
 z+="                  print hfield\xFE";
 z+="               case hname = \"domain\"\xFE";
 z+="                  print hfield\xFE";
 z+="               case hname = \"path\"\xFE";
 z+="                  print hfield\xFE";
 z+="               case hname = \"secure\"\xFE";
 z+="                  print hfield\xFE";
 z+="               case hname = \"HttpOnly\"\xFE";
 z+="                  print hfield\xFE";
 z+="               case else\xFE";
 z+="                     m = instr(hfield, \"=\")                             \xFE";
 z+="                     if m then\xFE";
 z+="                        print \"* \":hfield[1,m-1]:\" = \":mid(hfield, m+1)\xFE";
 z+="                     end else\xFE";
 z+="                        print \"?? \":hfield \xFE";
 z+="                     end\xFE";
 z+="            end select                                     \xFE";
 z+="            \xFE";
 z+="         next\xFE";
 z+="      end\xFE";
 z+="   next            "
window.cached_jsb_tcl["header"]=z;
var z="Program Help\xFE";
 z+="    S = @Sentence\xFE";
 z+="    If Left(LCase(S), 8) = \"run tcl \" Then S = Mid(S, 9)\xFE";
 z+="    If Left(LCase(S), 12) = \"run jsb_tcl \" Then S = Mid(S, 13)\xFE";
 z+="\xFE";
 z+="    SearchTerm = @DropLeft(Field(S, \" (\", 1), \" \", 1)\xFE";
 z+="    Options = LCase(Field(S, \" (\", 2))\xFE";
 z+="    Open \"\", \"JSB_DOCS\" To F_jsbdocs Else Stop \"Unable to open JSB_DOCS table: \":@Errors\xFE";
 z+="    Readjson Catagories From F_jsbdocs, \"__treeCatagories\" Else Stop \"No __treeCatagories found; Run COMPILE JSB_DOCS *\"\xFE";
 z+="    Write \"\" On F_jsbdocs, \"testPermissions\" Then\xFE";
 z+="        Delete F_jsbdocs, \"testPermissions\" Else Stop @Errors\xFE";
 z+="        Ed = \"ed\"\xFE";
 z+="    Else\xFE";
 z+="        Ed = \"view\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    open \"jsb_examples\" to x else stop \"The jsb_examples file is missing\"\xFE";
 z+="    \xFE";
 z+="    If SearchTerm Then\xFE";
 z+="        Select \"\" From F_jsbdocs Where \"ItemId Like '%\":SearchTerm:\"%'\" To Sl Else Stop @Errors\xFE";
 z+="        HelpList = Split(GetList(Sl), am())\xFE";
 z+="        If Len(HelpList) = 0 Then Stop \"No items found\"\xFE";
 z+="\xFE";
 z+="        If Len(HelpList) = 1 Then\xFE";
 z+="            Id = Join(HelpList, '')\xFE";
 z+="            Read Item From Fhandle('jsb_docs'), Id Else Stop @Errors\xFE";
 z+="            Item = Replace(Item, am(), \"\")\xFE";
 z+="            Print anchorEdit('jsb_docs', id)\xFE";
 z+="            Print @Html(Item)\xFE";
 z+="            Stop\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        Print  @Html(\"<table style='width: 95%; white-space: nowrap;'>\"):\xFE";
 z+="        For Each Id, Li In HelpList\xFE";
 z+="            R = \"\"\xFE";
 z+="            For I = 1 To 4\xFE";
 z+="                If Id <> \"\" Then\xFE";
 z+="                    Es = `?`:Ed:` JSB_DOCS '`:@UrlEncode(Id):`'`\xFE";
 z+="                    R = R:@Td(anchorEdit('jsb_docs', id, false, 40))\xFE";
 z+="                    Cnt = Cnt + 1\xFE";
 z+="                End If\xFE";
 z+="                Li = Li + 1\xFE";
 z+="                Id = HelpList[Li]\xFE";
 z+="                If !Id Then Break\xFE";
 z+="            Next\xFE";
 z+="            Li = Li - 1\xFE";
 z+="            Print @Tr(R):\xFE";
 z+="        Next\xFE";
 z+="\xFE";
 z+="        Print @Html(\"</table>\")\xFE";
 z+="        ClearSelect\xFE";
 z+="\xFE";
 z+="        Print Cnt:\" items listed\"\xFE";
 z+="        Stop\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If true or System(1) = \"js\" Or @MaxWidth < 800 Then\xFE";
 z+="        hamburger = @Button('', @Html(`<span class=\"glyphicon glyphicon-menu-hamburger\"></span>`), { onclick: 'westToggle()', style: 'min-width: 15px' } )\xFE";
 z+="        QuitBtn = @Submitbtn('btnCommand', 'Quit', { style: 'width: 100%' }  )\xFE";
 z+="        \xFE";
 z+="        NorthHtml = Cols2(\"38px\", hamburger, \"%\" , QuitBtn, \"\", \"overflow: hidden;\", \"overflow: hidden\")\xFE";
 z+="        NorthOptions = \"startsize: 40px, Fixed\"\xFE";
 z+="        \xFE";
 z+="        WestHtml = @Jsb_html.jsonTree(Catagories)\xFE";
 z+="        WestOptions = \"startsize: 270px\"\xFE";
 z+=" \xFE";
 z+="        CenterHtml = @Div('centerDiv', '', { style: 'background-color: white; color: black; height: 100%; width: 100%; overflow-y: auto' })\xFE";
 z+="        \xFE";
 z+="        Print @(-1):@Jsb_html.LAYOUT(CenterHtml, NorthHtml, NorthOptions, \"South\", \"\", \"East\", \"\", WestHtml, WestOptions)\xFE";
 z+="        \xFE";
 z+="        Print @genEventHandler(\"leafSelected\", Url, 7, \"itemID\"):\xFE";
 z+="        Print @Script(`\xFE";
 z+="                function westToggle() {\xFE";
 z+="                  $(\"#mylayout\").layout().toggle(\"west\");\xFE";
 z+="                }\xFE";
 z+="                function westHide() {\xFE";
 z+="                  $(\"#mylayout\").layout().close(\"west\");\xFE";
 z+="                }\xFE";
 z+="            `):\xFE";
 z+="\xFE";
 z+="        Loop\xFE";
 z+="           print @script(`\xFE";
 z+="            $('#centerDiv').html(`:jsescapestring(Item):`);\xFE";
 z+="            `):\xFE";
 z+="            \xFE";
 z+="            @Server.Pause\xFE";
 z+="            Cmd =  @formVar(\"btnCommand\")\xFE";
 z+="            ItemID =  @formVar(\"itemID\")\xFE";
 z+="        Until Cmd = 'Quit' Do\xFE";
 z+="            Read Item From Fhandle('jsb_docs'), ItemID Else Item = @Errors:\" with \":ItemID\xFE";
 z+="            Item = Replace(Item, Chr(254), '')\xFE";
 z+="            print @script(`window.westHide()`):\xFE";
 z+="        Repeat\xFE";
 z+="\xFE";
 z+="        Print @(-1):\xFE";
 z+="        if System(1) = \"js\" then Chain \"jsb\"\xFE";
 z+="        stop\xFE";
 z+="\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    containerName = \"Tabs_\":Rnd(9999)\xFE";
 z+="    CenterHtml = @Jsb_html.TABS(containerName, \"\", \"\", \"\", \"\", \"\", \"\")\xFE";
 z+="\xFE";
 z+="   **********************\xFE";
 z+="    If @IsAdmin And System(1) = \"aspx\" Then\xFE";
 z+="        Url = @jsbRootExecuteTclCmd(\"ed JSB_DOCS '{id}'\")\xFE";
 z+="    Else\xFE";
 z+="        Url = `view JSB_DOCS '{id}'`\xFE";
 z+="    End If\xFE";
 z+="    OnSelect = @genEventHandler(\"leafSelected\", Url, 3, containerName) ;* open in tab\xFE";
 z+="\xFE";
 z+="    htmlTree = jsonTree(Catagories)\xFE";
 z+="    NorthHtml = @Submitbtn('btnCommand', 'Quit', { width: \"70%\" }  )\xFE";
 z+="    NorthOptions = \"fixed, startsize:auto\"\xFE";
 z+="\xFE";
 z+="    WestOptions = \"fixed, startsize: 270px\"\xFE";
 z+="    ' @genEventHandler(\"leafSelected\", Url, 7, \"itemID\"): // postback\xFE";
 z+="    \xFE";
 z+="    WestHtml = @Jsb_html.jsonTree(Catagories)\xFE";
 z+="\xFE";
 z+="    Html = @Jsb_html.LAYOUT(CenterHtml, NorthHtml, NorthOptions, \"South\", \"\", \"East\", \"\", WestHtml, WestOptions)\xFE";
 z+="\xFE";
 z+="    Print @(-1): Html:OnSelect:\xFE";
 z+="\xFE";
 z+="    @Server.Pause\xFE";
 z+="\xFE";
 z+="    Stop @(-1)\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="function help_addTableName(A, TableName)\xFE";
 z+="    NewA = Split(A, am())\xFE";
 z+="    For Each Catagory, I In A\xFE";
 z+="        Catagory = Split(Catagory, vm())\xFE";
 z+="        For J = 2 To UBound(Catagory)\xFE";
 z+="            Catagory[J] = TableName:\" \":UrlEncode(Catagory[J])\xFE";
 z+="        Next\xFE";
 z+="        NewA[I] = Join(Catagory, vm())\xFE";
 z+="    Next\xFE";
 z+="    Return Join(NewA, am())\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="Program Compile\xFE";
 z+="    ' Will extract the examples from the DOCS file (use Compile jsb_docs *)\xFE";
 z+="    ' Will build the necessary tree (use Compile jsb_docs)\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="*\xFE";
 z+="    Help = ['COMPILE jsb_docs {itemnames} or *> (options']\xFE";
 z+="    Help[-1] = ''\xFE";
 z+="    Help[-1] = '  This program will extract the examples from the JSB_DOCS, put them in JSB_EXAMPLES, and BASIC them.  (No PC compile necessary)'\xFE";
 z+="    Help[-1] = '  Use option (B to only rebuild the __treeCatagories index'\xFE";
 z+="    \xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = True\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    \xFE";
 z+="    $include __shell\xFE";
 z+="    \xFE";
 z+="    If Instr(Options, 'B') Then\xFE";
 z+="        Open \"jsb_docs\" To F_file Else Stop @Errors\xFE";
 z+="        Tree = @BuildCatagories(F_file, True, False)\xFE";
 z+="        Stop\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Instr(INames[1], '?') Or Instr(Options, '?') Or !INames Then Stop Join(Help, crlf())\xFE";
 z+="\xFE";
 z+="    F_Handle = @Fhandle(\"\", \"Examples\", True)\xFE";
 z+="    fdict_Handle = @Fhandle(\"DICT\", \"Examples\", true)\xFE";
 z+="    \xFE";
 z+="    If AllItems Then\xFE";
 z+="        Clearfile F_Handle Else Stop @Errors\xFE";
 z+="        Clearfile fdict_Handle Else Stop @Errors\xFE";
 z+="        Delete From @Fhandle(\"JSB_DOCS\"), \"__treeCatagories\" Else Stop @Errors\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Readjson Catagories From F_file, \"__treeCatagories\" Else Catagories = {}\xFE";
 z+="    OriginalCatagories = CStr(Catagories)\xFE";
 z+="    \xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        If Left(Iname, 1) = \"_\" Then Cycle\xFE";
 z+="\xFE";
 z+="        Read Item From F_file, Iname Else\xFE";
 z+="            If Len(@Errors) Then Errors[-1] = @Errors Else Errors[-1] = 'Item ':Iname:' not found.'\xFE";
 z+="            Cycle\xFE";
 z+="        End\xFE";
 z+="        \xFE";
 z+="        print iname:\" \":\xFE";
 z+="        if Mod(ItemI, 7) = 1 then  print ; @Server.Flush\xFE";
 z+="        \xFE";
 z+="        Iname = LCase(Iname)\xFE";
 z+="        Oitem = Item\xFE";
 z+="        \xFE";
 z+="        Cancel = @ExtractExamples(Iname, Item, \"\")\xFE";
 z+="        If Cancel Then\xFE";
 z+="            Print \"Errors in \":Iname\xFE";
 z+="        Else\xFE";
 z+="            Write Item On F_file, Iname Else Stop \"Error: \":@Errors\xFE";
 z+="            write datetime() on fdict_Handle, Iname:\".compile.time\" Else stop @Errors\xFE";
 z+="        End If\xFE";
 z+="    \xFE";
 z+="        UpdateAnExampleCatagory(F_file, Iname, Catagories)\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors Then Print MonoSpace(Join(Errors, crlf()))\xFE";
 z+="\xFE";
 z+="    If OriginalCatagories <> CStr(Catagories) Then\xFE";
 z+="        Catagories = SortByTags(Catagories, True)\xFE";
 z+="        For Each Tag In Catagories\xFE";
 z+="            Catagories[Tag] = SortByTags(Catagories[Tag])\xFE";
 z+="        Next\xFE";
 z+="\xFE";
 z+="        WriteJSon Catagories On F_file, \"__treeCatagories\"\xFE";
 z+="        If !Instr(Options, \"S\") Then Print \"Catagories updated\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If MsgBox(\"Do you want to update the cache now?\", \"*Yes,No\") = \"Yes\" Then\xFE";
 z+="        Execute \"cache jsb_docs (s\"; @Server.Flush\xFE";
 z+="        Execute \"cache jsb_examples (s\"; @Server.Flush\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Stop 'Done'\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="function ExtractExamples(Byval ItemID, ByRef Html, byRef ExampleName)\xFE";
 z+="*\xFE";
 z+="* Extracts and compiles the examples from the HTML code (writes them to the EXAMPLES file (prefiexed with ItemID))\xFE";
 z+="* Returns a count of errors\xFE";
 z+="*\xFE";
 z+="    docDIV = '<div class=\"docExample\">'\xFE";
 z+="    \xFE";
 z+="    niceItemID = Field(ItemID, \".htm\", 1)\xFE";
 z+="    If Left(niceItemID, 1) = \"@\" Then niceItemID = Mid(niceItemID, 2)\xFE";
 z+="    niceItemID = Replace(@DropTags(niceItemID), \" \", \"_\")\xFE";
 z+="    \xFE";
 z+="    If Html = \"\" Then\xFE";
 z+="        Open \"jsb_examples\" To F_file Else Stop \"Error: \":@Errors\xFE";
 z+="        Read Html From F_file, ItemID Else Stop 'jsb_examples item ':ItemID:' not found.'\xFE";
 z+="    End\xFE";
 z+="\xFE";
 z+="    // Clean up Html\xFE";
 z+="    Html = Replace(Html, Chr(160), Chr(32))\xFE";
 z+="    Html = Replace(Html, \"<br >\", \"<br>\")\xFE";
 z+="    Html = Replace(Html, \"<br/>\", \"<br>\")\xFE";
 z+="    \xFE";
 z+="    // Validate Category\xFE";
 z+="    C = Field(Field(Field(Field(Field(Field(Html[1,1000], \" Category:\", 2), \";\", 1), \"<\", 1), Chr(254), 1), Chr(10), 1), Chr(13), 1)\xFE";
 z+="    C = Trim(C)\xFE";
 z+="    If C Then\xFE";
 z+="        PreC = Field(Html[1,1000], \" Category:\", 1)\xFE";
 z+="        If Instr(PreC, \"<div\") Then\xFE";
 z+="            I = Instr(Html, \"</div>\")\xFE";
 z+="            Html = Mid(Html, I + 6)\xFE";
 z+="            Loop While Left(Html, 5) = \"<br/>\" Or Left(Html, 6) = \"<br />\" Or Left(Html, 4) = \"<br>\" Do\xFE";
 z+="                Html = Mid(Html, Instr(Html, \">\") + 1)\xFE";
 z+="            Repeat\xFE";
 z+="            Html = \"* Category: \":C:\"<br/><br/>\":Html\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    // Remove any Div's that are not docDIV's\xFE";
 z+="    \xFE";
 z+="    If Instr(Html, `<div class=\"docExample\"`) = 0 And Instr(Html, \"&lt;example&gt;\") = 0 Then Return 0\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    // convert all string of \"<example>\" tags to docDIV's\xFE";
 z+="    Ha = Split(Html, \"&lt;example\")\xFE";
 z+="    Segs = []\xFE";
 z+="    For I = 2 To UBound(Ha)\xFE";
 z+="        Segs = Split(Ha[I], \"&lt;/example&gt;\") ;* Find </example>\xFE";
 z+="        Example = Segs[1]\xFE";
 z+="        If UBound(Segs) = 1 Then Segs[-1] = \"\"\xFE";
 z+="        Header = Trim(Field(Example, \"&gt;\", 1)) ;* Remove <example>\xFE";
 z+="        Example = Mid(Example, Col2() + 4) ;* Header And Footer Dropped\xFE";
 z+="        Example = @DropTags(Example)\xFE";
 z+="        Ha[I] = `<div class=\"docExample\">`:Example:`</div>`:Segs[2]\xFE";
 z+="    Next\xFE";
 z+="    Html = Join(Ha, \"\")\xFE";
 z+="\xFE";
 z+="    // Split on docDIV\xFE";
 z+="    Ha = Split(Html, docDIV)\xFE";
 z+="    If UBound(Ha) <= 1 Then Return 0\xFE";
 z+="    ErrCnt = 0\xFE";
 z+="\xFE";
 z+="    Ha[1] = balanceTags(Ha[1])\xFE";
 z+="    For I = 2 To UBound(Ha)\xFE";
 z+="        ExampleName = \"example_\":Convert(\"[]()!@#$%^&*()+=-:;><,./?~|{}[].\", \"_\", niceItemID)\xFE";
 z+="        If I > 2 Then ExampleName = ExampleName:\"_\":I-1\xFE";
 z+="\xFE";
 z+="        Block = Ha[I]\xFE";
 z+="        Enddiv = InStrRev(Block, \"</div\")\xFE";
 z+="        If Enddiv Then \xFE";
 z+="            Example = Left(Block, Enddiv-1)\xFE";
 z+="            EndDiv = InStr(EndDiv, Block, \">\")\xFE";
 z+="            Block = balanceTags(Mid(Block, EndDiv +1))\xFE";
 z+="        Else\xFE";
 z+="            Block = \"\"\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        // Process the Example\xFE";
 z+="        If Instr(Example, \"<br>\") Then Example = Replace(Example, am(), \"\") Else Example = Replace(Example, am(), \"<br>\")\xFE";
 z+="        \xFE";
 z+="        // drop old runclick <a href> ... </a>\xFE";
 z+="        J = Index(Example, `<br><input `, 1)\xFE";
 z+="        If J = 0 Then J = Index(Example, `<input `, 1)\xFE";
 z+="        If J Then\xFE";
 z+="            K = Instr(J+8, Example, \">\")\xFE";
 z+="            Example = Left(Example, J-1):Mid(Example, K +1)\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        Example = @DropTags(Example)\xFE";
 z+="\xFE";
 z+="        loop while left(Example, 1) = am() do Example = Mid(Example, 2) repeat\xFE";
 z+="        loop while Right(Example, 1) = am() do Example = Left(Example, Len(Example) - 1) repeat\xFE";
 z+="        \xFE";
 z+="        If Instr(Example, \"TCL>\") Then\xFE";
 z+="            Code = Split(Example, am())\xFE";
 z+="            For Each Line, LineI In Code\xFE";
 z+="                If Instr(Line, \"TCL>\") Then\xFE";
 z+="                    Line = \"Execute `\":LTrim(Replace(Line, \"TCL>\", \"\"):\"`\")\xFE";
 z+="                Else\xFE";
 z+="                    Line = \"* \":Line\xFE";
 z+="                End If\xFE";
 z+="                Code[LineI] = Line\xFE";
 z+="            Next\xFE";
 z+="        Else\xFE";
 z+="            Example = FormatCode(Example, 4, false)\xFE";
 z+="            Code = Example\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        Code = \"Program \":ExampleName:am():Code\xFE";
 z+="\xFE";
 z+="        Lcode = LCase(Code)\xFE";
 z+="\xFE";
 z+="        iSub = Instr(Lcode, am():'sub')\xFE";
 z+="        iFunc = Instr(Lcode, am():'func')\xFE";
 z+="        iRest = Instr(Lcode, am():'rest')\xFE";
 z+="        iProg = Instr(Lcode, am():'prog')\xFE";
 z+="        iClass = Instr(Lcode, am():'class')\xFE";
 z+="\xFE";
 z+="        iSpot = Len(Lcode) + 1\xFE";
 z+="        If !iSub Then iSub = iSpot\xFE";
 z+="        If !iFunc Then iFunc = iSpot\xFE";
 z+="        If !iRest Then iRest = iSpot\xFE";
 z+="        If !iProg Then iProg = iSpot\xFE";
 z+="        If !iClass Then iClass = iSpot\xFE";
 z+="\xFE";
 z+="        If iSub < iSpot Then iSpot = iSub\xFE";
 z+="        If iFunc < iSpot Then iSpot = iFunc\xFE";
 z+="        If iRest < iSpot Then iSpot = iRest\xFE";
 z+="        If iProg < iSpot Then iSpot = iProg\xFE";
 z+="        If iClass < iSpot Then iSpot = iClass\xFE";
 z+="\xFE";
 z+="        Code = Left(Code, iSpot-1):am():' Print crlf():crlf():@CloseButton:':am():Mid(Code, iSpot)\xFE";
 z+="\xFE";
 z+="        Write Code On @Fhandle(\"\", \"jsb_examples\", True), ExampleName Else Stop @Errors\xFE";
 z+="        Execute \"basic jsb_examples \":ExampleName Capturing X\xFE";
 z+="        If Instr(X, \"^\") Then\xFE";
 z+="            ErrCnt=ErrCnt + 1;\xFE";
 z+="            Ans = @MsgBox(ItemID, X, \"Continue,*Cancel\")\xFE";
 z+="            * debug\xFE";
 z+="            If Ans = \"Cancel\" Or Ans = Chr(27) Then Return ErrCnt\xFE";
 z+="        Else\xFE";
 z+="\xFE";
 z+="        End If\xFE";
 z+="        ' title, URL, pWidth, pHeight, onCloseSubmit, putResultInCtlOrID, pFromWindow)\xFE";
 z+="        RunClick = `<input type=\"button\" class=\"docExampleClick\" value=\"Click here to run this example\" onclick=\"javascript: popoutWindow(&quot;help example&quot;, &quot;?showExample `:ExampleName:`&quot;, &quot;80%&quot;, &quot;80%&quot;, false);\">`\xFE";
 z+="        Example = Replace(Join(Example, crlf():\"<br>\"), \" \", \"&nbsp;\")\xFE";
 z+="\xFE";
 z+="        // Put it back together\xFE";
 z+="        Ha[I] = `<div class=\"docExample\">`:Example:`<br>`:RunClick:`</div ><br>`:Block\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    If ErrCnt = 0 Then Html = Join(Ha, \"\")\xFE";
 z+="    Return ErrCnt\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function BuildCatagories(F_file, Ignored, OneGroup)\xFE";
 z+="*  Notes - 1) Select returns a list of all primary keys selected. (It takes an optional list of columns too) \xFE";
 z+="*          2) ReadNext takes the next ID from the list are returns it.\xFE";
 z+="*          3) Locate, Extract, Delete, Insert, and Variable<x> are R83 style functions for working with Multi-valued data (see http://jes.com/pb/pb_wp1.html )\xFE";
 z+="*          4) Locate and Insert are great for sorting data\xFE";
 z+="*          5)\xFE";
 z+="\xFE";
 z+="    Select F_file Else\xFE";
 z+="        Print @(-1):@Errors\xFE";
 z+="        Stop @Errors\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Catagories = {}\xFE";
 z+="    Loop While 1 Do\xFE";
 z+="        ReadNext Id Else Break\xFE";
 z+="        i_Read Item From F_file, Id Then Else Item = \"\"\xFE";
 z+="\xFE";
 z+="        If Item And Left(Id, 1) <> \"_\" Then\xFE";
 z+="            Item = Left(Item, 3000)\xFE";
 z+="            Item = Trim(DropTags(Item))\xFE";
 z+="            C = Field(Field(Field(Field(Field(Field(Item[1,1000], \" Category:\", 2), \";\", 1), \"<\", 1), Chr(254), 1), Chr(10), 1), Chr(13), 1)\xFE";
 z+="            If C Then\xFE";
 z+="                If Count(C, \"|\") = 0 Then C = \"Reference|\":C:\"|\":Field(Field(Id, \".HTM\", 1), \".htm\", 1)\xFE";
 z+="                If Count(C, \"|\") = 1 Then C := \"|\":Field(LCase(Id), \".htm\", 1)\xFE";
 z+="                C = Split(C, \"|\")\xFE";
 z+="                SubA = Catagories\xFE";
 z+="\xFE";
 z+="                For Each Catagory, CatI In C\xFE";
 z+="                    Catagory = Trim(Catagory)\xFE";
 z+="                    If CatI = UBound(C) Then Break\xFE";
 z+="                    If IsNum(Catagory) Then Catagory = \":\":Catagory\xFE";
 z+="                    If !SubA[Catagory] Then SubA[Catagory] = {}\xFE";
 z+="                    SubA = SubA[Catagory]\xFE";
 z+="                Next\xFE";
 z+="\xFE";
 z+="                SubA[Catagory] = { id: id }\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    Repeat\xFE";
 z+="\xFE";
 z+="    Catagories = SortByTags(Catagories, True)\xFE";
 z+="    For Each Tag In Catagories\xFE";
 z+="        SubC = Catagories[Tag]\xFE";
 z+="        SubC = SortByTags(SubC, True)\xFE";
 z+="\xFE";
 z+="        For Each subTag In SubC\xFE";
 z+="            SubCC = SubC[subTag]\xFE";
 z+="            SubC[subTag] = SortByTags(SubCC, True)\xFE";
 z+="        Next\xFE";
 z+="\xFE";
 z+="        Catagories[Tag] = SubC\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    Write Catagories On F_file, \"__treeCatagories\"\xFE";
 z+="\xFE";
 z+="    Return Catagories\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function UpdateAnExampleCatagory(F_file, Id, Catagories)\xFE";
 z+="*  Notes - 1) Select returns a list of all primary keys selected. (It takes an optional list of columns too) \xFE";
 z+="*          2) ReadNext takes the next ID from the list are returns it.\xFE";
 z+="*          3) Locate, Extract, Delete, Insert, and Variable<x> are R83 style functions for working with Multi-valued data (see http://jes.com/pb/pb_wp1.html )\xFE";
 z+="*          4) Locate and Insert are great for sorting data\xFE";
 z+="*          5)\xFE";
 z+="\xFE";
 z+="    If Left(Id, 1) = \"_\" Then Return False\xFE";
 z+="\xFE";
 z+="    i_Read Item From F_file, Id Then Else Return False\xFE";
 z+="\xFE";
 z+="    Item = Left(Item, 3000)\xFE";
 z+="    Item = Trim(DropTags(Item))\xFE";
 z+="\xFE";
 z+="    C = Field(Field(Field(Field(Field(Field(Item[1,1000], \" Category:\", 2), \";\", 1), \"<\", 1), Chr(254), 1), Chr(10), 1), Chr(13), 1)\xFE";
 z+="\xFE";
 z+="    If C Then\xFE";
 z+="        If Count(C, \"|\") = 0 Then C = \"Reference|\":C:\"|\":Field(Field(Id, \".HTM\", 1), \".htm\", 1)\xFE";
 z+="        If Count(C, \"|\") = 1 Then C := \"|\":Field(LCase(Id), \".htm\", 1)\xFE";
 z+="        C = Split(C, \"|\")\xFE";
 z+="        SubA = Catagories\xFE";
 z+="\xFE";
 z+="        For Each Catagory, CatI In C\xFE";
 z+="            If CatI = UBound(C) Then Break\xFE";
 z+="            If IsNum(Catagory) Then Catagory = \":\":Catagory\xFE";
 z+="            If !SubA[Catagory] Then SubA[Catagory] = {}\xFE";
 z+="            SubA = SubA[Catagory]\xFE";
 z+="        Next\xFE";
 z+="\xFE";
 z+="        SubA[Catagory] = { id: id }\xFE";
 z+="        If SubA[Catagory] <> { id: id } Then  SubA[Catagory] = { id: id }\xFE";
 z+="    End If\xFE";
 z+="    Return True\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="Program showExample()\xFE";
 z+="    ExampleName = field(field(@sentence, \"(\", 1), \" \", 2)\xFE";
 z+="    If !ExampleName Then Stop \"showExample ExampleName\"\xFE";
 z+="\xFE";
 z+="    Open \"dict\", \"jsb_examples\" To F Else\xFE";
 z+="        F = Fhandle(\"dict\", \"jsb_examples\", True)\xFE";
 z+="        If !F Then Stop @Errors\xFE";
 z+="        Write \"R-\" On F, \"options.txt\" Else Stop @Errors\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Read mdItem from fHandle('md'), ExampleName Then\xFE";
 z+="        If System(1) = \"js\" Then\xFE";
 z+="            Read Src From F, ExampleName:\".js\" Then Chain ExampleName\xFE";
 z+="        Else\xFE";
 z+="                Read Src From F, ExampleName:\".pcd\" Then Chain ExampleName\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Execute \"basic jsb_examples \":ExampleName Capturing Results\xFE";
 z+="    If Instr(Results, \"^\") Then Stop Results\xFE";
 z+="\xFE";
 z+="    Print @(-1):\xFE";
 z+="    \xFE";
 z+="    Chain ExampleName\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["help"]=z;
var z="\xFE";
 z+="Program IDE\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="   call IDE\xFE";
 z+="end program\xFE";
 z+="\xFE";
 z+="Subroutine IDE\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    roleMsg = Iff(@IsAuthenticated, \"\", \"You must be logged in to view this page. \":@Anchor(@LoginUrl, \"Click here to login\"))\xFE";
 z+="    If !@IsEmployee Then Stop Iff(roleMsg, roleMsg, \"You must be at least an employee to view this page.\")\xFE";
 z+="    \xFE";
 z+="    Theme('lumen')\xFE";
 z+="    tabID = \"ideTabs\"\xFE";
 z+="    treeID = \"ideTree\"\xFE";
 z+="    \xFE";
 z+="    CenterHtml = @Jsb_html.TABS(tabID, \"\", \"\", \"\", \"\", \"\", \"\")\xFE";
 z+="    WestOptions = \"startsize: 270px\"\xFE";
 z+="    Theme = \"jsb_themes.\":@jsbConfig(\"default_jsb_Themes\", \"theme_none\")\xFE";
 z+="    NorthHtml = \"\"; NorthOptions = \"\"; SouthOptions = \"\"; EastOptions = \"\"\xFE";
 z+="    \xFE";
 z+="    Loop\xFE";
 z+="        Tree = @ideapi_BuildTreeView(tabID)\xFE";
 z+="        WestHtml = @Div('', jsonTree(treeID, Tree), { style: 'height: 98%; width: 100%' })\xFE";
 z+="        \xFE";
 z+="        Html = @Jsb_html.LAYOUT(CenterHtml, NorthHtml, NorthOptions, \"South\", SouthOptions, \"East\", EastOptions, WestHtml, WestOptions)\xFE";
 z+="        Html := @Script(`function westToggle() {$(\"#mylayout\").layout().toggle(\"west\");}`)\xFE";
 z+="        Html := @Script(`function westHide() { if (innerWidth < 1024) $(\"#mylayout\").layout().close(\"west\");}`)\xFE";
 z+="        Html := @ideapi_ReloadTreeScript(tabID, treeID)\xFE";
 z+="        \xFE";
 z+="        Html = @((Theme))(System(27),System(28), Html)\xFE";
 z+="        \xFE";
 z+="        Print @(-1):Html:\xFE";
 z+="        \xFE";
 z+="        @Server.Pause\xFE";
 z+="        Cmd =  @formVar(\"SelectedMenu\")\xFE";
 z+="        ItemID =  @formVar(\"itemID\")\xFE";
 z+="    Until Cmd = 'Quit' Do\xFE";
 z+="    Repeat\xFE";
 z+="\xFE";
 z+="    If @HasParentProcess Then Stop @(-1) Else @Server.End\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="sub IDE_customMenu(tabID, jsonMenu)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    //     // ******************* Open / Close     // ******************* \xFE";
 z+="    onclick = 'westToggle()'\xFE";
 z+="    //Hamburger = @Button('', @Html(`<span class=\"glyphicon glyphicon-forward\"></span>`), { onclick: { onclick: onclick, style: 'min-width: 15px; padding-top: 2px; padding-bottom: 2px;' } } )\xFE";
 z+="    //JsonMenu.htmlFip = Hamburger\xFE";
 z+="    JsonMenu.iconOpenClose = {\"id\":\"openclose\",\"glyphicon\":\"forward\", onclick: onclick } \xFE";
 z+="    \xFE";
 z+="    // ******************* upload     // ******************* \xFE";
 z+="    Url = @jsbRestCall('dbUploadDatabase'):`?tabID=`:@UrlEncode(tabID):`&noCache=`:timer()\xFE";
 z+="    onclick =  `openInTab(`:jsEscapeString(tabID):`, \"Upload_Database\", \"Upload directory\", `:jsEscapeString(Url):`);`\xFE";
 z+="    JsonMenu.File = {} \xFE";
 z+="    JsonMenu.File.Upload = { id: \"upload\", caption:\"Upload MS Access DB\", onclick: onclick }\xFE";
 z+="    \xFE";
 z+="    // JsonMenu.iconNewDB= {\"id\":\"uploaddatabase\",\"glyphicon\":\"calendar\", onclick: onclick } \xFE";
 z+="    \xFE";
 z+="    JsonMenu.collaspable = true\xFE";
 z+="    \xFE";
 z+="    if !hasTag(JsonMenu, \"rightalign\") Then JsonMenu.rightalign = True \xFE";
 z+="    if @hasTclParent Then \xFE";
 z+="        JsonMenu.btnQuit = \"Quit\" ;* put into @FormVar('SelectedMenu') will be \"Quit\"\xFE";
 z+="    End If\xFE";
 z+="end sub\xFE";
 z+="    \xFE";
 z+="function ideapi_ReloadTreeScript(tabID, treeID)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    // create a script to reload tree when we delete or add a new directory or file\xFE";
 z+="    Return @Script(`\xFE";
 z+="        function reloadDbTree() {\xFE";
 z+="            var url = '`:@jsbRestCall('ideapi_BuildTreeView'):`?tabID=`:tabID:`&cacheBuster=' + newGUID();\xFE";
 z+="            \xFE";
 z+="            ajaxCall(\"GET\", url, null, function(newTree) { \xFE";
 z+="                var openedFolders = getTreeOpenedFolders();\xFE";
 z+="                $(\".css-treeview\").html(jsonTree(newTree));\xFE";
 z+="                reopenTreeFolders(openedFolders);\xFE";
 z+="            })\xFE";
 z+="        }\xFE";
 z+="    `)\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="Restful function ideapi_BuildTreeView(tabID)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    Return ideapi_BuildTreeView(tabID)\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="// Build top level of tree\xFE";
 z+="function ideapi_BuildTreeView(tabID)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    projectGroups = ideGetProjectGroups(tabID)\xFE";
 z+="    Return ideProjectFolders(tabID, projectGroups, {})\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="// 1st level - Project folders (accounts)\xFE";
 z+="function ideProjectFolders(tabID, projectSubGroup, Optional Byval Tree)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    If !Tree Then Tree = {}\xFE";
 z+="    \xFE";
 z+="    For Each levelName In projectSubGroup\xFE";
 z+="        Level = projectSubGroup[levelName]\xFE";
 z+="\xFE";
 z+="        If Isjson(Level) Then // *** more tree grouping\xFE";
 z+="            Tree[levelName] = ideProjectFolders(tabID, Level)\xFE";
 z+="            \xFE";
 z+="        Else If Isarray(Level) Then // *** an array of databases\xFE";
 z+="            treeBranch = {}\xFE";
 z+="            For Each accountName In Level\xFE";
 z+="                leafName = accountName\xFE";
 z+="                if Left(leafName, 1) = \"Z\" And InStr(leafName, \"-\") Then leafName = DropLeft(leafName, \"-\")\xFE";
 z+="                treeBranch[leafName] = { url: ideapi_fetchProjectFoldersURL(tabID, accountName), data: accountName }\xFE";
 z+="            Next\xFE";
 z+="            Tree[levelName] = treeBranch\xFE";
 z+="            \xFE";
 z+="        Else // *** a single directory\xFE";
 z+="            If Level Then accountName = Level Else accountName = levelName\xFE";
 z+="            Tree[levelName] = { url: ideapi_fetchProjectFoldersURL(tabID, accountName), data: accountName }\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    Return Tree\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="// 1st level - Project folders (accounts)\xFE";
 z+="function ideapi_fetchProjectFoldersURL(tabID, accountName)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    Url = @jsbRestCall('ideapi_FetchProjectFolders'):`?tabID=`:@UrlEncode(tabID)\xFE";
 z+="    If accountName Then Url := `&accountName=`:@UrlEncode(accountName)\xFE";
 z+="    Url := `&noCache=`:Timer()\xFE";
 z+="    Return Url\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="// 1nd level -> contain list of files\xFE";
 z+="Restful function ideapi_FetchProjectFolders(tabID, accountName)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    accountName = Replace(Replace(accountName, `[`, ``), `]`, ``)\xFE";
 z+="    \xFE";
 z+="    Files = @ideListOfFiles(accountName)\xFE";
 z+="    Tree = {}\xFE";
 z+="    \xFE";
 z+="    for each FileName in Files\xFE";
 z+="        Tree[FileName] = { url: ideapi_fetchItemListURL(tabID, accountName, FileName), data: accountName:\"*\":FileName }\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    Return Tree\xFE";
 z+="End Sub\xFE";
 z+="\xFE";
 z+="function ideListOfFiles(accountName)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    Attachdb accountName Then\xFE";
 z+="        Listfiles To TableNames Else Return { Errors: @Errors }\xFE";
 z+="        TableNames = Split(TableNames, am())\xFE";
 z+="        TableNames = @Sort(TableNames)\xFE";
 z+="    Else\xFE";
 z+="        Attachdb \"databaseBuilder_ro\" Else Return { Errors: \"Unable to open directory:\": accountName }\xFE";
 z+="        Sql = `use [`:accountName:`]; SELECT table_name FROM information_schema.tables WHERE table_type = 'base table'  Order By table_name`\xFE";
 z+="        Sqlselect Sql To Sl Else Return ({ Errors: @Errors })\xFE";
 z+="        \xFE";
 z+="        Recs = GetList(Sl)\xFE";
 z+="        TableNames = []\xFE";
 z+="        For Each Rec In Recs\xFE";
 z+="            TableNames[-1] = Rec.table_name\xFE";
 z+="        Next\xFE";
 z+="    End If\xFE";
 z+="    return TableNames\xFE";
 z+="End function\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="// 2nd level - givn file -> list of items\xFE";
 z+="function ideapi_fetchItemListURL(tabID, accountName, fileName)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    Url = @jsbRestCall('ideapi_FetchItemList'):`?tabID=`:@UrlEncode(tabID):`&accountName=`:@UrlEncode(accountName):`&fileName=`:@UrlEncode(fileName)\xFE";
 z+="    Url := `&noCache=`:Timer()\xFE";
 z+="    Return Url\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function attachAccount(accountName)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    accountName = Replace(Replace(accountName, `[`, ``), `]`, ``)\xFE";
 z+="\xFE";
 z+="    Attachdb accountName ELse\xFE";
 z+="        Attachdb \"databaseBuilder_ro\" Else @Errors = \"Unable to attach to account:\": accountName:crlf():@errors \xFE";
 z+="    End If\xFE";
 z+="    return true\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="Restful function ideapi_FetchItemList(tabID, accountName, fileName)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    accountName = Replace(Replace(accountName, `[`, ``), `]`, ``)\xFE";
 z+="    if !attachAccount(accountName) Then return { Errors: \"Unable to open directory:\" :accountName:crlf():@errors }\xFE";
 z+="\xFE";
 z+="    open fileName to fFile else Return { Errors: \"Unable to open file:\": fileName:crlf():@errors }\xFE";
 z+="    \xFE";
 z+="    select fFile to sl else Return { Errors: \"Unable to select file:\": fileName:crlf():@errors } \xFE";
 z+="    \xFE";
 z+="    itemlist = getlist(sl)\xFE";
 z+="    Tree = {}\xFE";
 z+="\xFE";
 z+="    for each ItemID in itemlist\xFE";
 z+="        Url = ideEditorURL(tabID, accountName, fileName, ItemID)\xFE";
 z+="        tabCaption =  accountName:\" \":fileName:\" \":ItemID\xFE";
 z+="        id = accountName:\"_\":fileName:\"_\":ItemID\xFE";
 z+="        onItemIDClick = `openInTab(`:jsEscapeString(tabID):`, `:jsEscapeString(accountName:\"_\":fileName:\"_\":ItemID):`, `:jsEscapeString(tabCaption):`, `:jsEscapeString(Url):`); westHide();`\xFE";
 z+="        Tree[ItemID] = { id: id, caption: ItemID, onclick: onItemIDClick }\xFE";
 z+="    next\xFE";
 z+="    \xFE";
 z+="    Return Tree\xFE";
 z+="End Sub\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="function ide_GetDBList(projectSubGroup)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    dbList = []\xFE";
 z+="    \xFE";
 z+="    For Each levelName In projectSubGroup\xFE";
 z+="        Level = projectSubGroup[levelName]\xFE";
 z+="\xFE";
 z+="        If Isjson(Level) Then \xFE";
 z+="            ideProjectFolders(Level, dbList)\xFE";
 z+="            \xFE";
 z+="        Else If Isarray(Level) Then // *** an array of databases\xFE";
 z+="            For Each accountName In Level\xFE";
 z+="                dbList[-1] = accountName\xFE";
 z+="            Next\xFE";
 z+="            \xFE";
 z+="        Else // *** a single directory\xFE";
 z+="            If Level Then accountName = Level Else accountName = levelName\xFE";
 z+="            dbList[-1] = accountName\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    Return dbList\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function ideGetProjectGroups(tabID)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    // databaseNames = dbGetDatabaseNames()\xFE";
 z+="    databaseNames = [@jsbAccount]\xFE";
 z+="    okToUpdate = True\xFE";
 z+="    \xFE";
 z+="    // projectGroups is a { groupname: [directory..], ... }\xFE";
 z+="    Readjson projectGroups From @fJsbConfig, \"ideProjectGroups\" Then\xFE";
 z+="        If HasTag(projectGroups, \"ItemID\") Then \xFE";
 z+="            Ans = msgbox(\"Your ideProjectGroups config file is currupt.  Reset?\", \"Yes,No,Quit\")\xFE";
 z+="            okToUpdate = Ans = \"Yes\"\xFE";
 z+="            if Ans = Chr(27) Or Ans = \"No\" Then stop\xFE";
 z+="            projectGroups = {}\xFE";
 z+="        end if\xFE";
 z+="    Else\xFE";
 z+="        projectGroups = {}\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    definedDBs = ide_GetDBList(projectGroups)\xFE";
 z+="    \xFE";
 z+="    // Make sure each directory is represented somewhere\xFE";
 z+="    Changed = False\xFE";
 z+="\xFE";
 z+="    // make sure each directory is defined somewhere\xFE";
 z+="    orphedAccounts = []\xFE";
 z+="    For Each accountName In databaseNames\xFE";
 z+="        Locate LCase(accountName) In definedDBs Else orphedAccounts[-1] = accountName\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Len(orphedAccounts) Then\xFE";
 z+="        // make sure misc group exists\xFE";
 z+="        miscName = \"Accounts\"\xFE";
 z+="        Misc = projectGroups[miscName]\xFE";
 z+="        If !Misc Then\xFE";
 z+="            Misc = []\xFE";
 z+="            projectGroups[miscName] = Misc\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        For Each accountName In orphedAccounts\xFE";
 z+="            Misc[-1] = accountName\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        if okToUpdate Then Writejson projectGroups On @fJsbConfig, \"ideProjectGroups\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Return projectGroups\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function ideListOfRecentItems(tabID, accountName)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    recentFiles = {}\xFE";
 z+="    \xFE";
 z+="    readjson recentList from @fHandle(\"\", \"tmp\", true), @UserName:\"_ideRecentFiles\" then\xFE";
 z+="        For Each accountName In recentList\xFE";
 z+="            recentFileNames = recentList[accountName]\xFE";
 z+="            For Each fileName In recentFileNames\xFE";
 z+="                Url = ideEditorURL(tabID, fileName, accountName, ItemID)\xFE";
 z+="                tabCaption = accountName:\" \":fileName\xFE";
 z+="                onTableClick = `openInTab(`:jsEscapeString(tabID):`, `:jsEscapeString(accountName:\"_\":fileName):`, `:jsEscapeString(tabCaption):`, `:jsEscapeString(Url):`); westHide();`\xFE";
 z+="                recentFiles[fileName] = { id: fileName, onclick: onTableClick }\xFE";
 z+="            Next\xFE";
 z+="        Next\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Return recentFiles\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="function ideEditorURL(tabID, accountName, fileName, itemName)\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    Return @jsbRootAccount():`ideEditor?tabID=`:@UrlEncode(tabID):`&accountName=`:@UrlEncode(accountName):`&fileName=`:@UrlEncode(fileName):`&itemName=`:@UrlEncode(itemName)\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="program ideEditor\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    accountName = Replace(Replace(accountName, `[`, ``), `]`, ``)\xFE";
 z+="    if !attachAccount(accountName) Then stop @errors\xFE";
 z+="\xFE";
 z+="    tabID = @QueryVar('tabID')\xFE";
 z+="    accountName = @QueryVar('accountName')\xFE";
 z+="    fileName = @QueryVar('fileName')\xFE";
 z+="    itemName = @QueryVar('itemName')\xFE";
 z+="    \xFE";
 z+="    print \"editing \": accountName:\" \":fileName:\" \":itemName\xFE";
 z+="    stop\xFE";
 z+="    \xFE";
 z+="    @Server.End\xFE";
 z+="end program\xFE";
 z+="\xFE";
 z+="/*\xFE";
 z+="\xFE";
 z+="program ide_createtable\xFE";
 z+="    print @(-1):setStyle('body', 'background-color', 'white'):setStyle('body', 'color', 'black'):\xFE";
 z+="    if system(1) = \"js\" then print @script(`$('#jsbAdminBar').hide()`):\xFE";
 z+="    \xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    print @Center(\"Name your new table\"):\xFE";
 z+="    print @Center(@textBox('id', '', false, { style: 'width: 98%' })):\xFE";
 z+="    Print @Center(@submitbtn(\"Btn\", \"OK\"):\" \":@submitbtn(\"Btn\", \"Cancel\"))\xFE";
 z+="    \xFE";
 z+="    @Server.Pause\xFE";
 z+="    tblName = @FormVar('id')\xFE";
 z+="    if @FormVar('Btn') = \"Cancel\" or tblname = \"\"  Then Goto Quit\xFE";
 z+="    \xFE";
 z+="    open tblname to x then\xFE";
 z+="        print @msgbox(\"Table already exists\"):\xFE";
 z+="        goto Quit\xFE";
 z+="    end if\xFE";
 z+="        \xFE";
 z+="    CREATEFILE tblname ELSE STOP @ERRORS\xFE";
 z+="\xFE";
 z+="    if system(1) <> \"js\" THEN \xFE";
 z+="        this = this\xFE";
 z+="    else\xFE";
 z+="        CREATEFILE \"DICT \":tblname ELSE STOP @ERRORS\xFE";
 z+="        newTree = ide_buildtree(true)\xFE";
 z+="        newTree = ide_convert2html(newTree)\xFE";
 z+="        window.parent.$('.css-treeview').html(this.Newtree)\xFE";
 z+="        window.parent.$('.treeFolder_Tables > input').prop( \"checked\", true );\xFE";
 z+="        window.parent.$('.treeFolder_' + nicename(tblName) + ' > input').prop( \"checked\", true );\xFE";
 z+="        @response.redirect(@jsbRestCall(`#close_html`))\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="quit:\xFE";
 z+="    if system(1) = \"js\" THEN window.parent.$('#popOutDIV').dialog(\"close\")\xFE";
 z+="    @server.End\xFE";
 z+="end program  \xFE";
 z+="\xFE";
 z+="program ide_createitem\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    ListFiles To L Else Stop @Errors \xFE";
 z+="    \xFE";
 z+="lp:\xFE";
 z+="    print @(-1):setStyle('body', 'background-color', 'white'):setStyle('body', 'color', 'black'):\xFE";
 z+="    if system(1) = \"js\" then print @script(`$('#jsbAdminBar').hide()`):\xFE";
 z+="    \xFE";
 z+="    print @Center(\"Pick your table and new item\")\xFE";
 z+="    \xFE";
 z+="    print @label(\"ItemID\",\"id\"):@textBox('id', '', false, { style: 'width: 200px' })\xFE";
 z+="    print @label(\"File\",\"id\"):DropDownBox('fname', L, \"\", false, false, { style: 'width: 200px' }) ;* DropDownBox(ID, VALUES, DEFAULT, ADDBLANK, ReadOnly, AdditionalAttributes, subDelimetersOK\xFE";
 z+="    print\xFE";
 z+="    Print @label(\"\",\"\"):@submitbtn(\"Btn\", \"OK\"):\" \":@submitbtn(\"Btn\", \"Cancel\")\xFE";
 z+="    \xFE";
 z+="    @Server.Pause\xFE";
 z+="    itmName = @FormVar('id')\xFE";
 z+="    fname = @FormVar('fname')\xFE";
 z+="    \xFE";
 z+="    if @FormVar('Btn') = \"Cancel\"  Then Goto Quit\xFE";
 z+="    if fname = \"\" or itmName = \"\" then\xFE";
 z+="        msgbox(\"Please select an itemID and Table\")\xFE";
 z+="        goto lp\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    open fname to x else\xFE";
 z+="        print @msgbox(fname:\" does not exists!\"):\xFE";
 z+="        goto Quit\xFE";
 z+="    end if\xFE";
 z+="        \xFE";
 z+="    read itm from x, itmName else \xFE";
 z+="        write \"\" on x, itmName else\xFE";
 z+="            print @msgbox(@Errors):\xFE";
 z+="            goto Quit\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if system(1) <> \"js\" THEN \xFE";
 z+="        this = this\xFE";
 z+="    else\xFE";
 z+="        newTree = ide_buildtree(true)\xFE";
 z+="        newTree = ide_convert2html(newTree)\xFE";
 z+="        window.parent.$('.css-treeview').html(this.Newtree)\xFE";
 z+="        window.parent.$('.treeFolder_Tables > input').prop( \"checked\", true );\xFE";
 z+="        window.parent.$('.treeFolder_' + nicename(fname) + ' > input').prop( \"checked\", true );\xFE";
 z+="        window.parent.$('#popOutDIV').dialog(\"close\")\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="quit:\xFE";
 z+="    if system(1) = \"js\" THEN window.parent.$('#popOutDIV').dialog(\"close\")\xFE";
 z+="    @server.End\xFE";
 z+="end program  \xFE";
 z+="\xFE";
 z+="subroutine ide\xFE";
 z+="*\xFE";
 z+="* ide table itemname \xFE";
 z+="*\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    S = TRIM(Field(@SENTENCE, \"(\", 1))\xFE";
 z+="    tableName = FIELD(S, \" \", 2)\xFE";
 z+="    ItemID = FIELD(S, \" \", 3)\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    jsbUrl = @jsbconfig(\"jsburl\", \"//jsbwinforms.azurewebsites.net/\")\xFE";
 z+="    if Right(jsbUrl, 1) <> \"/\" Then jsbUrl := \"/\"\xFE";
 z+="    MenuBar.Help = `new popoutWindow('', jsbUrl:'sysprog/help', '80%', '80%')`\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    MenuBar = @jsb_html.MenuBar(MenuBar, \"IDE\", additionalProps)\xFE";
 z+="    MenuBar = MenuBar:@genEventHandler(\"SelectMenu\", \"\", 11, `\xFE";
 z+="      $('#jsb').append('<input type=\"hidden\" id=\"btn\" name=\"btn\" value=\"' + title + '\"/>')\xFE";
 z+="      doJsbSubmit();\xFE";
 z+="   `)\xFE";
 z+="\xFE";
 z+="    * Create Layout\xFE";
 z+="    Html = @jsb_html.LAYOUT(Tabs, MenuBar, \"startsize:30, allowoverflow, Fixed\", \"South\", \"\", \"East\", \"\", ide_buildtree(false), \"startsize:120, minSize:60\")\xFE";
 z+="\xFE";
 z+="    print @(-1):Html:\xFE";
 z+="\xFE";
 z+="    Script = ``\xFE";
 z+="    ***************************************** Empty Folder CLick (get list of items) *****************************************\xFE";
 z+="    if system(1) <> \"js\" Then\xFE";
 z+="        * Click an empty table, and we will ajax call to fill the folder with a list of items\xFE";
 z+="        onSuccess = `\xFE";
 z+="             if (json.errors) {\xFE";
 z+="                alert(json.errors)\xFE";
 z+="             } else {\xFE";
 z+="                for(var key in json) { \xFE";
 z+="                   $.each(json[key], function(i, value) {\xFE";
 z+="                      $(window.myUL).append(\"<li class='treeLeaf'><a>\" + value + \"</a></li>\")\xFE";
 z+="                   });\xFE";
 z+="                }\xFE";
 z+="             }`\xFE";
 z+="        QuotedUrl = `'`:@jsb_bf.jsbRestCall(`editor_getTableItemIDs?tableName='+urlEncode(folderCaption)`)\xFE";
 z+="        AJax = @jsb_bf.Ajax(QuotedUrl, onSuccess)\xFE";
 z+="\xFE";
 z+="        Script = `\xFE";
 z+="         $('#jsb').on(\"click\", \"ul .treeFolder input\", function () { \xFE";
 z+="               var folderCaption = $(this).parent().children('label').text();\xFE";
 z+="               var childCnt = $(this).parent().children('ul').children('li').length;\xFE";
 z+="               \xFE";
 z+="               window.myUL = $(this).parent().children('ul');\xFE";
 z+="               if (childCnt == 0) {\xFE";
 z+="                  // add item to folder\xFE";
 z+="                  if (Left(folderCaption, 1) == '*') folderCaption = Mid(folderCaption, 1)\xFE";
 z+="                  `:AJax:`\xFE";
 z+="               }\xFE";
 z+="           })`\xFE";
 z+="    end if\xFE";
 z+="    ****************************************** ItemID CLick (Load item & update recent list) *****************************************\xFE";
 z+="    Print @genEventHandler(\"launchEdit\", @jsbRootExecuteTclCmd(\"ed {folderCaption} '{leafCaption}'\"), 3, containerName): ;* new tab 2\xFE";
 z+="\xFE";
 z+="    Script = Script:`\xFE";
 z+="       $(\"#jsb\").on(\"click\", \".treeFolder ul .treeLeaf a\", function () { \xFE";
 z+="           var folderCaption = $(this).closest('.treeFolder').children('label').text();\xFE";
 z+="           var leafCaption = $(this).text();\xFE";
 z+="           doTreeSelect(folderCaption, leafCaption)\xFE";
 z+="           return false;\xFE";
 z+="       })\xFE";
 z+="\xFE";
 z+="    function jsonTreeSelect(folderCaption, leafCaption) {\xFE";
 z+="        // place this item in the recent list\xFE";
 z+="        if (Left(folderCaption, 1) == '*') folderCaption = Mid(folderCaption, 1)\xFE";
 z+="\xFE";
 z+="        var folderClass = 'treeFolder_' + nicename(folderCaption); \xFE";
 z+="        var leafClass = 'treeLeaf_' + nicename(leafCaption);\xFE";
 z+="\xFE";
 z+="        $('.treeFolder_Tables > input').prop(\"checked\", false );\xFE";
 z+="\xFE";
 z+="        if ($('.treeFolder_Recent > ul > .'+folderClass + ' > ul > .' + leafClass).length == 0) {\xFE";
 z+="            if ($('.treeFolder_Recent > ul > .'+folderClass).length == 0) {\xFE";
 z+="                $('.treeFolder_Recent > ul').append('<li class=\"treeFolder ' + folderClass + '\"><input type=\"checkbox\"><label for=\"' + folderCaption + '\">' + folderCaption + '</label><ul></ul></li>')\xFE";
 z+="            }\xFE";
 z+="            $('.treeFolder_Recent > ul > .'+folderClass + ' > ul').append('<li class=\"treeLeaf ' + leafClass + '\"><a>' + leafCaption + '</a></li>')\xFE";
 z+="        }\xFE";
 z+="        $('.treeFolder_Recent > input').prop(\"checked\", true );\xFE";
 z+="        $('.' + folderClass + ' > input').prop( \"checked\", true );    \xFE";
 z+="    }\xFE";
 z+="    `\xFE";
 z+="   \xFE";
 z+="   print @Script(Script):\xFE";
 z+="   Print activateNode:\xFE";
 z+="   @Server.Pause\xFE";
 z+="   \xFE";
 z+="   stop @(-1)\xFE";
 z+="end subroutine\xFE";
 z+="\xFE";
 z+="function ide_buildtree(justInside)\xFE";
 z+="    tree = {}\xFE";
 z+="    tree.Recent = {}\xFE";
 z+="    tree.File = {}\xFE";
 z+="    \xFE";
 z+="    read recentList from @fHandle(\"\", \"tmp\", true), @UserName:\"_editorRecentList\" then\xFE";
 z+="        \xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    tbls = tree.File\xFE";
 z+="    \xFE";
 z+="    * Create branch of ListFiles\xFE";
 z+="    ListFiles To TableNames Else Stop @ERRORS\xFE";
 z+="    if system(1) <> \"aspx\" then\xFE";
 z+="        TableNames<-1> = \"jsb_bf\"\xFE";
 z+="        TableNames<-1> = \"jsb_html\"\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    ClearSelect\xFE";
 z+="    TableNames = @Sort(TableNames)\xFE";
 z+="    For Each tblName In TableNames\xFE";
 z+="        itemlist = {}\xFE";
 z+="        tbls[tblName] = itemlist\xFE";
 z+="        \xFE";
 z+="        if system(1) = \"js\" then\xFE";
 z+="            if left(tblname, 2) <> \"./\" and lcase(tblname) <> \"md\" then\xFE";
 z+="                open tblName to fHandle then\xFE";
 z+="                    select fHandle to sl then\xFE";
 z+="                        itemIds = GetList(sl)\xFE";
 z+="                        for each id, idi in itemIds\xFE";
 z+="                            itemList[id] = {}\xFE";
 z+="                            if idi > 300 then exit for\xFE";
 z+="                        next\xFE";
 z+="                    end if\xFE";
 z+="                end if\xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    return @jsonTree(mvTree)\xFE";
 z+="end function    \xFE";
 z+="\xFE";
 z+="\xFE";
 z+="restful function editor_getTableItemIDs(tableName)\xFE";
 z+="    json = {}\xFE";
 z+="    open tableName to fHandle then\xFE";
 z+="        select fHandle to sl then\xFE";
 z+="            mvList = GetList(sl)\xFE";
 z+="            if DCount(mvList, am()) > 300 then mvList = Left(mvlist, Index(mvList, am(), 500)-1)\xFE";
 z+="            json.itemIds = Split(mvList, am())\xFE";
 z+="        else\xFE";
 z+="            json.errors = @errors\xFE";
 z+="        end if\xFE";
 z+="    else\xFE";
 z+="        ' Remove from recent List\xFE";
 z+="        json.errors = @errors\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    return json\xFE";
 z+="end function\xFE";
 z+="*/\xFE";
 z+="\xFE";
 z+="\xFE";
 z+=""
window.cached_jsb_tcl["ide"]=z;
var z="\xFE";
 z+="\xFE";
 z+="Program Ied\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    Buff = []                      ;* Buffers\xFE";
 z+="    P = []                         ;* Pre-stores\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="*     Buff[A]             Buff[B]\xFE";
 z+="*         --------          --------\xFE";
 z+="*       1 : XXXX :        1 : XXXX :\xFE";
 z+="*         --------          --------\xFE";
 z+="*  SP-> 2 : NEXT TO   DP->2 :      :\xFE";
 z+="*         --------          --------\xFE";
 z+="*       3 : YYYY :        3 :      :\xFE";
 z+="*         --------          --------\xFE";
 z+="*  LINENO : YYYY :        4 :      :\xFE";
 z+="*         --------          --------\xFE";
 z+="*       5 : YYYY :        5 :      :\xFE";
 z+="*         --------          --------\xFE";
 z+="*\xFE";
 z+="*     EOI : YYYY :        6 :      :\xFE";
 z+="*         --------          --------\xFE";
 z+="*       8 :      :        8 :      :\xFE";
 z+="*         --------          --------\xFE";
 z+="*\xFE";
 z+="* SUBROUTINES:\xFE";
 z+="*   300  FLIP\xFE";
 z+="*   400  CATCHUP EXCLUDING CURRENT LINE\xFE";
 z+="*   500  CATCHUP INCLUDING CURRENT LINE\xFE";
 z+="*   600  PARSE NN / SS / RR /       (DEL IN C)\xFE";
 z+="*   800  DELETE LINENO to NN using pattern SS\xFE";
 z+="*   900  Flip buffer, maintain LINENO\xFE";
 z+="*  8000  From LINENO find next SS\xFE";
 z+="*  9000  Check for valid block markers\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="    Help = 'ED TableName <ITEMNAMES>'\xFE";
 z+="* CHECK FOR EDIT-LIST XX\xFE";
 z+="* TCLREAD SENTENCE\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    Sentence = @Sentence\xFE";
 z+="    Cmd = Field(Sentence,' ',1)\xFE";
 z+="    Cmd = Field(Cmd, '\\\\', Dcount(Cmd, '\\\\'))\xFE";
 z+="    If Index(Cmd,'L',1) Then\xFE";
 z+="        Fname = '&SAVEDLISTS&'\xFE";
 z+="    End Else\xFE";
 z+="        Fname = ''\xFE";
 z+="    End\xFE";
 z+="    Cmdl = 'No previous locate'\xFE";
 z+="    Savecmd = ''\xFE";
 z+="    For I = 1 To 9 ; P[I] = ''; Next I\xFE";
 z+="    Rcmd = 'No previous replace'\xFE";
 z+="    P[1] = 'L20'\xFE";
 z+="    Ss = ''\xFE";
 z+="    Autoflip = 1\xFE";
 z+="\xFE";
 z+="    Filei = 1\xFE";
 z+="    Prompt \"\"\xFE";
 z+="*\xFE";
 z+="* Specific file(s) given?\xFE";
 z+="*\xFE";
 z+="    Itemlist = Trim(@Sentence)\xFE";
 z+="*\xFE";
 z+="    Firstcmd = \"\"\xFE";
 z+="    Options = Field(Itemlist,'(',2)\xFE";
 z+="    Itemlist = Field(Itemlist, '(', 1)\xFE";
 z+="    If Options = '' Then\xFE";
 z+="        Options = Field(Itemlist,'[',2)\xFE";
 z+="        Options = Field(Options,']',1)\xFE";
 z+="        Itemlist = Field(Itemlist,'[',1)\xFE";
 z+="    End Else\xFE";
 z+="        Options = Field(Options,')',1)\xFE";
 z+="    End\xFE";
 z+="    Options = Field(Options,' ',1)\xFE";
 z+="    Options = Trim(Options)\xFE";
 z+="    Itemlist = Trim(Itemlist)\xFE";
 z+="*\xFE";
 z+="    J = 1\xFE";
 z+="    Loop I = Index(Itemlist,' ',J) While I Do\xFE";
 z+="        If Mcu(Itemlist[I-4,4]) = 'DICT' Then\xFE";
 z+="            Itemlist = Itemlist[1,I-1]:' ':Itemlist[I+1, 9999]\xFE";
 z+="            J = J + 1\xFE";
 z+="        End Else\xFE";
 z+="            Itemlist = Itemlist[1,I-1]:am():Itemlist[I+1, 9999]\xFE";
 z+="        End\xFE";
 z+="    Repeat\xFE";
 z+="*\xFE";
 z+="    If Fname = '' Then\xFE";
 z+="        If Itemlist<2> = '' Then\xFE";
 z+="            If Help = '' Then\xFE";
 z+="                Print Itemlist<1>:' TableName ItemID(s) (Options'\xFE";
 z+="            End Else\xFE";
 z+="                Helpcnt = Count(Help,am())+ (Help#'')\xFE";
 z+="                For I = 1 To Helpcnt ; Print Help<I> ; Next I\xFE";
 z+="            End\xFE";
 z+="            Stop\xFE";
 z+="        End\xFE";
 z+="        *\xFE";
 z+="        Fname = Itemlist<2>\xFE";
 z+="        Itemlist = Delete(Itemlist,1,0,0)\xFE";
 z+="    End\xFE";
 z+="    Itemlist = Delete(Itemlist,1,0,0)\xFE";
 z+="*\xFE";
 z+="    Readnext Id Then\xFE";
 z+="        Itemlist<-1> = Id\xFE";
 z+="        Allitems = 0\xFE";
 z+="    End Else\xFE";
 z+="        Allitems = Itemlist<1> = '' Or Itemlist<1> = '*'\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    Errors = ''\xFE";
 z+="    If Mcu(Fname[1,5]) = 'DICT ' Then\xFE";
 z+="        TableName = Fname[6, 9999]\xFE";
 z+="        Dictdata = 'DICT'\xFE";
 z+="    End Else\xFE";
 z+="        TableName = Fname\xFE";
 z+="        Dictdata = 'DATA'\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    I_open Dictdata,TableName To F_file Else\xFE";
 z+="        TableName = Mcl(TableName)\xFE";
 z+="        Fname = Mcl(Fname)\xFE";
 z+="        I_open Dictdata,TableName To F_file Else\xFE";
 z+="            TableName = Mcu(TableName)\xFE";
 z+="            Fname = Mcu(Fname)\xFE";
 z+="            I_open Dictdata, TableName To F_file Else\xFE";
 z+="                Print 'FILE ':Fname:' NOT FOUND'\xFE";
 z+="                Stop\xFE";
 z+="            End\xFE";
 z+="        End\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    If Allitems Then\xFE";
 z+="        Itemlist = ''\xFE";
 z+="        *     PERFORM 'SSELECT ':FNAME\xFE";
 z+="        I_select F_file Else Stop @Errors\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    Itemi = 1\xFE";
 z+="    Loop\xFE";
 z+="        Iname = Itemlist<Itemi>\xFE";
 z+="        If Iname = '' Then\xFE";
 z+="            Loop Readnext Iname Else Iname = '' While Iname[1,1]='$' Do Repeat\xFE";
 z+="        End Else Itemi = Itemi + 1\xFE";
 z+="    While Iname # '' Do Gosub 100 Repeat\xFE";
 z+="*\xFE";
 z+="    If Errors # '' Then\xFE";
 z+="        Errcnt = Count(Errors,am())+ (Errors#'')\xFE";
 z+="        For I = 1 To Errcnt ; Print Errors<I> ; Next I\xFE";
 z+="    End\xFE";
 z+="    Stop\xFE";
 z+="*\xFE";
 z+="*PROGRAM SHELL\xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="    Stop\xFE";
 z+="*\xFE";
 z+="100: *\xFE";
 z+="*\xFE";
 z+="* ERRORS, INAME, FNAME, TableName(NO DD), F_FILE, UV\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="    Lineno = 0                        ;* Range 0__EOI\xFE";
 z+="    A = 1 ; B = 2\xFE";
 z+="    Startm = 0 ; Endm = 0\xFE";
 z+="    Sp = 1                            ;* Range 1__EOI+1\xFE";
 z+="    Buff[1] = \"\"\xFE";
 z+="    Buff[2] = \"\"\xFE";
 z+="    Dp = 1\xFE";
 z+="*\xFE";
 z+="    Print \"'\":Fname:' ':Iname:\"'\"\xFE";
 z+="*\xFE";
 z+="    I_read Item From F_file, Iname Then\xFE";
 z+="        If Instr(Item, Chr(13)) Or Instr(Item, Chr(10)) Then\xFE";
 z+="            Item = Replace(Item, Chr(13):Chr(10), Chr(254))\xFE";
 z+="            Item = Replace(Item, Chr(13), Chr(254))\xFE";
 z+="            Item = Replace(Item, Chr(10), Chr(254))\xFE";
 z+="        End If\xFE";
 z+="        Eoi = Count(Item,am())+(Item#\"\")\xFE";
 z+="        Buff[A] = Item\xFE";
 z+="        If Eoi > 999 Then Lc = 4 Else Lc = 3\xFE";
 z+="        If Eoi = 1 Then\xFE";
 z+="            Print '1 line'\xFE";
 z+="        End Else\xFE";
 z+="            Print Eoi:' lines'\xFE";
 z+="        End\xFE";
 z+="    End Else\xFE";
 z+="        Eoi = 0\xFE";
 z+="        Lc = 3\xFE";
 z+="        Print 'New item'\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    Quit = 0\xFE";
 z+="    Loop\xFE";
 z+="        If Lineno = 0 Then\xFE";
 z+="            Print 'Top'\xFE";
 z+="        End Else\xFE";
 z+="            If Lineno = Eoi Then Print Eoi:' lines.'\xFE";
 z+="        End\xFE";
 z+="        Oldlineno = Lineno\xFE";
 z+="        Print '.':\xFE";
 z+="        If Firstcmd = \"\" Then\xFE";
 z+="            Input Cmd\xFE";
 z+="        End Else\xFE";
 z+="            Cmd = Firstcmd\xFE";
 z+="            Firstcmd = \"\"\xFE";
 z+="        End\xFE";
 z+="        Gosub 200\xFE";
 z+="    Until Quit Do Repeat\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="200: * PARSE COMMAND\xFE";
 z+="    Err = 0\xFE";
 z+="    Cmd = Mid(Cmd, Index(Cmd, Trim(Cmd)[1,1], 1))\xFE";
 z+="    Ucmd = Cmd\xFE";
 z+="    Ucmd = Mcu(Ucmd)\xFE";
 z+="    Cmdchr = Ucmd[1,1]\xFE";
 z+="    Begin Case\xFE";
 z+="        Case Cmdchr = ''\xFE";
 z+="            If Lineno < Eoi Then\xFE";
 z+="                Lineno = Lineno + 1\xFE";
 z+="                If Lineno Then Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="            End\xFE";
 z+="        Case Ucmd = 'F'\xFE";
 z+="            Gosub 300                   ;* Flip\xFE";
 z+="        Case Ucmd[1,2] = 'I '\xFE";
 z+="            Gosub 400 ; If Err Then Return        ;* Catch Up To Eol\xFE";
 z+="            Buff[B]<Dp> = Cmd[3,9999]\xFE";
 z+="            Dp = Dp + Count(Cmd[3,9999],am()) + 1\xFE";
 z+="            If Autoflip Then\xFE";
 z+="                If Lineno Then Lineno = Lineno - 1\xFE";
 z+="                Gosub 900\xFE";
 z+="                Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="            End\xFE";
 z+="        Case Ucmd = 'I'\xFE";
 z+="            Gosub 400 ; If Err Then Return        ;* Catch Up To Eol\xFE";
 z+="            Linecnt = Lineno\xFE";
 z+="            Loop\xFE";
 z+="                Linecnt = Linecnt + Autoflip\xFE";
 z+="                Print Fmt(Linecnt, \"R#4\"):'+':\xFE";
 z+="                Input Newline\xFE";
 z+="            Until Newline = '' Do\xFE";
 z+="                Buff[B]<Dp> = Newline\xFE";
 z+="                Dp = Dp + Count(Newline,am()) + 1\xFE";
 z+="            Repeat\xFE";
 z+="            If Autoflip Then Gosub 900\xFE";
 z+="        Case Cmdchr = 'P' And Cmd[3,1] = '' And (Index('123456789',Cmd[2,1],1) Or Cmd[2,1]='')\xFE";
 z+="            If Index('123456789',Cmd[2,1],1) And Cmd[2,1] # '' Then\xFE";
 z+="                Pno = Cmd[2,1]\xFE";
 z+="            End Else\xFE";
 z+="                Pno = 1\xFE";
 z+="            End\xFE";
 z+="            Cmds = P[PNo]\xFE";
 z+="            If Cmds = '' Then Return\xFE";
 z+="            For Pamc = 1 To Count(Cmds,am()) + 1 Until Err Or Quit\xFE";
 z+="                Cmd = Cmds<Pamc>; Gosub 200\xFE";
 z+="            Next Pamc\xFE";
 z+="            If Quit Then Firstcmd = Cmds<Pamc>\xFE";
 z+="        Case Cmdchr = 'P' And Cmd[3,1] = ' ' And Index('123456789',Cmd[2,1],1)\xFE";
 z+="            Cmd = Convert(Char(30), am(), Cmd)\xFE";
 z+="            P[Cmd[2,1]] = Cmd[4, 9999]\xFE";
 z+="        Case Ucmd[1,5] = 'LOAD '\xFE";
 z+="            Lfname = Field(Cmd,' ',2)\xFE";
 z+="            If Mcu(Lfname) = \"DICT\" Then\xFE";
 z+="                Lfname = \"DICT \":Field(Cmd, ' ', 3)\xFE";
 z+="                Liname = Field(Cmd, ' ', 4)\xFE";
 z+="            End Else\xFE";
 z+="                Liname = Field(Cmd,' ',3)\xFE";
 z+="            End\xFE";
 z+="            Print 'Starting line number: ': ; Input Sline\xFE";
 z+="            If Sline = '' Then Return\xFE";
 z+="            If Not(Num(Sline)) Then Return\xFE";
 z+="            Print 'Ending line number  : ': ; Input Eline\xFE";
 z+="            If Eline = '' Then Eline = Sline\xFE";
 z+="            If Not(Num(Eline)) Then Return\xFE";
 z+="            If Eline < Sline Then Return\xFE";
 z+="            Cnt = Eline - Sline + 1\xFE";
 z+="            If Liname = '' Then\xFE";
 z+="                Cmd = 'ME':Cnt:'/':Lfname:'/':Sline\xFE";
 z+="            End Else\xFE";
 z+="                Cmd = 'ME':Cnt:'(':Lfname:' ':Liname:')':Sline\xFE";
 z+="            End\xFE";
 z+="            Goto 200\xFE";
 z+="        Case Ucmd[1,1] = 'L' Or Ucmd = 'A' Or Ucmd[1,2] = 'F ' Or Ucmd = 'FA'\xFE";
 z+="            If Ucmd[1,2] = 'F ' Then\xFE";
 z+="                Cmd = 'L:':Cmd[3, 9999]\xFE";
 z+="                Ucmd = Mcu(Cmd)\xFE";
 z+="            End\xFE";
 z+="            If Ucmd = 'A' Or Ucmd = 'L' Or Ucmd = 'FA' Then\xFE";
 z+="                Cmd = Cmdl\xFE";
 z+="                Ucmd = Mcu(Cmdl)\xFE";
 z+="            End\xFE";
 z+="            I = 2 ; Gosub 600 ; If Err Then Return          ;* Parse Ncsscrr\xFE";
 z+="            If C # '' Then Cmdl = Cmd\xFE";
 z+="            If Nn = 0 Then Cnt = Eoi Else Cnt = Lineno + Nn\xFE";
 z+="            If Cnt > Eoi Then Cnt = Eoi\xFE";
 z+="            I = 1\xFE";
 z+="            Loop\xFE";
 z+="                Lineno = Lineno + 1\xFE";
 z+="                Gosub 8000               ;* From Lineno, Find Next Cssc\xFE";
 z+="            While Found And Lineno<=Cnt Do\xFE";
 z+="                Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="                If Not(Nn) Then Return\xFE";
 z+="            Repeat\xFE";
 z+="            Lineno = Cnt\xFE";
 z+="        Case Ucmd[1,2] = 'G<'\xFE";
 z+="            If Not(Startm) Then Print '?No block START set'; Return\xFE";
 z+="            Lineno = Startm\xFE";
 z+="            If Lineno > Eoi Then Lineno = Eoi\xFE";
 z+="            If Lineno Then Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="        Case Ucmd[1,2] = 'G>'\xFE";
 z+="            If Not(Endm) Then Print '?No block END set'; Return\xFE";
 z+="            Lineno = Endm\xFE";
 z+="            If Lineno > Eoi Then Lineno = Eoi\xFE";
 z+="            If Lineno Then Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="        Case Cmdchr='+' And Num(Cmd[2,99])\xFE";
 z+="            Lineno = Lineno + Cmd[2,99]\xFE";
 z+="            If Lineno > Eoi Then Lineno = Eoi\xFE";
 z+="            If Lineno Then Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="        Case Num(Cmd[2,99]) And (Cmdchr='-' Or Cmdchr = 'U')\xFE";
 z+="            Lineno = Lineno - Cmd[2,99]\xFE";
 z+="            If Lineno > Eoi Then Lineno = Eoi\xFE";
 z+="            If Lineno < 0 Then Lineno = 0\xFE";
 z+="            If Lineno Then Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="        Case Num(Cmd)\xFE";
 z+="            Lineno = Cmd\xFE";
 z+="            If Lineno > Eoi Then Lineno = Eoi\xFE";
 z+="            If Lineno Then Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="        Case Ucmd = 'X' Or Ucmd = 'OOPS'\xFE";
 z+="            If Autoflip Then\xFE";
 z+="                If Savecmd # '' Then\xFE";
 z+="                    Buff[A] = Savebuf\xFE";
 z+="                    Lineno = Savelineno\xFE";
 z+="                    Eoi = Count(Buff[A],am())+(Buff[A]#\"\")\xFE";
 z+="                    Print 'Buffer restored prior to ':Savecmd\xFE";
 z+="                    If Lineno # 0 Then\xFE";
 z+="                        Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="            End Else\xFE";
 z+="                Sp = 1\xFE";
 z+="                Lineno = 0\xFE";
 z+="                Buff[B] = ''\xFE";
 z+="                Dp = 1\xFE";
 z+="            End\xFE";
 z+="        Case Ucmd = 'T'\xFE";
 z+="            Lineno = 0\xFE";
 z+="        Case Ucmd = 'B'\xFE";
 z+="            Lineno = Eoi\xFE";
 z+="        Case Ucmd[1,2] = 'DE'\xFE";
 z+="            I = 3 ; Gosub 600 ; If Err Then Return          ;* Parse Ncsscrr\xFE";
 z+="            If Lineno = 0 Then Lineno = 1\xFE";
 z+="            Gosub 800                   ;* Delete\xFE";
 z+="            If Autoflip Then Gosub 900\xFE";
 z+="            If Lineno Then Lineno = Lineno - 1\xFE";
 z+="        Case Ucmd[1,2] = 'R '\xFE";
 z+="            Nn = 1 ; C= ''; Gosub 800   ;* Delete One Line\xFE";
 z+="            Buff[B]<Dp> = Cmd[3,9999]\xFE";
 z+="            Dp = Dp + Count(Cmd[3,9999],am()) + 1\xFE";
 z+="            If Lineno Then Lineno = Lineno - 1\xFE";
 z+="            Print Fmt(Lineno, \"R#4\"):' ':Cmd[3,9999]\xFE";
 z+="            If Autoflip Then Gosub 900\xFE";
 z+="        Case Ucmd[1,1] = 'R' Or Ucmd[1,2] = 'RU' Or Ucmd = 'RA'\xFE";
 z+="            If Ucmd = 'RA' Then\xFE";
 z+="                Cmd = Rcmd\xFE";
 z+="                Ucmd = Rcmd\xFE";
 z+="                Ucmd = Mcu(Ucmd)\xFE";
 z+="            End Else\xFE";
 z+="                Rcmd = Cmd\xFE";
 z+="            End\xFE";
 z+="            I=2 ; Gosub 600 ; If Err Then Return  ;* Parse Ncsscrr\xFE";
 z+="            If Lineno = 0 Then Lineno = 1\xFE";
 z+="            If C = '' Then\xFE";
 z+="                If Gflg Then\xFE";
 z+="                    Print '?? ':Cmd\xFE";
 z+="                    Err = 1\xFE";
 z+="                    Return\xFE";
 z+="                End\xFE";
 z+="                Gosub 500 ; If Err Then Return     ;* Catch Up To Bol\xFE";
 z+="                Print Fmt(Lineno, \"R#4\"):'+':\xFE";
 z+="                Input Newline\xFE";
 z+="                If Newline = '' Then Return\xFE";
 z+="                Gosub 800                ;* Delete Lines\xFE";
 z+="                Buff[B]<Dp> = Newline\xFE";
 z+="                Dp = Dp + Count(Newline,am()) + 1\xFE";
 z+="                If Autoflip Then Gosub 900\xFE";
 z+="                If Lineno Then Lineno =  Lineno - 1\xFE";
 z+="            End Else\xFE";
 z+="                If Lineno = 0 Then Lineno = 1\xFE";
 z+="                Rlen = Len(Rr)\xFE";
 z+="                Slen = Len(Ss)\xFE";
 z+="                Endl = Lineno + Nn - 1\xFE";
 z+="                Loop\xFE";
 z+="                    Gosub 400 ; If Err Then Return  ;* Catch Up To Eol\xFE";
 z+="                    Line = Buff[B]<Dp-1>\xFE";
 z+="                    Rs = 1\xFE";
 z+="                    Found = 0\xFE";
 z+="                    Loop\xFE";
 z+="                        If Ss = '' Then J = 1 Else\xFE";
 z+="                            If C = ':' Then\xFE";
 z+="                                If (Line:Space(Slen))[1,Slen] = Ss Then J = 1 Else J = 0\xFE";
 z+="                            End Else\xFE";
 z+="                                J = Index(Line[Rs,9999]:Space(Slen),Ss,1)\xFE";
 z+="                            End\xFE";
 z+="                        End\xFE";
 z+="                        If J Then\xFE";
 z+="                            Found = 1\xFE";
 z+="                            Rs = Rs + J - 1\xFE";
 z+="                            Line=Line[1,Rs-1]: Rr:Line[Rs+Slen,9999]\xFE";
 z+="                            Rs = Rs + Rlen\xFE";
 z+="                        End\xFE";
 z+="                    While J And Gflg And Ss#'' And C#':' Do Repeat\xFE";
 z+="                    If Found Then Print Fmt(Sp-1, \"R#4\"):' ':Line\xFE";
 z+="                    Buff[B]<Dp-1> = Line\xFE";
 z+="                    Lineno = Lineno + 1\xFE";
 z+="                    Gosub 8000            ;* Find Next\xFE";
 z+="                While Found And Lineno <= Endl Do\xFE";
 z+="                    Line = Buff[A]<Sp>\xFE";
 z+="                Repeat\xFE";
 z+="                Lineno = Sp-1\xFE";
 z+="                If Autoflip Then Gosub 900\xFE";
 z+="            End\xFE";
 z+="        Case Ucmd[1,2] = 'A '\xFE";
 z+="            Gosub 400 ; If Err Then Return        ;* Catch Up To Eol\xFE";
 z+="            If Dp <= 1 Then Return\xFE";
 z+="            If Lineno = 0 Then Lineno = 1\xFE";
 z+="            Line = Buff[B]<Dp-1>:Cmd[3, 9999]\xFE";
 z+="            Print Fmt(Lineno, \"R#4\"):' ':Line\xFE";
 z+="            Buff[B]<Dp-1> = Line\xFE";
 z+="            Dp = Dp + Count(Line,am())\xFE";
 z+="            If Autoflip Then Gosub 900\xFE";
 z+="        Case Ucmd[1,2] = 'B '\xFE";
 z+="            Gosub 400 ; If Err Then Return        ;* Catch Up To Eol\xFE";
 z+="            If Dp <= 1 Then Return\xFE";
 z+="            If Lineno = 0 Then Lineno = 1\xFE";
 z+="            Cmdl = Len(Cmd)-2\xFE";
 z+="            Line = Buff[B]<Dp-1>\xFE";
 z+="            I = Index(Line,Cmd[3,9999],1)\xFE";
 z+="            If I Then Line=Line[1,I+Cmdl-1]:am():Line[I+Cmdl,9999]\xFE";
 z+="            Print Fmt(Lineno, \"R#4\"):' ':Line<1>\xFE";
 z+="            If Not(Autoflip) Then Print Fmt(Lineno, \"R#4\"):' ':Line<2>\xFE";
 z+="            Buff[B]<Dp-1> = Line\xFE";
 z+="            Dp = Dp + Count(Line, am())\xFE";
 z+="            If Autoflip Then\xFE";
 z+="                Gosub 900\xFE";
 z+="                If Lineno Then Lineno = Lineno - 1\xFE";
 z+="            End\xFE";
 z+="        Case Ucmd = 'EXT' Or Ucmd = 'EXK'\xFE";
 z+="            Print \"'\":Iname:\"' exited.\"\xFE";
 z+="            Stop\xFE";
 z+="        Case Ucmd = 'EX'\xFE";
 z+="            Print \"'\":Iname:\"' exited.\"\xFE";
 z+="            Quit = 1\xFE";
 z+="        Case Ucmd = 'FD'\xFE";
 z+="            Print 'DELETE item ':Iname:\" (Y/N): \":\xFE";
 z+="            Input Ans\xFE";
 z+="            If Mcu(Ans[1,1]) # 'Y' Then Return\xFE";
 z+="            I_delete F_file, Iname Then \xFE";
 z+="                Print \"'\":Iname:\"' deleted.\"\xFE";
 z+="                Quit = 1\xFE";
 z+="            Else\xFE";
 z+="                Print @Errors\xFE";
 z+="            End If\xFE";
 z+="        Case Ucmd = '?'\xFE";
 z+="            Print Fname:' ':Iname:'; Lines=':Eoi:'; Bytes=':Len(Buff[A])\xFE";
 z+="            If Startm And Startm >= Sp Then\xFE";
 z+="                Print 'Block start: ':\xFE";
 z+="                Print Fmt(Startm, \"R#4\"):' ':Buff[A]<Startm>\xFE";
 z+="            End\xFE";
 z+="            If Endm And Endm >= Startm And Endm >= Sp Then\xFE";
 z+="                Print 'Block end  : ':\xFE";
 z+="                Print Fmt(Endm, \"R#4\"):' ':Buff[A]<Endm>\xFE";
 z+="            End\xFE";
 z+="        Case Ucmd = 'FI' Or Ucmd[1,3] = 'FI '\xFE";
 z+="            If Ucmd[3,1] = ' ' Then Sname = Ucmd[4, 9999] Else Sname = Iname\xFE";
 z+="            Gosub 300                   ;* Flip\xFE";
 z+="            B = Buff[A]\xFE";
 z+="            I_write B On F_file, Sname Then\xFE";
 z+="               B = \"\"\xFE";
 z+="               Quit = 1\xFE";
 z+="               Print \"'\":Iname:\"' written.\"\xFE";
 z+="            Else\xFE";
 z+="                Print @Errors\xFE";
 z+="            End If\xFE";
 z+="        Case Ucmd = 'FS' Or Ucmd[1,3] = 'FS '\xFE";
 z+="            Gosub 300                   ;* Flip\xFE";
 z+="            If Ucmd[3,1] = ' ' Then\xFE";
 z+="                Sname = Ucmd[4, 9999]\xFE";
 z+="                Readv Ans From F_file, Sname,1 Then\xFE";
 z+="                    Print Sname:' exists; Overwrite (Y/N)? ':\xFE";
 z+="                    Input Ans\xFE";
 z+="                    If Ans[1,1] # 'Y' And Ans[1,1] # 'y' Then Return\xFE";
 z+="                End\xFE";
 z+="            End Else Sname = Iname\xFE";
 z+="            B = Buff[A]\xFE";
 z+="            I_write B On F_file, Sname Then Print \"'\":Sname:\"' written.\" Else Print @Errors\xFE";
 z+="            B = \"\"\xFE";
 z+="            \xFE";
 z+="        Case Ucmd = 'FORMAT'\xFE";
 z+="            Gosub 300\xFE";
 z+="            B = formatCode(Buff[A], 4, True)\xFE";
 z+="            Buff[A] = Join(B, am())\xFE";
 z+="            Print \"Format complete\"\xFE";
 z+="            B = \"\"\xFE";
 z+="\xFE";
 z+="        Case Ucmd = 'FORMATC'\xFE";
 z+="            Gosub 300                   ;* Flip\xFE";
 z+="            Ni = 0\xFE";
 z+="            For Linei = 1 To Eoi\xFE";
 z+="                Ci = Ni\xFE";
 z+="                Sline = Buff[A<Linei>]\xFE";
 z+="                Sline = Sline[Index(Sline, Trim(Sline)[1,1], 1), 9999]\xFE";
 z+="                Line = Trim(Sline)\xFE";
 z+="                Ol = ''\xFE";
 z+="                If Index(Line,'\"',1) Or Index(Line,\"'\",1) Then\xFE";
 z+="                    Llen = Len(Line)\xFE";
 z+="                    For J = 1 To Llen\xFE";
 z+="                        C = Line[J,1]\xFE";
 z+="                        If C = '\"' Or C = \"'\" Then\xFE";
 z+="                            Loop\xFE";
 z+="                                J=J+1\xFE";
 z+="                                If Line[J,1] = '\\\\' Then J = J + 2\xFE";
 z+="                            Until Line[J,1]='' Or Line[J,1]=C Do Repeat\xFE";
 z+="                            C = 'X'\xFE";
 z+="                        End\xFE";
 z+="                        Ol = Ol:C\xFE";
 z+="                    Next J\xFE";
 z+="                End Else\xFE";
 z+="                    Ol = Line\xFE";
 z+="                End\xFE";
 z+="                R=Index(Ol,'/*',1) ; If R Then Ol=Ol[1,R-1]\xFE";
 z+="                R=Index(Ol,'//',1) ; If R Then Ol=Ol[1,R-1]\xFE";
 z+="                R = (Count(Ol,'{') - Count(Ol,'}')) * 3\xFE";
 z+="                Ni = Ni + R\xFE";
 z+="                If R < 0 Then\xFE";
 z+="                    Ci = Ci + R\xFE";
 z+="                End Else\xFE";
 z+="                    If Ol[1,1] = '}' Then Ci = Ci - 3\xFE";
 z+="                End\xFE";
 z+="                If Ol[1,4] = '#if ' Then Ni = Ni + 3\xFE";
 z+="                If Ol[1,5] = '#else' Then Ci = Ci - 3\xFE";
 z+="                If Ol[1,6] = '#endif' Then\xFE";
 z+="                    Ci = Ci - 3\xFE";
 z+="                    Ni = Ni - 3\xFE";
 z+="                End\xFE";
 z+="                Buff[A]<Linei> = Space(Ci):Sline\xFE";
 z+="                Print '*':\xFE";
 z+="            Next Linei\xFE";
 z+="            Print\xFE";
 z+="        Case Ucmd[1,2] = 'ME'\xFE";
 z+="            Oth_file = Index(Cmd,'(',1)\xFE";
 z+="            If Oth_file Then Cmd = Convert('(', ')', Cmd)\xFE";
 z+="            I = 3 ; Gosub 600 ; If Err Then Return          ;* Parse Ncsscrr\xFE";
 z+="            If Nn = 0 Then Nn = 1\xFE";
 z+="            If Not(Num(Rr)) Then\xFE";
 z+="                Print '?? ':Cmd\xFE";
 z+="                Return\xFE";
 z+="            End\xFE";
 z+="            If Rr = '' Then Rr = 1\xFE";
 z+="            Gosub 400 ; If Err Then Return        ;* Catch Up To Eol\xFE";
 z+="            If Ss # '' Then\xFE";
 z+="                If Oth_file Then\xFE";
 z+="                    Dictdata = ''\xFE";
 z+="                    Oth_fname = Field(Ss,' ',1)\xFE";
 z+="                    Oth_iname = Field(Ss,' ',2)\xFE";
 z+="                    If Mcu(Oth_fname) = 'DICT' Or Mcu(Oth_fname) = 'DATA' Then\xFE";
 z+="                        Dictdata = Oth_fname\xFE";
 z+="                        Oth_fname = Oth_iname\xFE";
 z+="                        Oth_iname = Field(Ss,' ',3)\xFE";
 z+="                    End\xFE";
 z+="                    If Oth_iname = '' Then Oth_iname = Iname\xFE";
 z+="                    I_open Dictdata,Oth_fname To Oth_file Else\xFE";
 z+="                        Print 'File not found.'\xFE";
 z+="                        Return\xFE";
 z+="                    End\xFE";
 z+="                    I_read Ti From Oth_file, Oth_iname Else\xFE";
 z+="                        Print 'Not on file.'\xFE";
 z+="                        Return\xFE";
 z+="                    End\xFE";
 z+="                End Else\xFE";
 z+="                    I_read Ti From F_file, Ss Else\xFE";
 z+="                        Print 'Not on file.'\xFE";
 z+="                        Return\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="                Maxcnt = Count(Ti,am()) + (am()#'') - Rr + 1\xFE";
 z+="            End Else\xFE";
 z+="                Maxcnt = Eoi - Rr + 1\xFE";
 z+="            End\xFE";
 z+="            If Nn > Maxcnt Then Nn = Maxcnt\xFE";
 z+="            For I = Rr To Rr+Nn-1\xFE";
 z+="                If Ss = '' Then Line=Buff[A]<I> Else Line=Ti<I>\xFE";
 z+="                Buff[B]<Dp> = Line\xFE";
 z+="                Dp = Dp +  1\xFE";
 z+="            Next I\xFE";
 z+="            If Autoflip Then Gosub 900\xFE";
 z+="        Case Cmd = '<' Or Cmd = '<>'\xFE";
 z+="            Startm = Lineno\xFE";
 z+="            If Startm = 0 Then Startm = 1\xFE";
 z+="            If Startm < Sp Then\xFE";
 z+="                Print 'Flip required'\xFE";
 z+="            End Else\xFE";
 z+="                If Cmd = '<>' Then\xFE";
 z+="                    Print 'Block set at ':Startm\xFE";
 z+="                End Else\xFE";
 z+="                    Print 'Block start at ':Startm\xFE";
 z+="                End\xFE";
 z+="            End\xFE";
 z+="            If Cmd = '<>' Then\xFE";
 z+="                Endm = Lineno\xFE";
 z+="                If Endm = 0 Then Endm = 1\xFE";
 z+="            End\xFE";
 z+="        Case Cmd = '>'\xFE";
 z+="            Endm = Lineno\xFE";
 z+="            If Endm = 0 Then Endm = 1\xFE";
 z+="            Print 'Block stop at ':Endm\xFE";
 z+="        Case Ucmd = 'DROP'\xFE";
 z+="            Gosub 9000 ; If Err Then Return       ;* Check Block Markers\xFE";
 z+="            Print 'DROP from ':Startm:' to ':Endm:'? ':\xFE";
 z+="            Input Ans\xFE";
 z+="            If Mcu(Ans[1,1]) # 'Y' Then Return\xFE";
 z+="            Lineno = Startm\xFE";
 z+="            Cmd = 'DE':Endm-Startm+1\xFE";
 z+="            Startm = 0 ; Endm = 0\xFE";
 z+="            Goto 200\xFE";
 z+="        Case Ucmd = 'MOVE'\xFE";
 z+="            Gosub 9000 ; If Err Then Return       ;* Check Block Markers\xFE";
 z+="            Print 'MOVE from ':Startm:' to ':Endm:'? ':\xFE";
 z+="            Input Ans\xFE";
 z+="            If Mcu(Ans[1,1]) # 'Y' Then Return\xFE";
 z+="            Olineno = Lineno\xFE";
 z+="            Linecnt = Endm-Startm+1\xFE";
 z+="            Oldauto = Autoflip\xFE";
 z+="            Autoflip = 0\xFE";
 z+="            If Lineno < Startm Then\xFE";
 z+="                Cmd = 'ME':Linecnt:'//':Startm\xFE";
 z+="                Gosub 200\xFE";
 z+="                Lineno = Startm\xFE";
 z+="                Cmd = 'DE':Linecnt\xFE";
 z+="                Gosub 200\xFE";
 z+="                Lineno = Olineno\xFE";
 z+="            End Else If Lineno >= Endm Then\xFE";
 z+="                Lineno = Startm\xFE";
 z+="                Cmd = 'DE':Linecnt\xFE";
 z+="                Gosub 200\xFE";
 z+="                Lineno = Olineno\xFE";
 z+="                Cmd = 'ME':Linecnt:'//':Startm\xFE";
 z+="                Gosub 200\xFE";
 z+="            End Else\xFE";
 z+="                Print \"Can't move a block within itself\"\xFE";
 z+="            End\xFE";
 z+="            Autoflip = Oldauto\xFE";
 z+="            If Autoflip Then Gosub 900\xFE";
 z+="            Startm = 0 ; Endm = 0\xFE";
 z+="        Case Ucmd = 'COPY'\xFE";
 z+="            Gosub 9000 ; If Err Then Return       ;* Check Block Markers\xFE";
 z+="            Print 'COPY from ':Startm:' to ':Endm:'? ':\xFE";
 z+="            Input Ans\xFE";
 z+="            If Mcu(Ans[1,1]) # 'Y' Then Return\xFE";
 z+="            Olineno = Lineno\xFE";
 z+="            Linecnt = Endm-Startm+1\xFE";
 z+="            Cmd = 'ME':Linecnt:'//':Startm\xFE";
 z+="            Gosub 200\xFE";
 z+="        Case Ucmd = 'DUP'\xFE";
 z+="            Gosub 400 ; If Err Then Return        ;* Catch Up To Eol\xFE";
 z+="            If Dp <= 1 Then Return\xFE";
 z+="            Buff[B]<Dp> = Buff[B]<Dp-1>\xFE";
 z+="            Dp = Dp + 1\xFE";
 z+="            If Autoflip Then\xFE";
 z+="                If Lineno Then Lineno = Lineno - 1\xFE";
 z+="                Gosub 900\xFE";
 z+="                Print Fmt(Lineno, \"R#4\"):' ':Buff[A]<Lineno>\xFE";
 z+="            End\xFE";
 z+="        Case Ucmd = 'MCU'\xFE";
 z+="            Gosub 400 ; If Err Then Return        ;* Catch Up To Eol\xFE";
 z+="            If Dp <= 1 Then Return\xFE";
 z+="            If Lineno = 0 Then Lineno = 1\xFE";
 z+="            Line = Mcu(Buff[B]<Dp-1>)\xFE";
 z+="            Print Fmt(Lineno, \"R#4\"):' ':Line\xFE";
 z+="            Buff[B]<Dp-1> = Line\xFE";
 z+="            If Autoflip Then Gosub 900\xFE";
 z+="        Case Ucmd = 'MCL'\xFE";
 z+="            Gosub 400 ; If Err Then Return        ;* Catch Up To Eol\xFE";
 z+="            If Dp <= 1 Then Return\xFE";
 z+="            If Lineno = 0 Then Lineno = 1\xFE";
 z+="            Line = Mcl(Buff[B]<Dp-1>)\xFE";
 z+="            Print Fmt(Lineno, \"R#4\"):' ':Line\xFE";
 z+="            Buff[B]<Dp-1> = Line\xFE";
 z+="            If Autoflip Then Gosub 900\xFE";
 z+="        Case 1\xFE";
 z+="            Print '? ':Cmd\xFE";
 z+="            Err = 1\xFE";
 z+="    End Case\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="300: * FLIP\xFE";
 z+="    Lineno = 0\xFE";
 z+="    If Sp = 1 And Dp=1 Then Return\xFE";
 z+="    Stopat = Eoi\xFE";
 z+="    Gosub 550\xFE";
 z+="    C = A ; A = B ; B = C\xFE";
 z+="    Sp = 1\xFE";
 z+="    Eoi = Count(Buff[A],am()) + (Buff[A] # '')\xFE";
 z+="    If Eoi > 999 Then Lc = 4 Else Lc = 3\xFE";
 z+="    Buff[B] = ''\xFE";
 z+="    Dp = 1\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="900: * AUTOFLIP\xFE";
 z+="    If Sp # 1 Or Dp>1 Then\xFE";
 z+="        Savebuf = Buff[A]\xFE";
 z+="        Savelineno = Oldlineno\xFE";
 z+="        Savecmd = Cmd\xFE";
 z+="        If Lineno >= Sp-1 Then Gosub 400         ;* Catch Up To Eol\xFE";
 z+="        Nlineno = Count(Buff[B],am())+ (Buff[B]#'')\xFE";
 z+="        Gosub 300                      ;* Finish Flip\xFE";
 z+="        Lineno = Nlineno\xFE";
 z+="    End\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="400: * CATCH UP EOL\xFE";
 z+="    If Lineno < Sp-1 Then\xFE";
 z+="        Print '??'\xFE";
 z+="        Err = 1\xFE";
 z+="    End Else\xFE";
 z+="        Stopat = Lineno\xFE";
 z+="        Gosub 550\xFE";
 z+="        Err = 0\xFE";
 z+="    End\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="500: * CATCH UP BOL\xFE";
 z+="    If Lineno < Sp-1 Then\xFE";
 z+="        Print '??'\xFE";
 z+="        Err = 1\xFE";
 z+="    End Else\xFE";
 z+="        Stopat = Lineno - 1\xFE";
 z+="        Gosub 550\xFE";
 z+="        Err = 0\xFE";
 z+="    End\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="550: * COPY UPTO STOPAT\xFE";
 z+="    If Sp <= Eoi Then\xFE";
 z+="        If Sp <= Stopat Then\xFE";
 z+="            If Sp = 1 Then Firstl = 1 Else Firstl = Index(Buff[A],am(),Sp-1)+1\xFE";
 z+="            If Stopat >= Eoi Then Lastl = Len(Buff[A])+1 Else Lastl = Index(Buff[A],am(),Stopat)\xFE";
 z+="            Buff[B]<Dp> = Buff[A][Firstl,Lastl-Firstl]\xFE";
 z+="            Dp = Dp + Count(Buff[A][Firstl,Lastl-Firstl],am()) + 1\xFE";
 z+="        End\xFE";
 z+="        Sp = Stopat + 1\xFE";
 z+="    End\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="600: * PARSE NNCSSCRR - STARTING AT CMD[I,1]\xFE";
 z+="    Err = 0\xFE";
 z+="    If Ucmd[I,1] = 'U' Then\xFE";
 z+="        Gflg = 1\xFE";
 z+="        I = I + 1\xFE";
 z+="    End Else\xFE";
 z+="        Gflg = 0\xFE";
 z+="    End\xFE";
 z+="    Nn = 0\xFE";
 z+="    Loop\xFE";
 z+="        C = Cmd[I,1]\xFE";
 z+="    While Num(C) And C # '' Do\xFE";
 z+="        I = I + 1\xFE";
 z+="        Nn = Nn * 10 + C\xFE";
 z+="    Repeat\xFE";
 z+="    If Index('ABCDEFGHIJKLMNOPQRSTUVWXYZ',C,1) And C # '' Then\xFE";
 z+="        Err = 1\xFE";
 z+="        Print '? ':Cmd\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    Ss = ''\xFE";
 z+="    If C # '' Then\xFE";
 z+="        I = I + 1\xFE";
 z+="        Loop\xFE";
 z+="            S = Cmd[I,1]\xFE";
 z+="        While S # '' And S # C Do\xFE";
 z+="            I = I + 1\xFE";
 z+="            Ss = Ss:S\xFE";
 z+="        Repeat\xFE";
 z+="    End\xFE";
 z+="    Rr = ''\xFE";
 z+="    If C # '' Then\xFE";
 z+="        I = I + 1\xFE";
 z+="        Loop\xFE";
 z+="            S = Cmd[I,1]\xFE";
 z+="        While S # '' And S # C Do\xFE";
 z+="            I = I + 1\xFE";
 z+="            Rr = Rr:S\xFE";
 z+="        Repeat\xFE";
 z+="    End\xFE";
 z+="    If Not(Nn) And Cmd[I,1] # '' Then\xFE";
 z+="        I = I + 1\xFE";
 z+="        If Ucmd[I,1] = 'G' Then\xFE";
 z+="            Gflg = 1\xFE";
 z+="            I = I + 1\xFE";
 z+="        End\xFE";
 z+="        Loop\xFE";
 z+="            S = Cmd[I,1]\xFE";
 z+="        While Num(S) And S # '' Do\xFE";
 z+="            I = I + 1\xFE";
 z+="            Nn = Nn * 10 + S\xFE";
 z+="        Repeat\xFE";
 z+="    End\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="800: * DELETE FROM LINENO + NN LINES\xFE";
 z+="    If Nn = 0 Then Nn = 1\xFE";
 z+="    Gosub 500 ; If Err Then Return    ;* Catch Up To Bol\xFE";
 z+="    If C = '' Then\xFE";
 z+="        Sp = Sp + Nn\xFE";
 z+="        Lineno = Sp\xFE";
 z+="    End Else\xFE";
 z+="        Endl = Lineno + Nn - 1\xFE";
 z+="        Loop\xFE";
 z+="            Gosub 8000                  ;* Find Next Pattern\xFE";
 z+="        Until Not(Found) Or Lineno > Endl Do\xFE";
 z+="            Gosub 500                   ;* Catch Up To Bol\xFE";
 z+="            Print Fmt(Sp, \"R#4\"):' ':Buff[A]<Sp>\xFE";
 z+="            Sp = Sp + 1\xFE";
 z+="            Lineno = Lineno + 1\xFE";
 z+="        Repeat\xFE";
 z+="        Lineno = Endl + 1\xFE";
 z+="    End\xFE";
 z+="    If Lineno > Eoi Then Lineno = Eoi + 1\xFE";
 z+="    If Sp > Eoi Then Sp = Eoi + 1\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="8000: * FROM LINENO, FIND CSSC\xFE";
 z+="    If Lineno > Eoi Then\xFE";
 z+="        Found = 0\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    If Ss = '' Then\xFE";
 z+="        Found = Lineno <= Eoi\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="*      TSS = TRIMB(SS)\xFE";
 z+="    Tss = Ss\xFE";
 z+="    Loop\xFE";
 z+="        If Lineno=1 Then Firstl=1 Else Firstl=Index(Buff[A],am(),Lineno-1)+1\xFE";
 z+="        If C = ':' Then\xFE";
 z+="            Found = Index(am():Buff[A][Firstl,9999],am():Tss,1)\xFE";
 z+="        End Else\xFE";
 z+="            Found = Index(Buff[A][Firstl,9999],Tss,1)\xFE";
 z+="        End\xFE";
 z+="        If Found Then\xFE";
 z+="            Lineno = Lineno + Count(Buff[A][Firstl,Found],am())\xFE";
 z+="            If C = ':' Then\xFE";
 z+="                Found = Index(am():Buff[A]<Lineno>:Space(80),am():Ss,1)\xFE";
 z+="            End Else\xFE";
 z+="                Found = Index(Buff[A]<Lineno>:Space(80),Ss,1)\xFE";
 z+="            End\xFE";
 z+="            If Found Then Return\xFE";
 z+="            Lineno = Lineno + 1\xFE";
 z+="            Found = 1\xFE";
 z+="        End\xFE";
 z+="    While Found Do Repeat\xFE";
 z+="    Lineno = Eoi + 1\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="9000: * Check block markers\xFE";
 z+="    Err = 1\xFE";
 z+="    If Startm < Sp Then\xFE";
 z+="        Print 'Flip required'\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    If Startm > Endm Then\xFE";
 z+="        Print 'Block markers not set'\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    Err = 0\xFE";
 z+="    Return"
window.cached_jsb_tcl["ied"]=z;
var z="*\xFE";
 z+="* This program is the PHONEGAP startup (started by @Account in TCL). See also TCL INDEX and TCL TCL\xFE";
 z+="*\xFE";
 z+="program jsb\xFE";
 z+="*\xFE";
 z+="*$options js\xFE";
 z+="*\xFE";
 z+="    Print `Welcome Admin to JSB. This startup program is TCL JSB`\xFE";
 z+="    \xFE";
 z+="    // If the default Account is \"jsb\" (default), then check the EXE Name\xFE";
 z+="    If @Account = \"jsb\" And window.dotNetObj Then\xFE";
 z+="        myExeName = window.dotNetObj.dnoMyExeName()\xFE";
 z+="        if myExeName <> \"jsb\" Then\xFE";
 z+="            Print \"You may create an account called '\":myExeName:\"' (this wndows Executable File Name) to create an auto logto, or\"\xFE";
 z+="        End If\xFE";
 z+="        Print \"You may catalog a program called '\":myExeName:\"' (this wndows Executable File Name) to create an autostart routine\":\xFE";
 z+="        If @Account <> myExeName Then Print \", or\" ELse Print\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If @Account <> myExeName Then\xFE";
 z+="        Print \"You may catalog a program called '\":@Account:\"' (from your @Account) to create an autostart routine\"\xFE";
 z+="    End If\xFE";
 z+="       \xFE";
 z+="    Print @inputButton('DOCS', Chr(27) : 'DOCS' : Chr(13)) :' ': @inputButton('DEMOS', Chr(27) : 'DEMOS' : Chr(13)) :' ': @Html(`<a href=\"https://groups.google.com/d/forum/jsb---json-basic\">Blog</a>`)\xFE";
 z+="    @Html(`<a href=\"https://groups.google.com/d/forum/jsb---json-basic\">Blog</a>`)\xFE";
 z+="    Print\xFE";
 z+="    Print `You are at TCL:`\xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["jsb"]=z;
window.cached_jsb_tcl["jsbroot"]="Program jsbRoot\xFE   Stop @jsbRoot";
window.cached_jsb_tcl["jsbrootact"]="Program jsbRootAct\xFE   Stop @jsbRootAccount\xFE   \xFEProgram jsbRootAccount\xFE   Stop @jsbRootAccount";
var z="//\xFE";
 z+="// Do sync between main jsonbasic and this local machine\xFE";
 z+="//\xFE";
 z+="Program jsbSync\xFE";
 z+="    myDomain = @Domain\xFE";
 z+="    S = DropLeft(Trim(@Sentence), ' ')\xFE";
 z+="    \xFE";
 z+="    If Instr(S, \"?\") Or !S Then\xFE";
 z+="        Print \"This will check edit for newer files against jsbwinforms.azurewebsites.net.\"\xFE";
 z+="        Print \"A   options: (a or *  sync all\"\xFE";
 z+="        Print \"C   options: (c   compare different items\"\xFE";
 z+="        Print \"Z   options: (z   compare all items\"\xFE";
 z+="        Print \"P   options: (p   compile with jsb2js\"\xFE";
 z+="        Print \"M   options: (m   must already exists - defaulted on browser systems for css & js files)\"\xFE";
 z+="        Stop\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If System(1) = \"aspx\" And myDomain = \"jsbwinforms.azurewebsites.net\" Then Stop 'You are on azure. No sync necessary!'\xFE";
 z+="    If !@isAdmin Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    fSystem = fHandle('system')\xFE";
 z+="    myAccount = @jsbAccount\xFE";
 z+="    Options = UCase(Field(S, ' (', 2):Field(jsbConfig(\"jsbSync\"), \";\", 1))\xFE";
 z+="    doPC = Instr(Options, \"P\")\xFE";
 z+="    doCompare = Instr(Options, \"C\")\xFE";
 z+="    doCompareAll = Instr(Options, \"Z\")\xFE";
 z+="    Onefile = FieldLeft(S, ' ')\xFE";
 z+="    If Onefile = \"*\" Then Onefile = \"\"\xFE";
 z+="    \xFE";
 z+="    // Sync only core jsb in SYSPROG\xFE";
 z+="    jsbCore = Split(LCase(@jsbConfig(\"core.jsb\")), am())\xFE";
 z+="\xFE";
 z+="    If Onefile Then\xFE";
 z+="        trueFName = Truefilename(Onefile)\xFE";
 z+="        If Left(trueFName,1) = \".\" Or Instr(trueFName,\"\\\\\") Then trueFName = Onefile\xFE";
 z+="        \xFE";
 z+="        gotIt = False\xFE";
 z+="        FList = []\xFE";
 z+="        For Each Fname In jsbCore\xFE";
 z+="            If Left(Fname,1) = \"*\" Then FList[-1] = \"*\"\xFE";
 z+="            If LCase(Fname) = LCase(trueFName) Then\xFE";
 z+="                gotIt = True\xFE";
 z+="                FList[-1] = Fname\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="        If !gotIt Then Stop \"I don't sync \":trueFName\xFE";
 z+="        \xFE";
 z+="    Else\xFE";
 z+="        FList = jsbCore\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    jsbUrl = @jsbConfig(\"jsburl\", \"https://jsbwinforms.azurewebsites.net/\")\xFE";
 z+="    If Right(jsbUrl, 1) <> \"/\" Then jsbUrl := \"/\"\xFE";
 z+="    If !Instr(jsbUrl, \"//\") Then jsbUrl = \"//\":jsbUrl\xFE";
 z+="    jsbUrl := 'sysprog/'\xFE";
 z+="    \xFE";
 z+="    Read Sysprog From fSystem, 'sysprog.jsb' Then\xFE";
 z+="        If Sysprog<2> <> jsbUrl Then\xFE";
 z+="            Sysprog<2> = jsbUrl\xFE";
 z+="            Write Sysprog On fSystem, 'sysprog.jsb' Else Stop @Errors\xFE";
 z+="        End If\xFE";
 z+="    Else\xFE";
 z+="        Write 'P!':am():jsbUrl:'/sysprog/':am():'guest':am():'9A7C569F40' On fSystem, 'sysprog.jsb' Else Stop @Errors\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Read Sysprog From fSystem, 'sysprog.lcl' Else\xFE";
 z+="        Write 'F':am():'<<database>>/sysprog/' On fSystem, 'sysprog.lcl' Else Stop @Errors\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Ccnt = 0\xFE";
 z+="    Fcnt = 0\xFE";
 z+="    fMd = fHandle('md')\xFE";
 z+="    CompileIt = True\xFE";
 z+="    \xFE";
 z+="    doNotOverWrite = ['htamd', 'pics', `.\\jsb\\pics`]\xFE";
 z+="    copyOnlyOnce = ['htaconfig', 'htasystem', 'htausers', 'jsb']\xFE";
 z+="    \xFE";
 z+="    SrcFile = 'src.compare.file'\xFE";
 z+="    DstFile = 'dst.compare.file'\xFE";
 z+="    fTmp = fHandle('tmp')\xFE";
 z+="    \xFE";
 z+="    For Each Fname In FList\xFE";
 z+="        If Left(Fname, 1) = \"*\" Then\xFE";
 z+="            CompileIt = False\xFE";
 z+="            Cycle\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        Fname = LCase(Fname)\xFE";
 z+="        Print @Backgroundcolor(\"lightgray\", @Color(\"blue\", Fname)):\xFE";
 z+="        tfName = LCase(Truefilename(Fname))\xFE";
 z+="\xFE";
 z+="        Locate Fname In doNotOverWrite Then NoOverWrites = True Else NoOverWrites = False\xFE";
 z+="        Locate tfName In doNotOverWrite Then NoOverWrites = True\xFE";
 z+="        \xFE";
 z+="        mustExist = Instr(Options, \"M\")\xFE";
 z+="        if System(1) = \"js\" And (fName = \"js\" or fName = \"css\") Then mustExist = True\xFE";
 z+="\xFE";
 z+="        Open Fname To fDst Else stop @Errors\xFE";
 z+="    \xFE";
 z+="        Locate Fname In copyOnlyOnce Then Cycle\xFE";
 z+="        Locate tfName In copyOnlyOnce Then Cycle\xFE";
 z+="\xFE";
 z+="        Write \"q\":am():\"sysprog.jsb\":am():Fname On fMd, SrcFile Else Stop @Errors\xFE";
 z+="        \xFE";
 z+="        Open SrcFile To fSrc Then\xFE";
 z+="            if doCompareAll then\xFE";
 z+="                select fSrc to sl else stop @errors\xFE";
 z+="                difItems = getList(sl)\xFE";
 z+="                print @(-1):\xFE";
 z+="            else\xFE";
 z+="                difItems = DifFiles(SrcFile, Fname, mustExist)\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            If difItems Then\xFE";
 z+="                Print \"(\":Len(difItems):\") \":\xFE";
 z+="                \xFE";
 z+="                Fcnt = 0\xFE";
 z+="                For Each Id In difItems\xFE";
 z+="                    Fcnt += 1\xFE";
 z+="\xFE";
 z+="                    Read SItem From fSrc, Id Else Stop @Errors\xFE";
 z+="                    \xFE";
 z+="                    if doCompare Then\xFE";
 z+="                        Read PItem From fDst, Id Else PItem = \"\"\xFE";
 z+="                        \xFE";
 z+="                        If InStr(SItem, cr()) Or InStr(SItem, lf()) Then\xFE";
 z+="                            SItem = Replace(SItem, crlf(), am())\xFE";
 z+="                            SItem = Replace(SItem, cr(), am())\xFE";
 z+="                            SItem = Replace(SItem, lf(), am())\xFE";
 z+="                        End If\xFE";
 z+="                        If InStr(PItem, cr()) Or InStr(PItem, lf()) Then\xFE";
 z+="                            PItem = Replace(PItem, crlf(), am())\xFE";
 z+="                            PItem = Replace(PItem, cr(), am())\xFE";
 z+="                            PItem = Replace(PItem, lf(), am())\xFE";
 z+="                        End If\xFE";
 z+="                        PITEM = Replace(PITEM, Chr(160), ' ')\xFE";
 z+="                        SITEM = Replace(SITEM, Chr(160), ' ')\xFE";
 z+="                        Loop While Right(PItem, 1) = am() do pItem = Left(PItem, Len(pItem)-1) Repeat\xFE";
 z+="                        Loop While Right(sItem, 1) = am() do sItem = Left(sItem, Len(sItem)-1) Repeat\xFE";
 z+="                        \xFE";
 z+="                        \xFE";
 z+="                        if Trim(PItem) = Trim(SItem) Then\xFE";
 z+="                            Print FName:\" \":ID:\"  (JSB) \":DateTime(sTimer):\" <--> (Local) \":DateTime(dTimer):\"  ==== ITEMS ARE EQUAL\"\xFE";
 z+="                            @Server.Flush\xFE";
 z+="                            Cycle\xFE";
 z+="                        End If\xFE";
 z+="                        \xFE";
 z+="                        Write SItem On fTmp, Id Else Stop @Errors\xFE";
 z+="                        sStats = fileStats(fSrc, id)\xFE";
 z+="                        sTime = sStats.currentTime\xFE";
 z+="                        sStats = sStats.stats[1]\xFE";
 z+="                        sTimer = Date(sStats.date:\" \":sStats.time) - Date(sStats.currentTime)\xFE";
 z+="                        \xFE";
 z+="                        dStats = fileStats(fDst, id)\xFE";
 z+="                        dTime = dStats.currentTime\xFE";
 z+="                        dStats = dStats.stats[1]\xFE";
 z+="                        \xFE";
 z+="                        dTimer = Date(dStats.date:\" \":dStats.time) - Date(dStats.currentTime)\xFE";
 z+="                        \xFE";
 z+="                        sTimer = sTimer + Date(datetime())\xFE";
 z+="                        dTimer = dTimer + Date(datetime())\xFE";
 z+="                        \xFE";
 z+="       \xFE";
 z+="                        Print\xFE";
 z+="                        Print FName:\" \":ID:\"  (JSB) \":DateTime(sTimer):\" <--> (Local) \":DateTime(dTimer)\xFE";
 z+="\xFE";
 z+="                        Cmd = \"Compare \":SrcFile:\" \":Id:\" (Z,(tmp\"\xFE";
 z+="                        // Print @(-1):Cmd\xFE";
 z+="                        Execute Cmd\xFE";
 z+="                        b = @response.buffer()\xFE";
 z+="                        Print @SubmitBtn(\"btn\", \"Continue\"):\" \":@SubmitBtn(\"btn\", \"Accept\"):\" \":@SubmitBtn(\"btn\", \"Quit\")\xFE";
 z+="                        @Server.Pause\xFE";
 z+="                        @response.buffer(b)\xFE";
 z+="                        print @(-1):\xFE";
 z+="                        \xFE";
 z+="                        delete fTmp, ID else null\xFE";
 z+="                        \xFE";
 z+="                        if @FormVar(\"btn\") = \"Quit\" Then Stop\xFE";
 z+="                        if @FormVar(\"btn\") = \"Continue\" Then Cycle\xFE";
 z+="                    End if\xFE";
 z+="                    \xFE";
 z+="                    If NoOverWrites Then\xFE";
 z+="                       Read PItem From fDst, Id Then Cycle\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    If isJson(SItem) Then\xFE";
 z+="                        Writejson SItem On fDst, Id Else Stop @Errors\xFE";
 z+="                    Else\xFE";
 z+="                        Write SItem On fDst, Id Else Stop @Errors\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    Ccnt += 1\xFE";
 z+="\xFE";
 z+="                    If CompileIt Then\xFE";
 z+="                        Print \"<<\":anchorEdit(Fname, Id):\">> \": ;* @Server.Flush\xFE";
 z+="                        Execute \"basic \":Fname:\" \":Id Capturing X\xFE";
 z+="                        If Instr(X, \"^\") Then Print crlf():Id:\" \":Replace(X, am(), crlf())\xFE";
 z+="                    Else\xFE";
 z+="                        Print anchorEdit(Fname, Id):\" \":\xFE";
 z+="                        If Fcnt Mod 20 = 19 Then Print @Crlf():\"...\": ; @Server.flush\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="                \xFE";
 z+="                If CompileIt And doPC Then\xFE";
 z+="                    For Each Id In difItems\xFE";
 z+="                        Fcnt += 1\xFE";
 z+="                        Print \"[[\":anchorEdit(Fname, Id):\"]] \": ;* @Server.Flush\xFE";
 z+="                        Execute \"pc \":Fname:\" \":Id Capturing X\xFE";
 z+="                        If Instr(X, \"^\") Then Print crlf():Id:\" \":Replace(X, am(), crlf())\xFE";
 z+="                    Next\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                If Fcnt And CompileIt And doPC Then\xFE";
 z+="                    Print @Crlf:\"Linking \":Fname:\" \":\xFE";
 z+="                    Execute \"link \":Fname:\" (n\"\xFE";
 z+="                    Print \"Caching \":Fname:\" \":\xFE";
 z+="                    Execute \"cache \":Fname\xFE";
 z+="                End If\xFE";
 z+="            Else\xFE";
 z+="                If IsNull(difItems) Then Print @Errors\xFE";
 z+="                @Server.Flush\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            Stop \"Error opening remote file: \":Fname:@Crlf:@Errors\xFE";
 z+="        End If\xFE";
 z+="        If !Fcnt Or !CompileIt Or !doPC Then Print\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    // Deal with local changes - not synced, but edited\xFE";
 z+="    If doPC Then\xFE";
 z+="        If Onefile Then\xFE";
 z+="            Corejsb = Split(Field(LCase(@Jsb_bf.jsbconfig(\"core.jsb\")), \"*\", 1), am()):am():\"cs\"\xFE";
 z+="            Locate trueFName In Corejsb Then\xFE";
 z+="                Print \"Checking for local changes in \":Onefile\xFE";
 z+="                Execute \"build \":Onefile:\" (s\" ;* Quietly\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If !Ccnt Then Stop \"No sync files were changed\"\xFE";
 z+="    If Ccnt = 1 Then Stop \"One file synced\"\xFE";
 z+="    Stop Ccnt:\" items updated\"\xFE";
 z+="End Program"
window.cached_jsb_tcl["jsbsync"]=z;
var z="Program L\xFE";
 z+="    Call Tcl_LCmd(@Sentence, True)\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Subroutine Tcl_LCmd(Sentence, checkPrivilages)\xFE";
 z+="    If !ParseSelect(Sentence, \"\", Top, Columns, Dict, Fname, FilterBy, OrderBY, Options, AllItems, F, True, False, headerColumns) Then\xFE";
 z+="        If @Errors Then Stop @Errors\xFE";
 z+="        Print \"l (list) syntax:\"\xFE";
 z+="        Print \"   l { columnNames | * } From tableName { Where Condition }\"\xFE";
 z+="        Print \"   l tableName ColumnNames { Where Condition }\"\xFE";
 z+="        Print\xFE";
 z+="        Print \"options:\"\xFE";
 z+="        Print \"   (1-9 - # of columns (default is 4)\"\xFE";
 z+="        Print \"   (n - do not clear screen\"\xFE";
 z+="        Print \"   (f - include file stats\"\xFE";
 z+="        Print \"   (s - sort by file size\"\xFE";
 z+="        Print \"   (d - sort by file datetime\"\xFE";
 z+="        Print \"   (t - sort by file time\"\xFE";
 z+="        Print \"   (#1, (#2, ... set default list format n (use 'l tablename #1' to use)\"\xFE";
 z+="        Stop\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Instr(Options, \"#\") Then\xFE";
 z+="        setDft = Val(Field(Options, \"#\", 2))\xFE";
 z+="        If !setDft Then setDft = \"0\"\xFE";
 z+="        Options = Left(Options, Col1()-1):Mid(Options, Col1() + Len(setDft) + 1)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Val(Options) Then Cols = Cint(Val(Options)) Else Cols = 4\xFE";
 z+="    If checkPrivilages Then If isRestrictedFile(F) Then Stop @Errors\xFE";
 z+="    If Dict <> \"\" Then Dict = Dict:\" \"\xFE";
 z+="\xFE";
 z+="    TFName = trueTableName(Fname)\xFE";
 z+="    \xFE";
 z+="    if !Columns and !Len(setDft) then \xFE";
 z+="        Read dftColumns From Fhandle('dict', Fname), iif(dict, \"ld\", \"l\"):\"_defaultcolumns_0\" Then\xFE";
 z+="            Columns = \"#0\"\xFE";
 z+="        Else\xFE";
 z+="            Read dftColumns From Fhandle('dict', TFName), iif(dict, \"ld\", \"l\"):\"_defaultcolumns_0\" Then\xFE";
 z+="                Columns = \"#0\"\xFE";
 z+="            end if\xFE";
 z+="        End If\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // use default?\xFE";
 z+="    If Left(Columns, 1) = \"#\" Then\xFE";
 z+="        dftNo = Val(Mid(Columns, 2))\xFE";
 z+="        Read dftColumns From Fhandle('dict', Fname), iif(dict, \"ld\", \"l\"):\"_defaultcolumns_\":dftNo Else\xFE";
 z+="            Read dftColumns From Fhandle('dict', TFName), iif(dict, \"ld\", \"l\"):\"_defaultcolumns_\":dftNo Else dftColumns = \"\"\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If dftColumns Then\xFE";
 z+="            If !Top Then Top = dftColumns<1>\xFE";
 z+="            Columns = Split(dftColumns<2>, vm())\xFE";
 z+="            headerColumns = Split(dftColumns<3>, vm())\xFE";
 z+="            If !FilterBy Then FilterBy = dftColumns<4>\xFE";
 z+="            If !OrderBY Then OrderBY = dftColumns<5>\xFE";
 z+="            If !Options Then Options = Replace(dftColumns<6>, \",\", \"\") \xFE";
 z+="            If Val(Options) Then Cols = Cint(Val(Options))\xFE";
 z+="        Else\xFE";
 z+="            Stop \"Unable to find default column list \":dftNo\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Select LTrim(Top:' '):Join(Columns, \" \") From F Where FilterBy:OrderBY To Ss Else Stop @Errors\xFE";
 z+="    If Len(setDft) Then\xFE";
 z+="        Rec = Top\xFE";
 z+="        Rec<2> = Join(Columns, vm())\xFE";
 z+="        Rec<3> = Join(headerColumns, vm())\xFE";
 z+="        Rec<4> = FilterBy\xFE";
 z+="        Rec<5> = OrderBY\xFE";
 z+="        Rec<6> = Replace(Options, \",\", \"\")\xFE";
 z+="        Write Rec On Fhandle('dict', Fname, true), iif(dict, \"ld\", \"l\"):\"_defaultcolumns_\":setDft Else Stop @Errors\xFE";
 z+="        If MsgBox(\"Default Columns set\", \"OK\") <> \"OK\" Then Stop\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Index(Options, \"N\") = 0 Then Print @(-1):\xFE";
 z+="\xFE";
 z+="    If @IsAdmin Then Ed = \"ED \"\xFE";
 z+="\xFE";
 z+="    Missing = []\xFE";
 z+="    IsDosDirectory = typeoffile(F) = \"dos\"\xFE";
 z+="    MaxLen = Int(150 / Cols) - 1\xFE";
 z+="    If MaxLen < 40 Then MaxLen = 40\xFE";
 z+="    Cnt = 0\xFE";
 z+="    Ds = GetList(Ss)\xFE";
 z+="    ClearSelect\xFE";
 z+="    If !Ds Then Stop 'No items found'\xFE";
 z+="    if Columns = \"\" And !isArray(ds) Then DS = Split(ds, am())\xFE";
 z+="    \xFE";
 z+="    * Setup for Binary files\xFE";
 z+="    WantStats = Instr(Options, \"F\") Or Instr(Options, \"S\") Or Instr(Options, \"D\") Or Instr(Options, \"T\") // Or (Options = \"\" And IsDosDirectory And Columns = \"\")\xFE";
 z+="    if IsDosDirectory then \xFE";
 z+="        Fpath = Replace(Mid(f, 5), `\\`, `/`)\xFE";
 z+="        If Fpath = \".\" Then Fpath = `./`\xFE";
 z+="        if left(fpath, 1) = `.` then \xFE";
 z+="            Fpath = @HtmlRoot:FPath \xFE";
 z+="        Else \xFE";
 z+="            fPath = @htmlRoot:Replace(Mid(filePath(f), len(@jsbrootdir)+1), `\\`, `/`)\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If Right(Fpath, 1) <> `/` Then Fpath := `/`\xFE";
 z+="\xFE";
 z+="        If WantStats Then\xFE";
 z+="            Fstats = fileStats(F)\xFE";
 z+="            If Fstats Then\xFE";
 z+="                Fstats = Fstats.stats\xFE";
 z+="                If Instr(Options, \"D\") Or Options = \"\" Then Fstats = Sort(Fstats, \"#timeStamp\")\xFE";
 z+="                If Instr(Options, \"S\") Then Fstats = Sort(Fstats, \"#size\")\xFE";
 z+="                If Instr(Options, \"T\") Then Fstats = Sort(Fstats, \"time\")\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Columns Then\xFE";
 z+="        if Fstats Then\xFE";
 z+="            Dim tItemIDs As Array = []\xFE";
 z+="            pkName = primaryKeyName(F)\xFE";
 z+="            \xFE";
 z+="            For Each Rec, RecI In Ds\xFE";
 z+="                tItemIDs[RecI] = Rec[pkName]\xFE";
 z+="            Next\xFE";
 z+="            \xFE";
 z+="            OldDS = Ds\xFE";
 z+="            Ds = []\xFE";
 z+="            For Each dirEntry In Fstats\xFE";
 z+="                Locate dirEntry.name In tItemIDs Setting Spot Then\xFE";
 z+="                    Rec = OldDS[Spot]\xFE";
 z+="                    If !Rec.date Then Rec.date = dirEntry.date\xFE";
 z+="                    If !Rec.time Then Rec.time = dirEntry.time\xFE";
 z+="                    If !Rec.timeStamp Then Rec.timeStamp = dirEntry.timeStamp\xFE";
 z+="                    If !Rec.size Then Rec.size = dirEntry.size\xFE";
 z+="                \xFE";
 z+="                    Ds[-1] = Rec\xFE";
 z+="                End If\xFE";
 z+="            Next\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        trueColumnNames = []\xFE";
 z+="        lcTrueColumnNames = []\xFE";
 z+="        For Each Tag In Ds[LBound(Ds)]\xFE";
 z+="            trueColumnNames[-1] = Tag\xFE";
 z+="            lcTrueColumnNames[-1] = LCase(Tag)\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        If Trim(Columns) = \"*\" Then\xFE";
 z+="            Columns = trueColumnNames\xFE";
 z+="            headerColumns = trueColumnNames\xFE";
 z+="            \xFE";
 z+="        Else\xFE";
 z+="            wColumns = Split(LTrim(Join(Columns, am())), am())\xFE";
 z+="            Columns = []\xFE";
 z+="            For Each C, I In wColumns\xFE";
 z+="                Locate LCase(C) In lcTrueColumnNames Setting Spot Then Columns[-1] = trueColumnNames[Spot] Else Columns[-1] = trueColumnNames[I]\xFE";
 z+="            Next\xFE";
 z+="            \xFE";
 z+="            wHeaderColumns = Split(LTrim(Join(Columns, am())), am())\xFE";
 z+="            headerColumns = []\xFE";
 z+="            For Each C, I In wHeaderColumns\xFE";
 z+="                Locate LCase(C) In lcTrueColumnNames Setting Spot Then headerColumns[-1] = trueColumnNames[Spot] Else headerColumns[-1] = C\xFE";
 z+="            Next\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        jColumnNames = Join(Columns, \",\")\xFE";
 z+="        If jColumnNames Then jColumnNames := ' From '\xFE";
 z+="        Top = LTrim(Top:' ')\xFE";
 z+="        \xFE";
 z+="        HeadLine = \"L \":Top:jColumnNames:Dict:Fname:' ':Iff(FilterBy And Left(LCase(FilterBy), 6) <> \"order \", \"Where \":FilterBy, FilterBy)\xFE";
 z+="        Print @Html(`<button type='button' class='btn btn-primary' onclick='appendKey(\"`:@HtmlEncode(HeadLine):`\");'>`:@HtmlEncode(HeadLine):`</button>`)\xFE";
 z+="        Print\xFE";
 z+="        \xFE";
 z+="        Print  @Html(\"<table style='max-width: 95%; white-space: nowrap;'>\"):\xFE";
 z+="        \xFE";
 z+="        ' Pre-read all headers in one GetList\xFE";
 z+="        ReadDicts = []\xFE";
 z+="        LColumns = LCase(Columns)\xFE";
 z+="        For Each C In headerColumns\xFE";
 z+="            C = DropIfLeft(LCase(C), \" as \")\xFE";
 z+="            Locate C In LColumns Setting Ci Then ReadDicts[-1] = C\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        DReads = Nothing\xFE";
 z+="        If Len(ReadDicts) Then\xFE";
 z+="            Open \"dict\", Fname To Fd_file Then\xFE";
 z+="                FormList ReadDicts\xFE";
 z+="                Select \"ItemID,*\" From Fd_file To Ss Else Stop @Errors\xFE";
 z+="                DReads = GetList(Ss)\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        ' Process Header\xFE";
 z+="        OCONVs = []\xFE";
 z+="        R = [@Html(\"<tr>\")]\xFE";
 z+="        For Each C In headerColumns\xFE";
 z+="            Max = 0\xFE";
 z+="            LC = DropIfLeft(LCase(C), \" as \")\xFE";
 z+="            Locate LC In LColumns Setting Ci Then\xFE";
 z+="                For Each PreRead In DReads\xFE";
 z+="                    If LCase(PreRead.ItemID) = LC Then\xFE";
 z+="                        DItem = PreRead.ItemContent\xFE";
 z+="                        If DItem<2> Then Max = DItem<2>\xFE";
 z+="                        If Instr(\" AaSs\", DItem<1>) > 1 And DItem<7> <> \"\" Then OCONVs[Ci] = DItem<7>\xFE";
 z+="                        Break\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="            End If\xFE";
 z+="            V = \"\"\xFE";
 z+="            If Max Then\xFE";
 z+="                If Val(Max) = Max Then Max = Max * 8 : \"px\"\xFE";
 z+="                R[-1] = @Td(@Bold(C), { style: 'max-width: ':Max, overflow: 'hidden' } )\xFE";
 z+="            Else\xFE";
 z+="                R[-1] = @Td(@Bold(C))\xFE";
 z+="            End If\xFE";
 z+="            R[-1] = @Td(' ')\xFE";
 z+="        Next\xFE";
 z+="        R[-1] = @Html(\"</tr>\")\xFE";
 z+="        Print Join(R, ''):\xFE";
 z+="        \xFE";
 z+="        ' Process dataset\xFE";
 z+="        Cache = Null\xFE";
 z+="        pkName = LCase(pkName)\xFE";
 z+="        For Each Rec In Ds\xFE";
 z+="            R = [\"<tr>\"]\xFE";
 z+="            For Each C, Ci In Columns\xFE";
 z+="                V = Rec[Trim(C)]\xFE";
 z+="                Conv = OCONVs[Ci]\xFE";
 z+="                If Conv Then V = Ioconv('O', V, Conv, Null, Cache)\xFE";
 z+="                \xFE";
 z+="                If Left(V,1) <> Chr(28) Then\xFE";
 z+="                    Lc = LCase(C)\xFE";
 z+="                    If Lc = \"itemid\" Or Lc = pkName Then\xFE";
 z+="                        V = anchorEdit(Dict:Fname, V, V, fPath, MaxLen)\xFE";
 z+="                    Else\xFE";
 z+="                        If V = \"\" Then V = '&nbsp;' Else V = @Server.HtmlEncode(V)\xFE";
 z+="                    End If\xFE";
 z+="                End If\xFE";
 z+="                R[-1] = \"<td>\":V:\"</td><td>&nbsp;</td>\"\xFE";
 z+="            Next\xFE";
 z+="            R[-1] = \"</tr>\"\xFE";
 z+="            \xFE";
 z+="            Print Chr(28):Join(R, ''):Chr(29):\xFE";
 z+="            Cnt = Cnt + 1\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="    Else\xFE";
 z+="        Top = LTrim(Top:' ')\xFE";
 z+="        Space = @Html(\"&\":\"nbsp;\")\xFE";
 z+="        Space = \" \"\xFE";
 z+="        if !isArray(Ds) Then Ds = Split(Ds, am())\xFE";
 z+="        \xFE";
 z+="        HeadLine = \"L \":LTrim(Top:\" \"):Dict:Fname:' ':Iff(FilterBy And Left(LCase(FilterBy), 6) <> \"order \", \"Where \":FilterBy, FilterBy)\xFE";
 z+="        Print @Html(`<button type='button' class='btn btn-primary' onclick='appendKey(\"`:@HtmlEncode(HeadLine):`\");'>`:@HtmlEncode(HeadLine):`</button>`)\xFE";
 z+="        Print\xFE";
 z+="        \xFE";
 z+="        Print \"*************** L \":Top:\" \":Dict:TFName:\" \":Iff(FilterBy, \" Where \":FilterBy, \"\")\xFE";
 z+="        Print\xFE";
 z+="        Print  @Html(\"<table style='width: 95%; white-space: nowrap;'>\"):\xFE";
 z+="        \xFE";
 z+="        If Fstats Then\xFE";
 z+="            OldDS = Ds\xFE";
 z+="            Ds = []\xFE";
 z+="            ItemIDs = {}\xFE";
 z+="            For Each dirEntry, dirEntryI In Fstats\xFE";
 z+="                Name = dirEntry.name\xFE";
 z+="                Locate Name In OldDS Then Ds[-1] = Name\xFE";
 z+="                ItemIDs[Name] = dirEntry\xFE";
 z+="            Next\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        For Each Id, Li In Ds\xFE";
 z+="            Td = \"\"\xFE";
 z+="            For I = 1 To Cols\xFE";
 z+="                isMissing = Id = \"\"\xFE";
 z+="                Loop\xFE";
 z+="                    if Fstats Then dirEntry = ItemIDs[ID] Else dirEntry = \"\"\xFE";
 z+="                    \xFE";
 z+="                    If !dirEntry And (FilterBy = \"*\" Or WantStats) Then\xFE";
 z+="                        Read X From F, Id Else\xFE";
 z+="                            isMissing = True\xFE";
 z+="                            If Id Then Missing[-1] = Id\xFE";
 z+="                        End If\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    If Not(isMissing) Then\xFE";
 z+="                        Cnt += 1\xFE";
 z+="                        Td := @Td(anchorEdit(Dict:Fname, Id, Id, Fpath, MaxLen))\xFE";
 z+="                        \xFE";
 z+="                        If Fstats Then\xFE";
 z+="                            dirEntry = ItemIDs[ID]\xFE";
 z+="                            Td := @Td(@MonoSpace(Space:dirEntry.date:Space:dirEntry.time:Space:Space:Right(Space(10):dirEntry.size, 10):Space))\xFE";
 z+="                        ElseIf WantStats Then\xFE";
 z+="                            Td := @Td(@MonoSpace(Right(Space(10):Len(X), 10):Space))\xFE";
 z+="                        End If\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    Li += 1\xFE";
 z+="                    If Li > UBound(Ds) Then Break\xFE";
 z+="                    Id = Ds[Li]\xFE";
 z+="                While Missing Do Repeat\xFE";
 z+="                \xFE";
 z+="                If Li > UBound(Ds) Then Break\xFE";
 z+="            Next\xFE";
 z+="\xFE";
 z+="            Print Chr(28):\"<tr>\":Td:\"</tr>\":Chr(29):\xFE";
 z+="            Li -= 1\xFE";
 z+="        Next\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Print @Html(\"</table>\")\xFE";
 z+="    \xFE";
 z+="    if Cnt = 0 Then Desc = \"\" Else if Cnt = 1 Then Desc = \"1 item listed.\" else Desc = Cnt:\" items listed.\"\xFE";
 z+="    \xFE";
 z+="    if system(1) = \"aspx\" then\xFE";
 z+="        Try\xFE";
 z+="            bytesFree = @@dosExecute(@jsbrootdir, \"dir a*.*\", Errs)\xFE";
 z+="        End try\xFE";
 z+="        if bytesFree Then\xFE";
 z+="            bytesFree = trim(field(field(bytesFree, \"(s)\", 3), \"bytes\", 1))\xFE";
 z+="            nBytesFree = CNum(replace(bytesFree, \",\", \"\"))\xFE";
 z+="            if nBytesFree < 10000000 then desc := \"    \":@BackgroundColor(\"Yellow\", @Color(\"Black\", \"(\":bytesFree:\" bytes free)\" )) Else desc := \"     (\":bytesFree:\" bytes free)\"\xFE";
 z+="        End If\xFE";
 z+="    end if\xFE";
 z+="    print desc\xFE";
 z+="\xFE";
 z+="    If Len(Missing) Then Print \"Missing item \":Join(Missing, crlf():\"Missing item \")\xFE";
 z+="    ClearSelect\xFE";
 z+=" \xFE";
 z+="    if !@isPhoneGap Or @hasParentProcess Or @hasTclParent Then Stop\xFE";
 z+="    print @button('is','Close',{onclick:'At_Server.End(me)'} )\xFE";
 z+="\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="\xFE";
 z+=""
window.cached_jsb_tcl["l"]=z;
window.cached_jsb_tcl["let"]="Program Let\xFE   If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE   s = @sentence[index(@sentence, ' ', 1)+1, 9999]\xFE\xFE   fh = @fHandle(\"\", \"tmp\", true)\xFE   write \"Program LR\":am():\"Let \":s on fh, 'lr' else stop @errors\xFE\xFE   if system(1) = \"gae\" OR system(1) = \"aspx\" then\xFE      execute \"basic tmp lr\" capturing x\xFE   end else\xFE      execute \"pc tmp lr\" capturing x\xFE   end if\xFE\xFE\xFE   if instr(x, \"Successful\") then execute \"run tmp lr\" else print x\xFE\xFE   CLEARSELECT";
var z="Program Lf\xFE";
 z+="\xFE";
 z+="    Clearselect\xFE";
 z+="    Dim attachedDB As String = @attacheddb\xFE";
 z+="    Dim rmtAttachedDB As String  = \"\"\xFE";
 z+="    if attachedDB then rmtAttachedDB = @@attachedDB\xFE";
 z+="        \xFE";
 z+="    Dim Sentence As String = @Sentence\xFE";
 z+="    Dim Options As String = LCase(Field(Sentence, \" (\", 2)) // Isolate options \xFE";
 z+="    Sentence = LCase(Field(Sentence, \" (\", 1))\xFE";
 z+="    Dim AllFields As Boolean = Instr(Options, \"*\") \xFE";
 z+="    Dim includeJsb As Boolean = Instr(Options, \"j\") Or Instr(Options, \"a\")\xFE";
 z+="    Dim includeLocal As Boolean = Instr(Options, \"a\")\xFE";
 z+="    Dim includeViews As Boolean = Instr(Options, \"a\") Or Instr(Options, \"v\")\xFE";
 z+="    Dim Cols As Integer = Val(Options)\xFE";
 z+="    If Cols <= 0 Then Cols = 3\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    Dim filterBy As String = Field(Sentence, \" \", 3)\xFE";
 z+="    Dim listAccount As String = \"\"\xFE";
 z+="    Dim mustContain As String = \"\"\xFE";
 z+="    Dim mustEndWith As String = \"\"\xFE";
 z+="    Dim LenMustEndWith As Integer = 0\xFE";
 z+="    Dim MustStartWith As String = \"\"\xFE";
 z+="    Dim LenMustStartWith As Integer = 0\xFE";
 z+="    If filterBy Then listAccount = Field(Sentence, \" \", 2) Else filterBy = Field(Sentence, \" \", 2)\xFE";
 z+="    \xFE";
 z+="    If !attachedDB And !listAccount And !includeJsb Then includeJsb = LCase(@JSBAccount) = \"sysprog\"\xFE";
 z+="    \xFE";
 z+="    If Left(filterBy, 1) = \"[\" Or Right(filterBy, 1) = \"]\" Then\xFE";
 z+="        includeJsb = True\xFE";
 z+="        If Left(filterBy, 1) = \"[\" Then\xFE";
 z+="            If Right(filterBy, 1) = \"]\" Then\xFE";
 z+="                mustContain = LCase(Mid(filterBy, 2, Len(filterBy)-2))\xFE";
 z+="            Else\xFE";
 z+="                mustEndWith = LCase(Mid(filterBy, 2))\xFE";
 z+="                LenMustEndWith = Len(mustEndWith)\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            MustStartWith = LCase(Left(filterBy, Len(filterBy) - 1))\xFE";
 z+="            LenMustStartWith = Len(MustStartWith)\xFE";
 z+="        End If\xFE";
 z+="    ElseIf listAccount Then\xFE";
 z+="        Stop \"filters must start or end with []\"\xFE";
 z+="    Else\xFE";
 z+="        listAccount = filterBy\xFE";
 z+="        filterBy = \"\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If listAccount <> \"\" Then\xFE";
 z+="        AttachDB listAccount Else\xFE";
 z+="            Print @Errors\xFE";
 z+="            AttachDB attachedDB Else Null\xFE";
 z+="            Stop\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    // Get whatever we are attached to\xFE";
 z+="    Dim sFileList As String, FileList As Array, FName As String, IdI As Integer\xFE";
 z+="    Dim FileMix As Integer = 0 // Only local files\xFE";
 z+="    \xFE";
 z+="    if rmtAttachedDB Then\xFE";
 z+="        sFileList = @@listFiles()\xFE";
 z+="    else\xFE";
 z+="        sFileList = listFiles()\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    FileList = @Sort(sFileList, \"LAI\") ;* Left, Ascending, Ignore Case\xFE";
 z+="    For Each FName, IdI In FileList\xFE";
 z+="        if attachedDB Then FName := vm():\"RMT:\"\xFE";
 z+="        FileList[Idi] = FName\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    // Do we need dos files too?\xFE";
 z+="    If (listAccount <> \"\" Or attachedDB <> \"\") And includeLocal Then\xFE";
 z+="        AttachDB \"\" Then\xFE";
 z+="            Listfiles To localFiles Then\xFE";
 z+="                localFiles = Split(localFiles, am())\xFE";
 z+="                For Each FName In localFiles\xFE";
 z+="                    FileList[-1] = FName:vm():\"DOS\"\xFE";
 z+="                Next\xFE";
 z+="                FileList = @Sort(FileList, \"LAI\")\xFE";
 z+="                FileMix = 1 // Remote and Local\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If    \xFE";
 z+="    \xFE";
 z+="    if includeViews then\xFE";
 z+="        Dim views As Array \xFE";
 z+="        if system(1) = \"js\" then views = @@listfiles(e, true) else views = system(37)\xFE";
 z+="        if views then\xFE";
 z+="            for each viewName As String In views\xFE";
 z+="                FileList[-1] = viewName\xFE";
 z+="            next\xFE";
 z+="            FileList = @Sort(FileList, \"I\")\xFE";
 z+="            FileMix = 2 // Remote and Local and views\xFE";
 z+="        End if\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    If listAccount Or attachedDB <> \"\" Then AttachDB attachedDB Else Null\xFE";
 z+="    \xFE";
 z+="    if attachedDB then\xFE";
 z+="        Print @Div('id2', @Center(@Bold(attachedDB)))\xFE";
 z+="    Else\xFE";
 z+="        Print @Div('id2', @Center(@Account))\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Print @setStyle('id2', { 'background-color': 'lightgray', color: 'black', border: '1px solid black ' } )\xFE";
 z+="    Print  @Html(\"<table style='width: 95%; white-space: nowrap;'>\"):\xFE";
 z+="    dim Cnt As Integer = 0\xFE";
 z+="    IdI = 1\xFE";
 z+="    Dim forFormList As Array  = []\xFE";
 z+="    Loop While IdI <= UBound(FileList) Do\xFE";
 z+="        Dim R As String = \"\"\xFE";
 z+="        For I = 1 To Cols While IdI <= UBound(FileList)\xFE";
 z+="            Loop\xFE";
 z+="                Dim FileName As String = FileList[IdI]<1,1>\xFE";
 z+="                if left(FileName, 1) = Chr(1) Then FileName = Mid(FileName, 2)\xFE";
 z+="                Dim LCFileName As String = LCase(FileName)\xFE";
 z+="                \xFE";
 z+="                If mustContain Then\xFE";
 z+="                    If !Instri(FileName, mustContain) Then FileName = \"\"\xFE";
 z+="                    \xFE";
 z+="                ElseIf mustEndWith Then\xFE";
 z+="                    If LCase(Right(FileName, LenMustEndWith)) <> mustEndWith Then FileName = \"\"\xFE";
 z+="                    \xFE";
 z+="                ElseIf MustStartWith Then\xFE";
 z+="                    If LCase(Left(FileName, LenMustStartWith)) <> MustStartWith Then FileName = \"\"\xFE";
 z+="                Endif\xFE";
 z+="                \xFE";
 z+="                isJsbFile = Left(LCFileName, 4) = \"jsb_\" or Left(LCFileName, 4) = \"jsb2\"\xFE";
 z+="                \xFE";
 z+="            While !FileName Or (isJsbFile And !includeJsb) Do\xFE";
 z+="                IdI += 1\xFE";
 z+="                If IdI > UBound(FileList) Then Break\xFE";
 z+="            Repeat\xFE";
 z+="            \xFE";
 z+="\xFE";
 z+="            If IdI <= UBound(FileList) Then\xFE";
 z+="                if Cols = 1 Then \xFE";
 z+="                    DisplayName = @HtmlEncode(FileName)\xFE";
 z+="                Elseif Cols = 2 Then \xFE";
 z+="                    DisplayName = @HtmlEncode(Right(FileName, 60))\xFE";
 z+="                Else\xFE";
 z+="                    DisplayName = @HtmlEncode(Right(FileName, 30))\xFE";
 z+="                End If\xFE";
 z+="                Dim ProtoColTag As String = FileList[IdI]<1,2>\xFE";
 z+="                \xFE";
 z+="                // Local and Remote\xFE";
 z+="                if FileMix = 1 Then\xFE";
 z+="                    If ProtoColTag = \"RMT:\" Then \xFE";
 z+="                        displayName = @html(\"<span style='opacity: .5'>\" : DisplayName : \"</span>\") \xFE";
 z+="                    Else\xFE";
 z+="                        // displayName = @Bold(displayName)\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                // and Views\xFE";
 z+="                ElseIf FileMix = 2 Then\xFE";
 z+="                    If ProtoColTag Then \xFE";
 z+="                        displayName = @html(`<span data-toggle=\"tooltip\" title=\"`:HtmlEncode(ProtoColTag):`\">` : DisplayName : `</span>`) \xFE";
 z+="                    Else\xFE";
 z+="                        // displayName = @html(\"<span style='opacity: .5'>\" : DisplayName : \"</span>\") \xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                ElseIf ProtoColTag Then\xFE";
 z+="                    displayName = @html(\"<span style='opacity: .5'>\" : DisplayName : \"</span>\") \xFE";
 z+="                End if\xFE";
 z+="                \xFE";
 z+="                if ProtoColTag <> \"RMT:\" Then ProtoColTag = \"\"\xFE";
 z+="                If AllFields Then ExeCmd = @jsbRootExecuteTclCmd(\"L * From '\":ProtoColTag:FileName:\"'\") Else ExeCmd = @jsbRootExecuteTclCmd(\"L '\":ProtoColTag:FileName:\"'\")\xFE";
 z+="                R = R:@Td(Chr(28):'<a href=':jsEscapeHREF(ExeCmd):' target=\"_blank\">':DisplayName:'</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;':Chr(29))\xFE";
 z+="                \xFE";
 z+="                forFormList[-1] = ProtoColTag:FileName \xFE";
 z+="                Cnt += 1\xFE";
 z+="                IdI += 1\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="        If R Then Print @Tr(R):\xFE";
 z+="    Repeat\xFE";
 z+="\xFE";
 z+="    Print @Html(\"</table>\")\xFE";
 z+="    If Cnt Then\xFE";
 z+="        If Cnt = 1 Then Print \"1 file listed.\": Else Print Cnt:\" files listed.\":\xFE";
 z+="        Print \" (savelist saved to \":Anchoredit(\"jsb_selectlists\", \"lf\"):\")\"\xFE";
 z+="        FormList forFormList\xFE";
 z+="        Savelist To 'lf' Else Stop @Errors\xFE";
 z+="    Else\xFE";
 z+="        Print \"No files listed.\"\xFE";
 z+="    End If\xFE";
 z+="    Clearselect\xFE";
 z+="\xFE";
 z+="    If !isPhoneGap() Or @hasTclParent Or @hasParentProcess Then Stop\xFE";
 z+="    Print @Button('id', 'Close', { onclick:'return jsbClose()' }):\xFE";
 z+="\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["lf"]=z;
var z="Program Link\xFE";
 z+="*$options aspx\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    Cmdline = @Sentence\xFE";
 z+="    Fname = LCase(Field(Cmdline, ' ', 2))\xFE";
 z+="    Opts = LCase(Field(Cmdline, \"(\", 2))\xFE";
 z+="    beQuiet = Instr(Opts, 's')\xFE";
 z+="    noBump = Instr(Opts, 'n')\xFE";
 z+="    IsJsb = @Domain = \"jsbwinforms.azurewebsites.net\"\xFE";
 z+="    \xFE";
 z+="    If Fname = \"?\" Or Opts = \"?\" Then\xFE";
 z+="        Print \"Options: k)keep spaces, s)ilient n)o bumping revision\"\xFE";
 z+="        Stop \"Done with counts - use jsbBuild to recompile everything\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If Fname = \"a\" Or Instr(Opts, \"a\") Or Fname = \"all\" Or Fname = \"*\" Then\xFE";
 z+="        Execute \"Link jsb_bf (s\"; @Server.Flush\xFE";
 z+="        Execute \"Link jsb_html (s\"; @Server.Flush\xFE";
 z+="        Execute \"Link jsb_tcl (s\"; @Server.Flush\xFE";
 z+="        Execute \"Link jsb_odb (s\"; @Server.Flush\xFE";
 z+="        Execute \"Link jsb2js (s\"; @Server.Flush\xFE";
 z+="        Execute \"Link jsb_mdl (s\"; @Server.Flush\xFE";
 z+="        Execute \"Link jsb_ctls (s\"; @Server.Flush\xFE";
 z+="        Execute \"Link jsb_themes (s\"; @Server.Flush\xFE";
 z+="        Execute \"Link cs (s\"; @Server.Flush\xFE";
 z+="        If !noBump Then \xFE";
 z+="            if beQuiet Then @bumpJsbVersion(\"tcl.html\") Else Print \"Revision set to \":@bumpJsbVersion(\"tcl.html\")\xFE";
 z+="        End If\xFE";
 z+="        if beQuiet Then Stop Else Stop \"Done\"\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If Fname = \"\" Then Stop \"LINK FILENAME (K) (KEEP SPACES)\"\xFE";
 z+="    If LCase(Fname) = \"dict\" Then Stop \"Do not use the DICT clause on linking.\"\xFE";
 z+="\xFE";
 z+="    Fname = LCase(TrueFileName(Fname))\xFE";
 z+="\xFE";
 z+="    Locate Fname In [\"jsb_bf\", \"jsb_html\", \"jsb_tcl\", \"jsb_odb\", \"jsb_ctls\", \"jsb_mdl\", \"jsb2js\", \"jsb_themes\", \"cs\"] Else\xFE";
 z+="        Read Itm From Fhandle('htamd'), Fname Then\xFE";
 z+="            If LCase(Itm<1>) = \"qd\" Then Stop Fname:\" is a QD file and should be compiled locally (Basic) or t-dumped'ed, not linked\"\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        Stop Fname:` is not something I link. I link only \"jsb_bf\", \"jsb_html\", \"jsb_tcl\", \"jsb_odb\", \"jsb_ctls\", \"jsb_mdl\", and \"jsb2js\"  See the  <!-- linked code section --> in your tcl.html file`\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Options = UCase(Field(Cmdline, \"(\", 2))\xFE";
 z+="    If Instr(Options, 'K') Then Keepspaces = True\xFE";
 z+="    Keepspaces = True\xFE";
 z+="    \xFE";
 z+="    Read QFile From @Fhandle('md'), Fname Then\xFE";
 z+="        QFile = LCase(QFile)\xFE";
 z+="        Locate 'q' In QFile<1> Setting Spot Then Fname = QFile<3, Spot>\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Open 'DICT',Fname To F_dfile Else Stop @Errors\xFE";
 z+="    Open `.\\jsb\\js` To F_Js Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    Select F_dfile To Sl Where \"ItemID Like '[.js'\" Else Stop @Errors\xFE";
 z+="    allIds = GetList(Sl)\xFE";
 z+="    \xFE";
 z+="    Lib = []\xFE";
 z+="    Cnt = 0\xFE";
 z+="    TwoLines = Chr(254):Chr(254)\xFE";
 z+="    OneLine = Chr(254)\xFE";
 z+="    TwoSpaces = Chr(254):Space(2)\xFE";
 z+="    OneSpace = Chr(254):Space(1)\xFE";
 z+="    If !beQuiet Then Print \"Linking \":Fname:\xFE";
 z+="    For Each Iname In allIds\xFE";
 z+="        If UCase(Right(Iname, 3)) = \".JS\" Then\xFE";
 z+="            Read Code From F_dfile, Iname Else Stop \"Unable to read file \":Iname\xFE";
 z+="            Code = Replace(Code, Sm(), am())\xFE";
 z+="\xFE";
 z+="            If !Keepspaces Then\xFE";
 z+="                Loop I = Instr(Code, TwoSpaces) While I Do Code = Change(Code, TwoSpaces, OneSpace) Repeat\xFE";
 z+="                Loop I = Instr(Code, TwoLines) While I Do Code = Change(Code, TwoLines, OneLine) Repeat\xFE";
 z+="            End If\xFE";
 z+="            Lib[-1] = Code\xFE";
 z+="            If Cnt Mod 20 = 1 Then Print \".\":\xFE";
 z+="            Cnt = Cnt + 1\xFE";
 z+="            \xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    Print\xFE";
 z+="    If Cnt = 0 Then Stop \"There were no javacript files in this dictionary to link\"\xFE";
 z+="    Lib = Join(Lib, am())\xFE";
 z+="    \xFE";
 z+="    If Fname = \"cs\" Then Name = @JsbAccount:\"_\":Fname Else Name = Fname\xFE";
 z+="    AnchorPath = @Anchor(@JsbRoot:`js/`:Name:\".js?cacheBuster=\":DropIfRight(Timer(), '.'), @JsbRoot:\"js/\":Name:\".js\", { target: \"_blank\" })\xFE";
 z+="    Write Lib On F_Js, Name:\".js\" Else Stop @Errors\xFE";
 z+="\xFE";
 z+="    If !beQuiet Then Print Len(Lib):\" bytes written to \":AnchorPath\xFE";
 z+="    If !noBump Then \xFE";
 z+="        if beQuiet Then @bumpJsbVersion(\"tcl.html\") Else Print \"Revision set to \":@bumpJsbVersion(\"tcl.html\")\xFE";
 z+="    End If\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Program Bump\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    Print bumpJsbVersion(\"tcl.html\")\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="function bumpJsbVersion(Byval Fname)\xFE";
 z+="    // Bump the version numbers used in JSB\xFE";
 z+="    Rel = DropIfRight(Timer(), \".\") + 1\xFE";
 z+="    Open `.\\jsb` To fMD2 Else Stop @Errors\xFE";
 z+="    Select fMD2 To Sl Where \"ItemID like '[.html'\" Else Stop @Errors\xFE";
 z+="    Fnames = GetList(Sl)\xFE";
 z+="    For Each Fname In Fnames\xFE";
 z+="        Read tclHtml From fMD2, Fname Then\xFE";
 z+="            If Instr(tclHtml, `?cacheBuster=`) Then\xFE";
 z+="                For C = 1 To Count(tclHtml, `?cacheBuster=`)\xFE";
 z+="                    I = Index(tclHtml, `?cacheBuster=`, C)\xFE";
 z+="                    J = Instr(I, tclHtml, `!`)\xFE";
 z+="                    If !J Then Stop 'Missing ! after ?cacheBuster='\xFE";
 z+="                    tclHtml = Left(tclHtml, I-1):\"?cacheBuster=\":Rel:Mid(tclHtml, J)\xFE";
 z+="                Next C\xFE";
 z+="\xFE";
 z+="                Write tclHtml On fMD2, Fname Else Stop @Errors\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    Return Rel\xFE";
 z+="End function\xFE";
 z+=""
window.cached_jsb_tcl["link"]=z;
var z="/*\xFE";
 z+="\xFE";
 z+="Program List\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    Issort = 0\xFE";
 z+="    Call English_list\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Program Sort\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    Issort = 1\xFE";
 z+="    Call English_list\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="Function LinesOnPage()\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    \xFE";
 z+="    If mLinesOnPage < 10 Then\xFE";
 z+="        If System(1) = \"js\" Then mLinesOnPage = CInt((@maxHeight-35)/ 27) Else mLinesOnPage = CInt((@maxHeight-35) / 22)\xFE";
 z+="        If mLinesOnPage < 10 Then mLinesOnPage = 10\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Return mLinesOnPage\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function PageWidth()\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    Return 160\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Subroutine English_list\xFE";
 z+="    $Include _VCOM\xFE";
 z+="*\xFE";
 z+="    Sentence = @Sentence\xFE";
 z+="    If !@IsAdmin Then Stop \"You are not have enough privilages\"\xFE";
 z+="    \xFE";
 z+="    Call English_parser\xFE";
 z+="    If Errors Then\xFE";
 z+="        Erri = 1\xFE";
 z+="        Loop\xFE";
 z+="            Err = Errors<Erri>\xFE";
 z+="            Erri = Erri + 1\xFE";
 z+="        While Err # '' Do\xFE";
 z+="            If Err[1,1] = Char(1) Then\xFE";
 z+="                Print \"Unknown term: \":Err[2, 9999]\xFE";
 z+="            End Else\xFE";
 z+="                Print Err\xFE";
 z+="            End\xFE";
 z+="        Repeat\xFE";
 z+="        \xFE";
 z+="        *IF TOPRINTER THEN PRINTER OFF ; PRINTER CLOSE \xFE";
 z+="        Stop\xFE";
 z+="    End If\xFE";
 z+="*\xFE";
 z+="* Build a select where clause that doesn't include selections on exploding columns, but not any selections on ICONV, OCONV columns (these are done later)\xFE";
 z+="*\xFE";
 z+="    Conj = \"\"\xFE";
 z+="    Whereclause = \"\"\xFE";
 z+="    For Each Andclause In Selecttbl\xFE";
 z+="        For Each Orclause In Andclause\xFE";
 z+="            Whereclause := Conj\xFE";
 z+="            If Isnum(Orclause.sel_atr) Then Whereclause := \"*A\"\xFE";
 z+="            Arg = Orclause.sel_relarg\xFE";
 z+="            If Left(Arg, 2) = `'[` Or Right(Arg, 2) = `]'` Then\xFE";
 z+="                Orclause.sel_relcond = 'LIKE'\xFE";
 z+=" *               ARG = REPLACE(ARG, \"[\", \"%\") ;* sql syntax\xFE";
 z+=" *               ARG = REPLACE(ARG, \"]\", \"%\")\xFE";
 z+="            ElseIf Left(Arg, 2) = `'%` Or Right(Arg, 2) = `%'` Then\xFE";
 z+="                Orclause.sel_relcond = 'LIKE'\xFE";
 z+="            End If\xFE";
 z+="            Whereclause := Orclause.sel_atr:\" \":Orclause.sel_relcond:\" \":Arg\xFE";
 z+="            Conj = \" OR \"\xFE";
 z+="        Next\xFE";
 z+="        Conj = \" AND \"\xFE";
 z+="    Next\xFE";
 z+="*\xFE";
 z+="* Build column list\xFE";
 z+="*\xFE";
 z+="    Dcolcnt = UBound(Displaytbl)\xFE";
 z+="    If !Dcolcnt Then\xFE";
 z+="        For I = 1 To 100\xFE";
 z+="            Read Ditem From F_dictionary, I Then\xFE";
 z+="                Dcolcnt = Dcolcnt + 1\xFE";
 z+="                Displaytbl[Dcolcnt] = {}\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_atr = Ditem<2>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_convi = Ditem<8>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_convo = Ditem<7>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_colwdt = Ditem<10>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_coljst = Ditem<9>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_colhdr = Ditem<1>\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="    End If\xFE";
 z+="*\xFE";
 z+="    Columns = []\xFE";
 z+="    For Coli = 1 To Dcolcnt\xFE";
 z+="        If Displaytbl[Coli].Dis_colwdt Then\xFE";
 z+="            Column = Displaytbl[Coli].Dis_atr\xFE";
 z+="            If Num(Column) Then\xFE";
 z+="                If Column = 0 Then\xFE";
 z+="                    Columns[-1] = \"ItemID\"\xFE";
 z+="                Else\xFE";
 z+="                    Columns[-1] = \"*A\":Column\xFE";
 z+="                End If\xFE";
 z+="\xFE";
 z+="            ElseIf Column = \"*A0\" Then\xFE";
 z+="                Columns[-1] = \"ItemID\"\xFE";
 z+="\xFE";
 z+="            Else\xFE";
 z+="                Columns[-1] = Column\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    Expatrs = []\xFE";
 z+="    Detailsort = UBound(Exptbl) > 0\xFE";
 z+="    For Each Colname In Exptbl\xFE";
 z+="        Ditem = Exptbl[Colname]\xFE";
 z+="        Atr = Ditem<2>\xFE";
 z+="        If !Atr Then Atr = Colname\xFE";
 z+="        If Num(Atr) Then Atr = \"*A\":Atr\xFE";
 z+="        Locate Atr In Columns Else Columns[-1] = Atr\xFE";
 z+="        Expatrs[-1] = Atr\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    *\xFE";
 z+="    * add Sort clause (except for exploding columns - and OCONVs)\xFE";
 z+="    *\xFE";
 z+="    Sortcolumns = []\xFE";
 z+="    Sortcolumnsi = []\xFE";
 z+="    For Coli = 1 To Sortcnt\xFE";
 z+="        Conv = Sorttbl[Coli].Srt_oconv\xFE";
 z+="        \xFE";
 z+="        * IGNORE SORT IF THERE IS A CONVERSION, AS IF WILL BE DONE POST-CONVERSION\xFE";
 z+="        Atr = Sorttbl[Coli].Srt_atr\xFE";
 z+="        \xFE";
 z+="        If Num(Atr) Then\xFE";
 z+="            If Atr = 0 Then Atr = \"ItemID\" Else Atr = \"*A\":Atr\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If Sorttbl[Sortcnt].Srt_ad = 'D' Then\xFE";
 z+="            Sortcolumns[-1] = Atr:' desc'\xFE";
 z+="            Sortcolumnsi[-1] = '<':Atr\xFE";
 z+="        Else\xFE";
 z+="            Sortcolumns[-1] = Atr\xFE";
 z+="            Sortcolumnsi[-1] = Atr\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    *\xFE";
 z+="    * Execute and get the dataset\xFE";
 z+="    *\xFE";
 z+="    If Sortcolumns Then Sortby = \" order by \":Join(Sortcolumns,\",\")\xFE";
 z+="    Columns = \"[\":Join(Columns, \"],[\"):\"]\"\xFE";
 z+="\xFE";
 z+="    If Itemlist Then\xFE";
 z+="        If Whereclause Then Whereclause := \" AND \" Else Whereclause = \" WHERE \"\xFE";
 z+="        Whereclause = `(ItemId = '`:Join(Itemlist, `' Or ItemId = '`):`')`\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    Select Columns From F_file To Ss Where Whereclause:Sortby Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    Dataset = Json(Getlist(Ss))\xFE";
 z+="    ClearSelect\xFE";
 z+="\xFE";
 z+="    *\xFE";
 z+="    * Explode any data rows necessary - EXPTBL is an array of ATR's\xFE";
 z+="    *\xFE";
 z+="    Endi = UBound(Dataset)\xFE";
 z+="    Rowi = LBound(Dataset)\xFE";
 z+="    \xFE";
 z+="    Loop While Rowi <= Endi Do\xFE";
 z+="        Row = Dataset[Rowi]\xFE";
 z+="\xFE";
 z+="        Mvcnt = 0 ;* Determine Number Of Multivalues\xFE";
 z+="  \xFE";
 z+="        For Each Atr In Expatrs\xFE";
 z+="            Cnt = Dcount(Row[Atr], vm())\xFE";
 z+="            If Cnt > Mvcnt Then Mvcnt = Cnt\xFE";
 z+="        Next\xFE";
 z+="\xFE";
 z+="        If Mvcnt > 1 Then\xFE";
 z+="            For Mvi = 2 To Mvcnt\xFE";
 z+="                Dataset.insert(Rowi+1, Clone(Row))\xFE";
 z+="                Endi += 1\xFE";
 z+="            Next\xFE";
 z+="            For Mvi = 1 To Mvcnt\xFE";
 z+="                Row = Dataset[Rowi]\xFE";
 z+="\xFE";
 z+="                For Each Atr In Expatrs\xFE";
 z+="                    Row[Atr] = Field(Row[Atr], vm(), Mvi)\xFE";
 z+="                Next\xFE";
 z+="\xFE";
 z+="                Rowi += 1\xFE";
 z+="            Next\xFE";
 z+="        Else\xFE";
 z+="            Rowi += 1\xFE";
 z+="        End If\xFE";
 z+="    Repeat\xFE";
 z+="\xFE";
 z+="    *\xFE";
 z+="    * Process any ICONV's / OCONV's across the whole dataset\xFE";
 z+="    * \xFE";
 z+="    * Collection from DISPLAYTBL, SORTTBL, EXPTBL\xFE";
 z+="\xFE";
 z+="    Convs = [] ;* .Atrno, .Conv\xFE";
 z+="\xFE";
 z+="    If False Then\xFE";
 z+="        For Coli = 1 To UBound(Sorttbl)\xFE";
 z+="            Conv = Sorttbl[Coli].Srt_oconv ;*  Use I If Possible, Else Use O\xFE";
 z+="            If Conv Then\xFE";
 z+="                Atrno = Sorttbl[Coli].Srt_atr\xFE";
 z+="                If Num(Atrno) Then\xFE";
 z+="                    If Atrno = 0 Then Atrno = \"ItemID\" Else Atrno = \"*A\":Column\xFE";
 z+="                End If\xFE";
 z+="                Convs[-1] = { Atrno: Atrno, Conv: Conv }\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="\xFE";
 z+="        * THIS IS AN ICONV FOR FILTERING\xFE";
 z+="        Expatrs = []\xFE";
 z+="        For Each Colname In Exptbl\xFE";
 z+="            Ditem = Exptbl[Colname]\xFE";
 z+="            If Ditem<8> Then\xFE";
 z+="                ' ICONV\xFE";
 z+="                Atr = Ditem<2>\xFE";
 z+="                If !Atr Then Atr = Colname\xFE";
 z+="                If Num(Atr) Then Atr = \"*A\":Atr\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    For Coli = 1 To UBound(Displaytbl)\xFE";
 z+="        Conv = Displaytbl[Coli].Dis_convo\xFE";
 z+="        If Conv Then\xFE";
 z+="            Atrno = Displaytbl[Coli].Dis_atr\xFE";
 z+="            If Num(Atrno) Then\xFE";
 z+="                If Atrno = 0 Then Atrno = \"ItemID\" Else Atrno = \"*A\":Column\xFE";
 z+="            End If\xFE";
 z+="            Convs[-1] = { Atrno: Atrno, Conv: Conv, Just: Displaytbl[Coli].Dis_coljst }\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    If Convs Then\xFE";
 z+="        For Each Conv In Convs\xFE";
 z+="            Call English_conversions('O', Dataset, Conv.atrno, Conv.conv, Conv.just)\xFE";
 z+="        Next\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="*\xFE";
 z+="* Do a final filter (if we have Expoding criteria or OCONV criteria)\xFE";
 z+="*   if !filterJsonArray(SelectedItemIDs, SelectedItems, WhereClause) Then Return false\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="*\xFE";
 z+="* Do final sort if necessary (if we have Expoding criteria or ICONV/OCONV criteria)\xFE";
 z+="*\xFE";
 z+="    If Detailsort Then Dataset = @Sort(Dataset, Sortcolumnsi)\xFE";
 z+="\xFE";
 z+="*\xFE";
 z+="* Drop filter columns if they aren't show in results\xFE";
 z+="*\xFE";
 z+="\xFE";
 z+="    If False Then ;* If Paging Use Grid\xFE";
 z+="        * Build a list of display columns / group columns for grid\xFE";
 z+="        UserModelColumns = jqGridDefaultModel(dataSet)\xFE";
 z+="        Print @(-1):@jqGrid(\"myID\", dataSet, UserModelColumns, {})\xFE";
 z+="    Else\xFE";
 z+="    \xFE";
 z+="        Call English_display\xFE";
 z+="    End If\xFE";
 z+="End Subroutine\xFE";
 z+="\xFE";
 z+="Subroutine English_tokenizer(Command)\xFE";
 z+="* \xFE";
 z+="    $Include _VCOM\xFE";
 z+="* \xFE";
 z+="* Break COMMAND line into Tokens \xFE";
 z+="* \xFE";
 z+="    Open '','MD' To Mdx Else\xFE";
 z+="        Print 'UNABLE TO OPEN MD'\xFE";
 z+="        Stop\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    Throwaway = 'A':am():'AN':am():'ANY':am():'ARE':am():'FILE':am():'FOR':am()\xFE";
 z+="    Throwaway<-1> = 'ITEMS':am():'OF':am():'THE':am():'THIS':am():'EVERY'\xFE";
 z+="*\xFE";
 z+="    Tkstrs = '=':am():'EQ':am():'>':am():'GT':am():'AFTER':am():'GE'\xFE";
 z+="    Tkvals = C_eq:C_eq:C_gt:C_gt:C_gt:C_ge\xFE";
 z+="    Tkstrs<-1> = '<':am():'LT':am():'BEFORE':am():'>='\xFE";
 z+="    Tkvals = Tkvals:C_lt:C_lt:C_lt:C_ge\xFE";
 z+="    Tkstrs<-1> = '<=':am():'LE':am():'#':am():'NE':am():'NO':am():'NOT'\xFE";
 z+="    Tkvals = Tkvals:C_le:C_le:C_ne:C_ne:C_not:C_not\xFE";
 z+="    Tkstrs<-1> = 'AND':am():'OR':am():'DICT':am():'DATA':am():'EACH':am():'EVERY'\xFE";
 z+="    Tkvals = Tkvals:C_and:C_or:C_dict:C_data:C_each:C_each\xFE";
 z+="    Tkstrs<-1> = 'ID-SUPP':am():'HDR-SUPP':am():'USING':am():'SUPP'\xFE";
 z+="    Tkvals = Tkvals:C_idspp:C_hdrspp:C_using:C_hdrspp\xFE";
 z+="    Tkstrs<-1> = 'HEADING':am():'FOOTING':am():'BREAK-ON':am():'GROUP-ON':am():'GROUP-BY'\xFE";
 z+="    Tkvals = Tkvals:C_heading:C_footing:C_breakon:C_breakon:C_breakon\xFE";
 z+="    Tkstrs<-1> = 'BY':am():'BY-DSND':am():'BY-EXP':am():'BY-EXP-DSND':am():'BY-DESCENDING':am():'BY-EXPLODING-DESCENDING'\xFE";
 z+="    Tkvals = Tkvals:C_by:C_bydsnd:C_byexp:C_byexpdsnd:C_bydsnd:C_byexpdsnd\xFE";
 z+="    Tkstrs<-1> = 'COL-HDR-SUPP':am():'DBL-SPC':am():'DET-SUPP'\xFE";
 z+="    Tkvals = Tkvals:C_colhdrspp:C_dblspc:C_detspp\xFE";
 z+="    Tkstrs<-1> = 'TOTAL':am():'GRAND-TOTAL':am():'ONLY':am():'WITH':am():'WHERE':am():\"WITHOUT\"\xFE";
 z+="    Tkvals = Tkvals:C_total:C_gndtotal:C_only:C_with:C_with:C_without\xFE";
 z+="    Tkstrs<-1> = \"NOPAGE\":am():'LPTR'\xFE";
 z+="    Tkvals = Tkvals:C_nopage:C_lptr\xFE";
 z+="* \xFE";
 z+="    Slen = Len(Command)\xFE";
 z+="    Instr = 0\xFE";
 z+="    Terms = ''\xFE";
 z+="    Tokens = ''\xFE";
 z+="    Term = ''\xFE";
 z+="    Termi = 0\xFE";
 z+="    Strc = ''\xFE";
 z+="* \xFE";
 z+="    Starti = Index(Command,' ',1)+1\xFE";
 z+="    For I = Starti To Slen+1\xFE";
 z+="        C = Command[I,1]\xFE";
 z+="        Begin Case\xFE";
 z+="            Case Instr And C = Strc\xFE";
 z+="                Termi = Termi + 1\xFE";
 z+="                Terms<Termi> = \"'\":Change(Term, \"'\", `\\'`):\"'\"\xFE";
 z+="                Tokens<Termi> = c_STR\xFE";
 z+="                Instr = 0\xFE";
 z+="                Term = ''\xFE";
 z+="            Case Instr\xFE";
 z+="                Term = Term:C\xFE";
 z+="            Case Index(`\\\"'`,C,1)\xFE";
 z+="                If Term # '' Then Gosub 50\xFE";
 z+="                Instr = 1\xFE";
 z+="                Strc = C\xFE";
 z+="                Term = ''\xFE";
 z+="            Case C = '#' Or C = '='\xFE";
 z+="                If Term # '' Then Gosub 50\xFE";
 z+="                Term = C ; Gosub 50\xFE";
 z+="            Case C = '<' Or C = '>'\xFE";
 z+="                If Term # '' Then Gosub 50\xFE";
 z+="                If Command[I+1,1] = '=' Then\xFE";
 z+="                    Term = C:Command[I+1,1]\xFE";
 z+="                    I = I + 1\xFE";
 z+="                End Else Term = C\xFE";
 z+="                Gosub 50\xFE";
 z+="            Case C = '!'\xFE";
 z+="                If Term # '' Then Gosub 50\xFE";
 z+="                If Command[I+1,1] = '=' Then\xFE";
 z+="                    Term = C:Command[I+1,1]\xFE";
 z+="                    I = I + 1\xFE";
 z+="                End Else Term = C\xFE";
 z+="                Gosub 50\xFE";
 z+="            Case Seq(C) = 32 Or Seq(C) = 160 Or C = ''\xFE";
 z+="                If Term # '' Then Gosub 50\xFE";
 z+="                Term = ''\xFE";
 z+="            Case Index('(),^;',C,1)\xFE";
 z+="                If Term # '' Then Gosub 50\xFE";
 z+="                Term = C ; Gosub 50\xFE";
 z+="            Case 1\xFE";
 z+="                Term = Term:C\xFE";
 z+="        End Case\xFE";
 z+="    Next I\xFE";
 z+="    Termi = Termi + 1\xFE";
 z+="    Tokens<Termi> = c_EOL\xFE";
 z+="    Termi = 1\xFE";
 z+="    Return\xFE";
 z+="* \xFE";
 z+="50: * EVAL TERM\xFE";
 z+="* \xFE";
 z+="    Termi = Termi + 1\xFE";
 z+="    Terms<Termi> = Term\xFE";
 z+="    Tokens<Termi> = c_ID\xFE";
 z+="    Uterm = Mcu(Term)\xFE";
 z+="    Locate Uterm In Tkstrs Setting Spot Then\xFE";
 z+="        Tokens<Termi> = Tkvals[Spot,1]\xFE";
 z+="    End Else Locate Uterm In Throwaway Setting Spot Then\xFE";
 z+="        Termi = Termi -1\xFE";
 z+="    End Else Read Krec From Mdx, Term Then\xFE";
 z+="        If Krec<1> = \"K\" Then\xFE";
 z+="            Tokens<Termi> = Char(Krec<2>)\xFE";
 z+="            If Tokens<Termi> = c_THROWAWAY Then\xFE";
 z+="                Tokens<Termi> = ''\xFE";
 z+="                Termi = Termi -1\xFE";
 z+="            End\xFE";
 z+="        End\xFE";
 z+="    End\xFE";
 z+="* \xFE";
 z+="    Term = ''\xFE";
 z+="    Return\xFE";
 z+="End Subroutine\xFE";
 z+="\xFE";
 z+="Subroutine English_parser\xFE";
 z+="* \xFE";
 z+="* A JSonBasic routine written by Randy Walsh at randynwalsh@gmail.com\xFE";
 z+="*\xFE";
 z+="*    // AND - OR, &&, ||\xFE";
 z+="*   // A Matches B\xFE";
 z+="*   // =, #, NE, >=, <=, >, <, EQ, GE, LE, LT, GT\xFE";
 z+="*   // Concat : &\xFE";
 z+="*   // + -\xFE";
 z+="*   // ^\xFE";
 z+="*   // uniary + -\xFE";
 z+="*   //\xFE";
 z+="*\xFE";
 z+="    $Include _VCOM\xFE";
 z+="*\xFE";
 z+="    Cmdline = Sentence\xFE";
 z+="    Pcnt = Count(Cmdline, '(')\xFE";
 z+="    If Pcnt Then\xFE";
 z+="        Pcnt = Index(Cmdline, '(', Pcnt)\xFE";
 z+="        Opts = Mcu(Cmdline[Pcnt+1,99])\xFE";
 z+="        If Index(Opts,'\"',1) Or Index(Opts,\" \",1) Or Index(Opts,\"'\",1) Then\xFE";
 z+="            Opts = \"\"\xFE";
 z+="        End Else\xFE";
 z+="            Cmdline = Cmdline[1,Pcnt-1]\xFE";
 z+="        End\xFE";
 z+="    End Else\xFE";
 z+="        Opts = \"\"\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    If Field(Cmdline,' ',2) = '' Then\xFE";
 z+="        Print \"NO TableName GIVEN\"\xFE";
 z+="        Stop\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    Displaytbl = []\xFE";
 z+="    Dcolcnt = 0\xFE";
 z+="    Ecolcnt = 0\xFE";
 z+="    Selecttbl = []\xFE";
 z+="    Sorttbl = []\xFE";
 z+="    Exptbl = {}\xFE";
 z+="    Sortcnt = 0\xFE";
 z+="    Toprinter = Index(Opts,'P',1)\xFE";
 z+="    Xusing = 0\xFE";
 z+="    Onlylist = 0\xFE";
 z+="    Colhdrspp = Index(Opts,\"H\",1)                      ; * Supresses Header, Column Headings, Itemslisted\xFE";
 z+="    Detspp = Index(Opts,\"D\",1)                         ; * Supressed Detail On Break-On And Total\xFE";
 z+="    Idspp = Index(Opts,\"I\",1)                         ; * Supressed Detail On Break-On And Total\xFE";
 z+="    Hdrspp = 0                         ; * Supresses Default Header And Itemslisted\xFE";
 z+="    Rdstate = 1\xFE";
 z+="    !\xFE";
 z+="    If Prime Then\xFE";
 z+="        Header = Sentence\xFE";
 z+="        Convert \"]\" To \"}\" In Header\xFE";
 z+="        Convert \"^\" To \"~\" In Header\xFE";
 z+="        Header = Header:Space(1):\"'T'\":\" \":((\"PAGE\")):Space(1):\"'P'\"\xFE";
 z+="    End Else\xFE";
 z+="        Header = ((\"PAGE\")):Space(1):\"'P'\":Space(40):\"'T'\":vm()\xFE";
 z+="    End\xFE";
 z+="    Footer = \"\"\xFE";
 z+="    Grandstr = \"***\"\xFE";
 z+="    Errors = ''\xFE";
 z+="    Pagepause = Not(Index(Opts,'N',1))\xFE";
 z+="*\xFE";
 z+="* Pick up the COMMAND line\xFE";
 z+="*\xFE";
 z+="    Call English_tokenizer(Cmdline)\xFE";
 z+="*\xFE";
 z+="* CHECK FOR 'ONLY'\xFE";
 z+="*\xFE";
 z+="    If Tokens<Termi> = C_only Then\xFE";
 z+="        Onlylist = 1\xFE";
 z+="        Termi = Termi + 1\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="* GET @FileName\xFE";
 z+="*\xFE";
 z+="    If Tokens<Termi> = C_dict Then\xFE";
 z+="        FileDictData = 'DICT'\xFE";
 z+="        @FileName = Terms<Termi+1>\xFE";
 z+="        Termi = Termi + 2\xFE";
 z+="        Fshort = '*':@FileName\xFE";
 z+="    End Else If Tokens<Termi> = C_data Then\xFE";
 z+="        FileDictData = ''\xFE";
 z+="        @FileName = Terms<Termi+1>\xFE";
 z+="        Termi = Termi + 2\xFE";
 z+="        Fshort = @FileName\xFE";
 z+="    End Else\xFE";
 z+="        FileDictData = ''\xFE";
 z+="        @FileName = Terms<Termi>\xFE";
 z+="        Termi = Termi + 1\xFE";
 z+="        Fshort = @FileName\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    Open FileDictData,@FileName To F_file Else\xFE";
 z+="        Print \"Unable to open file \":@FileName\xFE";
 z+="        Stop\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    Open 'DICT',@FileName To F_dictionary Else\xFE";
 z+="        Open '','MD' To F_dictionary Else\xFE";
 z+="            Print \"Unable to open dictionary of file \":@FileName\xFE";
 z+="            Stop\xFE";
 z+="        End\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="* LOOK ANYWHERE FOR 'USING' CLAUSE\xFE";
 z+="*\xFE";
 z+="    Loop\xFE";
 z+="        Locate C_using In Tokens Setting Spot Else Spot = 0\xFE";
 z+="    While Spot Do\xFE";
 z+="        If Terms<Spot+1> = 'DICT' Then\xFE";
 z+="            UsingDictData = 'DICT'\xFE";
 z+="            USINGTableName = Terms<Spot+2>\xFE";
 z+="            Terms = Delete(Terms,Spot,0,0)\xFE";
 z+="            Tokens = Delete(Tokens,Spot,0,0)\xFE";
 z+="        End Else If Terms<Spot+1> = 'DATA' Then\xFE";
 z+="            UsingDictData = 'DATA'\xFE";
 z+="            USINGTableName = Terms<Spot+2>\xFE";
 z+="            Terms = Delete(Terms,Spot,0,0)\xFE";
 z+="            Tokens = Delete(Tokens,Spot,0,0)\xFE";
 z+="        End Else\xFE";
 z+="            UsingDictData = ''\xFE";
 z+="            USINGTableName = Terms<Spot+1>\xFE";
 z+="        End\xFE";
 z+="        Terms = Delete(Terms,Spot,0,0)\xFE";
 z+="        Terms = Delete(Terms,Spot,0,0)\xFE";
 z+="        Tokens = Delete(Tokens,Spot,0,0)\xFE";
 z+="        Tokens = Delete(Tokens,Spot,0,0)\xFE";
 z+="        Xusing = 1\xFE";
 z+="    Repeat\xFE";
 z+="*\xFE";
 z+="    If Xusing Then\xFE";
 z+="        Open UsingDictData,USINGTableName To F_usingfile Else\xFE";
 z+="            Print \"Unable to open file \":USINGTableName\xFE";
 z+="            Stop\xFE";
 z+="        End\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="* Read any select list\xFE";
 z+="*\xFE";
 z+="    Itemlist = ''\xFE";
 z+="*\xFE";
 z+="* Grammer -> IdSelect (AtrSelect SortCri)* OutSpec\xFE";
 z+="*\xFE";
 z+="    Ditem = ''\xFE";
 z+="    If FileDictData = 'DICT' Then\xFE";
 z+="        Read Ditem From Mdx,@FileName Else Null\xFE";
 z+="        If Ditem<9>=\"\" Then Ditem<9> = 'L'\xFE";
 z+="        If Ditem<10>=\"\" Then Ditem<10> = '20'\xFE";
 z+="        Ditem<1> = @FileName\xFE";
 z+="    End Else\xFE";
 z+="        Read Atid From F_dictionary, '@ID' Then\xFE";
 z+="            Ditem<1> = Atid<4>\xFE";
 z+="            Ditem<9> = Atid<5>[Len(Atid<5>),1]\xFE";
 z+="            Ditem<10> = Atid<5>[1,Len(Atid<5>)-1]\xFE";
 z+="        End Else\xFE";
 z+="            Read Ditem From F_dictionary,@FileName Else\xFE";
 z+="                Ditem<9> = 'L'\xFE";
 z+="                Ditem<10> = '20'\xFE";
 z+="            End\xFE";
 z+="            Ditem<1> = @FileName\xFE";
 z+="        End\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    Eflg = 0\xFE";
 z+="    Ditem<2> = '0'\xFE";
 z+="    Locate C_idspp In Tokens Setting Spot Else\xFE";
 z+="        If Index(Opts,'I',1) = 0 Then\xFE";
 z+="            Dcolcnt = Dcolcnt + 1\xFE";
 z+="            Displaytbl[Dcolcnt] = {}\xFE";
 z+="            Displaytbl[Dcolcnt].Dis_atr = Ditem<2>\xFE";
 z+="            If Isnum(Displaytbl[Dcolcnt].Dis_atr) Then Displaytbl[Dcolcnt].Dis_atr = \"*A\":Displaytbl[Dcolcnt].Dis_atr\xFE";
 z+="            Displaytbl[Dcolcnt].Dis_convi = Ditem<8>\xFE";
 z+="            Displaytbl[Dcolcnt].Dis_convo = Ditem<7>\xFE";
 z+="            Displaytbl[Dcolcnt].Dis_colwdt = Ditem<10>\xFE";
 z+="            Displaytbl[Dcolcnt].Dis_coljst = Ditem<9>\xFE";
 z+="            Displaytbl[Dcolcnt].Dis_colhdr = Ditem<1>\xFE";
 z+="            Displaytbl[Dcolcnt].Term = \"ITEMID\"\xFE";
 z+="        End\xFE";
 z+="    End\xFE";
 z+="    Byexp = 0\xFE";
 z+="    Gosub 100                          ; * (Dictselect) Returns Sspec[Andcnt, Orcnt]\xFE";
 z+="    Selecttbl = Sspec\xFE";
 z+="    Selectcnt = Len(Selecttbl) + 1     ; * Next Placement\xFE";
 z+="*\xFE";
 z+="    Loop\xFE";
 z+="        Begin Case\xFE";
 z+="                *\xFE";
 z+="                * CHECK FOR ITEM(IDS)\xFE";
 z+="                *\xFE";
 z+="            Case Tokens<Termi> = C_str\xFE";
 z+="                Term = Terms<Termi>\xFE";
 z+="                Term = Mid(Term, 2, Len(Term) - 2)\xFE";
 z+="                Terms<Termi> = Term\xFE";
 z+="                Read X From F_file, Term Else Goto Checkcname\xFE";
 z+="                Itemlist<-1> = Term\xFE";
 z+="                Termi = Termi + 1\xFE";
 z+="                \xFE";
 z+="            Case Tokens<Termi> = C_eol\xFE";
 z+="                *\xFE";
 z+="                * CHECK FOR SELECTION CRITERIA (WITH'S)\xFE";
 z+="                *\xFE";
 z+="            Case Tokens<Termi> = C_with Or Tokens<Termi> = C_without\xFE";
 z+="                Withtype = Tokens<Termi>\xFE";
 z+="                Termi = Termi + 1\xFE";
 z+="                If Tokens<Termi> = C_each Then\xFE";
 z+="                    Eflg = 1\xFE";
 z+="                    Termi = Termi + 1\xFE";
 z+="                End Else\xFE";
 z+="                    Eflg = 0\xFE";
 z+="                End\xFE";
 z+="\xFE";
 z+="                If Readdef(Terms<Termi>, Ditem, False) Then Termi = Termi + 1\xFE";
 z+="                \xFE";
 z+="                Byexp = 0\xFE";
 z+="                Gosub 100                 ; * (Dictselect)\xFE";
 z+="                \xFE";
 z+="                If Len(Sspec) = 0 Then\xFE";
 z+="                    Sspec[1] = []\xFE";
 z+="                    Sspec[1][1] = {}\xFE";
 z+="                    Sspec[1][1].Sel_atr = Ditem<2>\xFE";
 z+="                    Sspec[1][1].Sel_conv = Ditem<8>\xFE";
 z+="                    Sspec[1][1].Sel_eachflg = '0'\xFE";
 z+="                    Sspec[1][1].Sel_relcond = \"=\"\xFE";
 z+="                    Sspec[1][1].Sel_relarg = Char(1):'0X'\xFE";
 z+="                End\xFE";
 z+="\xFE";
 z+="                For Each Androw In Sspec\xFE";
 z+="                    Selecttbl[Selectcnt] = Androw\xFE";
 z+="                    Selectcnt = Selectcnt + 1\xFE";
 z+="                Next\xFE";
 z+="                Selectcnt = Selectcnt - 1\xFE";
 z+="\xFE";
 z+="                If Tokens<Termi> = C_and Then\xFE";
 z+="                    Termi = Termi + 1\xFE";
 z+="                    Selectcnt = Selectcnt + 1\xFE";
 z+="                End Else If Tokens<Termi> = C_or Then\xFE";
 z+="                    Termi = Termi + 1\xFE";
 z+="                End\xFE";
 z+="\xFE";
 z+="            Case Index(C_by:C_bydsnd:C_byexp:C_byexpdsnd,Tokens<Termi>,1)\xFE";
 z+="                Issort = 1\xFE";
 z+="                !\xFE";
 z+="                ! CHECK FOR SORT CRITERIA (BY'S)\xFE";
 z+="                !\xFE";
 z+="                Bytype = Tokens<Termi>\xFE";
 z+="                Eflg = 0\xFE";
 z+="                Termi = Termi + 1\xFE";
 z+="\xFE";
 z+="                If Readdef(Terms<Termi>, Ditem, False) Then Termi = Termi + 1\xFE";
 z+="                \xFE";
 z+="                Byexp = Index(C_byexp:C_byexpdsnd,Bytype,1)\xFE";
 z+="                If Byexp Then Exptbl[Term] = Ditem\xFE";
 z+="                Sortcnt = Sortcnt + 1\xFE";
 z+="                Sorttbl[Sortcnt] = {}\xFE";
 z+="                Sorttbl[Sortcnt].Srt_atr = Ditem<2>\xFE";
 z+="                If Index(C_bydsnd:C_byexpdsnd,Bytype,1) Then\xFE";
 z+="                    Sorttbl[Sortcnt].Srt_ad = 'D'\xFE";
 z+="                End Else\xFE";
 z+="                    Sorttbl[Sortcnt].Srt_ad = 'A'\xFE";
 z+="                End\xFE";
 z+="                Sorttbl[Sortcnt].Srt_oconv = Ditem<7>\xFE";
 z+="                Sorttbl[Sortcnt].Srt_iconv = Ditem<8>\xFE";
 z+="                Sorttbl[Sortcnt].Srt_coljst = Ditem<9>\xFE";
 z+="                Sorttbl[Sortcnt].Srt_colwdt = Ditem<10>\xFE";
 z+="                Sorttbl[Sortcnt].Srt_type = Bytype\xFE";
 z+="                *\xFE";
 z+="                Gosub 100                 ; * (Dictselect)\xFE";
 z+="                If Len(Sspec) Then Selecttbl[Selectcnt][-1] = Sspec\xFE";
 z+="                *\xFE";
 z+="            Case Index(C_breakon:C_total:C_heading:C_footing:C_gndtotal,Tokens<Termi>,1)\xFE";
 z+="                *\xFE";
 z+="                * CHECK FOR OUTPUT SPECIFICATIONS (BREAK'S, TOTAL'S, HEADING, ETC.)\xFE";
 z+="                *\xFE";
 z+="                Begin Case\xFE";
 z+="                    Case Tokens<Termi> = C_breakon\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="\xFE";
 z+="                        If Readdef(Terms<Termi>, Ditem, False) Then Termi = Termi + 1\xFE";
 z+="                        \xFE";
 z+="                        If Tokens<Termi> = C_str Then\xFE";
 z+="                            Bktxt = Terms<Termi>\xFE";
 z+="                            Termi = Termi + 1\xFE";
 z+="                        End Else Bktxt = '***'\xFE";
 z+="                        If Ditem<9> = \"R\" And Num(Ditem<10>) Then\xFE";
 z+="                            Bktxt = Space(Ditem<10> - Len(Bktxt)): Bktxt\xFE";
 z+="                        End\xFE";
 z+="                        Dcolcnt = Dcolcnt + 1\xFE";
 z+="                        Displaytbl[Dcolcnt] = {}\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_atr = Ditem<2>\xFE";
 z+="                        If Isnum(Displaytbl[Dcolcnt].Dis_atr) Then Displaytbl[Dcolcnt].Dis_atr = \"*A\":Displaytbl[Dcolcnt].Dis_atr\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_convi = Ditem<8>\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_convo = Ditem<7>\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_brktxt = Bktxt\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_colwdt = Ditem<10>\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_coljst = Ditem<9>\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_colhdr = Ditem<3>\xFE";
 z+="                        Displaytbl[Dcolcnt].Term = Term\xFE";
 z+="                        \xFE";
 z+="                    Case Tokens<Termi> = C_total\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="\xFE";
 z+="                        If Readdef(Terms<Termi>, Ditem, False) Then Termi = Termi + 1\xFE";
 z+="                        \xFE";
 z+="                        If Tokens<Termi> = C_str Then\xFE";
 z+="                            Totaltxt = Terms<Termi>\xFE";
 z+="                            Termi = Termi + 1\xFE";
 z+="                        End Else Totaltxt = '***'\xFE";
 z+="                        Dcolcnt = Dcolcnt + 1\xFE";
 z+="                        Displaytbl[Dcolcnt] = {}\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_atr = Ditem<2>\xFE";
 z+="                        If Isnum(Displaytbl[Dcolcnt].Dis_atr) Then Displaytbl[Dcolcnt].Dis_atr = \"*A\":Displaytbl[Dcolcnt].Dis_atr\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_convi = Ditem<8>\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_convo = Ditem<7>\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_colwdt = Ditem<10>\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_coljst = Ditem<9>\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_tottxt = Totaltxt\xFE";
 z+="                        Displaytbl[Dcolcnt].Dis_colhdr = Ditem<3>\xFE";
 z+="                        Displaytbl[Dcolcnt].Term = Term\xFE";
 z+="                        \xFE";
 z+="                    Case Tokens<Termi> = C_heading\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="                        If Tokens<Termi> # C_str Then\xFE";
 z+="                            Print \"Heading must be a string\"\xFE";
 z+="                            Stop\xFE";
 z+="                        End\xFE";
 z+="                        Header = Terms<Termi>\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="                    Case Tokens<Termi> = C_footing\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="                        If Tokens<Termi> # C_str Then\xFE";
 z+="                            Print \"Footing must be a string\"\xFE";
 z+="                            Stop\xFE";
 z+="                        End\xFE";
 z+="                        Footer = Terms<Termi>\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="                    Case Tokens<Termi> = C_gndtotal\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="                        If Tokens<Termi> # C_str Then\xFE";
 z+="                            Print \"Total must be a string\"\xFE";
 z+="                            Stop\xFE";
 z+="                        End\xFE";
 z+="                        Grandstr = Terms<Termi>\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="                End Case\xFE";
 z+="            Case Index(C_lptr:C_colhdrspp:C_hdrspp:C_detspp:C_nopage:C_dblspc:C_idspp,Tokens<Termi>,1)\xFE";
 z+="                *\xFE";
 z+="                * CHECK FOR OPTIONS (LPTR, COL-HDR-SPP, ETC)\xFE";
 z+="                *\xFE";
 z+="                Begin Case\xFE";
 z+="                    Case Tokens<Termi> = C_lptr\xFE";
 z+="                        Toprinter = 1\xFE";
 z+="                    Case Tokens<Termi> = C_hdrspp\xFE";
 z+="                        Hdrspp = 1\xFE";
 z+="                        Header = ''\xFE";
 z+="                    Case Tokens<Termi> = C_idspp\xFE";
 z+="                        Idspp = 1\xFE";
 z+="                    Case Tokens<Termi> = C_detspp\xFE";
 z+="                        Detspp = 1\xFE";
 z+="                    Case Tokens<Termi> = C_nopage\xFE";
 z+="                        Pagepause = 0\xFE";
 z+="                    Case Tokens<Termi> = C_dblspc\xFE";
 z+="                        Dblspc = 1\xFE";
 z+="                    Case Tokens<Termi> = C_colhdrspp\xFE";
 z+="                        Colhdrspp = 1\xFE";
 z+="                        Header = ''\xFE";
 z+="                        Hdrspp = 1\xFE";
 z+="                End Case\xFE";
 z+="                Termi = Termi + 1\xFE";
 z+="            Case 1\xFE";
 z+="CHECKCNAME: \xFE";
 z+="                Found = Readdef(Terms<Termi>, Ditem, True)\xFE";
 z+="                If Found Then Termi = Termi + 1\xFE";
 z+="                \xFE";
 z+="                If Not(Found) Then\xFE";
 z+="                    Read Ditem From F_file, Terms<Termi> Else\xFE";
 z+="                       * STOP 111,TERMS<TERMI>\xFE";
 z+="                        Ditem = \"A\"\xFE";
 z+="                        Ditem<2> = Terms<Termi>\xFE";
 z+="                        Ditem<3> = Terms<Termi>\xFE";
 z+="                        Ditem<9> = \"L\"\xFE";
 z+="                        Ditem<10> = 15\xFE";
 z+="                        Found = 1\xFE";
 z+="                        Termi = Termi + 1\xFE";
 z+="                    End If\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                If Not(Found) Then\xFE";
 z+="                    Itemlist<-1> = Terms<Termi>\xFE";
 z+="                    Termi = Termi + 1\xFE";
 z+="                End Else\xFE";
 z+="                    Dcolcnt = Dcolcnt + 1\xFE";
 z+="                    Displaytbl[Dcolcnt] = {}\xFE";
 z+="                    Displaytbl[Dcolcnt].Dis_atr = Ditem<2>\xFE";
 z+="                    If Isnum(Displaytbl[Dcolcnt].Dis_atr) Then Displaytbl[Dcolcnt].Dis_atr = \"*A\":Displaytbl[Dcolcnt].Dis_atr\xFE";
 z+="                    Displaytbl[Dcolcnt].Dis_convi = Ditem<8>\xFE";
 z+="                    Displaytbl[Dcolcnt].Dis_convo = Ditem<7>\xFE";
 z+="                    Displaytbl[Dcolcnt].Dis_colwdt = Ditem<10>\xFE";
 z+="                    Displaytbl[Dcolcnt].Dis_coljst = Ditem<9>\xFE";
 z+="                    Displaytbl[Dcolcnt].Dis_colhdr = Ditem<3>\xFE";
 z+="                    Displaytbl[Dcolcnt].Term = Term\xFE";
 z+="                    \xFE";
 z+="                End\xFE";
 z+="        End Case\xFE";
 z+="    While Tokens<Termi> # C_eol Do Repeat\xFE";
 z+="*\xFE";
 z+="    If Not(Onlylist) Then\xFE";
 z+="        If (Dcolcnt=1 And Idspp=0) Or (Dcolcnt=0 And Idspp=1) Then\xFE";
 z+="            Dftnum = 1\xFE";
 z+="            Loop\xFE";
 z+="                Found = 0\xFE";
 z+="                If Xusing Then\xFE";
 z+="                    Read Ditem From F_usingfile, Dftnum Then\xFE";
 z+="                        Found = 1\xFE";
 z+="                        Dftnum = Dftnum\xFE";
 z+="                    End Else\xFE";
 z+="                        Read Ditem From F_usingfile, Dftnum Then Found = 1\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="                *\xFE";
 z+="                If Not(Found) Then\xFE";
 z+="                    Read Ditem From F_dictionary, Dftnum Then\xFE";
 z+="                        Found = 1\xFE";
 z+="                        Dftnum = Dftnum\xFE";
 z+="                    End Else\xFE";
 z+="                        Read Ditem From F_dictionary, Dftnum Then Found = 1\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="                *\xFE";
 z+="                If (Ditem<1> # 'A' And Ditem<1> # 'S') Then Found = 0 ;* Or Not(Num(Ditem<2>))\xFE";
 z+="            While Found Do\xFE";
 z+="                Dcolcnt = Dcolcnt + 1\xFE";
 z+="                Displaytbl[Dcolcnt] = {}\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_atr = Ditem<2>\xFE";
 z+="                If Isnum(Displaytbl[Dcolcnt].Dis_atr) Then Displaytbl[Dcolcnt].Dis_atr = \"*A\":Displaytbl[Dcolcnt].Dis_atr\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_convi = Ditem<8>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_convo = Ditem<7>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_colwdt = Ditem<10>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_coljst = Ditem<9>\xFE";
 z+="                Displaytbl[Dcolcnt].Dis_colhdr = Ditem<3>\xFE";
 z+="                Displaytbl[Dcolcnt].Term = Term\xFE";
 z+="                \xFE";
 z+="                Dftnum = Dftnum + 1\xFE";
 z+="            Repeat\xFE";
 z+="        End\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    If Issort And Sortcnt = 0 Then\xFE";
 z+="        Sortcnt = Sortcnt + 1\xFE";
 z+="        Sorttbl[Sortcnt] = {}\xFE";
 z+="        Sorttbl[Sortcnt].Srt_atr = 0\xFE";
 z+="        Sorttbl[Sortcnt].Srt_ad = 'A'\xFE";
 z+="        Sorttbl[Sortcnt].Srt_coljst = 'L'\xFE";
 z+="        Sorttbl[Sortcnt].Srt_colwdt = \"15\"\xFE";
 z+="    End\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="100: * DICT SELECTION\xFE";
 z+="    Sspec = []\xFE";
 z+="    * DITEM, BYEXP, & EFLG MUST BE SET BEFORE ENTRY\xFE";
 z+="\xFE";
 z+="    If Not(Index(C_eq:C_gt:C_lt:C_le:C_ge:C_ne,Tokens<Termi>,1)) Then Return\xFE";
 z+="    And_cnt = 1\xFE";
 z+="    Or_cnt = 1\xFE";
 z+="    Op = Terms<Termi>\xFE";
 z+="    Termi = Termi + 1\xFE";
 z+="*\xFE";
 z+="    Loop\xFE";
 z+="        If Tokens<Termi> # C_str Then\xFE";
 z+="            Print \"Unknown term \": Terms<Termi>\xFE";
 z+="            Stop\xFE";
 z+="        End\xFE";
 z+="        Relstr = Terms<Termi>\xFE";
 z+="        If (Relstr[1,1] = '[' Or Relstr[Len(Relstr),1] = ']' Or Index(Relstr,'^',1)) And Index(C_eq:C_ne,Op,1) Then\xFE";
 z+="            If Index(Relstr,'\"',1) Then\xFE";
 z+="                Suffix = \"'\"\xFE";
 z+="                Prefix = Char(1):\"'\"\xFE";
 z+="                Infix = \"'\"\xFE";
 z+="            End Else\xFE";
 z+="                Suffix = '\"'\xFE";
 z+="                Prefix = Char(1):'\"'\xFE";
 z+="                Infix = '\"'\xFE";
 z+="            End\xFE";
 z+="            If Relstr[1,1] = '[' Then\xFE";
 z+="                Prefix = Char(1):'0X':Infix\xFE";
 z+="                Relstr = Relstr[2, 9999]\xFE";
 z+="            End\xFE";
 z+="            If Relstr[Len(Relstr),1] = ']' Then\xFE";
 z+="                Relstr = Relstr[1,Len(Relstr)-1]\xFE";
 z+="                Suffix = Suffix:'0X'\xFE";
 z+="            End\xFE";
 z+="            Loop Upi = Index(Relstr,'^',1) While Upi Do\xFE";
 z+="                Relstr = Relstr[1,Upi-1]:Infix:\"1X\":Infix:Relstr[Upi+1,9999]\xFE";
 z+="            Repeat\xFE";
 z+="            Relstr = Prefix:Relstr:Suffix\xFE";
 z+="        End\xFE";
 z+="        *\xFE";
 z+="        If (!Sspec[And_cnt]) Then Sspec[And_cnt] = []\xFE";
 z+="        Sspec[And_cnt][Or_cnt] = {}\xFE";
 z+="        Sspec[And_cnt][Or_cnt].Sel_eachflg = Eflg\xFE";
 z+="        Sspec[And_cnt][Or_cnt].Sel_atr = Ditem<2>\xFE";
 z+="        Sspec[And_cnt][Or_cnt].Sel_conv = Ditem<8>\xFE";
 z+="        Sspec[And_cnt][Or_cnt].Sel_relcond = Op\xFE";
 z+="        Sspec[And_cnt][Or_cnt].Sel_relarg = Relstr\xFE";
 z+="        Termi = Termi + 1\xFE";
 z+="        *\xFE";
 z+="        Cont = 0\xFE";
 z+="        Ntoken = Tokens<Termi+1>\xFE";
 z+="        If Instr(C_eq:C_gt:C_ge:C_lt:C_le:C_ne:C_with:C_without, Ntoken) = 0 Then\xFE";
 z+="            If Tokens<Termi> = C_or Then\xFE";
 z+="                Cont = 1\xFE";
 z+="                Termi = Termi + 1\xFE";
 z+="                Or_cnt = Or_cnt + 1\xFE";
 z+="            End Else If Tokens<Termi> = C_and Then\xFE";
 z+="                Cont = 1\xFE";
 z+="                Or_cnt = 1\xFE";
 z+="                And_cnt = And_cnt + 1\xFE";
 z+="                Termi = Termi + 1\xFE";
 z+="            End\xFE";
 z+="            *\xFE";
 z+="            If Index(C_eq:C_gt:C_lt:C_le:C_ge:C_ne,Tokens<Termi>,1) Then\xFE";
 z+="                Op = Tokens<Termi>\xFE";
 z+="                If Cont = 0 Then Or_cnt = Or_cnt + 1\xFE";
 z+="                Cont = 1\xFE";
 z+="                Termi = Termi + 1\xFE";
 z+="            End Else If Tokens<Termi> = C_str And Terms<Termi>#'' Then\xFE";
 z+="                If Cont = 0 Then Or_cnt = Or_cnt + 1\xFE";
 z+="                Cont = 1\xFE";
 z+="            End\xFE";
 z+="        End\xFE";
 z+="    While Cont Do Repeat\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="Function Readdef(Term, Ditem, Ignore_errors)\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    \xFE";
 z+="    Found = 0\xFE";
 z+="    If Term Then\xFE";
 z+="        If Xusing Then\xFE";
 z+="            Read Ditem From F_usingfile, Term Then\xFE";
 z+="                Found = 1\xFE";
 z+="            End Else\xFE";
 z+="                Read Ditem From F_usingfile, Terms<Termi> Then Found = 1\xFE";
 z+="            End\xFE";
 z+="        End\xFE";
 z+="    *\xFE";
 z+="        If Not(Found) Then\xFE";
 z+="            Read Ditem From F_dictionary, Term Then\xFE";
 z+="                Found = 1\xFE";
 z+="            End Else\xFE";
 z+="                Read Ditem From F_dictionary, Term Then Found = 1\xFE";
 z+="            End\xFE";
 z+="        End\xFE";
 z+="    *\xFE";
 z+="        If Not(Found) Then\xFE";
 z+="            Read Ditem From Mdx, Term Then\xFE";
 z+="                Found = 1\xFE";
 z+="            End Else\xFE";
 z+="                Read Ditem From Mdx, Term Then Found = 1\xFE";
 z+="            End\xFE";
 z+="        End\xFE";
 z+="   *\xFE";
 z+="        Nextop = Tokens<Termi+1>\xFE";
 z+="        If Not(Found) And UCase(Left(Term, 2)) = \"*A\" And Isnumeric(Mid(Term, 3)) Or Index(C_eq:C_gt:C_lt:C_le:C_ge:C_ne,Nextop,1) Then\xFE";
 z+="            Ditem = \"A\"\xFE";
 z+="            Ditem<2> = Mid(Term, 3)\xFE";
 z+="            Ditem<9> = \"L\"\xFE";
 z+="            Ditem<10> = \"15\"\xFE";
 z+="            Found = 1\xFE";
 z+="        End If\xFE";
 z+="    End\xFE";
 z+="    \xFE";
 z+="    If Not(Found) Then\xFE";
 z+="        If Ignore_errors Then Return False\xFE";
 z+="        Ditem = ''\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    If Ditem<1> = \"D\" And Num(Ditem<5>[1,1]) Then\xFE";
 z+="        S = Len(Ditem<5>)\xFE";
 z+="        Ditem<1> = \"A\"\xFE";
 z+="        Ditem<9> = Ditem<5>[S,1]\xFE";
 z+="        Ditem<10> = Ditem<5>[1,S-1]\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    If Index(\"LRT\", Ditem<9>, 1) = 0 Then Ditem<9> = \"L\"\xFE";
 z+="    If (Ditem<1> # 'A' And Ditem<1> # 'S') Or Not(Num(Ditem<2>)) Or Not(Num(Ditem<10>)) Then\xFE";
 z+="        Ditem<1> = \"A\"\xFE";
 z+="        Ditem<2> = Term\xFE";
 z+="        Ditem<9> = \"L\"\xFE";
 z+="        Ditem<10> = \"15\"\xFE";
 z+="*        PRINT \"Unknown dictionary item \":TERM\xFE";
 z+="*        STOP\xFE";
 z+="    End\xFE";
 z+="    \xFE";
 z+="    If Ditem<3> = \"\" Then Ditem<3> = Term\xFE";
 z+="*\xFE";
 z+="    Return Found\xFE";
 z+="End Subroutine\xFE";
 z+="\xFE";
 z+="Subroutine English_display\xFE";
 z+="*\xFE";
 z+="    $Include _VCOM\xFE";
 z+="*\xFE";
 z+="    Breakvals = []\xFE";
 z+="    Brktots = []\xFE";
 z+="    Settots = []\xFE";
 z+="    Dataval = []\xFE";
 z+="*\xFE";
 z+="    Lastbreakni = 0\xFE";
 z+="    Toting = 0\xFE";
 z+="    @Nd = 0\xFE";
 z+="*\xFE";
 z+="*   Start MonoSpace\xFE";
 z+="*\xFE";
 z+="    Print Chr(28):\"<span style='font-family:monospace'>\":Chr(29):\xFE";
 z+="*   IF TOPRINTER THEN PRINTER ON\xFE";
 z+="    For Coli = 1 To Dcolcnt\xFE";
 z+="        If Displaytbl[Coli].Dis_tottxt # '' Then\xFE";
 z+="            Toting = 1\xFE";
 z+="            Settots[Coli] = 0\xFE";
 z+="        End\xFE";
 z+="    Next Coli\xFE";
 z+="*\xFE";
 z+="* Check column header to be greater then column width, compute total width\xFE";
 z+="*\xFE";
 z+="    Largestlbl = 0\xFE";
 z+="    Totalwidth = 0\xFE";
 z+="    For Coli = 1 To Dcolcnt\xFE";
 z+="        Lblsize = 0\xFE";
 z+="        If Displaytbl[Coli].Dis_colwdt Then\xFE";
 z+="            If Totalwidth Then Totalwidth = Totalwidth + 1\xFE";
 z+="            Colsize = Len(Displaytbl[Coli].Dis_colhdr)\xFE";
 z+="            Lblsize = Lblsize + Colsize\xFE";
 z+="            If Lblsize > Largestlbl Then Largestlbl = Lblsize\xFE";
 z+="            If Colsize > Displaytbl[Coli].Dis_colwdt Then\xFE";
 z+="                Displaytbl[Coli].Dis_colwdt = Colsize\xFE";
 z+="            End\xFE";
 z+="            Totalwidth = Totalwidth + Displaytbl[Coli].Dis_colwdt\xFE";
 z+="        End\xFE";
 z+="    Next Coli\xFE";
 z+="*\xFE";
 z+="* Too big to fit on 1 line?\xFE";
 z+="*\xFE";
 z+="    Gowide = Totalwidth <= 999\xFE";
 z+="    Wide = 999\xFE";
 z+="    If Not(Totalwidth) Then Colhdrspp = 1\xFE";
 z+="    \xFE";
 z+="*\xFE";
 z+="* SETUP COLUMN HEADER\xFE";
 z+="*\xFE";
 z+="    If Colhdrspp Or Not(Gowide) Then\xFE";
 z+="        SetHeading(Header)\xFE";
 z+="    End Else\xFE";
 z+="        *\xFE";
 z+="        * If WIDE output, print some column headers\xFE";
 z+="        *\xFE";
 z+="        Cline = ''\xFE";
 z+="        For Ccol = 1 To Dcolcnt\xFE";
 z+="            If Displaytbl[Ccol].Dis_colwdt Then\xFE";
 z+="                If Cline # '' Then Cline = Cline:' '\xFE";
 z+="                Ccolhead = Displaytbl[Ccol].Dis_colhdr\xFE";
 z+="                Clen = Len(Ccolhead)\xFE";
 z+="                Cline = Cline:Ccolhead\xFE";
 z+="                Cjust = Displaytbl[Ccol].Dis_colwdt\xFE";
 z+="                If Clen < Cjust Then\xFE";
 z+="                    If Clen = 0 Then\xFE";
 z+="                        Cline = Cline:Space(Cjust)\xFE";
 z+="                    End Else\xFE";
 z+="                        Cline = Cline:Str('.',Cjust-Clen)\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="            End\xFE";
 z+="        Next Ccol\xFE";
 z+="        If Header # \"\" Then Header = Header:\"'L'\"\xFE";
 z+="        Header = Header:Cline\xFE";
 z+="        SetHeading(Header)\xFE";
 z+="    End\xFE";
 z+="    \xFE";
 z+="    SetFooting(Footer)\xFE";
 z+="    \xFE";
 z+="*\xFE";
 z+="* Ouput items\xFE";
 z+="*\xFE";
 z+="    @Ni = 0\xFE";
 z+="    Endoflist = 0\xFE";
 z+="    \xFE";
 z+="    For Each Record, Ni In Dataset\xFE";
 z+="        @Ni = @Ni + 1\xFE";
 z+="        *\xFE";
 z+="        * Get column data\xFE";
 z+="        *\xFE";
 z+="        Dataval = []\xFE";
 z+="        For Coli = 1 To Dcolcnt\xFE";
 z+="            Atrno = Displaytbl[Coli].Dis_atr\xFE";
 z+="            If Atrno = \"*A0\" Then\xFE";
 z+="                Atr = RECORD.ItemID\xFE";
 z+="            End Else\xFE";
 z+="                Atr = Record[Atrno]\xFE";
 z+="            End\xFE";
 z+="            Dataval[Coli] = Atr\xFE";
 z+="        Next Coli\xFE";
 z+="        *\xFE";
 z+="        * Check for Break's\xFE";
 z+="        *\xFE";
 z+="        If Gowide Then Cstart = 0 Else Cstart = Largestlbl\xFE";
 z+="        Line = ''\xFE";
 z+="        @Nd = @Nd + 1\xFE";
 z+="        For Coli = 1 To Dcolcnt\xFE";
 z+="            If Displaytbl[Coli].Dis_brktxt # '' Then\xFE";
 z+="                Cdata = Dataval[Coli]\xFE";
 z+="                If Breakvals[Coli] = '' Then Breakvals[Coli] = Cdata Else\xFE";
 z+="                    If Breakvals[Coli] # '' And Breakvals[Coli] # Cdata Then\xFE";
 z+="                        Line = Line:Space(Cstart-Len(Line)):Displaytbl[Coli].Dis_brktxt\xFE";
 z+="                        Breakvals[Coli] = Cdata\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="            End\xFE";
 z+="            If Gowide Then Cstart = Cstart + Displaytbl[Coli].Dis_colwdt + 1\xFE";
 z+="        Next Coli\xFE";
 z+="        If Line # '' Then\xFE";
 z+="            Gosub 200\xFE";
 z+="            @Nd = 0\xFE";
 z+="        End\xFE";
 z+="        *\xFE";
 z+="        * Add Totals\xFE";
 z+="        *\xFE";
 z+="        If Toting Then\xFE";
 z+="            For Coli = 1 To Dcolcnt\xFE";
 z+="                If Displaytbl[Coli].Dis_tottxt # '' Then\xFE";
 z+="                    Cdata = Trim(Dataval[Coli])\xFE";
 z+="                    Vms = Dcount(Cdata,vm())\xFE";
 z+="                    For Vmi = 1 To Vms\xFE";
 z+="                        If Cdata<1,Vmi> # '' Then\xFE";
 z+="                            If Num(Cdata<1,Vmi>) Then\xFE";
 z+="                                Brktots[Coli] = Brktots[Coli] + Cdata<1,Vmi>\xFE";
 z+="                                Settots[Coli] = Settots[Coli] + Cdata<1,Vmi>\xFE";
 z+="                            End\xFE";
 z+="                        End\xFE";
 z+="                    Next Vmi\xFE";
 z+="                End\xFE";
 z+="            Next Coli\xFE";
 z+="        End\xFE";
 z+="        *\xFE";
 z+="        * Start building columns\xFE";
 z+="        *\xFE";
 z+="        Valno = 1\xFE";
 z+="        Loop\xFE";
 z+="            More = 0\xFE";
 z+="            Moretext = 0\xFE";
 z+="            Line = ''\xFE";
 z+="            For Coli = 1 To Dcolcnt\xFE";
 z+="                If Displaytbl[Coli].Dis_colwdt Then\xFE";
 z+="                    If Gowide Then\xFE";
 z+="                        Dlen = Displaytbl[Coli].Dis_colwdt\xFE";
 z+="                        Cdata = Dataval[Coli]<1,Valno>[1,Dlen]\xFE";
 z+="                        If Dataval[Coli]<1,Valno+1> # '' Then More = 1\xFE";
 z+="                        Just = Displaytbl[Coli].Dis_coljst\xFE";
 z+="                        If Len(Just) > 1 Then Cdata = Fmt(Cdata, Just)\xFE";
 z+="                        Clen = Len(Cdata)\xFE";
 z+="                        Begin Case\xFE";
 z+="                            Case Just[1,1] = 'R'\xFE";
 z+="                                Cdata = Space(Dlen-Clen):Cdata\xFE";
 z+="                            Case Just[1,1] = 'T'\xFE";
 z+="                                If Dataval[Coli]<1,Valno>[Dlen+1,1]#\"\" Then\xFE";
 z+="                                    Loop While Cdata[Clen,1]#' ' And Clen>1 Do Clen=Clen-1 Repeat\xFE";
 z+="                                    If Clen <= 1 Then Clen = Len(Cdata)\xFE";
 z+="                                    Cdata = Dataval[Coli]<1,Valno>[1,Clen]\xFE";
 z+="                                End\xFE";
 z+="                                Cdata = Cdata:Space(Dlen-Clen)\xFE";
 z+="                            Case 1\xFE";
 z+="                                Cdata = Cdata:Space(Dlen-Clen)\xFE";
 z+="                        End Case\xFE";
 z+="                        *\xFE";
 z+="                        *                DATAVAL[COLI]<1,VALNO> = DATAVAL[COLI]<1,VALNO>[CLEN+1,99999]\xFE";
 z+="                        *                IF DATAVAL[COLI]<1,VALNO> # '' THEN MORETEXT = 1\xFE";
 z+="                        *\xFE";
 z+="                        If Coli # 1 Then Line = Line:' '\xFE";
 z+="                        Line = Line:Cdata\xFE";
 z+="                        \xFE";
 z+="                    End Else\xFE";
 z+="                        *\xFE";
 z+="                        * Columns down the page\xFE";
 z+="                        *\xFE";
 z+="                        For Valno = 1 To Dcount(Dataval[Coli], vm())\xFE";
 z+="                            If Valno = 1 Then\xFE";
 z+="                                Chead = Displaytbl[Coli].Dis_colhdr\xFE";
 z+="                                Line = Chead:Str(\".\", Largestlbl -Len(Chead)):\".\"\xFE";
 z+="                            End Else\xFE";
 z+="                                Line = Space(Largestlbl):\".\"\xFE";
 z+="                            End\xFE";
 z+="                            Line = Line:' ':Dataval[Coli]<1,Valno>\xFE";
 z+="                            Pi = 1\xFE";
 z+="                            Loop\xFE";
 z+="                                Pline = Line[Pi,Wide-1]\xFE";
 z+="                                Pi = Pi + Wide\xFE";
 z+="                                Print Pline\xFE";
 z+="                                If Dblspc Then Print\xFE";
 z+="                            While Line[Pi,1] # '' Do Repeat\xFE";
 z+="                        Next Valno\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="            Next Coli\xFE";
 z+="            If Line # '' Then\xFE";
 z+="                If Gowide Then\xFE";
 z+="                    If Not(Detspp) Then\xFE";
 z+="                        Hf_print(Line)\xFE";
 z+="                        If Dblspc Then Hf_print(\"\")\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="                If Not(Moretext) And More Then Valno = Valno + 1\xFE";
 z+="            End\xFE";
 z+="        While More Or Moretext Do Repeat\xFE";
 z+="        If Not(Gowide) Then\xFE";
 z+="            If Not(Detspp) Then\xFE";
 z+="                Hf_print(\"\")\xFE";
 z+="                If Dblspc Then Hf_print(\"\")\xFE";
 z+="            End\xFE";
 z+="        End\xFE";
 z+="    Next\xFE";
 z+="*\xFE";
 z+="* Show final subtotal BREAK/TOTAL\xFE";
 z+="*\xFE";
 z+="    Cdata = ''\xFE";
 z+="    If Toting Then\xFE";
 z+="        If Gowide Then Cstart = 0 Else Cstart = Largestlbl\xFE";
 z+="        Line = ''\xFE";
 z+="        For Coli = 1 To Dcolcnt\xFE";
 z+="            Txt = Displaytbl[Coli].Dis_brktxt\xFE";
 z+="            If Txt # '' Then\xFE";
 z+="                Convo = Displaytbl[Coli].Dis_convo\xFE";
 z+="                If Convo#\"\" Then Txt = @Oconv(Txt, Convo)\xFE";
 z+="                Line = Line:Space(Len(Line)-Cstart-1):Txt\xFE";
 z+="            End\xFE";
 z+="            If Gowide Then Cstart = Cstart + Displaytbl[Coli].Dis_colwdt + 1\xFE";
 z+="        Next Coli\xFE";
 z+="        If Line # '' Then Gosub 200\xFE";
 z+="        *\xFE";
 z+="        * Show GRAND-TOTALS\xFE";
 z+="        *\xFE";
 z+="        Line = ''\xFE";
 z+="        Brktots = Clone(Settots)\xFE";
 z+="        Line = Grandstr\xFE";
 z+="        Gosub 200\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="* Show 'items listed'\xFE";
 z+="*\xFE";
 z+="    If Not(Hdrspp) Then\xFE";
 z+="        Hf_print(\"\")\xFE";
 z+="        If Dblspc Then Hf_print(\"\")\xFE";
 z+="        Hf_print(@Ni:\" Items listed\")\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="* Turn OFF MONOSPACE\xFE";
 z+="*\xFE";
 z+="    Print Chr(28):\"</span>\":Chr(29):\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="200: * Output BREAK/TOTAL string\xFE";
 z+="*     CDATA is value causing BREAK\xFE";
 z+="*     @NI is the output number of this data\xFE";
 z+="*\xFE";
 z+="    Bi = 1\xFE";
 z+="    Outstr = 1\xFE";
 z+="    Oline = ''\xFE";
 z+="    Noshow = 0\xFE";
 z+="    Outblank = 1\xFE";
 z+="    Outform = 0\xFE";
 z+="    Loop\xFE";
 z+="        Ch = Line[Bi,1]\xFE";
 z+="    While Ch # '' Do\xFE";
 z+="        Bi = Bi + 1\xFE";
 z+="        If Outstr Then\xFE";
 z+="            If Ch = '\"' Or Ch = \"'\" And Line[Bi,1] = Ch Then\xFE";
 z+="                Bi = Bi + 1\xFE";
 z+="                Oline = Oline:Ch\xFE";
 z+="            End Else If Ch = '\"' Or Ch = \"'\" Then\xFE";
 z+="                Outstr = 0\xFE";
 z+="                Endmark = Ch\xFE";
 z+="            End Else\xFE";
 z+="                Oline = Oline:Ch\xFE";
 z+="            End\xFE";
 z+="        End Else\xFE";
 z+="            Begin Case\xFE";
 z+="                Case Ch = Endmark And Line[Bi+1,1] = Endmark\xFE";
 z+="                    Oline = Oline:Endmark\xFE";
 z+="                    Bi = Bi + 1\xFE";
 z+="                Case Ch = Endmark ; Outstr = 1\xFE";
 z+="                Case Ch = 'B'\xFE";
 z+="                    Headfootb = Cdata\xFE";
 z+="                Case Ch = 'D'\xFE";
 z+="                    * DETAIL SUPPRESS\xFE";
 z+="                    If Lastbreakni-1 = @Ni Then Noshow = 1\xFE";
 z+="                    Lastbreakni = @Ni\xFE";
 z+="                Case Ch = 'L'\xFE";
 z+="                    Outblank = 0\xFE";
 z+="                Case Ch = 'P'\xFE";
 z+="                    Outform = 1\xFE";
 z+="                Case Ch = 'F'\xFE";
 z+="                    Size = 0\xFE";
 z+="                    Loop Ch = Line[Bi,1] While Num(Ch) And Ch # '' Do\xFE";
 z+="                        Size = Size*10 + Seq(Ch) - Seq('0')\xFE";
 z+="                        Bi = Bi + 1\xFE";
 z+="                    Repeat\xFE";
 z+="                    Oline = Oline:@FileName<1>\xFE";
 z+="                    If Size Then\xFE";
 z+="                        Bsize = Len(@FileName<1>)\xFE";
 z+="                        Oline = Oline:Space(Size-Bsize)\xFE";
 z+="                    End\xFE";
 z+="                Case Ch = 'I'\xFE";
 z+="                    Size = 0\xFE";
 z+="                    Loop Ch = Line[Bi,1] While Num(Ch) And Ch # '' Do\xFE";
 z+="                        Size = Size*10 + Seq(Ch) - Seq('0')\xFE";
 z+="                        Bi = Bi + 1\xFE";
 z+="                    Repeat\xFE";
 z+="                    Oline = Oline:@Id\xFE";
 z+="                    If Size Then\xFE";
 z+="                        Bsize = Len(@Id)\xFE";
 z+="                        Oline = Oline:Space(Size-Bsize)\xFE";
 z+="                    End\xFE";
 z+="                Case Ch = 'R'\xFE";
 z+="                Case Ch = 'U'\xFE";
 z+="                Case Ch = 'V'\xFE";
 z+="                    Oline = Oline:Cdata\xFE";
 z+="            End Case\xFE";
 z+="        End\xFE";
 z+="    Repeat\xFE";
 z+="*\xFE";
 z+="    If Toting Then\xFE";
 z+="        For Bi = 1 To Dcolcnt\xFE";
 z+="            Txt = Brktots(Bi)\xFE";
 z+="            Convo = Displaytbl[Bi].Dis_convo\xFE";
 z+="            If Convo#\"\" Then Txt = @Oconv(Txt, Convo)\xFE";
 z+="            Brktots(Bi) = Txt\xFE";
 z+="        Next Bi\xFE";
 z+="        Loop\xFE";
 z+="            If Gowide Then Bstart = 0 Else Bstart = Len(Oline) + 1\xFE";
 z+="            More = 0\xFE";
 z+="            For Bi = 1 To Dcolcnt\xFE";
 z+="                If Brktots(Bi) # '' Then\xFE";
 z+="                    Txt = Brktots(Bi)\xFE";
 z+="                    If Txt # '' Then\xFE";
 z+="                        Ctxt = Fmt(Txt, Displaytbl[Bi].Dis_coljst:'#':Displaytbl[Bi].Dis_colwdt)\xFE";
 z+="                        Oline = Oline:Space(Bstart-Len(Oline))\xFE";
 z+="                        Oline = Oline[1,Bstart]:Ctxt:Oline[Bstart+1+Len(Ctxt), 9999]\xFE";
 z+="                        Brktots(Bi) = Txt[Displaytbl[Bi].Dis_colwdt+1, 9999]\xFE";
 z+="                        If Len(Brktots(Bi)) Then More = 1\xFE";
 z+="                    End\xFE";
 z+="                End\xFE";
 z+="                If Gowide Then Bstart = Bstart + Displaytbl[Bi].Dis_colwdt + 1\xFE";
 z+="            Next Bi\xFE";
 z+="        While More Do\xFE";
 z+="            Hf_print(Oline)\xFE";
 z+="            Oline = ''\xFE";
 z+="            If Dblspc Then Hf_print(\"\")\xFE";
 z+="        Repeat\xFE";
 z+="    End\xFE";
 z+="*\xFE";
 z+="    If Noshow Then Return\xFE";
 z+="*\xFE";
 z+="    If Outblank Then Hf_print(\"\")\xFE";
 z+="    Hf_print(Oline)\xFE";
 z+="    If Dblspc Then Hf_print(\"\")\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="    If Outform Then\xFE";
 z+="        *      PAGE\xFE";
 z+="    End Else\xFE";
 z+="        Hf_print(\"\")\xFE";
 z+="        If Dblspc Then Hf_print(\"\")\xFE";
 z+="    End\xFE";
 z+="\xFE";
 z+="    Return\xFE";
 z+="End Subroutine\xFE";
 z+="\xFE";
 z+="Subroutine English_conversions(Io, activeDataset, Atrno, Conv, Lr)\xFE";
 z+="*\xFE";
 z+="    $Include _VCOM\xFE";
 z+="*\xFE";
 z+="    Equ V_str To 1\xFE";
 z+="    Equ V_ident To 2\xFE";
 z+="    Equ V_num To 3\xFE";
 z+="    Equ V_eol To 4\xFE";
 z+="    Equ V_sym To 5\xFE";
 z+="    Equ Stackmax To 10\xFE";
 z+="    Dim Stack(Stackmax)\xFE";
 z+="*\xFE";
 z+="    Ci = 1\xFE";
 z+="    Gosub 50\xFE";
 z+="    If Err <> \"\" Then\xFE";
 z+="        Print Conv\xFE";
 z+="        Print Space(Ci-Len(Yytext) - 1):\"^ \":Err\xFE";
 z+="    End\xFE";
 z+="    Return\xFE";
 z+="*\xFE";
 z+="50: *\xFE";
 z+="    Yytext = Mcu(Conv[Ci, 1]) ; Ci = Ci + 1\xFE";
 z+="\xFE";
 z+="    Err = \"\"\xFE";
 z+="    Begin Case\xFE";
 z+="        Case Yytext = \"D\" Or Yytext = \"M\" Or Yytext = \"U\"\xFE";
 z+="            If Isnum(Atrno) Then\xFE";
 z+="                If Io = \"I\" Then\xFE";
 z+="                    For Each Row In activeDataSet\xFE";
 z+="                        Ans = Iconv(ROW.ItemContent<Atrno>, Conv)\xFE";
 z+="                        ROW.ItemContent<Atrno> = Ans\xFE";
 z+="                    Next\xFE";
 z+="                End Else\xFE";
 z+="                    For Each Row In activeDataSet\xFE";
 z+="                        Ans = Oconv(ROW.ItemContent<Atrno>, Conv)\xFE";
 z+="                        ROW.ItemContent<Atrno> = Ans\xFE";
 z+="                    Next\xFE";
 z+="                End If\xFE";
 z+="            Else\xFE";
 z+="                If Io = \"I\" Then\xFE";
 z+="                    For Each Row In activeDataSet\xFE";
 z+="                        Row[Atrno] = Iconv(Row[Atrno], Conv)\xFE";
 z+="                    Next\xFE";
 z+="                End Else\xFE";
 z+="                    For Each Row In activeDataSet\xFE";
 z+="                        Row[Atrno] = Oconv(Row[Atrno], Conv)\xFE";
 z+="                    Next\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="\xFE";
 z+="        Case Yytext = \"G\"\xFE";
 z+="            Gosub Lex\xFE";
 z+="            If Yytype = V_num Then\xFE";
 z+="                Skipnum = Yytext\xFE";
 z+="                Gosub Lex\xFE";
 z+="            End Else\xFE";
 z+="                Skipnum = 0\xFE";
 z+="            End\xFE";
 z+="            If Yytext = \"\" Then\xFE";
 z+="                Err = \"Group Extract: Missing field seperator\"\xFE";
 z+="                Return\xFE";
 z+="            End\xFE";
 z+="            Fieldsep = Yytext\xFE";
 z+="            Gosub Lex\xFE";
 z+="            If Yytype <> V_num Then\xFE";
 z+="                Err = \"Group Extract: Missing extract count\"\xFE";
 z+="                Return\xFE";
 z+="            End\xFE";
 z+="            Fieldcnt = Yytext\xFE";
 z+="            \xFE";
 z+="            If Isnum(Atrno) Then\xFE";
 z+="                For Each Row In activeDataSet\xFE";
 z+="                    Cval = ROW.ItemContent<Atrno>\xFE";
 z+="                    Nval = \"\"\xFE";
 z+="                    For I = 1 To Fieldcnt\xFE";
 z+="                        If I > 1 Then Nval = Nval:Fieldsep\xFE";
 z+="                        Nval = Nval:Field(Cval, Fieldsep, Skipnum+I)\xFE";
 z+="                    Next\xFE";
 z+="                    ROW.ItemContent<Atrno> = Nval\xFE";
 z+="                Next\xFE";
 z+="            Else\xFE";
 z+="                For Each Row In activeDataSet\xFE";
 z+="                    Cval = Row[Atrno]\xFE";
 z+="                    Nval = \"\"\xFE";
 z+="                    For I = 1 To Fieldcnt\xFE";
 z+="                        If I > 1 Then Nval = Nval:Fieldsep\xFE";
 z+="                        Nval = Nval:Field(Cval, Fieldsep, Skipnum+I)\xFE";
 z+="                    Next\xFE";
 z+="                    Row[Atrno] = Nval\xFE";
 z+="                Next\xFE";
 z+="            End If\xFE";
 z+="\xFE";
 z+="        Case Yytext = \"L\"\xFE";
 z+="            Gosub Lex\xFE";
 z+="            If Yytype <> V_num Then\xFE";
 z+="                Err = \"Length restriction: Missing fixed length\"\xFE";
 z+="                Return\xFE";
 z+="            End\xFE";
 z+="            Range1 = Yytext\xFE";
 z+="            \xFE";
 z+="            If Conv[Ci,1] = \",\" Then\xFE";
 z+="                Gosub Lex\xFE";
 z+="                Gosub Lex\xFE";
 z+="                If Yytype <> V_num Then\xFE";
 z+="                    Err = \"Length restriction: Missing second length range\"\xFE";
 z+="                    Return\xFE";
 z+="                End\xFE";
 z+="\xFE";
 z+="                For Each Row In activeDataSet\xFE";
 z+="                    If Isnum(Atrno) Then\xFE";
 z+="                        Cval = ROW.ItemContent<Atrno>\xFE";
 z+="                        If Len(Cval) < Range1 Or Len(Cval) > Yytext Then ROW.ItemContent<Atrno> = Null\xFE";
 z+="                    Else\xFE";
 z+="                        Cval = Row[Atrno]\xFE";
 z+="                        If Len(Cval) < Range1 Or Len(Cval) > Yytext Then Row[Atrno] = Null\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="\xFE";
 z+="            End Else\xFE";
 z+="                For Each Row In activeDataSet\xFE";
 z+="                    If Isnum(Atrno) Then\xFE";
 z+="                        Cval = ROW.ItemContent<Atrno>\xFE";
 z+="                        If Len(Cval) <> Range1 Then ROW.ItemContent<Atrno> = Null\xFE";
 z+="                    Else\xFE";
 z+="                        Cval = Row[Atrno]\xFE";
 z+="                        If Len(Cval) <> Range1 Then Row[Atrno] = Null\xFE";
 z+="                    Endif\xFE";
 z+="                Next\xFE";
 z+="            End If\xFE";
 z+="\xFE";
 z+="        Case Yytext = \"R\"\xFE";
 z+="            If Instr(Conv, \";\") Then\xFE";
 z+="                Hci = Ci\xFE";
 z+="                Mins = []\xFE";
 z+="                Maxs = []\xFE";
 z+="                Loop\xFE";
 z+="                    Gosub Lex\xFE";
 z+="                    If Yytype <> V_num Then Err = \"Range parameter must be numeric: Rn,m\"; Return\xFE";
 z+="                    Range1 = Yytext\xFE";
 z+="                    Gosub Lex\xFE";
 z+="                    If Yytext <> \",\" Then Err = \"Range seperator missing: Rn,m\"; Return\xFE";
 z+="                    Gosub Lex\xFE";
 z+="                    If Yytype <> V_num Then Err = \"Range parameter must be numeric: Rn,m\"; Return\xFE";
 z+="                    Mins[-1] = Range1\xFE";
 z+="                    Maxs[-1] = Yytext\xFE";
 z+="                While Conv[Ci,1] = \";\" Do Ci +=1 Repeat\xFE";
 z+="                \xFE";
 z+="                For Each Row In activeDataSet\xFE";
 z+="                    Valid = False\xFE";
 z+="                    If Isnum(Atrno) Then Cval = ROW.ItemContent<Atrno> Else Cval = Row[Atrno]\xFE";
 z+="                    For I = 1 To UBound(Mins)\xFE";
 z+="                        If Cval >= Mins[I] And Cval <= Maxs[I] Then Valid = True; Break\xFE";
 z+="                    Next\xFE";
 z+="                    If !Valid Then\xFE";
 z+="                        If Isnum(Atrno) Then ROW.ItemContent<Atrno> = Null Else Row[Atrno] = Null\xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="                \xFE";
 z+="            Else\xFE";
 z+="                Gosub Lex\xFE";
 z+="                If Yytype <> V_num Then Err = \"Range parameter must be numeric: Rn,m\"; Return\xFE";
 z+="                Range1 = Yytext\xFE";
 z+="                Gosub Lex\xFE";
 z+="                If Yytext <> \",\" Then Err = \"Range seperator missing: Rn,m\"; Return\xFE";
 z+="                Gosub Lex\xFE";
 z+="                If Yytype <> V_num Then Err = \"Range parameter must be numeric: Rn,m\"; Return\xFE";
 z+="                If Isnum(Atrno) Then\xFE";
 z+="                    For Each Row In activeDataSet\xFE";
 z+="                        Cval = ROW.ItemContent<Atrno>\xFE";
 z+="                        If Cval < Range1 Or Cval > Yytext Then ROW.ItemContent<Atrno> = Null\xFE";
 z+="                    Next\xFE";
 z+="                Else\xFE";
 z+="                    For Each Row In activeDataSet\xFE";
 z+="                        Cval = Row[Atrno]\xFE";
 z+="                        If Cval < Range1 Or Cval > Yytext Then Row[Atrno] = Null\xFE";
 z+="                    Next\xFE";
 z+="                End If\xFE";
 z+="            Endif\xFE";
 z+="\xFE";
 z+="        Case Yytext = \"P\"\xFE";
 z+="            Pats = []\xFE";
 z+="            Loop\xFE";
 z+="                Gosub Lex\xFE";
 z+="                If Yytext <> \"(\" Then\xFE";
 z+="                    Err = \"P(nNnAnX): Pattern match missing (\"\xFE";
 z+="                    Return\xFE";
 z+="                End\xFE";
 z+="                Pattern = \"\"\xFE";
 z+="                Loop\xFE";
 z+="                    Gosub Lex\xFE";
 z+="                Until Yytext = \"\" Or Yytext = \")\" Do\xFE";
 z+="                    Pattern = Pattern:Yytext\xFE";
 z+="                Repeat\xFE";
 z+="                Pats[-1] = Pattern\xFE";
 z+="            While Conv[Ci,1] = \";\" Do\xFE";
 z+="                Ci = Ci + 1\xFE";
 z+="            Repeat\xFE";
 z+="                \xFE";
 z+="            For Each Row In activeDataSet\xFE";
 z+="                Valid = False\xFE";
 z+="                If Isnum(Atrno) Then Cval = ROW.ItemContent<Atrno> Else Cval = Row[Atrno]\xFE";
 z+="                For I = 1 To UBound(Pats)\xFE";
 z+="                    If Cval Matches Pats[I] Then Valid = True; Break\xFE";
 z+="                Next\xFE";
 z+="                If !Valid Then\xFE";
 z+="                    If Isnum(Atrno) Then ROW.ItemContent<Atrno> = Null Else Row[Atrno] = Null\xFE";
 z+="                End If\xFE";
 z+="            Next\xFE";
 z+="\xFE";
 z+="        Case Yytext = \"S\"\xFE";
 z+="            Gosub Lex\xFE";
 z+="            If Yytext <> \";\" Then\xFE";
 z+="                Err = \"S;string;string. Missing ;\"\xFE";
 z+="                Return\xFE";
 z+="            End\xFE";
 z+="            Gosub Getatrno\xFE";
 z+="            If Yytype <> V_str Then\xFE";
 z+="                Err = \"S;string;string. Missing string\"\xFE";
 z+="                Return\xFE";
 z+="            End\xFE";
 z+="            Ano = Yytext\xFE";
 z+="            Gosub Lex\xFE";
 z+="            If Yytext <> \";\" Then\xFE";
 z+="                Err = \"S;string;string. Missing ;\"\xFE";
 z+="                Return\xFE";
 z+="            End\xFE";
 z+="            Gosub Lex\xFE";
 z+="            If Yytype <> V_str Then\xFE";
 z+="                Err = \"S;string;string. Missing string\"\xFE";
 z+="                Return\xFE";
 z+="            End\xFE";
 z+="\xFE";
 z+="            For Each Row In activeDataSet\xFE";
 z+="                If Isnum(Atrno) Then Cval = ROW.ItemContent<Atrno> Else Cval = Row[Atrno]\xFE";
 z+="                If Cval = \"\" Or Cval = Null Then\xFE";
 z+="                    Cval = Yytext[2,Len(Yytext)-2]\xFE";
 z+="                End Else\xFE";
 z+="                    Cval = Ano[2,Len(Ano)-2]\xFE";
 z+="                End\xFE";
 z+="                If Isnum(Atrno) Then ROW.ItemContent<Atrno> = Cval Else Row[Atrno] = Cval\xFE";
 z+="            Next\xFE";
 z+="\xFE";
 z+="        Case Yytext = \" \"\xFE";
 z+="\xFE";
 z+="        Case Yytext = \"C\"\xFE";
 z+="            Sci = Ci\xFE";
 z+="            For Each Row In activeDataSet\xFE";
 z+="                @Id = ROW.ItemID\xFE";
 z+="                @Record = Row\xFE";
 z+="                Ci = Sci\xFE";
 z+="                \xFE";
 z+="                Result = \"\"\xFE";
 z+="                Loop\xFE";
 z+="                    Gosub Getatrno\xFE";
 z+="                    Begin Case\xFE";
 z+="                        Case Yytype = V_str\xFE";
 z+="                            Result = Result:Yytext[2,Len(Yytext)-2]\xFE";
 z+="                        Case Yytext = \";\"\xFE";
 z+="                        Case 1\xFE";
 z+="                            Result = Result:Yytext\xFE";
 z+="                    End Case\xFE";
 z+="                Until Yytext = \"\" Do Repeat\xFE";
 z+="                \xFE";
 z+="                Row[Atrno] = Result\xFE";
 z+="            Next\xFE";
 z+=" \xFE";
 z+="        Case Yytext = \"T\"\xFE";
 z+="            Gosub Lex\xFE";
 z+="            \xFE";
 z+="            If Yytype = V_num Then\xFE";
 z+="                Range1 = Yytext\xFE";
 z+="                If Conv[Ci,1] = \",\" Then\xFE";
 z+="                    Gosub Lex\xFE";
 z+="                    Gosub Lex\xFE";
 z+="                    If Yytype <> V_num Then\xFE";
 z+="                        Err = \"Tm,n: Text extraction: Missing length\"\xFE";
 z+="                        Return\xFE";
 z+="                    End\xFE";
 z+="                    \xFE";
 z+="                    If Isnum(Atrno) Then\xFE";
 z+="                        For Each Row In activeDataSet\xFE";
 z+="                            ROW.ItemContent<Atrno> = Mid(ROW.ItemContent<Atrno>, Range1, Yytext)\xFE";
 z+="                        Next\xFE";
 z+="                    Else\xFE";
 z+="                        For Each Row In activeDataSet\xFE";
 z+="                            Row[Atrno] = Mid(Row[Atrno], Range1, Yytext)\xFE";
 z+="                        Next\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    \xFE";
 z+="                End Else\xFE";
 z+="                    If Lr = \"R\" Then\xFE";
 z+="                        If Isnum(Atrno) Then\xFE";
 z+="                            For Each Row In activeDataSet\xFE";
 z+="                                ROW.ItemContent<Atrno> = Right(ROW.ItemContent<Atrno>, Yytext)\xFE";
 z+="                            Next\xFE";
 z+="                        Else\xFE";
 z+="                            For Each Row In activeDataSet\xFE";
 z+="                                Row[Atrno] = Right(Row[Atrno], Yytext)\xFE";
 z+="                            Next\xFE";
 z+="                        End If\xFE";
 z+="                    Else\xFE";
 z+="                        If Isnum(Atrno) Then\xFE";
 z+="                            For Each Row In activeDataSet\xFE";
 z+="                                ROW.ItemContent<Atrno> = Left(ROW.ItemContent<Atrno>, Yytext)\xFE";
 z+="                            Next\xFE";
 z+="                        Else\xFE";
 z+="                            For Each Row In activeDataSet\xFE";
 z+="                                Row[Atrno] = Left(Row[Atrno], Yytext)\xFE";
 z+="                            Next\xFE";
 z+="                        End If\xFE";
 z+="                    End If\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="            End Else\xFE";
 z+="                If Yytype <> V_ident Then\xFE";
 z+="                    Err = \"Bad Text extract: Tn, or bad translate: Tfile;c;iamc;oamc\"\xFE";
 z+="                    Return\xFE";
 z+="                End\xFE";
 z+="                If Yytext = \"DATA\" Or Yytext = \"DICT\" Then\xFE";
 z+="                    Ddata = Yytext\xFE";
 z+="                    Gosub Lex\xFE";
 z+="                    If Yytype <> V_ident Then\xFE";
 z+="                        Err = \"Tfile;c;iamc;oamc: Missing file name\"\xFE";
 z+="                        Return\xFE";
 z+="                    End\xFE";
 z+="                End Else\xFE";
 z+="                    Ddata = \"\"\xFE";
 z+="                End\xFE";
 z+="                Fname = Yytext\xFE";
 z+="                Yytext = Conv[Ci,1] ; Ci = Ci + 1\xFE";
 z+="                If Yytext <> \";\" Then\xFE";
 z+="                    Err = \"Tfile;c;iamc;oamc: Translate missing ;\"\xFE";
 z+="                    Return\xFE";
 z+="                End\xFE";
 z+="                Yytext = UCase(Conv[Ci, 1]) ; Ci = Ci + 1\xFE";
 z+="                If Index(\"VCIOX\", Yytext,1) = 0 Or Yytext = \"\" Then\xFE";
 z+="                    Err = \"Tfile;c;iamc;oamc: Bad c code \":Yytext:\" (VCIOX)\"\xFE";
 z+="                    Return\xFE";
 z+="                End\xFE";
 z+="                If Yytext = \"C\" And Num(Conv[Ci,1]) Then\xFE";
 z+="                    Gosub Lex\xFE";
 z+="                    Yytext = \"C\":Yytext\xFE";
 z+="                End\xFE";
 z+="                Ccode = Yytext\xFE";
 z+="                Yytext = Conv[Ci,1] ; Ci = Ci + 1\xFE";
 z+="                If Yytext <> \";\" Then\xFE";
 z+="                    Err = \"Tfile;c;iamc;oamc: Translate missing ;\"\xFE";
 z+="                    Return\xFE";
 z+="                End\xFE";
 z+="                Gosub Lex                 ; * Get Iamc\xFE";
 z+="                If Yytext = \";\" Then\xFE";
 z+="                    Iamc = 1\xFE";
 z+="                End Else\xFE";
 z+="                    If Yytype <> V_num Then Err = \"Tfile;iamc: not numeric\"; Return\xFE";
 z+="                    Iamc = Yytext\xFE";
 z+="                    Yytext = Conv[Ci,1] ; Ci = Ci + 1\xFE";
 z+="                End\xFE";
 z+="                If Yytext <> \";\" Then\xFE";
 z+="                    Err = \"Tfile;c;iamc;oamc: Translate missing ;\"\xFE";
 z+="                    Return\xFE";
 z+="                End\xFE";
 z+="                Gosub Lex                 ; * Get Oamc\xFE";
 z+="                If Yytext = \";\" Then\xFE";
 z+="                    Oamc = 1\xFE";
 z+="                End Else\xFE";
 z+="                    If Yytype <> V_num Then Err = \"Tfile;iamc;oamc: not numeric\"; Return\xFE";
 z+="                    Oamc = Yytext\xFE";
 z+="                    Yytext = Conv[Ci,1] ; Ci = Ci + 1\xFE";
 z+="                End\xFE";
 z+="                If Yytext = \";\" Then Gosub Lex\xFE";
 z+="                Result = \"\" ; Notfound = 1\xFE";
 z+="                Open Ddata, Fname To F_file Then\xFE";
 z+="                    If Io = \"I\" Then Amc = Iamc Else Amc = Oamc\xFE";
 z+="                    Numamc = Isnum(Amc)\xFE";
 z+="                    Numatr = Isnum(Atrno)\xFE";
 z+="                    \xFE";
 z+="                    Translates = {}\xFE";
 z+="                    Ccode1 = Left(Ccode, 1)\xFE";
 z+="                    Ccode2 = Mid(Ccode, 2)\xFE";
 z+="                    \xFE";
 z+="                    For Each Row In activeDataSet\xFE";
 z+="                        If Numatr Then Cval = ROW.ItemContent<Atrno> Else Cval = Row[Atrno]\xFE";
 z+="                        \xFE";
 z+="                        If Translates[\"X\":Cval] Then\xFE";
 z+="                            Result = Translates[\"X\":Cval]\xFE";
 z+="                        Else\xFE";
 z+="                            If Numamc Then\xFE";
 z+="                                Readv Result From F_file, Cval, Amc Else Result = Undefined\xFE";
 z+="                            End Else\xFE";
 z+="                                Readjson Result From F_file, Cval Then Result = Result[Amc] Else Result = Undefined\xFE";
 z+="                            End\xFE";
 z+="                            Translates[\"X\":Cval] = Result\xFE";
 z+="                        End If\xFE";
 z+=" \xFE";
 z+="                        If !Result Then\xFE";
 z+="                            Begin Case\xFE";
 z+="                                Case Ccode1 = \"V\"\xFE";
 z+="                                    Cval = \"Missing T Conversion not on file: \":Ddata:\" \":Fname:\" \":Cval:\", \":Oamc\xFE";
 z+="                                Case Ccode1 = \"C\" Or Ccode1 = \"I\" Or Ccode1 = \"O\"\xFE";
 z+="                                Case Ccode1 = \"X\"\xFE";
 z+="                                    Cval = \"\"\xFE";
 z+="                            End Case\xFE";
 z+="                        End Else\xFE";
 z+="                            If Ccode2 Then Cval = Result<1,Ccode2> Else Cval = Result\xFE";
 z+="                        End\xFE";
 z+="                        \xFE";
 z+="                        If Numatr Then ROW.ItemContent<Atrno> = Cval Else Row[Atrno] = Cval\xFE";
 z+="                    Next\xFE";
 z+="                End\xFE";
 z+="            End\xFE";
 z+="\xFE";
 z+="        Case Yytext = \"F\"\xFE";
 z+="            Sci = Ci\xFE";
 z+="            For Each Row In activeDataSet\xFE";
 z+="                @Id = ROW.ItemID\xFE";
 z+="                @Record = Row\xFE";
 z+="                Si = 0\xFE";
 z+="                Ci = Sci\xFE";
 z+="                Loop\xFE";
 z+="                    Fcmd = Conv[Ci, 1] ; Ci = Ci + 1\xFE";
 z+="                    Begin Case\xFE";
 z+="                        Case Fcmd = \"(\"\xFE";
 z+="                            Nconv = \"\"\xFE";
 z+="                            Nest = 0\xFE";
 z+="                            Loop\xFE";
 z+="                                Gosub Lex\xFE";
 z+="                            Until Yytext = \")\" And Nest = 0 Do\xFE";
 z+="                                If Yytext = \"\" Then Err = \"Missing )\" ; Return\xFE";
 z+="                                If Yytext = \"(\" Then Nest = Nest + 1\xFE";
 z+="                                If Yytext = \")\" Then Nest = Nest - 1\xFE";
 z+="                                Nconv = Nconv:Yytext\xFE";
 z+="                            Repeat\xFE";
 z+="                            Call English_conversions(Io, activeDataSet, Stack(Si), Nconv, '')\xFE";
 z+="                        Case Fcmd = \";\"\xFE";
 z+="                        Case Fcmd = \"\"\xFE";
 z+="                            Cval = Stack(1)\xFE";
 z+="                            Return\xFE";
 z+="                        Case Num(Fcmd)\xFE";
 z+="                            Ci = Ci - 1\xFE";
 z+="                            Gosub Lexr\xFE";
 z+="                            Si=Si+1 ; If Si>Stackmax Then Err = \"F-stack overflow\" ; Return\xFE";
 z+="                            Stack(Si) = @RECORD.ItemContent<Yytext>\xFE";
 z+="                        Case Fcmd = \"'\" Or Fcmd = '\"' Or Fcmd = `\\`\xFE";
 z+="                            Ci = Ci - 1\xFE";
 z+="                            Gosub Lex\xFE";
 z+="                            Si=Si+1 ; If Si>Stackmax Then Err = \"F-stack overflow\" ; Return\xFE";
 z+="                            Stack(Si) = Yytext[2,Len(Yytext)-2]\xFE";
 z+="                        Case Fcmd = \"C\"\xFE";
 z+="                            Gosub Lex\xFE";
 z+="                            Si=Si+1 ; If Si>Stackmax Then Err = \"F-stack overflow\" ; Return\xFE";
 z+="                            Stack(Si) = Yytext\xFE";
 z+="                        Case Fcmd = \"*\"\xFE";
 z+="                            If Num(Conv[Ci,1]) And Conv[Ci,1] # \"\" Then Gosub Lex\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            If Num(Stack(Si))=0 Or Num(Stack(Si+1))=0 Then Err = \"Stack element not numeric on \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si) * Stack(Si+1)\xFE";
 z+="                        Case Fcmd = \"/\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            If Num(Stack(Si))=0 Or Num(Stack(Si+1))=0 Then Err = \"Stack element not numeric on \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si) / Stack(Si+1)\xFE";
 z+="                        Case Fcmd = \"+\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            If Num(Stack(Si))=0 Or Num(Stack(Si+1))=0 Then Err = \"Stack element not numeric on \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si) + Stack(Si+1)\xFE";
 z+="                        Case Fcmd = \"-\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            If Num(Stack(Si))=0 Or Num(Stack(Si+1))=0 Then Err = \"Stack element not numeric on \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si) - Stack(Si+1)\xFE";
 z+="                        Case Fcmd = \"R\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            If Num(Stack(Si))=0 Or Num(Stack(Si+1))=0 Then Err = \"Stack element not numeric on \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Rem(Stack(Si), Stack(Si+1))\xFE";
 z+="                        Case Fcmd = \":\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si) : Stack(Si+1)\xFE";
 z+="                        Case Fcmd = \"[\" And Conv[Ci,1] = \"]\"\xFE";
 z+="                            Ci = Ci + 1\xFE";
 z+="                            Si = Si - 2 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si)[Stack(Si+1),Stack(Si+2)]\xFE";
 z+="                        Case Fcmd = \"S\"\xFE";
 z+="                            Sum = 0\xFE";
 z+="                            For I = 1 To Si\xFE";
 z+="                                If Num(Stack(Si))=0 Then Err = \"Stack element not numeric on \":Fcmd ; Return\xFE";
 z+="                                Sum = Sum + Stack(I)\xFE";
 z+="                            Next I\xFE";
 z+="                            Si = 1\xFE";
 z+="                            Stack(Si) = Sum\xFE";
 z+="                        Case Fcmd = \"_\"\xFE";
 z+="                            If Si <= 1 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Hs = Stack(Si-1)\xFE";
 z+="                            Stack(Si-1) = Stack(Si)\xFE";
 z+="                            Stack(Si) = Hs\xFE";
 z+="                        Case Fcmd = \"P\"\xFE";
 z+="                            Si=Si+1 ; If Si>Stackmax Then Err = \"F-stack overflow\" ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si-1)\xFE";
 z+="                        Case Fcmd = \"=\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si+1) = Stack(Si)\xFE";
 z+="                        Case Fcmd = \"<\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si+1) < Stack(Si)\xFE";
 z+="                        Case Fcmd = \">\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si+1) > Stack(Si)\xFE";
 z+="                        Case Fcmd = \"#\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si+1) <> Stack(Si)\xFE";
 z+="                        Case Fcmd = \"[\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si+1) <= Stack(Si)\xFE";
 z+="                        Case Fcmd = \"]\"\xFE";
 z+="                            Si = Si - 1 ; If Si <= 0 Then Err = \"Stack underflow (POP) \":Fcmd ; Return\xFE";
 z+="                            Stack(Si) = Stack(Si+1) >= Stack(Si+1)\xFE";
 z+="                        Case Fcmd = \"N\"\xFE";
 z+="                            Fcmd = Conv[Ci,1] ; Ci = Ci + 1\xFE";
 z+="                            Si=Si+1 ; If Si>Stackmax Then Err = \"F-stack overflow\" ; Return\xFE";
 z+="                            Begin Case\xFE";
 z+="                                Case Fcmd = \"I\" ; Stack(Si) = @Ni\xFE";
 z+="                                Case Fcmd = \"D\" ; Stack(Si) = @Nd\xFE";
 z+="                                Case Fcmd = \"V\" ; Stack(Si) = @Nv\xFE";
 z+="                                Case Fcmd = \"S\" ; Stack(Si) = @Ns\xFE";
 z+="                                Case Fcmd = \"B\" ; Stack(Si) = @Nb\xFE";
 z+="                                Case 1\xFE";
 z+="                                    Err = 'Unknown conversion N':Fcmd ; Return\xFE";
 z+="                            End Case\xFE";
 z+="                        Case 1\xFE";
 z+="                            Err = 'Unknown conversion ':Fcmd ; Return\xFE";
 z+="                    End Case\xFE";
 z+="                While 1 Do Repeat\xFE";
 z+="            Next\xFE";
 z+="        Case 1\xFE";
 z+="            Err = 'Unknown conversion ':Yytext\xFE";
 z+="    End Case\xFE";
 z+="    Return\xFE";
 z+="    *\xFE";
 z+="GETATRNO: \xFE";
 z+="    Gosub Lex\xFE";
 z+="    If Yytype = V_ident Then\xFE";
 z+="        Yytype = V_str\xFE";
 z+="        Readv An From F_dictionary, Yytext, 2 Then\xFE";
 z+="            If Num(An) Then Yytext = \"'\":@RECORD.ItemContent<An>:\"'\" Else Yytext = \"'\":@Record[An]:\"'\"\xFE";
 z+="        Else\xFE";
 z+="            Yytext = \"'\":@Record[Yytext]:\"'\"\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="    End Else If Yytype = V_num Then\xFE";
 z+="        Yytype = V_str\xFE";
 z+="        Yytext = \"'\":@RECORD.ItemContent<Yytext>:\"'\"\xFE";
 z+="\xFE";
 z+="    End\xFE";
 z+="    Return\xFE";
 z+="    *\xFE";
 z+="LEXR: * ACCEPT A REAL #\xFE";
 z+="    Ch = Conv[Ci,1]\xFE";
 z+="    If Ch = \"\" Then\xFE";
 z+="        Yytype = V_eol\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    *\xFE";
 z+="    If Index(\"0123456789+-\", Ch, 1) Then\xFE";
 z+="        Yytext = Ch; Ci += 1\xFE";
 z+="        Loop\xFE";
 z+="            Ch = Conv[Ci,1]\xFE";
 z+="        While Index(\"0123456789\", Ch, 1) And Ch <> \"\" Do\xFE";
 z+="            Ci = Ci + 1\xFE";
 z+="            Yytext = Yytext:Ch\xFE";
 z+="        Repeat\xFE";
 z+="        If Ch = \".\" Then\xFE";
 z+="            Yytext = Yytext:Ch\xFE";
 z+="            Ci = Ci + 1\xFE";
 z+="            Loop\xFE";
 z+="                Ch = Conv[Ci,1]\xFE";
 z+="            While Index(\"0123456789\", Ch, 1) And Ch <> \"\" Do\xFE";
 z+="                Ci = Ci + 1\xFE";
 z+="                Yytext = Yytext:Ch\xFE";
 z+="            Repeat\xFE";
 z+="        End\xFE";
 z+="        Yytype = V_num\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    *\xFE";
 z+="LEX: * LEX\xFE";
 z+="    Ch = Conv[Ci, 1]\xFE";
 z+="    Ci = Ci + 1\xFE";
 z+="    Yytext = Ch\xFE";
 z+="    If Ch = \"\" Then\xFE";
 z+="        Yytype = V_eol\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    *\xFE";
 z+="    * Check for a string\xFE";
 z+="    If Ch = \"'\" Or Ch = '\"' Or Ch = `\\` Then\xFE";
 z+="        Ech = Ch\xFE";
 z+="        Yytext = Ch\xFE";
 z+="        Loop\xFE";
 z+="            Ch = Conv[Ci,1]\xFE";
 z+="            Ci = Ci + 1\xFE";
 z+="            Yytext = Yytext:Ch\xFE";
 z+="        Until Ch = \"\" Or Ch = Ech Do Repeat\xFE";
 z+="        Yytype = V_str\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    *\xFE";
 z+="    * Check for a number\xFE";
 z+="    If Index(\"0123456789\", Ch, 1) Then\xFE";
 z+="        Loop\xFE";
 z+="            Ch = Conv[Ci,1]\xFE";
 z+="        While Index(\"0123456789\", Ch, 1) And Ch <> \"\" Do\xFE";
 z+="            Ci = Ci + 1\xFE";
 z+="            Yytext = Yytext:Ch\xFE";
 z+="        Repeat\xFE";
 z+="        Yytype = V_num\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    *\xFE";
 z+="    * Check for a identifier\xFE";
 z+="    If Alpha(Ch) Then\xFE";
 z+="        Loop\xFE";
 z+="            Ch = Conv[Ci,1]\xFE";
 z+="        While Not(Index(`;,-:.+^&#[](){}<>/=*'\\`:'\"', Ch, 1)) And Ch <> \"\" Do\xFE";
 z+="            Ci = Ci + 1\xFE";
 z+="            Yytext = Yytext:Ch\xFE";
 z+="        Repeat\xFE";
 z+="        Yytype = V_ident\xFE";
 z+="        Return\xFE";
 z+="    End\xFE";
 z+="    *\xFE";
 z+="    Yytype = V_sym\xFE";
 z+="    Yytext = Ch\xFE";
 z+="    Return\xFE";
 z+="End Subroutine\xFE";
 z+="\xFE";
 z+="Function List_ClearScreen()\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    mPageNo = mPageNo + 1 ;* Advance Paging (Header/Footer) Options\xFE";
 z+="    Print\xFE";
 z+="    If Pagepause Then\xFE";
 z+="        Print @(-1):Chr(28):\"<span style='font-family:monospace'>\":Chr(29):\xFE";
 z+="    Else\xFE";
 z+="        Print @Hr:\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    mLineNo = 0\xFE";
 z+="    AtBol = True\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function SetHeading(H)\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    \xFE";
 z+="    * Use the HEADING statement to specify the text to print at the top of each page of output.\xFE";
 z+="    * Pagination begins with page 1 and increments automatically on each new page or upon encountering\xFE";
 z+="    * the PAGE Subroutine. Use the N heading format control character to disable automatic paging.\xFE";
 z+="    *\xFE";
 z+="    * You can use the following heading format control characters. Do NOT these characters inside single quotes:\xFE";
 z+="    *\xFE";
 z+="    *   ( ] )  The right square bracket in the footing expression starts a new line.\xFE";
 z+="    *   ( \\ )  Backslash  prints current time and date formatted as dd mmm yyyy hh:mm:ss.  Time is in 12-hour \"am()\" or \"pm\" format.\xFE";
 z+="    *   ( ^ )  prints current page number right-justified in a field of 4 blanks.\xFE";
 z+="    *\xFE";
 z+="    * You can use the following heading format control characters, enclosed in single quotation marks, in the footing expression:\xFE";
 z+="    *\xFE";
 z+="    *   C[n]'  prints footing line centered in a field of n blanks.  If n is not specified, center the line on the page.\xFE";
 z+="    *   'D'    prints current date formatted as dd mmm yyyy\xFE";
 z+="    *   'T'    prints current time and date formatted as dd mmm yyyy hh:mm:ss. Time is in 12-hour \"am()\" or \"pm\" format.\xFE";
 z+="    *   'L'    starts a new line\xFE";
 z+="    *   'P[n]' prints current page number right-justified in a field of n blanks.  The default value for n is 4.\xFE";
 z+="    *   'N'    suppresses automatic paging\xFE";
 z+="    *   ( \" )  Double quote prints one single quote in footing text\xFE";
 z+="    *   'N' Turn off paging (Same as Page(-1) subroutine )\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    If !MlineNo Then mLineNo = 0\xFE";
 z+="\xFE";
 z+="    mHeader = H\xFE";
 z+="    If !mTrackingPages Then\xFE";
 z+="        mTrackingPages = True\xFE";
 z+="        mFootLineNo = LinesOnPage()\xFE";
 z+="        mPageNo = 0\xFE";
 z+="        List_ClearScreen()\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If mLineNo = 0 And !AtBol Then Return True\xFE";
 z+="    If mHeader <> \"\" Then\xFE";
 z+="        Print ProcessHeaderFooter(mHeader):\xFE";
 z+="        OutputCrlf_NoCheck()\xFE";
 z+="        AtBol = False\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function SetFooting(F)\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    * Use the Footing Subroutine to specify the text and format of the footing to print at the bottom\xFE";
 z+="    * of each page of output. Pagination begins with page 1 and increments automatically on each\xFE";
 z+="    * new page or upon encountering the PAGE Subroutine. Use the N footing format control character to\xFE";
 z+="    * disable automatic paging.\xFE";
 z+="    *\xFE";
 z+="    * You can use the following footing format control characters. Do NOT these characters inside single quotes:\xFE";
 z+="    *\xFE";
 z+="    *   ( ] )  The right square bracket in the footing expression starts a new line.\xFE";
 z+="    *   ( \\ )  Backslash  prints current time and date formatted as dd mmm yyyy hh:mm:ss.  Time is in 12-hour \"am()\" or \"pm\" format.\xFE";
 z+="    *   ( ^ )  prints current page number right-justified in a field of 4 blanks.\xFE";
 z+="    *\xFE";
 z+="    * You can use the following footing format control characters, enclosed in single quotation marks, in the footing expression:\xFE";
 z+="    *\xFE";
 z+="    *   C[n]'  prints footing line centered in a field of n blanks.  If n is not specified, center the line on the page.\xFE";
 z+="    *   'D'    prints current date formatted as dd mmm yyyy\xFE";
 z+="    *   'T'    prints current time and date formatted as dd mmm yyyy hh:mm:ss. Time is in 12-hour \"am()\" or \"pm\" format.\xFE";
 z+="    *   'L'    starts a new line\xFE";
 z+="    *   'P[n]' prints current page number right-justified in a field of n blanks.  The default value for n is 4.\xFE";
 z+="    *   'N'    suppresses automatic paging\xFE";
 z+="    *   ( \" )  Double quote prints one single quote in footing text\xFE";
 z+="    *   'N' Turn off paging (Same as Page(-1) subroutine )\xFE";
 z+="\xFE";
 z+="    If !MlineNo Then mLineNo = 0\xFE";
 z+="    If !mPageNo Then mPageNo = 1\xFE";
 z+="    \xFE";
 z+="    mFooter = F\xFE";
 z+="    mFootLineNo = LinesOnPage() - 1\xFE";
 z+="    mFootLineNo = mFootLineNo - Count(F, Chr(254)) - Count(F, \"[\") - Count(F, \"'L'\")\xFE";
 z+="    If !mTrackingPages Then\xFE";
 z+="        List_ClearScreen()\xFE";
 z+="        mTrackingPages = True\xFE";
 z+="        mPageNo = 0\xFE";
 z+="    End If\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function hf_Print(S)\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    \xFE";
 z+="    * Use the hf_Print subroutine to print data on the screen\xFE";
 z+="    * The hf_Print differs from the hf_Print_ subroutine in that hf_Print\xFE";
 z+="    * outputs a carriage return and linefeed after displaying the exression.\xFE";
 z+="\xFE";
 z+="    * Check for header\xFE";
 z+="    If mTrackingPages Then\xFE";
 z+="        If mLineNo = 0 Then\xFE";
 z+="            If AtBol Then\xFE";
 z+="                If mHeader <> \"\" Then\xFE";
 z+="                    Print ProcessHeaderFooter(mHeader):\xFE";
 z+="                    OutputCrlf_NoCheck()\xFE";
 z+="                    AtBol = False\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    hf_Print_(S : crlf())\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function hf_Print_(ByVal S)\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    Dim I\xFE";
 z+="\xFE";
 z+="    If !mTrackingPages Then\xFE";
 z+="        Print S:\xFE";
 z+="        Return True\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    I = 1\xFE";
 z+="    Loop\xFE";
 z+="        I = Instr(S, crlf())\xFE";
 z+="        If I = 0 Then\xFE";
 z+="            If Len(S) Then\xFE";
 z+="                Print S:\xFE";
 z+="                AtBol = False\xFE";
 z+="            End If\xFE";
 z+="            Return True\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        If I > 1 Then\xFE";
 z+="            Print Left(S, I - 1):\xFE";
 z+="            AtBol = False\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        OutputCrlf_FooterCheck()\xFE";
 z+="        S = Mid(S, I + 2)\xFE";
 z+="        AtBol = True\xFE";
 z+="    While Len(S) Do Repeat\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="Function Page(ByVal PageNo)\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    * Use the Page subroutine to print headings, footings, and page advances.  You can specify headings and footings\xFE";
 z+="    * before executing the Page subroutine.  If there is no Heading or Footing, Page clears the screen.\xFE";
 z+="    *\xFE";
 z+="    * PageNo: with a negitive number disables paging.\xFE";
 z+="    *         with a zero value advances to the next page and increments the current page number.\xFE";
 z+="    *         with a number greater than zero advances to the next page and sets the current page number to PageNo.\xFE";
 z+="    *\xFE";
 z+="    * PageNo with the null value results in program termination and a run-time error.\xFE";
 z+="    *\xFE";
 z+="    If IsNull(PageNo) Then PageNo = -1\xFE";
 z+="\xFE";
 z+="    If IsNumeric(PageNo) Then\xFE";
 z+="        If PageNo < 0 Then\xFE";
 z+="            mTrackingPages = False\xFE";
 z+="            Return True\xFE";
 z+="\xFE";
 z+="        ElseIf PageNo = 0 Then\xFE";
 z+="            If !mTrackingPages Then mPageNo = 0\xFE";
 z+="            mTrackingPages = True\xFE";
 z+="            If mFooter = \"\" Or mFootLineNo < 2 Then\xFE";
 z+="                List_ClearScreen()\xFE";
 z+="            Else\xFE";
 z+="                Loop Until mLineNo + 1 = mFootLineNo Do\xFE";
 z+="                    OutputCrlf_FooterCheck()\xFE";
 z+="                Repeat\xFE";
 z+="                OutputCrlf_FooterCheck() ;* Calls Footer And Clearscreen\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            mPageNo = PageNo\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If !mTrackingPages Then\xFE";
 z+="        mTrackingPages = True\xFE";
 z+="        mPageNo = 0\xFE";
 z+="        List_ClearScreen()\xFE";
 z+="    End If\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function LinesLeft()\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    \xFE";
 z+="    Dim PageLines\xFE";
 z+="\xFE";
 z+="    If mFootLineNo Then\xFE";
 z+="        PageLines = mFootLineNo\xFE";
 z+="    Else\xFE";
 z+="        PageLines = LinesOnPage() - 1\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    LinesLeft = PageLines - mLineNo\xFE";
 z+="    If LinesLeft < 0 Then LinesLeft = 0\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function OutputCrlf_FooterCheck()\xFE";
 z+="    * This routine is advances the cursor to the next line checking for Footers\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    \xFE";
 z+="    Dim PageLines\xFE";
 z+="\xFE";
 z+="    If mTrackingPages = 0 Then\xFE";
 z+="        OutputCrlf_NoCheck()\xFE";
 z+="        Return True\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    PageLines = LinesOnPage() - 1\xFE";
 z+="\xFE";
 z+="    * Check for footer\xFE";
 z+="    If mLineNo + 1 = mFootLineNo And !AtBol Then\xFE";
 z+="        OutputCrlf_NoCheck()\xFE";
 z+="        Print ProcessHeaderFooter(mFooter):\xFE";
 z+="        OutputCrlf_NoCheck()\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    * Check for page waiting and screen clear\xFE";
 z+="    If mLineNo >= PageLines And Pagepause Then\xFE";
 z+="        mLineNo = 0\xFE";
 z+="        \xFE";
 z+="        Print Chr(28):\"</span>\":Chr(29):\xFE";
 z+="        \xFE";
 z+="        B = @Response.buffer()\xFE";
 z+="        Print submitBtn('Continue'):' ':submitBtn('Quit'):\xFE";
 z+="\xFE";
 z+="        // Make Enter select Continue\xFE";
 z+="        Print @Script(`\xFE";
 z+="               $( document ).ready(function() {\xFE";
 z+="                   setTimeout(function(){ document.getElementById(\"Continue\").focus(); }, 50);\xFE";
 z+="               });\xFE";
 z+="           `):\xFE";
 z+="\xFE";
 z+="        @Server.pause\xFE";
 z+="        \xFE";
 z+="        If @Formvar('Quit') Then\xFE";
 z+="            @Response.buffer(B)\xFE";
 z+="            ClearSelect\xFE";
 z+="            Print\xFE";
 z+="            Stop\xFE";
 z+="        End If\xFE";
 z+="        List_ClearScreen()\xFE";
 z+="\xFE";
 z+="    Else\xFE";
 z+="        * move down one line\xFE";
 z+="        OutputCrlf_NoCheck()\xFE";
 z+="        If mDoubleSpacing Then\xFE";
 z+="            If mFootLineNo Then\xFE";
 z+="                If mLineNo < mFootLineNo Then OutputCrlf_NoCheck()\xFE";
 z+="            Else\xFE";
 z+="                If mLineNo < PageLines Then OutputCrlf_NoCheck()\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function OutputCrlf_NoCheck()\xFE";
 z+="    $Include _VCOM\xFE";
 z+="\xFE";
 z+="    mLineNo = mLineNo + 1\xFE";
 z+="    Print crlf():\xFE";
 z+="    AtBol = True\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="Function ProcessHeaderFooter(HeadFootLine)\xFE";
 z+="    * Outputs either a header or Footer string. Interprets control characters\xFE";
 z+="    $Include _VCOM\xFE";
 z+="    \xFE";
 z+="    * Define local variables\xFE";
 z+="    Dim BuildLine\xFE";
 z+="    Dim EndMark = \"\"\xFE";
 z+="    Dim I\xFE";
 z+="    Dim CenterSize\xFE";
 z+="    Dim DoCenter\xFE";
 z+="    Dim Size\xFE";
 z+="    Dim InsideLiteral As Boolean\xFE";
 z+="    Dim BSize\xFE";
 z+="    Dim Ch\xFE";
 z+="    Dim Result = \"\"\xFE";
 z+="\xFE";
 z+="    I = 1\xFE";
 z+="    InsideLiteral = False\xFE";
 z+="    DoCenter = 0\xFE";
 z+="\xFE";
 z+="    CenterSize = PageWidth()\xFE";
 z+="    BuildLine = \"\"\xFE";
 z+="    Loop\xFE";
 z+="        Ch = Mid(HeadFootLine, I, 1)\xFE";
 z+="        If Ch = \"\" Then Exit Do\xFE";
 z+="        I = I + 1\xFE";
 z+="\xFE";
 z+="        If !InsideLiteral Then\xFE";
 z+="            If (((Ch = `\"`) Or (Ch = \"'\"))) And (Ch = Mid(HeadFootLine, I, 1)) Then\xFE";
 z+="                * Two quotes next to each other, equal's only one\xFE";
 z+="                BuildLine = BuildLine : Ch\xFE";
 z+="                I = I + 1\xFE";
 z+="\xFE";
 z+="            ElseIf Ch = \"'\" Then ;* Start A Literal?\xFE";
 z+="                InsideLiteral = True\xFE";
 z+="                EndMark = Ch\xFE";
 z+="\xFE";
 z+="            ElseIf Ch = `\"` Then ;* Start A Literal?\xFE";
 z+="                InsideLiteral = True\xFE";
 z+="                EndMark = Ch\xFE";
 z+="                BuildLine = BuildLine : Ch\xFE";
 z+="\xFE";
 z+="            ElseIf Ch = `\\` Then ;* Current Date\xFE";
 z+="                BuildLine = BuildLine : TimeDate() ;* Format(Now, \"h:mm:s d mmm yyyy\")\xFE";
 z+="\xFE";
 z+="            ElseIf Ch = \"^\" Then ;* Page Number\xFE";
 z+="                BuildLine = BuildLine : Right(\"    \" : mPageNo, 4)\xFE";
 z+="\xFE";
 z+="            ElseIf Ch >= Chr(253) Or (Ch = \"]\") Then ;* Start New Line\xFE";
 z+="                If DoCenter Then Result := Space((CenterSize - Len(BuildLine)) / 2)\xFE";
 z+="                Result := BuildLine : crlf()\xFE";
 z+="                BuildLine = \"\"\xFE";
 z+="\xFE";
 z+="            Else\xFE";
 z+="                BuildLine = BuildLine : Ch\xFE";
 z+="            End If\xFE";
 z+="\xFE";
 z+="        ElseIf EndMark = \"'\" Then\xFE";
 z+="            Ch = UCase(Ch)\xFE";
 z+="            Select Case True\xFE";
 z+="                Case Ch = EndMark\xFE";
 z+="                    InsideLiteral = False\xFE";
 z+="\xFE";
 z+="                Case Ch = `\"` ;* Quote\xFE";
 z+="                    BuildLine = BuildLine : \"'\"\xFE";
 z+="\xFE";
 z+="                Case Ch = `\\` ;* Quote\xFE";
 z+="                    BuildLine = BuildLine : \"'\"\xFE";
 z+="\xFE";
 z+="                Case Ch = \"L\" ;* Line Break\xFE";
 z+="                    If DoCenter Then Result := Space((CenterSize - Len(BuildLine)) / 2)\xFE";
 z+="                    Result := BuildLine : crlf()\xFE";
 z+="                    BuildLine = \"\"\xFE";
 z+="\xFE";
 z+="                Case Ch = \"B\" ;* Output HeadFootB In Line On {N} Size\xFE";
 z+="                    Size = 0\xFE";
 z+="                    Loop\xFE";
 z+="                        Ch = Mid(HeadFootLine, I, 1) ; If !(IsNumeric(Ch) And (Ch <> \"\")) Then Exit Do\xFE";
 z+="                        Size = Size * 10 + Asc(Ch) - Asc(\"0\")\xFE";
 z+="                        I = I + 1\xFE";
 z+="                    While True Do Repeat\xFE";
 z+="                    BuildLine = BuildLine : HeadFootB\xFE";
 z+="                    If Size Then\xFE";
 z+="                        BSize = Len(HeadFootB)\xFE";
 z+="                        BuildLine = BuildLine : Space(Size - BSize)\xFE";
 z+="                    End If\xFE";
 z+="\xFE";
 z+="                Case Ch = \"C\" ;* Center Line On {N} Size\xFE";
 z+="                    DoCenter = 1\xFE";
 z+="                    Size = 0\xFE";
 z+="                    Loop\xFE";
 z+="                        Ch = Mid(HeadFootLine, I, 1) ; If !(IsNumeric(Ch) And (Ch <> \"\")) Then Exit Do\xFE";
 z+="                        Size = Size * 10 + Asc(Ch) - Asc(\"0\")\xFE";
 z+="                        I = I + 1\xFE";
 z+="                    While True Do Repeat\xFE";
 z+="                    If Size Then CenterSize = Size\xFE";
 z+="\xFE";
 z+="                Case Ch = \"D\" ;* Date\xFE";
 z+="                    BuildLine = BuildLine : Date(Date()) ;* Format(Now, \"d-mmm-yy\")\xFE";
 z+="\xFE";
 z+="                Case Ch = \"T\" ;* Time\xFE";
 z+="                    BuildLine = BuildLine : Time(Time()) ;* Format(Now, \"h:mm:s d mmm yyyy\")\xFE";
 z+="\xFE";
 z+="                Case Ch = \"F\" ;* @FileName\xFE";
 z+="                    Size = 0\xFE";
 z+="                    Loop\xFE";
 z+="                        Ch = Mid(HeadFootLine, I, 1) ; If !(IsNumeric(Ch) And (Ch <> \"\")) Then Exit Do\xFE";
 z+="                        Size = Size * 10 + Asc(Ch) - Asc(\"0\")\xFE";
 z+="                        I = I + 1\xFE";
 z+="                    While True Do Repeat\xFE";
 z+="                    BuildLine = BuildLine : @FileName\xFE";
 z+="                    If Size Then\xFE";
 z+="                        BSize = Len(@FileName)\xFE";
 z+="                        BuildLine = BuildLine : Space(Size - BSize)\xFE";
 z+="                    End If\xFE";
 z+="\xFE";
 z+="                Case Ch = \"I\" ;* Item Id\xFE";
 z+="                    Size = 0\xFE";
 z+="                    Loop\xFE";
 z+="                        Ch = Mid(HeadFootLine, I, 1) ; If !(IsNumeric(Ch) And (Ch <> \"\")) Then Exit Do\xFE";
 z+="                        Size = Size * 10 + Asc(Ch) - Asc(\"0\")\xFE";
 z+="                        I = I + 1\xFE";
 z+="                    While True Do Repeat\xFE";
 z+="                    BuildLine = BuildLine : @Id\xFE";
 z+="                    If Size Then\xFE";
 z+="                        BSize = Len(@Id)\xFE";
 z+="                        BuildLine = BuildLine : Space(Size - BSize)\xFE";
 z+="                    End If\xFE";
 z+="\xFE";
 z+="                Case Ch = \" \"\xFE";
 z+="                    BuildLine = BuildLine : Ch\xFE";
 z+="\xFE";
 z+="                Case Ch = \"N\"\xFE";
 z+="                    mTrackingPages = False\xFE";
 z+="\xFE";
 z+="                Case Ch = \"P\" ;* Page Number\xFE";
 z+="                    Size = 0\xFE";
 z+="                    Loop\xFE";
 z+="                        Ch = Mid(HeadFootLine, I, 1) ; If !(IsNumeric(Ch) And (Ch <> \"\")) Then Exit Do\xFE";
 z+="                        Size = Size * 10 + Asc(Ch) - Asc(\"0\")\xFE";
 z+="                        I = I + 1\xFE";
 z+="                    While True Do Repeat\xFE";
 z+="                    BuildLine = BuildLine : mPageNo\xFE";
 z+="                    If Size Then\xFE";
 z+="                        BSize = Len(HeadFootB)\xFE";
 z+="                        BuildLine = BuildLine : Space(Size - BSize)\xFE";
 z+="                    End If\xFE";
 z+="            End Select\xFE";
 z+="            \xFE";
 z+="        ElseIf Ch = EndMark Then\xFE";
 z+="            BuildLine = BuildLine : Ch\xFE";
 z+="            InsideLiteral = False\xFE";
 z+="            \xFE";
 z+="        Else\xFE";
 z+="            BuildLine = BuildLine : Ch\xFE";
 z+="        End If\xFE";
 z+="    While True Do Repeat\xFE";
 z+="\xFE";
 z+="    If DoCenter Then Result := Space((CenterSize - Len(BuildLine)) / 2)\xFE";
 z+="    Return Result : BuildLine\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="*/\xFE";
 z+=""
window.cached_jsb_tcl["list"]=z;
var z="\xFE";
 z+="program listdbs\xFE";
 z+="*$options aspx\xFE";
 z+="\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    Clearselect\xFE";
 z+="    Options = LCase(Field(@Sentence, \" (\", 2))\xFE";
 z+="    If Val(Options) > 0 Then Cols = Val(Options) Else Cols = 5\xFE";
 z+="    \xFE";
 z+="    dbNames = dbGetDatabaseNames()\xFE";
 z+="    \xFE";
 z+="    Print @Div('id2', @Center(@Bold(\"SQL DATABASES\")))\xFE";
 z+="    Print @setStyle('id2', { 'background-color': 'lightgray', color: 'black', border: '1px solid black ' } )\xFE";
 z+="    Print  @Html(\"<table style='width: 95%; white-space: nowrap;'>\"):\xFE";
 z+="    Cnt = 0\xFE";
 z+="    IdI = 1\xFE";
 z+="    \xFE";
 z+="    Loop While IdI <= UBound(dbNames) Do\xFE";
 z+="        R = \"\"\xFE";
 z+="        For I = 1 To Cols While IdI <= UBound(dbNames)\xFE";
 z+="            dbName = dbNames[IdI]\xFE";
 z+="            R = R:@Td(Right(dbName, 30):Chr(28):'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;':Chr(29))\xFE";
 z+="            Cnt += 1\xFE";
 z+="            IdI += 1\xFE";
 z+="        Next\xFE";
 z+="        If R Then Print @Tr(R):\xFE";
 z+="    Repeat\xFE";
 z+="\xFE";
 z+="    Print @Html(\"</table>\")\xFE";
 z+="    Print Cnt:\" SQL Databases listed\"\xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["listdbs"]=z;
var z="Program Login\xFE";
 z+="    Dim SuccessfulLogin As Boolean = false\xFE";
 z+="    Dim rtnTo  As String = @ParamVar(\"returnto\"):@ParamVar(\"returnurl\")\xFE";
 z+="    \xFE";
 z+="    Dim Config As Json = jsbConfig('authenticationtype')\xFE";
 z+="    Dim authType As String = \"local\"\xFE";
 z+="    If Config Then authType = Config.value\xFE";
 z+="    \xFE";
 z+="    Dim S As String = field(@Sentence, \"(\", 1)\xFE";
 z+="    Dim Opts As String = Field(S, \"?\", 2)\xFE";
 z+="    Dim D As String = \" \"\xFE";
 z+="    If Instr(S, \",\") Then D = \",\"\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    Dim UserName As String = Trim(field(S, D, 2))\xFE";
 z+="    Dim _passwd As String = Trim(field(S, D, 3))\xFE";
 z+="    \xFE";
 z+="    if rtnTo Then\xFE";
 z+="        if !UserName Then UserName = @ParamVar(\"returnurl\")\xFE";
 z+="        if !_passwd Then _passwd = @ParamVar(\"password\")\xFE";
 z+="    End If\xFE";
 z+="        \xFE";
 z+="    if authType = \"oauth\" and UserName = \"\" then\xFE";
 z+="        Dim access_token As String = @jsb_odb.oauth_Login(\"\" /* oAuthAuthority */, false) // will call  @jsb_bf.SignIn if successful\xFE";
 z+="        if access_token then \xFE";
 z+="            SuccessfulLogin = True\xFE";
 z+="            if instr(rtnTo, \"?\") Then rtnTo := \"&\" Else rtnTo := \"?\"\xFE";
 z+="            rtnTo := '&ccess_token=':access_token\xFE";
 z+="        end if\xFE";
 z+="    Else\xFE";
 z+="        if UserName Then SuccessfulLogin = @jsb_tcl.tclLogin(UserName, _Passwd)\xFE";
 z+="        \xFE";
 z+="        if !SuccessfulLogin And !_passwd And LCase(UserName) <> \"guest\" Then\xFE";
 z+="            if system(1) = \"gae\" then \xFE";
 z+="                if @IsAuthenticated Then Stop \"You are logged in as \":@UserName:\" and your email is \":@Request.UserEmail\xFE";
 z+="                @Response.Redirect(@Server.loginurl(@Request.Path))\xFE";
 z+="            End If\xFE";
 z+="    \xFE";
 z+="            Dim Msg As String = \"Please login\"\xFE";
 z+="            if !UserName Then UserName = @UserName\xFE";
 z+="            If UserName = \"anonymous\" then UserName = ''\xFE";
 z+="            \xFE";
 z+="            Loop\xFE";
 z+="                Ans = @LoginBox(\"JSB\", Msg, UserName)\xFE";
 z+="                if ans = Chr(27) Or Ans = '' then Break\xFE";
 z+="                UserName = ans<1>\xFE";
 z+="                _passwd = ans<2>\xFE";
 z+="                \xFE";
 z+="                SuccessfulLogin = @jsb_tcl.tclLogin(UserName, _Passwd)\xFE";
 z+="            Until SuccessfulLogin Do \xFE";
 z+="                Msg = \"Invalid.  Please try again\"\xFE";
 z+="            Repeat\xFE";
 z+="        end if\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    if !SuccessfulLogin Then Stop 'Login Failed'\xFE";
 z+="    If rtnTo Then @Response.Redirect(rtnTo)\xFE";
 z+="End Function\xFE";
 z+="\xFE";
 z+="function tclLogin(UserName, _Passwd)\xFE";
 z+="    if @jsb_bf.VerifyUser(UserName, _Passwd) Then\xFE";
 z+="        @jsb_bf.SignIn(UserName, true)\xFE";
 z+="        auditLog('Login ':UserName:' -- success')\xFE";
 z+="        return true\xFE";
 z+="    end if\xFE";
 z+="    auditLog('Login ':UserName:' -- failed')\xFE";
 z+="    return false\xFE";
 z+="end function\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="Function @@ServerTclLogin(UserName, _Passwd)\xFE";
 z+="    nap 500\xFE";
 z+="    return @jsb_tcl.tclLogin(UserName, _Passwd)\xFE";
 z+="End Function"
window.cached_jsb_tcl["login"]=z;
window.cached_jsb_tcl["loginfo"]="program logInfo\xFE   S = Trim(DropLeft(@Sentence, \" \"))\xFE   if S then logInfo(S)\xFEend Program";
window.cached_jsb_tcl["logout"]="Program Logout\xFE    CLEARSELECT\xFE    ByeBye = @ParamVar(\"returnurl\")\xFE    if !ByeBye Then\xFE        rootAct = LCase(jsbRootAct())\xFE        rootLen = Len(rootAct)\xFE        \xFE        ByeBye = Field(@LogoutUrl, '?', 1)\xFE        if left(ByeBye, rootLen) = rootAct Then ByeBye = Mid(ByeBye, rootLen + 1)\xFE        \xFE        LUrl = Field(@URL, '?', 1)\xFE        if left(LUrl, rootLen) = rootAct Then LUrl = Mid(LUrl, rootLen + 1)\xFE        if ByeBye = LURL then ByeBye = '' Else ByeBye = @LogoutUrl\xFE    End If\xFE\xFE    @SIGNOUT()\xFE    if !ByeBye Then @Server.End\xFE    if !InStr(ByeBye, \"//\") Then ByeBye = jsbRootAct() : ByeBye\xFE    @Response.redirect(ByeBye)\xFEend Program\xFE";
window.cached_jsb_tcl["logto"]="program LogTo\xFE    Dim toAccount As String = Field(Trim(@Sentence), \" \", 2)\xFE    if !toAccount Then Stop \"Logto <Account>\"\xFE    \xFE    if system(1) = \"js\" Then\xFE        if isHTA() Or window.dotNetObj Then stop window.Logto(toAccount)\xFE    else\xFE        if !accountExists(toAccount) Then Stop @Bold(toAccount):\" does not exist.\"\xFE    end if\xFE    attachdb \"\" else null\xFE    @Response.Redirect(@HtmlRoot:toAccount:\"/\")\xFEend program";
window.cached_jsb_tcl["lpics"]="Program LPics\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE    Clearselect\xFE    Open \"pics\" To Fpics Else Stop \"no pics\"\xFE    Select Fpics\xFE10: Readnext Id Else Stop\xFE    Print\xFE    Print Id\xFE    Print @Jsb_html.image(@jsbRoot:\"pics/\":Id)\xFE    Goto 10";
var z="Program Make\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = True\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    Dim Help As Array = ['MAKE <TableName> <ITEMNAMES> {(options)}']\xFE";
 z+="    \xFE";
 z+="    // ;; $include __shell\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    Prompt \"\"\xFE";
 z+="    Dim Errors As Array = []\xFE";
 z+="    DftAllItems = DftAllItems ;* Prevent not assigned warning\xFE";
 z+="    * \xFE";
 z+="    * Specific file(s) given? \xFE";
 z+="    * \xFE";
 z+="    Dim DefaultTop As String  = \"\"\xFE";
 z+="    Dim Top As String = \"\"\xFE";
 z+="    Dim Columns As String = \"\"\xFE";
 z+="    Dim Dictdata As String = \"\"\xFE";
 z+="    Dim TableName As String = \"\"\xFE";
 z+="    Dim FilterBy As String = \"\"\xFE";
 z+="    Dim OrderBY As String = \"\"\xFE";
 z+="    Dim AllItems As Boolean = False\xFE";
 z+="    Dim F_file As FileHandle = Nothing\xFE";
 z+="    \xFE";
 z+="    Dim Options As String = \"\"\xFE";
 z+="    Dim FName As String = \"\"\xFE";
 z+="    \xFE";
 z+="    if !Help Then Help = []\xFE";
 z+="    \xFE";
 z+="    If @ParseSelect(@Sentence, defaultTop, Top, Columns, Dictdata, TableName, FilterBy, OrderBY, Options, AllItems, F_file, False, IgnoreFileNotFound) Then\xFE";
 z+="        Fname = LTrim(Dictdata:\" \":TableName)\xFE";
 z+="        \xFE";
 z+="        If Fname = '' Then\xFE";
 z+="            If !IgnoreFileNotFound Then\xFE";
 z+="                If !Help Then Errors[-1] = Field(@Sentence, \" \", 1):' TableName ItemID(s) (Options' Else Errors = Help\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            If AllItems Or FilterBy = \"*\" Or (FilterBy = \"\" And DftAllItems And !System(11)) Then\xFE";
 z+="                FilterBy = \"\"\xFE";
 z+="                ClearSelect\xFE";
 z+="                Select F_file\xFE";
 z+="            Else\xFE";
 z+="                If FilterBy Then\xFE";
 z+="                    FilterBy = LTrim(RTrim(FilterBy:OrderBY))\xFE";
 z+="                    Select LTrim(Top:' '):Join(Columns, \" \") From F_file Where FilterBy Else Stop @Errors\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        dim rnIName as string\xFE";
 z+="\xFE";
 z+="    Else\xFE";
 z+="        If (TableName = '' Or TableName = '?') And Help Then Errors = Help Else Errors[-1] = @Errors\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Dim Inames As Array = []\xFE";
 z+="    Loop\xFE";
 z+="        Readnext rnIName Else Break\xFE";
 z+="    While rnIName # '' Do\xFE";
 z+="        Inames[-1] = rnIName\xFE";
 z+="    Repeat\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    clearFirst = Instr(LCase(Options), \"c\")\xFE";
 z+="  \xFE";
 z+="    If !FName Then FName = 'tmp'\xFE";
 z+="    \xFE";
 z+="    If !clearFirst Then\xFE";
 z+="        if LCase(FName) = 'tmp' then q = '*Yes,No' else q = 'Yes,*No' \xFE";
 z+="        Ans = MsgBox('Clear ':FName:' first?', q)\xFE";
 z+="        If Ans = '' Or Ans = Chr(27) Then Stop\xFE";
 z+="        If Ans = 'Yes' Then clearFirst = True\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    open FName To F_FILE else stop @Errors\xFE";
 z+="    If clearFirst Then Clearfile F_file Else stop @Errors\xFE";
 z+="    \xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        if !clearFirst then\xFE";
 z+="            read x from f_file, iname then Cycle\xFE";
 z+="        end if\xFE";
 z+="        Write Iname On F_file, Iname Else Stop @Errors\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors Then Print MonoSpace(Join(Errors, crlf()))\xFE";
 z+="End Program"
window.cached_jsb_tcl["make"]=z;
var z="Program Meta\xFE";
 z+="'\xFE";
 z+="' Generate meta structure from all records (stored in jsb_metadefs) - uses function dbTableSchema(TableName)\xFE";
 z+="'    tcl> Meta tablename\xFE";
 z+="'\xFE";
 z+="' Generate meta structure from a single CSV record (stored in jsb_metadefs) - uses function dbTableSchema(TableName)\xFE";
 z+="'    tcl> Meta tablename itemname (C\xFE";
 z+="'\xFE";
 z+="' Generate a database from the given structure: \xFE";
 z+="'    tcl> Meta tablename ... (R\xFE";
 z+="'\xFE";
 z+="' Generate \xFE";
 z+="    S = Field(@Sentence, ' (', 1)\xFE";
 z+="    Opts = UCase(Field(@Sentence, ' (', 2))\xFE";
 z+="    Reverse = InStr(Opts, \"R\")\xFE";
 z+="    forceAllowNulls = InStr(Opts, \"N\")\xFE";
 z+="    promptforname = instr(opts, \"P\")\xFE";
 z+="    csvItem = instr(opts, \"C\")\xFE";
 z+="    jsonItem = instr(opts, \"J\")\xFE";
 z+="    \xFE";
 z+="    F = DropLeft(S, ' ')\xFE";
 z+="    If !@isAdmin Then If isRestrictedFile(F) Then Stop @Errors\xFE";
 z+="    tableNames = Split(F, ' ')\xFE";
 z+="    fMeta = @fHandle(\"\", \"jsb_metadefs\", True)\xFE";
 z+="    if !tableNames then\xFE";
 z+="        if !csvItem and !jsonItem Then\xFE";
 z+="            Loop \xFE";
 z+="                readnext id else id = \" \"\xFE";
 z+="            while id <> \" \" do\xFE";
 z+="                tableNames[-1] = ltrim(rtrim(id))\xFE";
 z+="            repeat\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        if !tableNames Then\xFE";
 z+="            print \"Meta TableName\"\xFE";
 z+="            print \"   will use all items in table to generate a definition\"\xFE";
 z+="            print\xFE";
 z+="            print \"Meta TableName ItemName (C\"\xFE";
 z+="            print \"   will use all rows in the csv array ItemName to generate a definition\"\xFE";
 z+="            print\xFE";
 z+="            print \"Meta TableName (R\"\xFE";
 z+="            print \"   will previous TableName definition to generate a SQL table\"\xFE";
 z+="            stop\xFE";
 z+="        End If\xFE";
 z+="    end if\xFE";
 z+="        \xFE";
 z+="    if jsonItem Then\xFE";
 z+="        // build a json dataset from the csv\xFE";
 z+="        fSrc = Fhandle(tableNames[LBound(tableNames)])\xFE";
 z+="        ItemName = tableNames[2]\xFE";
 z+="        if !ItemName Then Stop \"An ItemName is required\"\xFE";
 z+="    \xFE";
 z+="        ReadJson ds From fSrc, ItemName Else Stop @Errors        \xFE";
 z+="        SchemaDefs = analyseJson(Ds, \"primaryKey\", False)\xFE";
 z+="    \xFE";
 z+="        ans = \"\"\xFE";
 z+="        For Each Col In SchemaDefs\xFE";
 z+="            if Col.Type = \"String\" Then \xFE";
 z+="                if ans <> \"Yes All\" Then ans = msgbox(Col.name:\" has a length of \":col.maxlength:\".  Would you like to set it to 255?\", \"Yes,No,Yes All,No All\")\xFE";
 z+="                if ans = \"No All\" Then break\xFE";
 z+="                if ans = \"Yes All\" or Ans = \"Yes\" Then Col.maxlength = 255\xFE";
 z+="            end if\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        Print AnchorEdit(\"jsb_metadefs\", ItemName, \"!\")\xFE";
 z+="        Writejson SchemaDefs On fMeta, ItemName Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    Else if csvItem Then\xFE";
 z+="        // build a json dataset from the csv\xFE";
 z+="        fSrc = Fhandle(tableNames[LBound(tableNames)])\xFE";
 z+="        ItemName = tableNames[2]\xFE";
 z+="        if !ItemName Then Stop \"An ItemName is required\"\xFE";
 z+="    \xFE";
 z+="        Read csvData From fSrc, ItemName Else Stop @Errors\xFE";
 z+="     \xFE";
 z+="        ds = convertCSV2Json(csvData, 200)\xFE";
 z+="        \xFE";
 z+="        SchemaDefs = analyseJson(Ds, \"primaryKey\", False)\xFE";
 z+="    \xFE";
 z+="        ans = \"\"\xFE";
 z+="        For Each Col In SchemaDefs\xFE";
 z+="            if Col.Type = \"String\" Then \xFE";
 z+="                if ans <> \"Yes All\" Then ans = msgbox(Col.name:\" has a length of \":col.maxlength:\".  Would you like to set it to 255?\", \"Yes,No,Yes All,No All\")\xFE";
 z+="                if ans = \"No All\" Then break\xFE";
 z+="                if ans = \"Yes All\" or Ans = \"Yes\" Then Col.maxlength = 255\xFE";
 z+="            end if\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        Print AnchorEdit(\"jsb_metadefs\", ItemName, \"!\")\xFE";
 z+="        Writejson SchemaDefs On fMeta, ItemName Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    Else\xFE";
 z+="        // Process whole tables\xFE";
 z+="        For Each TableName, TableI In tableNames\xFE";
 z+="            TableName = Trim(TableName)\xFE";
 z+="            If !TableName Then Cycle\xFE";
 z+="    \xFE";
 z+="            If Reverse Then\xFE";
 z+="                // Use the meta in jsb_metadefs to build a table\xFE";
 z+="                If @Session.AttachedDatabase = \"\" Then Stop \"Please attach to a SQL database first\"\xFE";
 z+="                Readjson ColumnDefs From fMeta, TableName Else Stop \"I wasn't able to find your jsb_metadef for this table\"\xFE";
 z+="                \xFE";
 z+="                if promptforname then TableName = InputBox(\"Create File\", \"Create file from metadefs \":TableName, TableName)\xFE";
 z+="                if TableName = \"\" or TableName = Chr(27) Then Stop\xFE";
 z+="                \xFE";
 z+="                Open TableName To sqlHandle Then \xFE";
 z+="                    if typeoffile(sqlHandle) = \"ado\" then\xFE";
 z+="                        if msgbox(typeoffile(sqlHandle):\" \":TableName:\" already exists, delete first?\", \"Yes,*No\") = \"Yes\" Then \xFE";
 z+="                            DeleteFile sqlHandle Else Print @Errors\xFE";
 z+="                        end if\xFE";
 z+="                    end if\xFE";
 z+="                end if\xFE";
 z+="                \xFE";
 z+="                If dbCreateTable(TableName, ColumnDefs, forceAllowNulls) Then Print TableName:\" created.\" Else MsgBox( @Errors )\xFE";
 z+="            Else\xFE";
 z+="                Open TableName To sqlHandle Else Stop TableName : \" not found \"\xFE";
 z+="    \xFE";
 z+="                SchemaDefs = dbTableSchema(TableName)\xFE";
 z+="                If !Len(SchemaDefs) Then Stop @Errors\xFE";
 z+="    \xFE";
 z+="                Print AnchorEdit(\"jsb_metadefs\", TableName, \"!\")\xFE";
 z+="                Writejson SchemaDefs On fMeta, TableName Else Stop @Errors\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="    end if\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="function convertCSV2Json(csvData, optional byval limit)\xFE";
 z+="        \xFE";
 z+="        csvData = Replace(csvData, \"`\", Chr(1))\xFE";
 z+="        csvData = Replace(csvData, \"'\", Chr(2))\xFE";
 z+="        \xFE";
 z+="        Csv = Split(csvData, am(), 4) // Split on crlf(), but not inside of a string\xFE";
 z+="        Ds = []\xFE";
 z+="        Keys = []\xFE";
 z+="        \xFE";
 z+="        if !limit Then Limit = UBound(csv)\xFE";
 z+="        For Each Line, csvI In Csv \xFE";
 z+="            if csvI > Limit Then break\xFE";
 z+="            \xFE";
 z+="            If csvI = 1 Then\xFE";
 z+="                Fieldnames = getCSVFields(Line)\xFE";
 z+="            Else\xFE";
 z+="                Datavalues = getCSVFields(Line)\xFE";
 z+="                Record = { primaryKey: @guid }\xFE";
 z+="                \xFE";
 z+="                For Each Fieldname, I In Fieldnames\xFE";
 z+="                    Dv = Datavalues[I]\xFE";
 z+="                    If Dv Then Record[Fieldname] = Dv Else Record[Fieldname] = Null\xFE";
 z+="                    \xFE";
 z+="                    R3 = Right(Dv, 3)\xFE";
 z+="                    If R3 = \" am()\" Or R3 = \" PM\" And Date(Dv) Then\xFE";
 z+="                        Dv = Datetime(Date(Dv))\xFE";
 z+="                        // if field(dv, \" \", 2) = \"07:00:00\" then dv = field(dv, \" \", 1)\xFE";
 z+="                        Record[Fieldname] = Dv\xFE";
 z+="                        \xFE";
 z+="                    Else If Count(Dv, \"-\") = 2 And Date(Dv) Then\xFE";
 z+="                        Record[Fieldname] = Date(Date(Dv))\xFE";
 z+="                        \xFE";
 z+="                    Else If Count(Dv, \"/\") = 2 And Date(Dv) Then\xFE";
 z+="                        Record[Fieldname] = Date(Date(Dv))\xFE";
 z+="                        \xFE";
 z+="                    ElseIf Dv = \"True\" Then\xFE";
 z+="                        Record[Fieldname] = True\xFE";
 z+="                        \xFE";
 z+="                    ElseIf Dv = \"False\" Then\xFE";
 z+="                        Record[Fieldname] = False\xFE";
 z+="                        \xFE";
 z+="                    ElseIf Val(Dv) = Dv Then\xFE";
 z+="                        Record[Fieldname] = Val(Dv)\xFE";
 z+="                        \xFE";
 z+="                    End If\xFE";
 z+="                Next\xFE";
 z+="                \xFE";
 z+="                Ds[-1] = Record\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="   return ds\xFE";
 z+="  end function\xFE";
 z+="  \xFE";
 z+="function getCSVFields(Line)\xFE";
 z+="    If Right(Line, 1) = Cr() Then Line = Left(Line, Len(Line)-1)\xFE";
 z+="    \xFE";
 z+="    Fields = Split(Line, \",\", 4) // Split on comma, but not inside of a string\xFE";
 z+="    \xFE";
 z+="    For Each Field, Fieldi In Fields\xFE";
 z+="        F = Fields[Fieldi]\xFE";
 z+="        If Instr(F, Chr(1)) Then\xFE";
 z+="            F = Replace(F, Chr(1), \"`\")\xFE";
 z+="            Fields[Fieldi] = F\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If Instr(F, Chr(2)) Then\xFE";
 z+="            F = Replace(F, Chr(2), \"'\")\xFE";
 z+="            Fields[Fieldi] = F\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If Instr(F, `\"\"`) Then\xFE";
 z+="            F = Replace(F, `\"\"`, `\"`)\xFE";
 z+="            Fields[Fieldi] = F\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    Return Fields\xFE";
 z+="End function\xFE";
 z+="    \xFE";
 z+="Program analyseJson\xFE";
 z+="'\xFE";
 z+="' Generate a json metadata structure for the given tables\xFE";
 z+="'\xFE";
 z+="    S = Field(@Sentence, ' (', 1)\xFE";
 z+="    Opts = UCase(Field(@Sentence, ' (', 2))\xFE";
 z+="    forceAllowNulls = Index(Opts, \"N\")\xFE";
 z+="    override = index(opts, \"O\")\xFE";
 z+="    \xFE";
 z+="    If !@isAdmin Then Stop \"You must be an admin to run this command\"\xFE";
 z+="    \xFE";
 z+="    F = DropLeft(S, ' ')\xFE";
 z+="    tableNames = Split(F, \" \")\xFE";
 z+="    fMeta = @fHandle(\"\", \"jsb_metadefs\", True)\xFE";
 z+="\xFE";
 z+="    For Each TableName, TableI In tableNames\xFE";
 z+="        TableName = Trim(TableName)\xFE";
 z+="        If !TableName Then Cycle\xFE";
 z+="        Open TableName To sqlHandle Else Stop @Errors\xFE";
 z+="        \xFE";
 z+="        Dataset = Fselect(TableName, 'ItemID,*')\xFE";
 z+="        if !Len(DataSet) Then Stop 'No records found to analyse'\xFE";
 z+="        \xFE";
 z+="        Pk = \"\"\xFE";
 z+="        Readjson ColumnDefs From fHandle('jsb_metadefs'), TableName Then\xFE";
 z+="            for each c in ColumnDefs\xFE";
 z+="               if c.primarykey then\xFE";
 z+="                   pk = c.name\xFE";
 z+="                   break\xFE";
 z+="                end if\xFE";
 z+="            next\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        /*\xFE";
 z+="            if !pk Then \xFE";
 z+="                if Len(ColumnDefs) = 1 then\xFE";
 z+="                    c = ColumnDefs[1]\xFE";
 z+="                    pk = c.name\xFE";
 z+="                else\xFE";
 z+="                    pk = InputBox(\"Primary Key\", \"What is the primary key for table: \":TableName, \"\")\xFE";
 z+="                    if pk = \"\" or pk = chr(27) then stop\xFE";
 z+="                end if\xFE";
 z+="            end if\xFE";
 z+="        */\xFE";
 z+="        \xFE";
 z+="        Ana = analyseJson(Dataset, pk, forceAllowNulls)\xFE";
 z+="        print \"[\":\xFE";
 z+="        For Each Row In Ana\xFE";
 z+="            Row = Row:\",\"\xFE";
 z+="            Print Row\xFE";
 z+="        Next\xFE";
 z+="        Print \"]\"\xFE";
 z+="        \xFE";
 z+="        if !override then\xFE";
 z+="            Readjson ColumnDefs From fHandle('jsb_metadefs'), TableName Then\xFE";
 z+="                If Msgbox('there is already a definition in jsb_metadefs, overwrite it?', \"Yes,No\") <> 'Yes' Then Stop\xFE";
 z+="            End If\xFE";
 z+="        end if\xFE";
 z+="        Writejson Ana On fHandle('jsb_metadefs'), TableName Else Stop @Errors\xFE";
 z+="        Print AnchorEdit(\"jsb_metadefs\", TableName, \"!\")\xFE";
 z+="    Next\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="\xFE";
 z+=""
window.cached_jsb_tcl["meta"]=z;
window.cached_jsb_tcl["muld"]="Program MULD\xFE* Decimal multiply\xFE      A = FIELD(@SENTENCE,' ',2)\xFE      B = FIELD(@SENTENCE,' ',3)\xFE      IF NOT(NUM(A)) OR NOT(NUM(B)) THEN STOP\xFE      PRINT A * B\xFE      CLEARSELECT";
window.cached_jsb_tcl["mulx"]="Program MULX\xFE* Hex multiply\xFE      A = FIELD(@SENTENCE,' ',2)\xFE      B = FIELD(@SENTENCE,' ',3)\xFE      PRINT DTX(XTD(A) * XTD(B))\xFE      CLEARSELECT";
var z="Program Nightly_http\xFE";
 z+="*$options aspx\xFE";
 z+="    Debugging = False\xFE";
 z+="    allowRedirect = False\xFE";
 z+="    \xFE";
 z+="    If !Debugging Then preventTimeOut = System(56)\xFE";
 z+="    \xFE";
 z+="    UrlAddress2Schedule = jsbConfig('nightly_http')\xFE";
 z+="    firstDelay = 1\xFE";
 z+="    XminutesFromNow = firstDelay\xFE";
 z+="    finalRedirectUrl = \"\"\xFE";
 z+="    \xFE";
 z+="    Log = 'nightly_http scheduler started'\xFE";
 z+="    If Debugging Then Print Log Else Loginfo(Log)\xFE";
 z+="    \xFE";
 z+="    Cnt = 0\xFE";
 z+="    For Each Address In UrlAddress2Schedule\xFE";
 z+="        Address = LTrim(Address)\xFE";
 z+="        If Address Then\xFE";
 z+="            Url = LTrim(DropIfLeft(Address, \",\"))\xFE";
 z+="            LUrl = LCase(Url)\xFE";
 z+="            Cmd = Field(Field(LUrl, \":\", 1), \" \", 1)\xFE";
 z+="            \xFE";
 z+="            If Left(Cmd, 1) = \"*\" Or Cmd = \"loginfo\" Then\xFE";
 z+="                // comments\xFE";
 z+="                Address = LTrim(Mid(Address, 2))\xFE";
 z+="                metaCmd = Field(Address, \" \", 1)\xFE";
 z+="                If metaCmd = \"loginfo\" Then\xFE";
 z+="                    Address = Dropleft(Address, \" \")\xFE";
 z+="                    If Debugging Then Print Address Else Loginfo(Address)\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="            ElseIf Cmd = \"http\" Or Cmd = \"https\" Then\xFE";
 z+="                If allowRedirect And !finalRedirectUrl Then\xFE";
 z+="                    finalRedirectUrl = Url\xFE";
 z+="                Else\xFE";
 z+="                    Schedule Url In XminutesFromNow\xFE";
 z+="                    Cnt += 1\xFE";
 z+="                    Log = Cnt:': nightly_http schedueled ':Url:' in ':XminutesFromNow\xFE";
 z+="                    If Debugging Then Print Log Else Loginfo(Log)\xFE";
 z+="                    \xFE";
 z+="                    runningTime = Val(Field(Address, \",\", 1))\xFE";
 z+="                    If runningTime <= 0 Then runningTime = 0.2\xFE";
 z+="                    XminutesFromNow += runningTime\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="            ElseIf Url Then\xFE";
 z+="                Err = '[jsb_config nightly_http] bad line: ':Url\xFE";
 z+="                If Debugging Then Print Err Else logErr(Err)\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If allowRedirect And finalRedirectUrl Then\xFE";
 z+="        Log = '1: nightly_http scheduler finished and redirecting to ':finalRedirectUrl\xFE";
 z+="        If Debugging Then Print Log Else Loginfo(Log)\xFE";
 z+="        \xFE";
 z+="        @Response.redirect(finalRedirectUrl)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    logInfo('nightly_http scheduler finished')\xFE";
 z+="End Program"
window.cached_jsb_tcl["nightly_http"]=z;
window.cached_jsb_tcl["off"]="Program Off\xFE    CLEARSELECT\xFE    ByeBye = @ParamVar(\"returnurl\")\xFE    if !ByeBye Then\xFE        rootAct = LCase(jsbRootAct())\xFE        rootLen = Len(rootAct)\xFE        \xFE        ByeBye = Field(@LogoutUrl, '?', 1)\xFE        if left(ByeBye, rootLen) = rootAct Then ByeBye = Mid(ByeBye, rootLen + 1)\xFE        \xFE        LUrl = Field(@URL, '?', 1)\xFE        if left(LUrl, rootLen) = rootAct Then LUrl = Mid(LUrl, rootLen + 1)\xFE        if ByeBye = LURL then ByeBye = '' Else ByeBye = @LogoutUrl\xFE    End If\xFE\xFE    @SIGNOUT()\xFE    if !ByeBye Then @Server.End\xFE    if !InStr(ByeBye, \"//\") Then ByeBye = jsbRootAct() : ByeBye\xFE    @Response.redirect(ByeBye)\xFEend Program\xFE";
var z="Program Phonegap\xFE";
 z+="    *$options aspx, aspxc-\xFE";
 z+="\xFE";
 z+="\xFE";
 z+="    Print @Anchor(\"https://build.phonegap.com/apps\", \"Adobe/Cordova PhoneGap Build\")\xFE";
 z+="    projectName = @jsbAccount\xFE";
 z+="    lcProjectName = lcase(projectName)\xFE";
 z+="    Options = field(LCase(Field(@Sentence, \"(\", 2)), \"!\", 1)\xFE";
 z+="    \xFE";
 z+="    // We start with JSB.HTML and morph it into the necessary ProjectName.HTML\xFE";
 z+="    \xFE";
 z+="    If @Domain = \"jsbwinforms.azurewebsites.net\" And lcProjectName = \"sysprog\" then\xFE";
 z+="        isJSB = True\xFE";
 z+="        projectName = \"JSB\"\xFE";
 z+="        lcProjectName = \"jsb\" \xFE";
 z+="        htmlPageName = \"sysprog\"\xFE";
 z+="        if options and Options <> \"d\" then \xFE";
 z+="            projectName = options\xFE";
 z+="            lcProjectName = lcase(projectName)\xFE";
 z+="            htmlPageName = lcProjectName\xFE";
 z+="        end if\xFE";
 z+="    else\xFE";
 z+="        htmlPageName = lcProjectName\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    If !Isadmin() Then\xFE";
 z+="        Sneak = @urlParam(\"overRide\")\xFE";
 z+="        Read Override From fHandle('tmp'), 'overRide' Else OverRide = ''\xFE";
 z+="        Delete fHandle('tmp'), 'overRide' Else Stop @Errors\xFE";
 z+="        If Sneak <> OverRide Or Sneak = \"\" Then Stop \"you must be an admin to run this command\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    fMD2 = @fHandle(`.\\jsb`)\xFE";
 z+="    \xFE";
 z+="    If Options = \"d\" Then Goto Downloadonly\xFE";
 z+="   \xFE";
 z+="    /////////////////////////////////////////////////////////////////////////////////////////////////\xFE";
 z+="    //  Make sure we can write file\xFE";
 z+="    /////////////////////////////////////////////////////////////////////////////////////////////////\xFE";
 z+="    Write '' On @fHandle('.'), lcProjectName:'.zip' Else\xFE";
 z+="        OverRide = @Guid\xFE";
 z+="        Write OverRide On fHandle('tmp'), 'overRide' Else Stop @Errors\xFE";
 z+="        @@dosExecute(Mappath(\"/\"):\"bin\", `copy 7z.exe tmp.exe /Y`, Errs)\xFE";
 z+="        @Response.Redirect(jsbRootExecute(`phonegap?overRide=`:OverRide))\xFE";
 z+="    End If\xFE";
 z+="    Delete @fHandle('.'),  lcProjectName:'.zip' Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    /////////////////////////////////////////////////////////////////////////////////////////////////\xFE";
 z+="    // Update CONFIG.XML\xFE";
 z+="    /////////////////////////////////////////////////////////////////////////////////////////////////\xFE";
 z+="    Read Config From fMD2, \"config.xml\" Else Stop \"no jsb config.xml which is required for phonegap\"\xFE";
 z+="    \xFE";
 z+="    // Do Version #\xFE";
 z+="    Rel = Dropleft(Config, `versionCode=\"`)\xFE";
 z+="    Rel = fieldLeft(Rel, `\"`)\xFE";
 z+="    Config = Replace(Config, `versionCode=\"`:Rel:`\"`, `versionCode=\"`:Rel+1:`\"`)\xFE";
 z+="    Config = Replace(Config, `version=\"0.0.`:Rel:`\"`, `version=\"0.0.`:Rel+1:`\"`)\xFE";
 z+="    \xFE";
 z+="    // Do widget id\xFE";
 z+="    oldWidgetName = Dropleft(Config, `id=\"`)\xFE";
 z+="    oldWidgetName = Field(oldWidgetName, '\"', 1)\xFE";
 z+="    if !oldWidgetName then stop \"No <widget id> in config.xml\"\xFE";
 z+="    Config = Replace(Config, oldWidgetName, \"com.jsonbasic.\":lcProjectName)\xFE";
 z+="    \xFE";
 z+="    // do ICON\xFE";
 z+="    oldICON = outerHTML(config, \"icon\")\xFE";
 z+="    if !oldICON Then Stop \"no <icon> tag in config.xml\"\xFE";
 z+="    Config = Replace(Config, oldICON, `<icon src=\"pics/`:lcProjectName:`.png\" />`)\xFE";
 z+="    \xFE";
 z+="    // do splash\xFE";
 z+="    oldSplash = outerHTML(config, \"splash\")\xFE";
 z+="    if !oldSplash Then Stop \"no <splash> tag in config.xml\"\xFE";
 z+="    Config = Replace(Config, oldSplash, `<splash src=\"pics/Default@2x~universal~`:lcProjectName:`.png\" />`)\xFE";
 z+="    \xFE";
 z+="    // do Name\xFE";
 z+="    oldName = outerHTML(config, `name`)\xFE";
 z+="    if !oldName Then Stop \"no <name> tag in config.xml\"\xFE";
 z+="    Config = Replace(Config, oldName, \"<name>\":projectName:\"</name>\")\xFE";
 z+="    \xFE";
 z+="    // do Startup Page (content)\xFE";
 z+="    oldContent = outerHTML(config, `content`)\xFE";
 z+="    if !oldContent Then Stop \"no <content> tag in config.xml\"\xFE";
 z+="    Config = Replace(Config, oldContent, `<content src=\"`:lcProjectName:`.html\" />`)\xFE";
 z+="\xFE";
 z+="    Write Config On fMD2, \"config.xml\" Else Stop @Errors\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    /////////////////////////////////////////////////////////////////////////////////////////////////\xFE";
 z+="    // Deal with creating a new ProjectName.HTML\xFE";
 z+="    /////////////////////////////////////////////////////////////////////////////////////////////////\xFE";
 z+="    \xFE";
 z+="    read projectHTML from fMD2, htmlPageName:\".html\" else\xFE";
 z+="        Read projectHTML From fMD2, \"tcl.html\" Else Stop \"no jsb tcl.html source\"\xFE";
 z+="    \xFE";
 z+="        tag = \"!-- this file\"; tagValue = \"!-- this file was generated from the original tcl.html --\"; gosub changeTag\xFE";
 z+="        tag = `link rel='shortcut icon'`; tagValue = `link rel='shortcut icon' href=\"./pics/`:projectName:`.ico\"`; gosub changeTag\xFE";
 z+="\xFE";
 z+="        // Change RPC URL\xFE";
 z+="        tag = \"myRpcUrl\"; tagValue = @jsbRootAct; gosub changeVar\xFE";
 z+="        \xFE";
 z+="        MsgBox(htmlPageName:\".html created (from tcl.html)\")\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    // You don't get to change these\xFE";
 z+="    projectHTML = Replace(projectHTML, \"/sysprog/\", \"/\":htmlPageName:\"/\")\xFE";
 z+="    projectHTML = Replace(projectHTML, \"_sysprog_\", \"_\":htmlPageName:\"_\")\xFE";
 z+="    \xFE";
 z+="    tag = \"myTitle\"; tagValue = projectName; gosub changeVar\xFE";
 z+="    \xFE";
 z+="    // change <title> tag\xFE";
 z+="    oldTitle = outerHTML(projectHTML, `title`)\xFE";
 z+="    if !oldTitle Then Stop \"no <Title> tag in jsb.html\"\xFE";
 z+="    projectHTML = Replace(projectHTML, oldTitle, \"<title>\":UCase(left(projectName, 1)):Mid(projectName, 2):\"</title>\")\xFE";
 z+="   \xFE";
 z+="    // Bump myVersion\xFE";
 z+="    tag = \"myVersion\"; tagValue = \"0.0.\":Rel+1; gosub changeVar\xFE";
 z+="    \xFE";
 z+="    // bump ?cacheBuster=xxxxxx\xFE";
 z+="    For C = 1 To Count(projectHTML, `?cacheBuster=`)\xFE";
 z+="        I = Index(projectHTML, `?cacheBuster=`, C)\xFE";
 z+="        J = Instr(I, projectHTML, `!`)\xFE";
 z+="        If !J Then Stop 'Missing ! after ?cacheBuster='\xFE";
 z+="        projectHTML = Left(projectHTML, I-1):\"?cacheBuster=\":Rel+1:Mid(projectHTML, J)\xFE";
 z+="    Next C\xFE";
 z+="\xFE";
 z+="    Write projectHTML On fMD2, htmlPageName:\".html\" Else Stop @Errors\xFE";
 z+="\xFE";
 z+="    // ==================================== ZIP THE DIRECTORY using phonegap.bat ==================================== \xFE";
 z+="    Print \"Zipping up... \":lcProjectName:\".zip (launch page is \":@anchorEdit(\"jsb\", lcProjectName:\".html\"):\")\"\xFE";
 z+="    @Server.flush\xFE";
 z+="   \xFE";
 z+="    cd = @JSBRootDir\xFE";
 z+="    Cmd = \"phonegap.bat \" : lcProjectName:'.zip'\xFE";
 z+="\xFE";
 z+="    s = executedos(left(cd, 2):' & cd \"':cd:'\" & echo -!-begin-!- & ':cmd:' & echo -!-newcd-!- & cd')\xFE";
 z+="    I = Instr(S, \"-!-newcd-!\")\xFE";
 z+="    Result = Field(S, \"-!-newcd-!-\", 1)\xFE";
 z+="    Result = Trimws(Field(Result, \"-!-begin-!-\", 2))\xFE";
 z+="  \xFE";
 z+="    Result = Replace(Result, Chr(13):Chr(10), Chr(254))\xFE";
 z+="    Result = Replace(Result, Chr(13), Chr(254))\xFE";
 z+="    Result = Replace(Result, Chr(10), Chr(254))\xFE";
 z+="    Print Replace(Result, Chr(254), Chr(13):Chr(10))\xFE";
 z+="   \xFE";
 z+="    Read Results From fHandle('.'), 'results.txt' Else Msgbox(@Errors)\xFE";
 z+="    If Instr(Results, 'Error:') Then Stop Field(Results, 'Error:', 2)\xFE";
 z+="\xFE";
 z+="    // ==================================== DOWNLOAD ZIP ==================================== \xFE";
 z+="DownloadOnly: \xFE";
 z+="    Print\xFE";
 z+="    Print @Anchor(\"https://build.phonegap.com/apps\", \"Adobe/Cordova PhoneGap Build\")\xFE";
 z+="    Print\xFE";
 z+="   \xFE";
 z+="    * Cause GAE to flush\xFE";
 z+="    B = @Response.buffer()\xFE";
 z+="    Print @Script(`windowOpen(\"`:@htmlRoot:lcProjectName:'.zip':`?cachebuster=`:@Guid:`\", '_blank');`):\xFE";
 z+="\xFE";
 z+="    @Server.flush\xFE";
 z+="    X = @Response.buffer(B)\xFE";
 z+="    stop\xFE";
 z+="    \xFE";
 z+="changeVar:\xFE";
 z+="    I = Instr(projectHTML, `var `:tag:` = \"`)\xFE";
 z+="    If !I Then Stop \"Missing var `:tag:` in `:lcProjectName:`.html\"\xFE";
 z+="    I = Instr(I, projectHTML, `\"`)\xFE";
 z+="    J = Instr(I+1, projectHTML, `\"`)\xFE";
 z+="    projectHTML = Left(projectHTML, I):tagValue:Mid(projectHTML, J)\xFE";
 z+="    return\xFE";
 z+="    \xFE";
 z+="changeTag:\xFE";
 z+="    I = Instr(projectHTML, `<`:tag)\xFE";
 z+="    If !I Then Stop \"Missing tag `:tag:` in `:lcProjectName:`.html\"\xFE";
 z+="    J = Instr(I+1, projectHTML, `>`)\xFE";
 z+="    projectHTML = Left(projectHTML, I):tagValue:Mid(projectHTML, J)\xFE";
 z+="    return\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+=""
window.cached_jsb_tcl["phonegap"]=z;
var z="Program Post\xFE";
 z+="        \xFE";
 z+="   If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="   adr = trim(field(@sentence, \"(\", 1))\xFE";
 z+="   body = lcase(field(@sentence, \"(\", 2))\xFE";
 z+="   i = index(adr, \" \", 1)\xFE";
 z+="   if i = 0 then \xFE";
 z+="      print \"POST http://addr (body\"\xFE";
 z+="      stop\xFE";
 z+="   end if\xFE";
 z+="*\xFE";
 z+="   URL = ltrim(mid(adr, i))\xFE";
 z+="*\xFE";
 z+="   print url\xFE";
 z+="   doc = @jsb_bf.Get(URL, \"POST\", Header, Body, \"\")\xFE";
 z+="*\xFE";
 z+="   Header= replace(Header, chr(10), \"\")\xFE";
 z+="   doc = replace(doc, chr(10), \"\")\xFE";
 z+="*\xFE";
 z+="   print \"=========== Header ==================\"\xFE";
 z+="   print Replace(field(header, \"<html\", 1), Chr(254), crlf())\xFE";
 z+="   print \"=====================================\"\xFE";
 z+="   if instr(doc, chr(13)) = 0 then doc = replace(doc, chr(10), chr(13))  \xFE";
 z+="   if doc = \"\" then stop @Errors         \xFE";
 z+="*\xFE";
 z+="   Print \"Length of \":Len(DOC)\xFE";
 z+="   * print doc\xFE";
 z+="  *\xFE";
 z+="   if Left(doc, 1) = \"{\" then\xFE";
 z+="      If @MsgBox(\"GET\", \"Show JSON?\", \"Yes,No\") <> \"Yes\" Then Stop \xFE";
 z+="      result = json(doc)\xFE";
 z+="   end else\xFE";
 z+="      If @MsgBox(\"GET\", \"Show HTML?\", \"Yes,No\") <> \"Yes\" Then Stop \xFE";
 z+="      result = xml(doc)\xFE";
 z+="   end if\xFE";
 z+="      \xFE";
 z+="   stop result\xFE";
 z+="                                  "
window.cached_jsb_tcl["post"]=z;
window.cached_jsb_tcl["primarykeys"]="Program PrimaryKeys\xFE    flist = fileList()\xFE    r = {}\xFE    for each fname in flist\xFE        r.fname = fname\xFE        r.primarykey =  primarykeyname(fname)\xFE        print r.fname, r.primarykey\xFE        @server.flush\xFE    next\xFEend program";
var z="Program Print\xFE";
 z+="    if @IsAdmin else Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    if system(11) then\xFE";
 z+="        js = JSON(system(11))\xFE";
 z+="        SelectedItemIDs = js.SelectedItemIDs\xFE";
 z+="        SelectedItems = js.SelectedItems\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    s = Field(@sentence[index(@sentence, ' ', 1)+1, 9999], \"(!\", 1)\xFE";
 z+="    \xFE";
 z+="    write \"Program PR\":am():\"PRINT \":s on @fHandle(\"\", \"tmp\", True), 'pr'\xFE";
 z+="    execute \"basic tmp pr\" capturing x\xFE";
 z+="    \xFE";
 z+="    if js then\xFE";
 z+="        rs = { SelectedItemIDs: SelectedItemIDs }\xFE";
 z+="        rs.SelectedItems = SelectedItems\xFE";
 z+="        rs.OnlyReturnItemIDs = js.OnlyReturnItemIDs\xFE";
 z+="        \xFE";
 z+="        formlist rs\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if instr(x, \"bytes\") then execute \"run tmp pr\" else print x\xFE";
 z+="end Program\xFE";
 z+="\xFE";
 z+="Program SetComp\xFE";
 z+="    if @IsAdmin else Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    S = @Sentence\xFE";
 z+="    toName = Field(S, ' ', 2)\xFE";
 z+="    if !toName Then Stop 'setComp name basic statement'\xFE";
 z+="    \xFE";
 z+="    S = \"Execute `\":S[index(S, ' ', 2)+1, 9999]:\"`\"\xFE";
 z+="    \xFE";
 z+="    write \"Program \":toName:am():S on @fHandle(\"\", \"jsb_comps\", True), toName\xFE";
 z+="    execute \"basic jsb_comps \":toName capturing x\xFE";
 z+="    \xFE";
 z+="    Print @Html(`<button type='button' class='btn btn-primary' onclick='appendKey(\"`:toName:`\" + Chr(13));'>`:toName:`</button>`)\xFE";
 z+="    \xFE";
 z+="    if instr(x, \"bytes\") then execute \"run tmp pr\" else print x\xFE";
 z+=""
window.cached_jsb_tcl["print"]=z;
var z="program profile\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    if system(64) and !InStr(system(64), \"-\") then \xFE";
 z+="        call profileStop(0, false)\xFE";
 z+="        stop\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Sent = @Sentence\xFE";
 z+="    cmd = field(Sent, \" \", 2)\xFE";
 z+="    if cmd = \"?\" then stop 'profile tcl_command (>detailsub'\xFE";
 z+="    \xFE";
 z+="    s = DropLeft(Sent, ' ')\xFE";
 z+="    x = system(63) ' Reset\xFE";
 z+="    @Session('gets') = []\xFE";
 z+="    \xFE";
 z+="    if instr(Sent, \"(>\") then \xFE";
 z+="        WhichPgm = Field(Sent, \"(>\", 2)\xFE";
 z+="        if !WhichPgm Then\xFE";
 z+="            LastSubName = @Session(\"LastDetailSubName\")\xFE";
 z+="            WhichPgm = InputBox(\"Sub Name\", LastSubName)\xFE";
 z+="            if WhichPgm = \"\" Or WhichPgm = Chr(27) Then Stop\xFE";
 z+="        End If\xFE";
 z+="        @Session(\"LastDetailSubName\") = WhichPgm\xFE";
 z+="        isDetail = true\xFE";
 z+="        x = system(\"60,\":WhichPgm)\xFE";
 z+="    else\xFE";
 z+="        isDetail = false\xFE";
 z+="        x = System(60) ' Start\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    startTimer = timer()\xFE";
 z+="    if s then \xFE";
 z+="        execute s\xFE";
 z+="        call profileStop(startTimer,isDetail)\xFE";
 z+="    else\xFE";
 z+="        print \"Profiling started, press \": inputButton(\"profileStop\" : chr(13)) : \" to stop\"\xFE";
 z+="    end if\xFE";
 z+="end program\xFE";
 z+="\xFE";
 z+="program profileStop\xFE";
 z+="   if !system(64) And InStr(system(64), \"-\") = 0 then stop \"You aren't profiling\"\xFE";
 z+="   call profileStop(0, false)\xFE";
 z+="end program\xFE";
 z+="\xFE";
 z+="sub profileStop(byval startTime, byval isDetail)\xFE";
 z+="    x = system(61) ' Profiling stopped\xFE";
 z+="    Sent = @Sentence\xFE";
 z+="    \xFE";
 z+="    if startTime then totalTimer = timer() - startTime\xFE";
 z+="    \xFE";
 z+="    stats = system(62)\xFE";
 z+="    if !stats then stop 'no stats'\xFE";
 z+="    \xFE";
 z+="    Mydata = []\xFE";
 z+="    for each stat in split(stats, am())\xFE";
 z+="        stat = split(stat, vm())\xFE";
 z+="        newstat = {}\xFE";
 z+="        fName = field(stat(1), \"|\", 1)\xFE";
 z+="        iName = field(stat(1), \"|\", 2)\xFE";
 z+="        lineNo = field(stat(1), \"|\", 3)\xFE";
 z+="        if instr(iName, \"'\") then Q = '\"' Else Q = \"'\"\xFE";
 z+="        \xFE";
 z+="        if lineNo Then \xFE";
 z+="            newstat.lineNo = LineNo \xFE";
 z+="            path = @jsbRootExecuteTclCmd(\"ED \":fname:` `:Q:iName:Q):` (`:LineNo\xFE";
 z+="            newstat.fName = fName :' ': iName\xFE";
 z+="            newstat.iName = LineNo     \xFE";
 z+="            \xFE";
 z+="        else\xFE";
 z+="            path = @jsbRootExecuteTclCmd(Sent):` (>`:iname\xFE";
 z+="            newstat.fName = fName \xFE";
 z+="            newstat.iName = iName      \xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        newstat.avg = stat(2)\xFE";
 z+="        newstat.Link = Path \xFE";
 z+="        newstat.time = stat(3)\xFE";
 z+="        newstat.calls = stat(4)\xFE";
 z+="        Mydata[-1] = newstat\xFE";
 z+="    next\xFE";
 z+="\xFE";
 z+="    myOptions = { width100percent: true }\xFE";
 z+="    myOptions.sortname = \"avg\"\xFE";
 z+="    myOptions.sortorder = \"desc\"\xFE";
 z+="    if lineNo Then myOptions.caption = fName:' ':iName\xFE";
 z+="    \xFE";
 z+="    MetaData = []\xFE";
 z+="    MetaData[-1] = { \"name\": \"fName\", \"index\": \"fName\", \"label\": \"Source\", \"width\": 150}\xFE";
 z+="    if isDetail then\xFE";
 z+="        MetaData[-1] = { \"name\": \"iName\", \"index\": \"iName\", \"label\": \"Line No\", \"width\": 150}\xFE";
 z+="    else\xFE";
 z+="        MetaData[-1] = { \"name\": \"iName\", \"index\": \"iName\", \"label\": \"IName\", \"width\": 150}\xFE";
 z+="    end if\xFE";
 z+="    MetaData[-1] = { \"name\": \"avg\", \"index\": \"avg\", \"label\": \"Avg\", \"width\": 80, \"datatype\": \"integer\" }\xFE";
 z+="    MetaData[-1] = { \"name\": \"time\", \"index\": \"time\", \"label\": \"Time\", \"width\": 80, \"datatype\": \"integer\"}\xFE";
 z+="    MetaData[-1] = { \"name\": \"calls\", \"index\": \"calls\", \"label\": \"Calls\", \"width\": 80, \"datatype\": \"integer\" }\xFE";
 z+="    MetaData[-1] = { \"name\": \"Link\", \"index\": \"Link\", \"label\": \"Link\", \"width\": 446, \"control\": \"url\", \"sortable\": false}\xFE";
 z+="    \xFE";
 z+="    Print @(-1):@Div('', @jqGrid(\"myID\", Mydata, MetaData, myOptions) , { style: 'height: 400px' }) \xFE";
 z+="    \xFE";
 z+="    if totalTimer then print \"Total time \":@DropIfRight(totalTimer, \".\") / 1000:\" seconds\"\xFE";
 z+="    \xFE";
 z+="    gets = @userVar('gets')\xFE";
 z+="    if gets then\xFE";
 z+="        print join(gets, crlf())\xFE";
 z+="        @userVar('gets', '')\xFE";
 z+="    end if\xFE";
 z+="end sub\xFE";
 z+="    "
window.cached_jsb_tcl["profile"]=z;
window.cached_jsb_tcl["pwd"]="Program Pwd\xFE     attachdb \"\" else null\xFE     \xFE    Cd = @JSBRootDir\xFE    Cd = Replace(Cd, \"file:///\", \"\")\xFE    Cd = Replace(Cd, `/`, `\\`)\xFE    if right(cd, 1) = `\\` then cd = left(cd, len(cd)-1)\xFE\xFE    cd2 = System(26) \xFE    Cd2 = Replace(Cd2, \"file:///\", \"\")\xFE    Cd2 = Replace(Cd2, `/`, `\\`)\xFE    if right(cd2, 1) = `\\` then cd2 = left(cd2, len(cd2)-1)\xFE    \xFE    \xFE    // if cd2 <> cd then cd2 = dropifright(cd2, `\\`)\xFE    if cd2 = cd then cd2 = \"\"\xFE    \xFE    DNO = false\xFE    if system(1) = \"js\" then If window.dotNetObj Then DNO = True\xFE    if DNO Then\xFE        cd = Anchor(\"file:///\" : cd, cd,  { target: \"_blank\" } )\xFE        if cd2 then cd2 = Anchor(\"file:///\" : cd2, cd2, { target: \"_blank\" } )\xFE    end if\xFE    \xFE    print cd\xFE    if cd2 then print cd2\xFE    \xFE    Clearselect\xFEend Program\xFE";
var z="program reset\xFE";
 z+="    if system(1) = \"aspx\" Then stop \"No reset is possible from aspx versions\"\xFE";
 z+="    \xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    if system(1) = \"js\" then \xFE";
 z+="        if msgbox(`Do you want to reset the jsb_dictionaries?`, '*Yes,No') = \"Yes\" Then \xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_tcl', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_bf', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_html', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_mdl', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_themes', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb2js', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_odb', true) Else Alert(@Errors)\xFE";
 z+="        \xFE";
 z+="            i_delete fhandle('jsb_cache'), 'postloads' Else Alert(@Errors)\xFE";
 z+="            window.location.reload()\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if system(1) = \"gae\" then \xFE";
 z+="        if msgbox(`Do you want to reset the jsb_* System files (if you made any local changes they will be lost)?`, 'Yes,*No') = \"Yes\" Then \xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_tcl', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_bf', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_html', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_mdl', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_themes', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb2js', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_examples', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_docs', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_demos', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('dict', 'jsb_ctls', true) Else Alert(@Errors)\xFE";
 z+="            \xFE";
 z+="            i_clearfile fhandle('', 'jsb_tcl', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_bf', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_html', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_cache', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_mdl', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_themes', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb2js', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_examples', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_docs', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_demos', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_ctls', true) Else Alert(@Errors)\xFE";
 z+="            \xFE";
 z+="            i_clearfile fhandle('', 'jsb_pagetemplates', true) Else Alert(@Errors)\xFE";
 z+="            i_clearfile fhandle('', 'jsb_viewtemplates', true) Else Alert(@Errors)\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        print \"Do you wish to clear the entire datastore? (Yes, No,Cancel, MD only) \":\xFE";
 z+="        input ans\xFE";
 z+="        ans = lcase(left(ans,1))\xFE";
 z+="        if ans = \"c\" then stop\xFE";
 z+="        if ans = \"y\" then\xFE";
 z+="           i_listfiles to flist then\xFE";
 z+="              for each fname in flist\xFE";
 z+="                    Loop I_ClearFile \"0\":fname Then Break while InStr(@Errors, \"retry:\") Do @Server.Flush Repeat\xFE";
 z+="                    i_deletefile \"0\":fname else print @errors\xFE";
 z+="                    if fname <> \"jsb_tcl\" then \xFE";
 z+="                       i_deletefile \"0\":fname:\".dct\" else print @errors\xFE";
 z+="                       Loop I_ClearFile \"0\":fname:\".dct\" Then Break while InStr(@Errors, \"retry:\") Do @Server.Flush Repeat\xFE";
 z+="                    end if\xFE";
 z+="                    print fname\xFE";
 z+="                    @server.flush\xFE";
 z+="              next\xFE";
 z+="           end if\xFE";
 z+="        end if\xFE";
 z+="                \xFE";
 z+="        execute \"clear-cache\"\xFE";
 z+="    end if\xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["reset"]=z;
window.cached_jsb_tcl["resetdb"]="program resetdb\xFE*$options js\xFE@response.redirect(field(field(@url, \"?\", 1), \"#\", 1):\"#resetdb\")\xFE";
var z="*program run\xFE";
 z+="*\xFE";
 z+="*$options js\xFE";
 z+="*$options nodebug\xFE";
 z+="*$options external singleStepping\xFE";
 z+="*$options external me\xFE";
 z+="*$options external function loadCode(code, id)\xFE";
 z+="*\xFE";
 z+="    me._dontDisplayInStack = 1\xFE";
 z+="    S = TRIM(@SENTENCE)\xFE";
 z+="    FNAME = FIELD(S, \" \", 2)\xFE";
 z+="    INAME = FIELD(S, \" \", 3)\xFE";
 z+="    IF INSTR(S, \"(\") THEN OPTS = FIELD(S, \"(\", 2) ELSE OPTS = FIELD(S, \"[\", 2)\xFE";
 z+="    OPTS = UCASE(OPTS)\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    IF UCASE(FNAME) = \"DICT\" THEN\xFE";
 z+="        FNAME = FNAME:\" \":INAME\xFE";
 z+="        INAME = FIELD(S, \" \", 4)\xFE";
 z+="    END IF\xFE";
 z+="\xFE";
 z+="    Open \"MD\" to fMD else stop @errors\xFE";
 z+="    OFNAME = FNAME\xFE";
 z+="    FNAME = TRUETableName(FNAME)\xFE";
 z+="\xFE";
 z+="    PGM = makeSubName(mcu(FNAME)):\"_\":makeSubName(mcu(INAME))\xFE";
 z+="\xFE";
 z+="    IF EVAL(\"typeof(\":PGM:\")\") = \"undefined\" THEN\xFE";
 z+="        open \"DICT\", OFNAME TO FRUN THEN\xFE";
 z+="            Read SRC FROM FRUN, INAME:\".js\" THEN\xFE";
 z+="                a = CHANGE(SRC, am(), CHR(13))\xFE";
 z+="                loadCode(a, NULL)\xFE";
 z+="            END IF\xFE";
 z+="        ELSE\xFE";
 z+="            FRUN = NULL\xFE";
 z+="        END IF\xFE";
 z+="        IF EVAL(\"typeof(\":PGM:\")\") = \"undefined\" THEN\xFE";
 z+="            IF FRUN THEN\xFE";
 z+="                PRINT \"Unable to find or load javascript code for \":PGM\xFE";
 z+="            ELSE\xFE";
 z+="                PRINT \"Unable to open DICT \":OFNAME\xFE";
 z+="            END IF\xFE";
 z+="        ELSE\xFE";
 z+="            IF INSTR(OPTS, \"#\") OR INSTR(OPTS, \"D\") THEN singleStepping = 1\xFE";
 z+="            PGM = makeSubName(mcu(FNAME)):\".\":makeSubName(mcu(INAME)) ;* CALLBYNAME needs the period in it\xFE";
 z+="            CALLBYNAME PGM\xFE";
 z+="        END IF\xFE";
 z+="    Else\xFE";
 z+="        PGM = makeSubName(mcu(FNAME)):\".\":makeSubName(mcu(INAME))\xFE";
 z+="        CALLBYNAME PGM\xFE";
 z+="    End If\xFE";
 z+="    "
window.cached_jsb_tcl["run"]=z;
var z="Program Search\xFE";
 z+="* Search a file for a string\xFE";
 z+="* Replaces a string with a string\xFE";
 z+="*\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = True\xFE";
 z+="    Dim Help As Array = [\"SEARCH FILE ITEMLIST (T: TOKEN SEARCH, C: Case Sensitive)\"]\xFE";
 z+="    \xFE";
 z+="    $include __shell\xFE";
 z+="\xFE";
 z+="    If !INames Then Stop \"No items found in file \":Fname\xFE";
 z+="    If Inames[1] = \"?\" Or Index(Options,\"?\",1) Then Stop Join(Help, crlf())\xFE";
 z+="\xFE";
 z+="    Isjson = Instr(Options, \"J\")\xFE";
 z+="    Tokensearch = Index(Options,\"T\",1) Or Index(Options,\"B\",1) Or Index(Options,\"W\",1)\xFE";
 z+="    CaseSensitive =Instr(Options, \"C\")\xFE";
 z+="    R83 = INDEX(UCASE(OPTIONS),\"R\",1)\xFE";
 z+="    IDENTIFIERCHARS = \"0123456789_ABCDEFGHIJKLMNOPQRSTUVWXYZ$@\"\xFE";
 z+="    IF R83 THEN IDENTIFIERCHARS := \".\"\xFE";
 z+="\xFE";
 z+="    List = []\xFE";
 z+="    Scnt = 0\xFE";
 z+="    ICnt = 0\xFE";
 z+="    Sstr = []\xFE";
 z+="    \xFE";
 z+="    Loop\xFE";
 z+="        P = \"String to search for (\"\xFE";
 z+="        If CaseSensitive Then\xFE";
 z+="            P := \"Case sensitive\"\xFE";
 z+="        Else\xFE";
 z+="            P := \"Case ignored - add ' (C' here to change\"\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If Tokensearch Then P := \" and Token Boundaries\"\xFE";
 z+="        P := \"): \"\xFE";
 z+="        prompt p\xFE";
 z+="        Input Ss\xFE";
 z+="\xFE";
 z+="    While Ss # '' Do\xFE";
 z+="        if InStr(SS, '()') = 0 Then\xFE";
 z+="            R3 = UCase(FieldRight(Ss, ' ('))\xFE";
 z+="            if len(r3) < 4 then\xFE";
 z+="                Ss = DropIfRight(Ss, ' (')\xFE";
 z+="                If Instr(R3, 'C') Then CaseSensitive = True\xFE";
 z+="                If Instr(R3, 'T') Then Tokensearch = True\xFE";
 z+="                If Instr(R3, '!') Then Stop \xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="        ss = unescapeString(ss)\xFE";
 z+="        if ss then                \xFE";
 z+="            Scnt = Scnt + 1\xFE";
 z+="            If CaseSensitive Then Sstr[-1] = Ss Else Sstr[-1] = LCase(Ss)\xFE";
 z+="        End If\xFE";
 z+="    Repeat\xFE";
 z+="    \xFE";
 z+="    If Scnt = 0 Then\xFE";
 z+="        Clearselect\xFE";
 z+="        Stop\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If Dictdata <> \"\" Then Dictdata = Dictdata:\" \"\xFE";
 z+="    Ed = 'ED'\xFE";
 z+="    Matches = 0\xFE";
 z+="    \xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        If Isjson Then\xFE";
 z+="            Readjson Item From F_file, Iname Else\xFE";
 z+="                Errors[-1] = 'Item ':Iname:' not found.'\xFE";
 z+="                Cycle\xFE";
 z+="            End\xFE";
 z+="            Item = Cstr(Item)\xFE";
 z+="        Else\xFE";
 z+="            Read Item From F_file, Iname Else\xFE";
 z+="                Errors[-1] = 'Item ':Iname:' not found.'\xFE";
 z+="                Cycle\xFE";
 z+="            End\xFE";
 z+="        End If\xFE";
 z+="    *\xFE";
 z+="        If Instr(Item, Chr(13)) Or Instr(Item, Chr(10)) Then\xFE";
 z+="            Item = Replace(Item, Chr(13):Chr(10), Chr(254))\xFE";
 z+="            Item = Replace(Item, Chr(13), Chr(254))\xFE";
 z+="            Item = Replace(Item, Chr(10), Chr(254))\xFE";
 z+="        End If\xFE";
 z+="    \xFE";
 z+="        nItem = Item\xFE";
 z+="        If !CaseSensitive Then Item = LCase(Item)\xFE";
 z+="        Printhead = 1\xFE";
 z+="    \xFE";
 z+="        lastLineNo = 0\xFE";
 z+="        for each SearchTerm In sStr\xFE";
 z+="            Spos = 1\xFE";
 z+="            Loop\xFE";
 z+="                SI = InStr(Spos, Item, SearchTerm)\xFE";
 z+="            While SI Do\xFE";
 z+="                If Tokensearch Then\xFE";
 z+="                    foundIt = True\xFE";
 z+="                    If SI > 1 Then\xFE";
 z+="                        // Check preceeding character\xFE";
 z+="                        C = UCase(Item[SI-1,1])\xFE";
 z+="                        If Index(IDENTIFIERCHARS, C, 1) Then \xFE";
 z+="                            if InStr(IDENTIFIERCHARS, UCase(Left(SearchTerm, 1))) Then foundIt = False\xFE";
 z+="                        End If\xFE";
 z+="                    End\xFE";
 z+="                    \xFE";
 z+="                    if foundIt Then \xFE";
 z+="                        // Check following character\xFE";
 z+="                        C = UCase(Item[SI+Len(SearchTerm),1])\xFE";
 z+="                        If Index(IDENTIFIERCHARS, C, 1) And C# \"\" Then \xFE";
 z+="                            if InStr(IDENTIFIERCHARS, UCase(Right(SearchTerm, 1))) Then foundIt = False\xFE";
 z+="                        End If\xFE";
 z+="                    End If\xFE";
 z+="                End Else\xFE";
 z+="                    foundIt = True\xFE";
 z+="                End\xFE";
 z+="                *\xFE";
 z+="                If foundIt Then\xFE";
 z+="                    Spos = SI + Len(SearchTerm)\xFE";
 z+="                    \xFE";
 z+="                    LineNo = Dcount(nItem[1,SI], Char(254))\xFE";
 z+="    \xFE";
 z+="                    If Printhead Then\xFE";
 z+="                        Print\xFE";
 z+="                        Print @Bold(Iname)\xFE";
 z+="                        List[-1] = Iname\xFE";
 z+="                        Printhead = 0\xFE";
 z+="                        Matches += 1\xFE";
 z+="                    End\xFE";
 z+="    \xFE";
 z+="                    If lastLineNo <> LineNo Then\xFE";
 z+="                        Print anchorEdit(Dictdata:Fname, IName, IName:\" (\":Right(\"   \":LineNo, 4):\")\", False, Null, LineNo):\xFE";
 z+="                        sLine = nItem<LineNo>\xFE";
 z+="                        \xFE";
 z+="                        I = 0\xFE";
 z+="                        Loop\xFE";
 z+="                            I = InStrI(sLine, SearchTerm)\xFE";
 z+="                        While I Do\xFE";
 z+="                            S = Mid(sLine, I, Len(SearchTerm))\xFE";
 z+="                            Print Left(sLine, I-1):@Bold(@Hilight(S)):\xFE";
 z+="                            sLine = Mid(sLine, I + Len(SearchTerm))\xFE";
 z+="                        Repeat\xFE";
 z+="                        \xFE";
 z+="                        Print sLine\xFE";
 z+="                            \xFE";
 z+="                        lastLineNo = LineNo\xFE";
 z+="                        if system(1) = \"js\" then @Server.Flush\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                End Else\xFE";
 z+="                    Spos = SI + 1\xFE";
 z+="                End\xFE";
 z+="            Repeat\xFE";
 z+="        Next\xFE";
 z+="        ICnt += 1\xFE";
 z+="        \xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors Then Print MonoSpace(Join(Errors, crlf()))\xFE";
 z+="    \xFE";
 z+="    If Matches Then\xFE";
 z+="        Print Matches:\" items had matches (\":ICnt:\" items searched)\"\xFE";
 z+="        Writelist List On TableName Else Stop @Errors\xFE";
 z+="        Print \"Search list saved to \":@InputButton(TableName, \"gl \":tablename:Cr())\xFE";
 z+="    Else\xFE";
 z+="        Print \"No matches found (\":ICnt:\" items searched)\"\xFE";
 z+="    End If\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["search"]=z;
var z="Program Select\xFE";
 z+="    Call Select(@Sentence, true)\xFE";
 z+="    if system(11) then print \"select list actived\" else print \"no items selected\"\xFE";
 z+="end Program\xFE";
 z+="\xFE";
 z+="Program SSelect\xFE";
 z+="    Call Select(@Sentence, true)\xFE";
 z+="    if system(11) then print \"select list actived\" else print \"no items selected\"\xFE";
 z+="end Program\xFE";
 z+="\xFE";
 z+="Subroutine Select(sentence, checkPrivilages)\xFE";
 z+="    If !ParseSelect(Sentence, \"\", Top, Columns, dict, fname, FilterBy, OrderBY, Options, AllItems, f, true, false, headerColumns) Then Stop @Errors\xFE";
 z+="\xFE";
 z+="    if len(Options) and num(Options) then cols = cint(Options) else cols = 4\xFE";
 z+="    tfname = lcase(trueTableName(fname))\xFE";
 z+="    \xFE";
 z+="    if checkPrivilages then If isRestrictedFile(tfname) then stop @Errors\xFE";
 z+="    \xFE";
 z+="    IF dict <> \"\" THEN dict = dict:\" \"\xFE";
 z+="\xFE";
 z+="    if FilterBy = \"\" and LCase(field(Sentence, \" \", 1)) = \"sselect\" then FilterBy = \" order by ItemID\"\xFE";
 z+="    select LTrim(Top:' '):Join(Columns, \" \") from f where FilterBy:OrderBy else stop @Errors\xFE";
 z+="end subroutine\xFE";
 z+=""
window.cached_jsb_tcl["select"]=z;
window.cached_jsb_tcl["seq"]="Program SEQ\xFE    a = field(field(@sentence, \"(\", 1), \" \", 2)\xFE    print a:\": \":\xFE    for i = 1 to len(a)\xFE        print seq(a[i,1]):\" \":\xFE    next\xFE    print\xFE    CLEARSELECT\xFE    \xFE    \xFEProgram STX\xFE    a = field(field(@sentence, \"(\", 1), \" \", 2)\xFE    print STX(a)\xFE    CLEARSELECT\xFE    \xFE    \xFEProgram XTS\xFE    a = field(field(@sentence, \"(\", 1), \" \", 2)\xFE    print XTS(a)\xFE    CLEARSELECT\xFE    \xFE";
var z="Program Setfile\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    Options = LCase(Field(@Sentence, \"(\", 2))\xFE";
 z+="    If Instr(Options, \"d\") Then Q = \"qd\" Else Q = \"q\"\xFE";
 z+="    \xFE";
 z+="    Terms = Split(Field(@sentence, \"(\", 1), \" \", 4) // split on spaces but not inside strings\xFE";
 z+="    S = []\xFE";
 z+="    for Each Term In Terms\xFE";
 z+="        q = Left(Term, 1)\xFE";
 z+="        locate q in [\"'\", '\"', \"`\"] then\xFE";
 z+="            if Right(Term,1) = Q Then Term = Mid(Term, 2, Len(Term) - 2)\xFE";
 z+="        End if\xFE";
 z+="        Term = Replace(Term, `/`, `\\`)\xFE";
 z+="        S[-1] = Term\xFE";
 z+="    next\xFE";
 z+="    \xFE";
 z+="    Act = S[2]\xFE";
 z+="    fName = S[3]\xFE";
 z+="    mdQName = S[4]\xFE";
 z+="\xFE";
 z+="    If !Act Then Stop \"setfile accountName fileName {QName} ({d}\"\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="    If mdQName = \"\" Then mdQName = \"qfile\"\xFE";
 z+="    \xFE";
 z+="    If (Mid(Act, 2, 1) = \":\" Or Left(Act, 1) = \".\" Or Left(Act, 1) = `\\`) and fname = \"\" Then Q = \"f\" else Q = \"q\"\xFE";
 z+="    pdef = q:am():act:am():fname\xFE";
 z+="    \xFE";
 z+="    FMd = @fHandle(\"md\")\xFE";
 z+="    Read oldPdef From Fmd, mdQName Then\xFE";
 z+="        locate \"cv\" in oldPdef<1> setting spot then\xFE";
 z+="           cvfile = oldpdef<2,spot>\xFE";
 z+="           cvitemid = oldpdef<3,spot>\xFE";
 z+="           pdef = q:vm():\"cv\":am():act():vm():cvfile:am():fname:vm():cvitemid\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Write Pdef On Fmd, mdQName Else Stop @Errors\xFE";
 z+="    Stop mdQName:\" written\"\xFE";
 z+=""
window.cached_jsb_tcl["setfile"]=z;
var z="// Delemited by crlf() and by Tab\xFE";
 z+="// Each row is: Source:Chr(9):Type:Chr(9):Type#:Chr(9):Message:Chr(9):Datetime():Chr(9):@UserName:Chr(9):@Account:Chr(9):@Domain:Chr(9):@IsAdmin\xFE";
 z+="//\xFE";
 z+="// Valid types are seperated by commas\xFE";
 z+="//     -<most recent N minutes>\xFE";
 z+="//     -<Since date or time HH:MM:SS>\xFE";
 z+="//     # <last N>\xFE";
 z+="//     !(i,w,e,c) everythng but this\xFE";
 z+="//     (i,w,e,c) this and everything above this level\xFE";
 z+="//\xFE";
 z+="Program ShowLogs\xFE";
 z+="    if !@isAdmin Then Stop \"You must be an admin to run this command\"\xFE";
 z+="    opts = ltrim(LCase(field(@sentence, ' ', 2)))\xFE";
 z+="    if left(opts, 2) = \"(!\" then opts = ltrim(mid(opts, 3))\xFE";
 z+="    if left(opts, 1) = \"(\" then opts = ltrim(mid(opts, 2))\xFE";
 z+="    if left(opts, 1) = \"!\" then\xFE";
 z+="        notThis = \"!\"\xFE";
 z+="        opts = mid(opts, 2)\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    select case opts\xFE";
 z+="        case 'w': iType = 'Warning'\xFE";
 z+="        case 'e': iType = 'Error'\xFE";
 z+="        case 'c': iType = 'Critical'\xFE";
 z+="        case else\xFE";
 z+="                  iType = 'Information'\xFE";
 z+="    end select\xFE";
 z+="        \xFE";
 z+="    ' Anything but information?\xFE";
 z+="    recentLogs = @Getlogs(notThis:iType:\",\":date(now()), false, cnum(opts)) ;* Today's logs\xFE";
 z+="    if count(recentLogs, \"</tr>\") <= 1 Then recentLogs = @Getlogs(notThis:iType:\",\":date(now()-1), false, cnum(opts)) ;* Today's logs\xFE";
 z+="    if count(recentLogs, \"</tr>\") <= 1 Then recentLogs = @Getlogs(date(now()), false, cnum(opts)) ;* Today's logs\xFE";
 z+="    if count(recentLogs, \"</tr>\") <= 1 Then recentLogs = @Getlogs(date(now()-1), false, cnum(opts)) ;* Today's logs\xFE";
 z+="    if count(recentLogs, \"</tr>\") <= 1 Then recentLogs = @Getlogs(\"\", false, cnum(opts)) ;* Today's logs\xFE";
 z+="    on error goto err59\xFE";
 z+="    Print @(-1):System(59)\xFE";
 z+="err59:\xFE";
 z+="    print crlf():recentLogs\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["showlogs"]=z;
window.cached_jsb_tcl["size"]="Program Size\xFE    *\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE    If !@ParseSelect(@Sentence, \"\", Top, Columns, Dict, Fname, FilterBy, OrderBY, Options, AllItems, F) Then Stop\xFE    \xFE    if !allItems And !FilterBy And !System(11) then Stop 'Touch TableName<ItemNames | *>'\xFE    Select LTrim(Top:' '):Join(Columns, \" \") From F Where FilterBy:OrderBY Else Stop @Errors\xFE\xFE    Readnext Id Else Stop \"No items found\"\xFE    Loop\xFE        Read Item From F, Id Then Size += Len(Item)\xFE        Cnt += 1\xFE        Readnext Id Else Stop Size:\" bytes, \":Cnt:\" items.\"\xFE    While True Do Repeat";
window.cached_jsb_tcl["sl"]="Program SL\xFE   If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE   S = TRIM(@SENTENCE)\xFE   FNAME = FIELD(S, \" \", 2)\xFE   INAME = FIELD(S, \" \", 3)\xFE  \xFE   \xFE   IF UCASE(FNAME) = \"DICT\" THEN\xFE      FNAME = FNAME:\" \":INAME\xFE      INAME = FIELD(S, \" \", 4)\xFE   END IF\xFE   IF SYSTEM(11) THEN\xFE      f = @fHandle(\"\", \"JSB_SelectLists\", true)\xFE      SAVELIST TO FNAME THEN\xFE         CLEARSELECT \xFE         PRINT \"LIST '\":FNAME:\"' SAVED\"\xFE      ELSE\xFE         PRINT @ERRORS\xFE         CLEARSELECT\xFE      END IF\xFE   END ELSE\xFE      PRINT \"THERE IS NO ACTIVE LIST TO SAVE\"\xFE   END IF";
window.cached_jsb_tcl["speed"]="Program SPEED\xFEt = timer()\xFEi = 0\xFEloop until timer() > t + 1000 do\xFEi = i + 1\xFErepeat\xFEprint i:\" iterations in 1 seconds\"";
var z="Program Split\xFE";
 z+="\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    Dim Help As Array = [\"Split srcFile ItemList - splits into code blocks\"]\xFE";
 z+="    \xFE";
 z+="    $include __shell\xFE";
 z+="    \xFE";
 z+="    If Inames[1] = \"?\" Or Index(Options,\"?\",1) Then Stop Help\xFE";
 z+="    Firsttime = 0\xFE";
 z+="    If Dictdata <> \"\" Then Dictdata = Dictdata:\" \"\xFE";
 z+="    ICnt = 0\xFE";
 z+="    open \"tmp\" to fdest else stop @errors\xFE";
 z+="    \xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        print iname\xFE";
 z+="        \xFE";
 z+="        Read Item From F_file, Iname Else\xFE";
 z+="            Errors[-1] = 'Item ':Iname:' not found.'\xFE";
 z+="            Cycle\xFE";
 z+="        End\xFE";
 z+="    \xFE";
 z+="        If Instr(Item, Chr(13)) Or Instr(Item, Chr(10)) Then\xFE";
 z+="            Item = Replace(Item, Chr(13):Chr(10), Chr(254))\xFE";
 z+="            Item = Replace(Item, Chr(13), Chr(254))\xFE";
 z+="            Item = Replace(Item, Chr(10), Chr(254))\xFE";
 z+="        End If\xFE";
 z+="    \xFE";
 z+="        nItem = Item\xFE";
 z+="        CodeBlocks = splitJsbCode(Item)\xFE";
 z+="    \xFE";
 z+="        for each BlockName in CodeBlocks\xFE";
 z+="            //     BlockName is \"funcName#ParamCnt#type\"\xFE";
 z+="            funcName = Field(BlockName, \"#\", 1)\xFE";
 z+="            ParamCnt = Field(BlockName, \"#\", 2)\xFE";
 z+="            fType    = Field(BlockName, \"#\", 3) // function, subroutine, program, restful\xFE";
 z+="            Src      = CodeBlocks[BlockName]\xFE";
 z+="            \xFE";
 z+="            if !funcName then\xFE";
 z+="                print \"??? \":iName\xFE";
 z+="                write src on fdest, iName else stop @errors\xFE";
 z+="                \xFE";
 z+="            else\xFE";
 z+="                read xsrc from fdest, funcName then src := am():xsrc\xFE";
 z+="                write src on fdest, funcName else stop @errors\xFE";
 z+="            end if\xFE";
 z+="            \xFE";
 z+="            ICnt += 1\xFE";
 z+="        next\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors Then Print MonoSpace(Join(Errors, crlf()))\xFE";
 z+="    \xFE";
 z+="    If Firsttime Then Stop \"No items found in file \":Fname\xFE";
 z+="    Stop ICnt:\" functions processed\"\xFE";
 z+=""
window.cached_jsb_tcl["split"]=z;
var z="Program Sql\xFE";
 z+="    *$options aspx\xFE";
 z+="    *$options internal myGrid, pg, JsbForm\xFE";
 z+="\xFE";
 z+="   roleMsg = Iff(@@IsAuthenticated, \"\", \"You must be logged in to view this page. \":@Anchor(@@LoginUrl, \"Click here to login\"))\xFE";
 z+="   If !@@IsEmployee Then Stop Iff(roleMsg, roleMsg, \"You must be at least an employee to view this page.\")\xFE";
 z+="    \xFE";
 z+="    ReadJSon savedSqls From @fHandle('jsb_config'), 'sqlCmds' Else \xFE";
 z+="        savedSqls = {\xFE";
 z+="            \"listDatabases\": \"SELECT name FROM sys.databases Where Not name In ('master', 'tempdb', 'model', 'msdb', 'MSys', 'sysdiagrams') And state_desc!='OFFLINE' Order By name\",\xFE";
 z+="            \"listTmpTables\": \"select schema_name(t.schema_id) as schema_name, t.name as table_name from sys.tables t Where t.name like '#%' order by table_name, schema_name;\"\xFE";
 z+="        }\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    savedSqls = Sortbytags(savedSqls)\xFE";
 z+="    Sql = \"type your sql statement here and then click the run button\"\xFE";
 z+="    \xFE";
 z+="    attachedDB = @Session.AttachedDatabase\xFE";
 z+="    if !attachedDB Then \xFE";
 z+="        attachedDB = \"autoAttach\"\xFE";
 z+="        Attachdb \"autoattach\" Else attachedDB = \"\"\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    Loop\xFE";
 z+="        Print @(-1): ;* allow jsb PRINTs\xFE";
 z+="        \xFE";
 z+="        oSql = Sql ;* Remember Original Sql\xFE";
 z+="        validSelect = False\xFE";
 z+="\xFE";
 z+="        If Run Then\xFE";
 z+="            If LCase(@FieldLeft(Sql, \" \")) = \"select\" Then\xFE";
 z+="                if attachedDB And System(1) = \"aspx\" Then\xFE";
 z+="                    if !@isAdmin Then \xFE";
 z+="                        Sql = SqlSelectCleanse(Sql)\xFE";
 z+="                        F2 = LCase(@FieldLeft(Sql, \" \"))\xFE";
 z+="                        If F2 <> \"top\" And F2 <> \"bottom\" Then Sql = \"Select Top 300 \":Sql Else Sql = \"Select \":Sql\xFE";
 z+="                    end if\xFE";
 z+="                    \xFE";
 z+="                    SqlSelect Sql To selectList Then validSelect = True Else \xFE";
 z+="                        CenterHtml = Sql:crlf():crlf():@Errors\xFE";
 z+="                    end if\xFE";
 z+="                    \xFE";
 z+="                ElseIf ParseSelect(Sql, \"\", Top, Columns, Dict, tableName, FilterBy, OrderBY, Options, AllItems, F_file, parseColumnNames, Ignorefilenotfound, headerColumns) Then \xFE";
 z+="                    Select LTrim(Top:' '):Join(Columns, \" \") From F_File Where FilterBy:OrderBY To selectList Then validSelect = True Else \xFE";
 z+="                        CenterHtml = `Select `:LTrim(Top:' '):Join(Columns, \" \"):crlf():crlf():@Errors\xFE";
 z+="                    end if\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="            End Else\xFE";
 z+="                If @IsAdmin Then\xFE";
 z+="                    CenterHtml = executeSql(sql)\xFE";
 z+="                    if !CenterHtml Then CenterHtml = @Errors\xFE";
 z+="                Else\xFE";
 z+="                    CenterHtml = \"You must be an administrator to execute SQL other than SELECT statements\"\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        if validSelect Then\xFE";
 z+="            dt = SelectList.RowHandle.Table\xFE";
 z+="            dataset = getlist(selectList)\xFE";
 z+="            if (!dataset) then \xFE";
 z+="                CenterHtml = \"No results\"\xFE";
 z+="            Else\xFE";
 z+="                model = jqGridDefaultModel(dataSet)\xFE";
 z+="                CenterHtml = @jqGrid(\"myID\", dataSet, model, {})\xFE";
 z+="            End If\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        \xFE";
 z+="        NorthHTML = @Textarea('sql', LTrim(oSql), 30, 133)\xFE";
 z+="        WestHtml = @submitBtn('Run!'):@Br:@Br:@submitBtn('Save'):@Br:@Br:@submitBtn('Make URL'):@Br:@Br:@submitBtn('MS2Access 2 SQL'):@Br:@Br:@submitBtn('Quit')\xFE";
 z+="        If sqlID Then WestHtml = WestHtml:@submitBtn('Delete')\xFE";
 z+="        \xFE";
 z+="        EastHtml = []\xFE";
 z+="        For Each TagName In savedSqls\xFE";
 z+="            If TagName = sqlID Then Prefix = \"*\" Else Prefix = \"\"\xFE";
 z+="            EastHtml[-1] = @submitBtn('Load', TagName, TagName, { style: 'width: 180px' } ):Prefix:\"<br/>\"\xFE";
 z+="        Next\xFE";
 z+="        \xFE";
 z+="        Print @(-1):@Html(`<style>button[type=\"submit\"] { min-width: 50px }</style>`):\xFE";
 z+="        Print @Layout(CenterHtml, NorthHTML, \"startsize:200\", \"\", \"\", Join(EastHtml,\"\"), \"startsize:200\", WestHtml, \"startsize:100\"):\xFE";
 z+="\xFE";
 z+="        @Server.pause\xFE";
 z+="        \xFE";
 z+="        Sql = @formVar(\"sql\"); Quit = @formVar(\"Quit\"); Save = @formVar(\"Save\"); MS2Access = @formVar(\"MS2Access 2 SQL\")\xFE";
 z+="        Load = @formVar(\"Load\"); Delete = formVar(\"Delete\") ; Run = @formVar(\"Run!\"); MakeURL = @formVar(\"Make URL\")\xFE";
 z+="\xFE";
 z+="    While !Quit Do\xFE";
 z+="        \xFE";
 z+="        CenterHtml = \"\"\xFE";
 z+="        \xFE";
 z+="        If Save Then\xFE";
 z+="            Ans = @InputBox(\"Save\", \"Save As\", sqlID)\xFE";
 z+="            If Ans <> Chr(27) And Ans <> \"\" Then\xFE";
 z+="                sqlID = Ans\xFE";
 z+="                savedSqls[sqlID] = Sql\xFE";
 z+="                savedSqls = Sortbytags(savedSqls, True)\xFE";
 z+="                WriteJson savedSqls On @fHandle('jsb_config'), 'sqlCmds' Else MsgBox(@Errors)\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If Delete Then\xFE";
 z+="            If MsgBox(\"Delete\", \"Are you sure you want to delete \":sqlID, \"Yes,*No\") = \"Yes\" Then\xFE";
 z+="                Remove savedSqls, sqlID\xFE";
 z+="                WriteJson savedSqls On @fHandle('jsb_config'), 'sqlCmds' Then sqlID = \"\" Else MsgBox(@Errors)\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If MS2Access Then\xFE";
 z+="            * MS2Access SQL to MS SQL\xFE";
 z+="            oSql = Sql\xFE";
 z+="            Sql = Replace(Replace(replaceI(replaceI(Replace(Replace(Sql, crlf(), ' '), am(), ' '), 'dbo.', ''), 'dbo_', ''), 'True', 1), 'False', 0)\xFE";
 z+="            Sql = Trim(Replace(Replace(Replace(Sql, '\"', \"'\"), \"'*\", \"'%\"), \"*'\", \"%'\"))\xFE";
 z+="            If oSql = Sql Then CenterHtml = \"No changes made to your sql\" Else CenterHtml = \"You're sql was reformatted for MS SQL\"\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If MakeURL Then\xFE";
 z+="            If LCase(Left(Sql, 7)) = \"select \" Then\xFE";
 z+="                CenterHtml = @jsbRootExecuteTclCmd(\"sql\":Sql)\xFE";
 z+="            Else\xFE";
 z+="                CenterHtml = \"Only Select statements can be made into URL's\"\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        If Load Then\xFE";
 z+="            sqlID = Load\xFE";
 z+="            Sql = savedSqls[sqlID]\xFE";
 z+="        End If\xFE";
 z+="    Repeat\xFE";
 z+="    \xFE";
 z+="    if attachedDB = \"autoAttach\" then Attachdb \"\" Else Null\xFE";
 z+="    Stop @(-1)\xFE";
 z+="End function\xFE";
 z+="\xFE";
 z+="function executeSql(sql)\xFE";
 z+="    Try\xFE";
 z+="        Dim Ans As Object = @@Sql(Sql)\xFE";
 z+="        Return Ans\xFE";
 z+="    Catch Err\xFE";
 z+="        MsgBox(Err)\xFE";
 z+="    End Try\xFE";
 z+="    Return Nothing\xFE";
 z+="End function\xFE";
 z+="    \xFE";
 z+="function SqlSelectCleanse(Sql)\xFE";
 z+="    Sql = Field(Sql, \";\", 1)\xFE";
 z+="    Sql = Replace(Sql, Chr(0), \" \")\xFE";
 z+="    Sql = Replace(Sql, Chr(9), \" \")\xFE";
 z+="    Sql = Replace(Sql, Chr(10), \" \")\xFE";
 z+="    Sql = Replace(Sql, Chr(13), \" \")\xFE";
 z+="    Sql = Replace(Sql, Chr(2), \" \")\xFE";
 z+="    Sql = Replace(Sql, am(), \" \")\xFE";
 z+="    Sql = LTrim(Sql)\xFE";
 z+="    Sql = RTrim(Sql)\xFE";
 z+="    \xFE";
 z+="    L1 = LCase(Field(Sql, \" \", 1))\xFE";
 z+="    If Instr(L1, \"select\") Then Sql = LTrim(DropLeft(Sql, \" \"))\xFE";
 z+="    If Right(Sql, 2) = \"(!\" Then Sql = RTrim(Left(Sql, Len(Sql)-2))\xFE";
 z+="\xFE";
 z+="    If @IsAdmin Then Return Sql\xFE";
 z+="    \xFE";
 z+="    * MS2Access to SQL\xFE";
 z+="    * sql = replace(replace(replaceI(replaceI(sql, 'dbo.', ''), 'dbo_', ''), 'True', 1), 'False', 0)\xFE";
 z+="    * sql = Trim(replace(replace(replace(sql, '\"', \"'\"), \"'*\", \"'%\"), \"*'\", \"%'\"))\xFE";
 z+="    \xFE";
 z+="    *\xFE";
 z+="    * Allow 2nd parenthesis\xFE";
 z+="    *\xFE";
 z+="    Loop While Instr(Sql, \"( \") Do Sql = Replace(Sql, \"( \", \"(\") Repeat\xFE";
 z+="    Loop While Instr(Sql, \"((\") Or Instr(Sql, Chr(2):\"(\") Do\xFE";
 z+="        Sql = Replace(Sql, \"((\", \"(\":Chr(2))\xFE";
 z+="        Sql = Replace(Sql, Chr(2):\"(\", Chr(2):Chr(2))\xFE";
 z+="    Repeat\xFE";
 z+="    *\xFE";
 z+="    * Allow only these functions\xFE";
 z+="    *\xFE";
 z+="    Sql = \" \":Sql\xFE";
 z+="    Sql = Replace(Sql, \"(\", \"( \")\xFE";
 z+="    Sql = replaceI(Sql, \" cast(\", \" cast\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" convert(\", \" convert\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" avg(\", \" avg\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" max(\", \" max\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" count(\", \" count\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" grouping(\", \" grouping\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" grouping_id(\", \" grouping_id\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" sum(\", \" sum\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" checksum_agg(\", \" checksum_agg\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" rank(\", \" rank\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" iff(\", \" iff\":Chr(2))\xFE";
 z+="\xFE";
 z+="    Sql = replaceI(Sql, \" time(\", \" time\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" date(\", \" date\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" smalldatetime(\", \" smalldatetime\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" datetime(\", \" datetime\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" datetime2(\", \" datetime2\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" datetimeoffset(\", \" datetimeoffset\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" getdate(\", \" getdate\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" datename(\", \" datename\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" datepart(\", \" datepart\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" day(\", \" day\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" month(\", \" month\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" year(\", \" year\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" datediff(\", \" datediff\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" dateadd(\", \" dateadd\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" isdate(\", \" isdate\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" abs(\", \" abs\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" ceiling(\", \" ceiling\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" char(\", \" char\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" charindex(\", \" charindex\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" concat(\", \" concat\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" format(\", \" format\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" difference(\", \" difference\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" left(\", \" left\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" len(\", \" len\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" lower(\", \" lower\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" rowcount(\", \" rowcount\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" row_number(\", \" row_number\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" join (\", \" join \":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" join(\", \" join\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" over (\", \" over \":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" over(\", \" over\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" on (\", \" on \":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" on(\", \" on\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" in (\", \" in \":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" in(\", \" in\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" having(\", \" having\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \" having (\", \" having \":Chr(2))\xFE";
 z+="    \xFE";
 z+="    Sql = replaceI(Sql, \", (\", \", \":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \",(\", \",\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \"= (\", \"= \":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \"=(\", \"=\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \"< (\", \"< \":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \"<(\", \"<\":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \"> (\", \"> \":Chr(2))\xFE";
 z+="    Sql = replaceI(Sql, \">(\", \">\":Chr(2))\xFE";
 z+="    \xFE";
 z+="    Sql = Replace(Sql, \"(\", \"**\")\xFE";
 z+="    Sql = Replace(Sql, Chr(2), \"(\")\xFE";
 z+="    Sql = LTrim(Sql)\xFE";
 z+="    \xFE";
 z+="    TopBottom = LCase(Field(Sql, \" \", 1))\xFE";
 z+="    If TopBottom = \"top\" Or TopBottom = \"bottom\" Then\xFE";
 z+="        Sql = @DropLeft(Sql, \" \")\xFE";
 z+="        TopBottomArg = Val(Field(Sql, \" \", 1))\xFE";
 z+="        Sql = @DropLeft(Sql, \" \")\xFE";
 z+="        \xFE";
 z+="        If TopBottomArg < 1 Or TopBottomArg > 10000 Then TopBottomArg = 10000\xFE";
 z+="        Sql = TopBottom:\" \":TopBottomArg:\" \":Sql\xFE";
 z+="    Else\xFE";
 z+="        Sql = \"Top 300 \":Sql\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Return Sql\xFE";
 z+="End function\xFE";
 z+=""
window.cached_jsb_tcl["sql"]=z;
var z="program SqlSelect\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    \xFE";
 z+="    attachedDB = @Session.AttachedDatabase\xFE";
 z+="    if !attachedDB then attachdb \"autoattach\" else null\xFE";
 z+="    \xFE";
 z+="    if lcase(left(sql, 4)) = \"use \" then\xFE";
 z+="        use = field(sql, \";\", 1):\" \"\xFE";
 z+="        sql = lTrim(dropleft(sql, \";\"))\xFE";
 z+="        if ucase(left(sql, 7)) = \"select \" then sql = mid(sql, 8)\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    S = @Sentence\xFE";
 z+="    if instr(s,  \"(!\") then s = dropRight(s, \" (!\")\xFE";
 z+="    \xFE";
 z+="    if @isAdmin Then\xFE";
 z+="        Sql = \"Select \":DropLeft(S, ' ')\xFE";
 z+="    Else\xFE";
 z+="        Sql = \"Select \":SqlSelectCleanse(S)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    SqlSelect use:Sql to ss else stop @Errors \xFE";
 z+="    dataSet = JSon(GetList(ss))\xFE";
 z+="    if len(dataset) = 0 then stop 'no items'\xFE";
 z+="    \xFE";
 z+="    UserModelColumns = jqGridDefaultModel(dataSet)\xFE";
 z+="    \xFE";
 z+="    Print @(-1):@jqGrid(\"myID\", dataSet, UserModelColumns, {})\xFE";
 z+="    if !attachedDB then attachdb \"\" else null\xFE";
 z+="    \xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["sqlselect"]=z;
var z="Program startGPS()\xFE";
 z+="*$options js\xFE";
 z+="*$options internal permissions\xFE";
 z+="\xFE";
 z+="    if !window.navigator then Stop 'No navigator object'\xFE";
 z+="    if !window.navigator.geolocation then Stop 'No geolocation object'\xFE";
 z+="\xFE";
 z+="    if window.hasCordovaPlugIn(\"permissions\") then\xFE";
 z+="        permissions = window.cordova.plugins.permissions;\xFE";
 z+="        permissions.requestPermission(permissions.ACCESS_FINE_LOCATION, callback(status), callback(status))\xFE";
 z+="        if callbacknumber <> 1 then stop \"GPS Permission Error\"\xFE";
 z+="        if !status.hasPermission then stop \"GPS Position disabled by user\"\xFE";
 z+="    else\xFE";
 z+="        stop \"You don't have the Cordova plugin permissions\"\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    window.GPS_Retries = 0;\xFE";
 z+="    window.enableHighAccuracy = true;\xFE";
 z+="    if window.backgroundGPSrunning then Stop \"Background GPS Running. Use ReadGPS\"\xFE";
 z+="    \xFE";
 z+="    window.backgroundGPSrunning = true\xFE";
 z+="    window.validGPS = false;\xFE";
 z+="    window.GPS_Time = null;\xFE";
 z+="    \xFE";
 z+="    javascript {\xFE";
 z+="        window.readGPSgeolocation = function (Timeout) {\xFE";
 z+="            window.navigator.geolocation.getCurrentPosition(\xFE";
 z+="                function (onSuccess) {\xFE";
 z+="                    window.GPS_latitude = onSuccess.coords.latitude;\xFE";
 z+="                    window.GPS_longitude = onSuccess.coords.longitude;\xFE";
 z+="                    window.validGPS = true;\xFE";
 z+="                    window.GPS_Time = TimeDate();\xFE";
 z+="                    window.GPS_Retries = 0;\xFE";
 z+="                    window.enableHighAccuracy = true;\xFE";
 z+="                    window.gpsCycleTimer = setTimeout(window.readGPSgeolocation, 5 * 1000); // every 5 seconds read again\xFE";
 z+="                },\xFE";
 z+="                \xFE";
 z+="                function (err) {\xFE";
 z+="                    // we timed out...\xFE";
 z+="                    window.GPS_Err = err;\xFE";
 z+="                    window.GPS_Retries += 1\xFE";
 z+="                    \xFE";
 z+="                    if (err.code != 3) { // timeout error\xFE";
 z+="                        window.GPS_Retries = 9999 // never going to happen\xFE";
 z+="                        window.backgroundGPSrunning = false;\xFE";
 z+="                        return\xFE";
 z+="                    }\xFE";
 z+="                        \xFE";
 z+="                    if (window.GPS_Retries >= 2) window.enableHighAccuracy = false;\xFE";
 z+="                    window.readGPSgeolocation(5 * 1000); // attempt to read within 5 seconds\xFE";
 z+="                }, \xFE";
 z+="                \xFE";
 z+="                { maximumAge: 10000, timeout: Timeout, enableHighAccuracy: window.enableHighAccuracy }\xFE";
 z+="            )\xFE";
 z+="        }\xFE";
 z+="        \xFE";
 z+="        // Do first attempt with a short timeout\xFE";
 z+="        window.readGPSgeolocation(100)\xFE";
 z+="    }\xFE";
 z+="    \xFE";
 z+="    Stop \"Background GPS Running. Use ReadGPS or StopGPS\"\xFE";
 z+="end Program\xFE";
 z+="    \xFE";
 z+="Program stopGPS()\xFE";
 z+="*$options js\xFE";
 z+="    window.clearTimeout(window.gpsCycleTimer)\xFE";
 z+="end Program\xFE";
 z+="\xFE";
 z+="Program readGPS()\xFE";
 z+="*$options js\xFE";
 z+="    if window.validGPS then\xFE";
 z+="        stop window.GPS_latitude:Chr(176):\" N, \":window.GPS_longitude:Chr(176):\" W\"\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if window.GPS_Err = 1 then if window.GPS_Err = 1 then Stop \"Your GPS is blocked by your browser settings\"\xFE";
 z+="    \xFE";
 z+="    $(\"<div id='gpswait' style='position: fixed; z-index:999999; width: 100%; height: 100%; background-color: black; color: white; opacity: .5'><div id='gpstext' style='position: fixed;top:45%; left:45%'>Waiting for GPS Single</div></div>\").appendTo('body')\xFE";
 z+="    gpsText = 'Waiting for GPS Single'\xFE";
 z+="    \xFE";
 z+="    Cnt = 15\xFE";
 z+="    Loop\xFE";
 z+="        Sleep 1 ;* 1/2 second sleep\xFE";
 z+="        $('#gpstext').text('Waiting for GPS Signal ':window.GPS_Retries:' ':StrRpt('.', Cnt))\xFE";
 z+="        \xFE";
 z+="        Cnt -= 1\xFE";
 z+="        If Cnt = 0 Then Cnt = 10\xFE";
 z+="        \xFE";
 z+="        if window.validGPS then\xFE";
 z+="            $('#gpswait').remove()\xFE";
 z+="            Stop window.GPS_latitude:Chr(176):\" N, \":window.GPS_longitude:Chr(176):\" W\"\xFE";
 z+="        end if\xFE";
 z+="    While window.GPS_Retries < 15 do repeat\xFE";
 z+="    \xFE";
 z+="    $('#gpswait').remove()\xFE";
 z+="    \xFE";
 z+="    Stop  window.GPS_Err.message\xFE";
 z+="End Sub"
window.cached_jsb_tcl["startgps"]=z;
window.cached_jsb_tcl["stx"]="Program STX\xFE* Convert string to HEX\xFE* \xFE   S = Field(UCase(Trim(@SENTENCE)),' ', 2)\xFE   if Left(S,2) = \"0X\" Then S = Mid(S, 3)\xFE   S = STX(S)\xFE   Print S\xFE   CLEARSELECT";
window.cached_jsb_tcl["subd"]="Program SUBD\xFE    Args = Split(Replace(Replace(DropLeft(@Sentence, ' '), \",\", \"\"), \"$\", \"\"), \" \")\xFE    For Each Arg, ArgI in Args\xFE       if ArgI = 1 then Sum = Val(Arg) Else Sum -= Val(Arg)\xFE    Next\xFE    Print Sum\xFE    ClearSelect\xFEEnd Program\xFE\xFEProgram Sub\xFE    Chain \"SUBD \":DropLeft(@Sentence, ' ')\xFEEnd Program\xFE\xFE";
window.cached_jsb_tcl["subx"]="Program SUBX\xFE    Args = Split(Mid(@Sentence, Index(@Sentence, ' ') + 1), ' ')\xFE    Sum = Xtd(Args(1)) * 2\xFE    For Each Arg in Args\xFE       Sum -= XTD(Arg)\xFE    Next\xFE    Print DTX(Sum)\xFE    ClearSelect\xFEEnd Program";
var z="\xFE";
 z+="Program Sysprog \xFE";
 z+="    *$options aspx\xFE";
 z+="\xFE";
 z+="    // Where do we get our updates from?\xFE";
 z+="    jsbUrl = @Jsbconfig(\"jsburl\", \"jsbwinforms.azurewebsites.net\")\xFE";
 z+="    if right(jsbUrl, 1) = \"/\" then jsbUrl = Left(jsbUrl, Len(jsbUrl)-1)\xFE";
 z+="    jsbUrl = DropIfLeft(jsbUrl, \"//\")\xFE";
 z+="    \xFE";
 z+="    //  setup theme \xFE";
 z+="    useTheme = @Application[@pageName:\"_lastuseTheme\"]\xFE";
 z+="    if !useTheme Then useTheme = @UserVar('currentTheme')\xFE";
 z+="    if !useTheme Then useTheme = jsbConfig(\"defaultTheme\", 'lumin')\xFE";
 z+="    Theme(useTheme)\xFE";
 z+="\xFE";
 z+="    If System(1) <> \"js\" Then\xFE";
 z+="        if Left(@Domain, 9) = \"localhost\" Then @jsb_bf.SignIn(\"admin\", true); stop\xFE";
 z+="        \xFE";
 z+="        // Give oauth one try\xFE";
 z+="        if !@isAdmin Then\xFE";
 z+="            config = jsbConfig('authenticationtype')\xFE";
 z+="            if config then\xFE";
 z+="                if config.value = \"oauth\" then \xFE";
 z+="                    if verifyuser(UserName, \"\") then \xFE";
 z+="                        @jsb_bf.SignIn(UserName, true)\xFE";
 z+="                        if @isAdmin then Print \"Hello Admin \":UserName:\". \" Else Print \"Hello \":UserName:\". \"\xFE";
 z+="                    end if\xFE";
 z+="                end if\xFE";
 z+="            end if\xFE";
 z+="                    \xFE";
 z+="            Loop Until @isAdmin Do\xFE";
 z+="                Prompt \"What is the magic word? \"\xFE";
 z+="                Echo Off\xFE";
 z+="                Input _Passwd\xFE";
 z+="                if @tclLogin(\"admin\", _Passwd) Then Break\xFE";
 z+="                Print @(-1):\xFE";
 z+="            Repeat\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="        if @isAdmin Then\xFE";
 z+="            If @Domain <> jsbUrl Then\xFE";
 z+="                read dontAsk from fhandle('tmp'), 'lastUpdateDate' then dontAsk = dontAsk > date() \xFE";
 z+="\xFE";
 z+="                if !dontask Then\xFE";
 z+="                    Ans = MsgBox(\"Get lasest updates from \":jsbUrl:\"?\", \"Yes,*Quick,No,Don'tAsk\") \xFE";
 z+="                    if Ans = \"Yes\" Then Chain \"jsbsync\"\xFE";
 z+="                    if Ans = \"Quick\" Then\xFE";
 z+="                       Execute \"jsbsync jsb_html\"\xFE";
 z+="                       Execute \"jsbsync jsb_bf\"\xFE";
 z+="                       Execute \"jsbsync jsb_tcl\"\xFE";
 z+="                       Execute \"jsbsync js\"\xFE";
 z+="                       Execute \"jsbsync mdl\"\xFE";
 z+="                       Execute \"jsbsync ctls\"\xFE";
 z+="                       Execute \"jsbsync css\"\xFE";
 z+="                       write Date()+1 on fhandle('tmp'), 'lastUpdateDate' \xFE";
 z+="                       stop \"done\"\xFE";
 z+="                    end if\xFE";
 z+="                    if ans = \"Don'tAsk\" Then write Date()+1 on fhandle('tmp'), 'lastUpdateDate' \xFE";
 z+="                end if\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            if !dontask Then\xFE";
 z+="                recentLogs = @Getlogs(\"!Information,\":date(now())) ;* Today's logs\xFE";
 z+="                if Count(recentLogs, \"</tr>\") > 1 Then \xFE";
 z+="                    Print System(59):crlf():recentLogs\xFE";
 z+="                Else\xFE";
 z+="                    Print @inputButton('ShowLogs (I', Chr(27) : 'ShowLogs' : Chr(13))\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["sysprog"]=z;
var z="program tattach\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    tapeFile = field(field(@sentence, \"(\", 1), \" \", 2)\xFE";
 z+="    if tapeFile = \"\" Then tapefile = @Session.tapeFile\xFE";
 z+="    if tapeFile = \"\" Then tapefile = \"tapefile\"\xFE";
 z+="\xFE";
 z+="    if lcase(tapefile) = \"dropbox\" then\xFE";
 z+="        read isSetup from @fHandle('md'), 'dropbox' then\xFE";
 z+="            open tapefile to f else stop \"I was unable to open the tapefile on dropbox\"\xFE";
 z+="        else\xFE";
 z+="            if msgbox(\"Would you like to use DROPBOX for your tape backup?\", \"Yes,No\") <> \"Yes\" Then Stop\xFE";
 z+="            \xFE";
 z+="            if !@jsb_odb.AttachDB(\"dropbox\") then stop @errors\xFE";
 z+="            write \"q\":am():\"dropbox\":am():'tapefile' on @fHandle('md'), 'dropbox' else stop @errors\xFE";
 z+="            open tapefile to f else\xFE";
 z+="                createfile 'tapefile' else stop @errors\xFE";
 z+="                open tapeFile to f else stop \"I was unable to create the tapefile on dropbox\"\xFE";
 z+="            end if\xFE";
 z+="            @Session.AttachedDatabase = \"\"\xFE";
 z+="        end if\xFE";
 z+="        \xFE";
 z+="    else\xFE";
 z+="        open tapeFile to fdump else \xFE";
 z+="            if msgbox(\"The tapefile \":tapeFile:\" doesn't exist, do you want to create it?\", \"Yes,*No\") <> \"Yes\" Then Stop\xFE";
 z+="            CreateFile tapeFile else Stop @Errors\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    @Session.tapeFile = tapeFile\xFE";
 z+="    \xFE";
 z+="    if tapeFile = \"\" Then tapeFile = \"no TAPEFILE is\"\xFE";
 z+="    stop tapeFile:\" attached\"\xFE";
 z+="end program\xFE";
 z+="\xFE";
 z+="program tdetach\xFE";
 z+="   @Session.tapeFile = ''\xFE";
 z+="   delete @fHandle('md'), 'dropbox'\xFE";
 z+="   stop \"TapeFile detaached\"\xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["tattach"]=z;
var z="*\xFE";
 z+="* This code is used by the JAVASCRIPT versions i.e. PhoneGap (projectname.html), Browser (tcl.html)\xFE";
 z+="*   (The GAE version is below), and ASPX has it built into the .NET code (tcl.vb)\xFE";
 z+="*\xFE";
 z+="Program Tcl\xFE";
 z+="*\xFE";
 z+="*$options js\xFE";
 z+="*\xFE";
 z+="*$options nodebug\xFE";
 z+="*$options external me, window\xFE";
 z+="*$options external singleStepping\xFE";
 z+="*$options external modalStep\xFE";
 z+="*$options external function asyncTclExecute(Sentence, ByRef_CapturedData)\xFE";
 z+="*$options external function loadCode(code, id)\xFE";
 z+="*$options external function unloadDynamicScript(id)\xFE";
 z+="*$options external function isPhoneGap() As Boolean\xFE";
 z+="*\xFE";
 z+="    \xFE";
 z+="    i_Open \"MD\" To fMD Else\xFE";
 z+="        If Instr(@Errors, \"quota\") Then\xFE";
 z+="            @Jsb_bf.msgbox(\"I can't write to storage.  Please check you Android > Settings > App permissions > Chrome > Storage is ON\")\xFE";
 z+="            stop\xFE";
 z+="        Else\xFE";
 z+="            @Jsb_bf.msgbox(\"Fatal Error\", @Errors)\xFE";
 z+="            Stop @Errors\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    I_read qPtr From fMD, 'css' Else\xFE";
 z+="        If window.isPhoneGap() Then\xFE";
 z+="            I_write `q`:am():am():`.\\css` on fMD, \"css\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\js` on fMD, \"js\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\fonts` on fMD, \"fonts\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\pics` on fMD, \"pics\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\sounds` on fMD, \"sounds\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\htm` on fMD, \"htm\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\sdcard` on fMD, \"sdcard\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\sdcard` on fMD, \"dblog\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\sdcardapp` on fMD, \"sdcardapp\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\sdcardfiles` on fMD, \"sdcardfiles\" Else Null\xFE";
 z+="            I_write `q`:am():am():`.\\sdcardcache` on fMD, \"sdcardcache\" Else Null\xFE";
 z+="\xFE";
 z+="        Else\xFE";
 z+="            jsbRoot = @jsbRoot\xFE";
 z+="            I_write `q`:am():am():jsbRoot:`css` on fMD, \"css\" Else Null\xFE";
 z+="            I_write `q`:am():am():jsbRoot:`js` on fMD, \"js\" Else Null\xFE";
 z+="            I_write `q`:am():am():jsbRoot:`fonts` on fMD, \"fonts\" Else Null\xFE";
 z+="            I_write `q`:am():am():jsbRoot:`pics` on fMD, \"pics\" Else Null\xFE";
 z+="            I_write `q`:am():am():jsbRoot:`sounds` on fMD, \"sounds\" Else Null\xFE";
 z+="            I_write `q`:am():am():jsbRoot:`htm` on fMD, \"htm\" Else Null\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    /*\xFE";
 z+="    I_Open 'jsb_cache' To FCache Else FCache = Null\xFE";
 z+="    i_Read Postloads From FCache, \"postloads\" Then\xFE";
 z+="        PostLoads = Split(Postloads, am())\xFE";
 z+="        *$options external function unloadDynamicScript(id) \xFE";
 z+="        \xFE";
 z+="        for each postload in PostLoads\xFE";
 z+="            postLoad = ltrim(postLoad)\xFE";
 z+="            if Count(postload, \",\") >= 2 Then\xFE";
 z+="                fName = field(postLoad, \",\", 1)\xFE";
 z+="                iName = field(postLoad, \",\", 2)\xFE";
 z+="                cname = field(postLoad, \",\", 3)\xFE";
 z+="                LoadScript(fName, iName, Cname)\xFE";
 z+="            End If\xFE";
 z+="        Next\xFE";
 z+="    End If\xFE";
 z+="    */\xFE";
 z+="\xFE";
 z+="    // setup theme\xFE";
 z+="    mySession = @Session(UserNo())\xFE";
 z+="    if !mySession Then mySession = {}\xFE";
 z+="    \xFE";
 z+="    if @UserVar('currentTheme') Then \xFE";
 z+="        Theme(@UserVar('currentTheme'))\xFE";
 z+="    ElseIf @application[@jsbAccount:\"_lastTheme\"] Then\xFE";
 z+="        Theme(@application[@jsbAccount:\"_lastTheme\"])\xFE";
 z+="    ElseIf @Session['lastTheme'] Then\xFE";
 z+="        Theme(@Session['lastTheme'])\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    // setup username - happens in new browser tabs\xFE";
 z+="    If mySession.UserName Then\xFE";
 z+="        @Jsb_bf.SignIn(mySession.UserName, true)\xFE";
 z+="    \xFE";
 z+="    ElseIf @Session.LastUserName Then\xFE";
 z+="        @Jsb_bf.SignIn(@Session.LastUserName, true)\xFE";
 z+="        \xFE";
 z+="    Else\xFE";
 z+="         @Jsb_bf.SignIn('guest', true)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If @Session.AttachedDatabase Then \xFE";
 z+="        attachdb @Session.AttachedDatabase else @Session.AttachedDatabase = \"\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    U = @UrlSentence()\xFE";
 z+="    U = U.tclCmd\xFE";
 z+="    @Sentence = U\xFE";
 z+="    Opts = UCase(Field(@Sentence, ' (', 2));\xFE";
 z+="    PgmName = LCase(Field(@Sentence, ' ', 1))\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    // jsb, index, and tcl do an EXECUTE below instead of a Call\xFE";
 z+="    Locate PgmName in [\"tcl\", \"index\", \"jsb\", \"hta\", \"jsbwinform\", \"jsbwinforms\"] else\xFE";
 z+="        If PgmName And Instr(PgmName, \"=\") = 0 then\xFE";
 z+="            i_Read Cv From fMD, PgmName then\xFE";
 z+="                window.document.title = @Sentence\xFE";
 z+="                Execute @Sentence\xFE";
 z+="                Return\xFE";
 z+="            Else\xFE";
 z+="                Print \"Unknown verb: \":PgmName\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    \xFE";
 z+="\xFE";
 z+="        ' Auto Start (EXECUTE @ACCOUNT) \xFE";
 z+="        Url = window.myLocation()\xFE";
 z+="        If Right(Url, 4) <> \"#tcl\" And Right(Url, 1) <> \"#\" And Right(Url, 1) <> \"?\" Then\xFE";
 z+="            AutoStart = @jsbAccount\xFE";
 z+="            \xFE";
 z+="            // If the default Account is \"jsb\" (default), then check the EXE Name\xFE";
 z+="            If AutoStart = \"jsb\" And window.dotNetObj Then\xFE";
 z+="                myExeName = window.dotNetObj.dnoMyExeName()\xFE";
 z+="                if myExeName <> \"jsb\" Then\xFE";
 z+="                    if accountExists(myExeName) Then stop window.Logto(myExeName)\xFE";
 z+="                End If\xFE";
 z+="                i_Read Cv From fMD, myExeName Then AutoStart = myExeName\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            i_Read Cv From fMD, AutoStart Then\xFE";
 z+="                Cv = LCase(CleanupText(Cv))\xFE";
 z+="                me._activeProcess.isUrlAutoStarted = true\xFE";
 z+="                Locate \"cv\" In Cv,1 Then \xFE";
 z+="                    Execute AutoStart\xFE";
 z+="                    Return // we don't go to TCL after an autostart\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    me._dontDisplayInStack = True;\xFE";
 z+="    me.isTCL = true\xFE";
 z+="    me._activeProcess.hasTCLParent = true \xFE";
 z+="    \xFE";
 z+="    \xFE";
 z+="    Loop\xFE";
 z+="        if window.dotNetObj Then \xFE";
 z+="            Act = system(19) \xFE";
 z+="            attachedDB = @Session.AttachedDatabase\xFE";
 z+="        Else \xFE";
 z+="            Act = @jsbAccount\xFE";
 z+="            attachedDB = @Session.AttachedDatabase\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        if attachedDB And attachedDB <> \"jsb\" and attachedDB <> Act then attachedDB = \" \":attachedDB else attachedDB = \"\"\xFE";
 z+="        Prompt Act:attachedDB:\"> \"\xFE";
 z+="        \xFE";
 z+="        @Errors = \"\";\xFE";
 z+="        doDebug = 0; singleStepping = 0; modalStep = 0; \xFE";
 z+="        \xFE";
 z+="        window.document.title = window.myTitle;\xFE";
 z+="        window.changeHistoryStack('tclhistory');\xFE";
 z+="        \xFE";
 z+="        S = \"\"\xFE";
 z+="        javascript {\xFE";
 z+="            S = await asyncInput('', true); \xFE";
 z+="        }\xFE";
 z+="            \xFE";
 z+="        window.document.title = S;\xFE";
 z+="        window.changeHistoryStack('userinput');\xFE";
 z+="        window.clearStatus()\xFE";
 z+="\xFE";
 z+="        if window.dotNetObj Then \xFE";
 z+="            Act = system(19) \xFE";
 z+="            attachedDB = @Session.AttachedDatabase\xFE";
 z+="        Else \xFE";
 z+="            Act = @jsbAccount\xFE";
 z+="            attachedDB = @Session.AttachedDatabase\xFE";
 z+="        End If\xFE";
 z+="        \xFE";
 z+="        if attachedDB And attachedDB <> \"jsb\" and attachedDB <> Act then attachedDB = \" \":attachedDB else attachedDB = \"\"\xFE";
 z+="        Print Chr(28):`<a href=\"\" onclick=\"$('#txtInput').val('`:@HtmlEncode(S):`'); txtInput_CRLF(event);\">`:Chr(29):S:Chr(28):`</a>`:Chr(29)\xFE";
 z+="        \xFE";
 z+="        // window.unloadDynamicScripts()\xFE";
 z+="        \xFE";
 z+="        Try\xFE";
 z+="            If Instr(Opts, \"!\") || Instr(Opts, \"$\") Then debug\xFE";
 z+="            Execute S\xFE";
 z+="        Catch E\xFE";
 z+="            Print E\xFE";
 z+="        End Try\xFE";
 z+="\xFE";
 z+="    While True Do Repeat\xFE";
 z+="End Program\xFE";
 z+="\xFE";
 z+="*\xFE";
 z+="* This version of TCL is used by GAE only (The JS version is below), and ASPX has it built into the framework\xFE";
 z+="*\xFE";
 z+="Program Tcl\xFE";
 z+="*\xFE";
 z+="*$options gae, aspx ;* Allow compile ASPX even though it runs on GAE\xFE";
 z+="*\xFE";
 z+="*$options nodebug\xFE";
 z+="*\xFE";
 z+="    UserNo = @UserNo\xFE";
 z+="    If @IsAuthenticated Then \xFE";
 z+="        Print @Jsb_html.anchor(@Logouturl(), \"Click here to logout\") \xFE";
 z+="    Else \xFE";
 z+="        Print @Jsb_html.anchor(@Loginurl(), \"Click here to login\") ;* Force A Login\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    If @IsAdmin Then\xFE";
 z+="        Print Chr(28):`<script>$('html').css('background-color', 'transparent')</script><div id=\"watermark\" style=\"color: #d0d0d0;font-size: 90pt;-webkit-transform: rotate(-45deg);-moz-transform: rotate(-45deg);position: absolute;width: 100%;height: 100%;margin: 0;z-index: -1;left:70px;top:-100px;\"><p>Jsb Admin</p></div>`:Chr(29):\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Print `Welcome user `:UserNo:` to JSB. This startup program is TCL TCL`\xFE";
 z+="    Print @inputButton('DOCS', Chr(27) : 'DOCS' : Chr(13)):' ':@inputButton('DEMOS', Chr(27) : 'DEMOS' : Chr(13)):' ':@Html(`<a href=\"https://groups.google.com/d/forum/jsb---json-basic\">Blog</a>`)\xFE";
 z+="    Print\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="tclInputLoop: \xFE";
 z+="    attachedDB = @Session.AttachedDatabase\xFE";
 z+="    jsbAccount = @jsbAccount\xFE";
 z+="    \xFE";
 z+="    If @IsAdmin Then gaePrompt = \"[Admin] \":jsbAccount Else gaePrompt = jsbAccount\xFE";
 z+="    If LCase(jsbAccount) <> LCase(attachedDB) And attachedDB Then gaePrompt := \" \":attachedDB\xFE";
 z+="    gaePrompt := \"> \"\xFE";
 z+="    \xFE";
 z+="    Prompt Replace(@HtmlEncode(gaePrompt), \" \", \"&nbsp;\")\xFE";
 z+="\xFE";
 z+="    @Session[UserNo].atTcl = True\xFE";
 z+="    Input S\xFE";
 z+="    @Session[UserNo].atTcl = False\xFE";
 z+="    @Session[UserNo].lastTCLCmd = S\xFE";
 z+="    \xFE";
 z+="    // Echo a quick-click\xFE";
 z+="    Print gaePrompt:Chr(28):`<a href=\"\" onclick=\"$('#txtInput').val('`:HtmlEncode(S):`'); jsb.submit();\">`:Chr(29):S:Chr(28):`</a>`:Chr(29)\xFE";
 z+="    \xFE";
 z+="    Prompt \"? \"\xFE";
 z+="    Execute S\xFE";
 z+="    Goto tclInputLoop\xFE";
 z+="End Program"
window.cached_jsb_tcl["tcl"]=z;
var z="Program TDUMP\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    \xFE";
 z+="    Marker = crlf():\"#EOF#\":crlf()\xFE";
 z+="    options = UCase(DropLeft(@sentence, \"(\"))\xFE";
 z+="    if instr(options, \")\") then options = DropRight(options, \")\")\xFE";
 z+="    \xFE";
 z+="    if field(field(@sentence, \"(\", 1), \" \", 2) = \"\" Then\xFE";
 z+="        print \"T-Dump TableName ItemSelection (options, P{password}, s{Scheme})\"\xFE";
 z+="        print \"   options: \":@Bold(\"T\"):\" - prompt for new tapefile\"\xFE";
 z+="        print \"   options: \":@Bold(\"A\"):\" - append to tapefle\"\xFE";
 z+="        print \"   options: \":@Bold(\"P\"):\" - prompt for password\"\xFE";
 z+="        print \"   options: \":@Bold(\"S\"):\" - prompt for scheme (project name)\"\xFE";
 z+="        print \"Example: t-dump md wh] (s mdtest, p passcode)\"\xFE";
 z+="        stop\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    firstOps = field(options, \" \", 1)\xFE";
 z+="    prompt4TapeFile = instr(firstOps, \"T\")\xFE";
 z+="    append = instr(firstOps, \"A\")\xFE";
 z+="    schemeName = instr(firstOps, \"S\") Or instr(options, \",S\")\xFE";
 z+="    passwordprotect = instr(firstOps, \"P\") Or instr(options, \",P\")\xFE";
 z+="    \xFE";
 z+="    options = replace(options, \", \", \",\")\xFE";
 z+="    if passwordprotect then \xFE";
 z+="        Cypher = ltrim(field(field(\",\":options, \",P\", 2), \",\", 1))\xFE";
 z+="        if !Cypher then Cypher = @inputbox(\"Password Encrypted\", \"Enter your cypher\", @session(\"Cypher\")) \xFE";
 z+="        if !Cypher or Cypher = Chr(27) then stop\xFE";
 z+="        @session(\"Cypher\") = Cypher\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if schemeName then \xFE";
 z+="        schemeName = ltrim(field(field(\",\":options, \",S\", 2), \",\", 1))\xFE";
 z+="        if !schemeName then schemeName = @inputbox(\"Project Scheme\", \"Enter your scheme name\", @session(\"schemeName\")) \xFE";
 z+="        if !schemeName or schemeName = Chr(27) then stop\xFE";
 z+="        @session(\"schemeName\") = schemeName\xFE";
 z+="    Else\xFE";
 z+="        schemeName = \"\"\xFE";
 z+="    end if\xFE";
 z+="    schemeName := \".\"\xFE";
 z+="    \xFE";
 z+="    if !prompt4TapeFile then tapeFile = @Session.tapeFile\xFE";
 z+="\xFE";
 z+="    if field(field(@sentence, \"(\", 1), \" \", 2) = \"\" then\xFE";
 z+="        ListFiles To FileList else Stop @Errors\xFE";
 z+="        FileList = LCase(FileList)\xFE";
 z+="        FileList = am():FileList:am()\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"jsb_users\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"jsb_config\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"system\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"jsb_dictionaries\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"jsb_selectlists\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"rest\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"rests\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"jsb_errmsg\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"tapefile\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"md\":am(), am())\xFE";
 z+="        fileList = ReplaceI(fileList, am():\"tmp\":am(), am())\xFE";
 z+="        filelist = mid(filelist, 2)\xFE";
 z+="        filelist = left(filelist, len(filelist)-1)\xFE";
 z+="\xFE";
 z+="        filelist = @inputMultiSelect('T-DUMP', 'Select files to t-dump', FileList, [], '80%', 'auto', '220px')\xFE";
 z+="        if FileList = \"\" or FileList = Chr(27) then stop\xFE";
 z+="        fileList = Split(fileList, am())\xFE";
 z+="\xFE";
 z+="        for each fname in fileList\xFE";
 z+="            open fname to fHandle then\xFE";
 z+="                fname = trueTableName(fname)\xFE";
 z+="                select fhandle\xFE";
 z+="                gosub tdumpit\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="        stop\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    If !@ParseSelect(@Sentence, \"\", Top, Columns, ddata, fname, FilterBy, OrderBY, Options, AllItems, fHandle) Then Stop\xFE";
 z+="\xFE";
 z+="    select LTrim(Top:' '):Join(Columns, \" \") from fHandle where FilterBy:OrderBY else stop @Errors\xFE";
 z+="\xFE";
 z+="    fname = trueTableName(fname)\xFE";
 z+="    gosub tdumpit\xFE";
 z+="    stop\xFE";
 z+="\xFE";
 z+="tdumpit: \xFE";
 z+="    if !tapeFile Or prompt4TapeFile Then\xFE";
 z+="        if !tapefile then tapefile = \"tapefile\"\xFE";
 z+="        tapeFile = @inputbox(\"Tape File Location\", \"Enter your tape file name\", tapeFile)\xFE";
 z+="        if !tapeFile = Chr(27) then stop\xFE";
 z+="        \xFE";
 z+="        if tapeFile = \"\" then tapeFile = \"tapeFile\"\xFE";
 z+="        if left(tapeFile, 1) = \"(\" then tapeFile = Mid(tapeFile, 2) \xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    open tapeFile to fdump else \xFE";
 z+="        Ans = MsgBox(\"Tape File '\":tapeFile:\"' does not exist, create it?\", \"Yes,*Exit\")\xFE";
 z+="        if Ans <> \"Yes\" Then Stop\xFE";
 z+="        tapeFile = @fHandle(\"\", tapeFile, True)\xFE";
 z+="    End If\xFE";
 z+="\xFE";
 z+="    @Session.tapeFile = tapeFile\xFE";
 z+="\xFE";
 z+="    if ddata = \"\" then ddata = \"data\"\xFE";
 z+="    cnt = 0\xFE";
 z+="    csize = 0\xFE";
 z+="    tsize = 0\xFE";
 z+="    dumpi = 1\xFE";
 z+="    dump = [ddata:\" \":fname:\" BACKUP [\":fHandle:\"]\":am()]\xFE";
 z+="\xFE";
 z+="    if append then\xFE";
 z+="        Loop \xFE";
 z+="            read dat from fdump, schemeName:ddata:'_':fname:'.':dumpi:'.tdump' else break\xFE";
 z+="            dumpi += 1\xFE";
 z+="        while true do Repeat\xFE";
 z+="\xFE";
 z+="        if dumpi > 1 then \xFE";
 z+="            dump = Split(dat, am():\"#\")\xFE";
 z+="            dumpi -= 1\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    Loop\xFE";
 z+="        ReadNext ID Else Break\xFE";
 z+="        read item from fHandle, id then\xFE";
 z+="            if passwordprotect then item = encode(item, Cypher); id = \"::\":id\xFE";
 z+="            if item then item = stx(item)\xFE";
 z+="            dump[-1] = id:am():item\xFE";
 z+="            csize += len(item)\xFE";
 z+="            tsize += len(item)\xFE";
 z+="            cnt = cnt + 1\xFE";
 z+="\xFE";
 z+="            if csize > 512000 then\xFE";
 z+="                dat = Join(dump, am():\"#\") \xFE";
 z+="                if dumpi = 1 then print schemeName:ddata:'_':fname:'.':dumpi:'.tdump': else print \".\":\xFE";
 z+="                @Server.Flush\xFE";
 z+="                write dat on fdump, schemeName:ddata:'_':fname:'.':dumpi:'.tdump' else stop @errors\xFE";
 z+="                dumpi += 1\xFE";
 z+="                dump = [ddata:\" \":fname:\" BACKUP\":am()]\xFE";
 z+="                CSize = 0\xFE";
 z+="            end if        \xFE";
 z+="        Else\xFE";
 z+="            Print 'Unable to read ':id:' from ':fname:\" \":@Errors\xFE";
 z+="        End If\xFE";
 z+="    While ID Do Repeat\xFE";
 z+="\xFE";
 z+="    dat = Join(dump, am():\"#\") \xFE";
 z+="    write dat on fdump, schemeName:ddata:'_':fname:'.':dumpi:'.tdump' else stop @errors\xFE";
 z+="    delete fdump, schemeName:ddata:'_':fname:'.':dumpi+1:'.tdump' else null\xFE";
 z+="    if dumpi > 1 then print\xFE";
 z+="\xFE";
 z+="    print \"Succesfully \":\xFE";
 z+="    if append Then Print \"appended \": else print \"wrote \":\xFE";
 z+="    print tsize:\" bytes, \":cnt:\" items to \":schemeName:ddata:'_':fname:'.':dumpi'.tdump'\xFE";
 z+="\xFE";
 z+="    print anchorEdit(tapefile, schemeName:ddata:\"_\":fname:\".1.tdump\"):\xFE";
 z+="    print CHR(28):`</a>`:CHR(29)\xFE";
 z+="    @Server.Flush\xFE";
 z+="    return\xFE";
 z+=""
window.cached_jsb_tcl["tdump"]=z;
var z="Program Theme\xFE";
 z+="    // Themes = [\"cerulean\", \"cosmo\", \"cyborg\", \"darkly\", \"flatly\", \"journal\", \"lumen\", \"paper\", \"readable\", \"sandstone\", \"simplex\", \"slate\", \"spacelab\", \"superhero\", \"united\", \"yeti\"]\xFE";
 z+="    useTheme = Trim(Field(Field(@Sentence, \" (\", 1), \" \", 2))\xFE";
 z+="    Options = LCase(Trim(Field(@Sentence, \" (\", 2)))\xFE";
 z+="    If Options = \"n\" Then Stop Theme(''):\"Theme removed\"\xFE";
 z+="    \xFE";
 z+="    If !useTheme Then\xFE";
 z+="        If @UserVar('currentTheme') Then Print @Center(@Mark(\"Current theme is \":@UserVar('currentTheme'))) Else Print \"No current theme is selected\"\xFE";
 z+="        Print \"Use \":@Bold(\"Theme *\"):\" or \":@Bold(\"Theme Name\"):\" to select a new theme.\"\xFE";
 z+="        Stop \"Use \":@Bold(\"Theme (n\"):\" to remove theme\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    ThemesCss = Fselect('css', 'ItemId Like \"bootstrap_]\"')\xFE";
 z+="    Themes = []\xFE";
 z+="    For Each Theme In ThemesCss\xFE";
 z+="        Theme = LCase(Theme)\xFE";
 z+="        If Right(Theme, 4) = \".css\" Then Themes[-1] = DropLeft(Left(Theme, Len(Theme) - 4), 'bootstrap_')\xFE";
 z+="    Next\xFE";
 z+="\xFE";
 z+="    If useTheme = \"*\" Then \xFE";
 z+="        useTheme = ChoseATheme()\xFE";
 z+="    Else\xFE";
 z+="        useTheme = LCase(useTheme)\xFE";
 z+="        Locate Field(useTheme, \"_\", 1) In Themes Else Stop \"Unable to find theme \":useTheme\xFE";
 z+="        Print @Jsb_bf.theme(useTheme):\xFE";
 z+="    End If\xFE";
 z+="end Program"
window.cached_jsb_tcl["theme"]=z;
window.cached_jsb_tcl["time"]="Program Time\xFE    Print Time(Time())\xFE    Clearselect\xFEend program\xFE\xFErestful function ServerTime()\xFE   return { time: Time(Time()) }\xFEend function\xFE";
var z="* c - auto create files\xFE";
 z+="* o - overwrite items\xFE";
 z+="* t - prompt for tapefile\xFE";
 z+="*\xFE";
 z+="Program TLOAD\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    options = lcase(DropLeft(@sentence, \"(\"))\xFE";
 z+="    if instr(options, \")\") then options = DropRight(options, \")\")\xFE";
 z+="    if instr(options, \"[\") then options = Field(options, \"[\", 1)\xFE";
 z+="\xFE";
 z+="    if field(field(@sentence, \"(\", 1), \" \", 2) = \"?\" Or InStr(Options, '?') Then\xFE";
 z+="        print \"T-Load {TableName or *} {ItemID or *} (options, P{password}, s{Scheme}, F{rom file}) [Source File Name]\"\xFE";
 z+="        print \"   options: \":@Bold(\"O\"):\" - override items without prompting\"\xFE";
 z+="        print \"   options: \":@Bold(\"T\"):\" - prompt for new tapefile\"\xFE";
 z+="        print \"   options: \":@Bold(\"C\"):\" - create files as needed without prompting\"\xFE";
 z+="        print \"   options: \":@Bold(\"CC\"):\"- create or clear file as needed without prompting\"\xFE";
 z+="        print \"   options: \":@Bold(\"V\"):\" - verify load only\"\xFE";
 z+="        print \"   options: \":@Bold(\"P\"):\" - prompt for password decoding\"\xFE";
 z+="        print \"   options: \":@Bold(\"S\"):\" - prompt for scheme (project name)\"\xFE";
 z+="        print \"   options: \":@Bold(\"F\"):\" - prompt for the source TableName to use\"\xFE";
 z+="        print \"   options: \":@Bold(\"X\"):\" - when done execute this TCL command\"\xFE";
 z+="        print \"   options: \":@Bold(\"L\"):\" - lower case all names\"\xFE";
 z+="        print \"   options: \":@Bold(\"U\"):\" - upper case all names\"\xFE";
 z+="        print \"   options: \":@Bold(\"*\"):\" - Load everything\"\xFE";
 z+="        print\xFE";
 z+="        print \"Example: t-load md (oc, s mdtest, p passcode, x basic bp ok (x\"\xFE";
 z+="        stop\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    useFile = Field(@Sentence, \"[\", 2)\xFE";
 z+="    if instr(useFile, \"(\") then useFile = Field(useFile, \"(\", 1)\xFE";
 z+="    useFile = Field(useFile, \"]\", 1)\xFE";
 z+="    if !useFile Then useFile = ltrim(field(field(\",\":options, \",f\", 2), \",\", 1))\xFE";
 z+="            \xFE";
 z+="    firstOps = field(options, \" \", 1)\xFE";
 z+="    override = instr(firstOps, \"o\")\xFE";
 z+="    if instr(firstOps, \"c\") then autocreate = 1\xFE";
 z+="    if instr(firstOps, \"cc\") then autocreate = 2\xFE";
 z+="    verifyOnly = instr(firstOps, \"v\")\xFE";
 z+="    lowerall = instr(firstOps, \"l\")\xFE";
 z+="    upperall = instr(firstOps, \"u\")\xFE";
 z+="    prompt4source = instr(firstOps, \"f\")\xFE";
 z+="    overwritestring = \"OVERWRITE ITEMS\"\xFE";
 z+="    autocreatestring = \"CREATE FILES\"\xFE";
 z+="    LoadEverything = instr(firstOps, \"*\")\xFE";
 z+="    AskToOverWrite = true\xFE";
 z+="\xFE";
 z+="    options = replace(options, \", \", \",\")\xFE";
 z+="    schemeName = instr(firstOps, \"s\") Or instr(options, \",s\")\xFE";
 z+="    if SchemeName then SchemeName = ltrim(field(field(\",\":options, \",s\", 2), \",\", 1))\xFE";
 z+="\xFE";
 z+="    passwordprotect = instr(firstOps, \"p\") Or instr(options, \",p\")\xFE";
 z+="    if passwordProtect then Cypher = ltrim(field(field(\",\":options, \",p\", 2), \",\", 1))\xFE";
 z+="\xFE";
 z+="    tclCommand = instr(firstOps, \"x\") Or instr(options, \",x\")\xFE";
 z+="    if tclCommand then tclCommand = ltrim(field(field(\",\":options, \",x\", 2), \",\", 1))\xFE";
 z+="\xFE";
 z+="    if passwordProtect then \xFE";
 z+="        Cypher = ltrim(field(field(\",\":options, \",p\", 2), \",\", 1))\xFE";
 z+="        if !Cypher then Cypher = @inputbox(\"Password Encrypted\", \"Enter your cypher\", @session(\"Cypher\")) \xFE";
 z+="        if Cypher = Chr(27) then stop\xFE";
 z+="        @session(\"Cypher\") = Cypher\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    prompt4TapeFile = instr(firstOps, \"t\") Or instr(options, \",t\")\xFE";
 z+="    if prompt4TapeFile then tapeFile = ltrim(field(field(\",\":options, \",t\", 2), \",\", 1))\xFE";
 z+="    if tapefile then prompt4TapeFile = false else tapeFile = @Session.tapeFile\xFE";
 z+="\xFE";
 z+="    if !prompt4TapeFile and !tapefile then \xFE";
 z+="        open tapeFile to fTapeFile then else tapeFile = \"\"\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    if !tapeFile Or prompt4TapeFile Then\xFE";
 z+="        if !tapeFile then tapeFile = @session(\"tapeFile\")\xFE";
 z+="        if !tapeFile then tapefile = \"tapeFile\"\xFE";
 z+="\xFE";
 z+="        tapeFile = @inputbox(\"Tape File Location\", \"Enter your tape file name\", tapeFile)\xFE";
 z+="        if tapeFile = Chr(27) or tapefile = \"\" then stop\xFE";
 z+="\xFE";
 z+="        if left(tapeFile, 1) = \"(\" then \xFE";
 z+="            tapeFile = Mid(tapeFile, 2)\xFE";
 z+="            if InStr(tapeFile, \" \") Then\xFE";
 z+="                useFile = DropLeft(TapeFile, \" \")\xFE";
 z+="                tapeFile = Field(TapeFile, \" \", 1)\xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="\xFE";
 z+="        @session(\"tapeFile\") = tapeFile\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if prompt4source And !useFile then \xFE";
 z+="        if !useFile Then useFile = @session.lastUseFile\xFE";
 z+="        useFile = @inputbox(\"use source file\", \"Source TableName\", usefile) \xFE";
 z+="        if useFile = Chr(27) then stop\xFE";
 z+="        @session.lastUseFile = useFile\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    S = Trim(Field(Field(@Sentence, \"(\", 1), \"[\", 1))\xFE";
 z+="    fname = field(s, \" \", 2)\xFE";
 z+="    if lcase(fname) = \"dict\" or lcase(fname) = \"data\" then\xFE";
 z+="        ddata = lcase(fname)\xFE";
 z+="        fname = field(S, \" \", 3)\xFE";
 z+="        SingleIName = field(S, \" \", 4)\xFE";
 z+="    else\xFE";
 z+="        ddata = \"data\"\xFE";
 z+="        SingleIName = field(S, \" \", 3)\xFE";
 z+="    end if\xFE";
 z+="    if fname = \"*\" Then fname = \"\"\xFE";
 z+="    if SingleIName = \"*\" Then SingleIName = \"\"\xFE";
 z+="    \xFE";
 z+="    open tapeFile to fTapeFile else stop @errors\xFE";
 z+="    @Session.tapeFile = tapeFile\xFE";
 z+="    select from fTapeFile where \"ItemID like '%.1.tdump'\" to ss\xFE";
 z+="    fList = GetList(ss)\xFE";
 z+="\xFE";
 z+="    if !schemeName then \xFE";
 z+="        projects = []\xFE";
 z+="        lastSchemeName = @session.schemeName\xFE";
 z+="        if right(lastSchemeName, 1) = \".\" Then lastSchemeName = Left(lastSchemeName, Len(lastSchemeName) - 1)\xFE";
 z+="        \xFE";
 z+="        for each TapeItemID in fList\xFE";
 z+="            scheme = field(TapeItemID, '.', 1)\xFE";
 z+="            if !Scheme then scheme = '.'\xFE";
 z+="            ddataFName = Field(TapeItemID, '.', 2)\xFE";
 z+="            if lcase(ddata:\"_\":fname) = LCase(ddatafname) then lastSchemeName = scheme\xFE";
 z+="            locate scheme in projects else projects[-1] = scheme\xFE";
 z+="        next\xFE";
 z+="        \xFE";
 z+="        projects = @Sort(projects)\xFE";
 z+="\xFE";
 z+="        if Len(projects) = 1 then\xFE";
 z+="            SchemeName = Projects[LBound(SchemeName)]\xFE";
 z+="        Else\xFE";
 z+="            Locate lastSchemeName in projects else lastSchemeName = \"\"\xFE";
 z+="            \xFE";
 z+="            schemeName = @inputComboBox(\"Project Scheme\", \"Enter your scheme name\", projects, lastSchemeName) \xFE";
 z+="            if schemeName = Chr(27) then stop\xFE";
 z+="        End If\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    if Right(schemeName, 1) <> '.' Then schemeName := '.'\xFE";
 z+="    @session.schemeName = schemeName\xFE";
 z+="\xFE";
 z+="    if tclCommand then \xFE";
 z+="        tclCommand = ltrim(field(field(\",\":options, \",x\", 2), \",\", 1))\xFE";
 z+="        if !tclCommand then tclCommand = @inputbox(\"On Finish\", \"Execute TCL command\", @session(\"tclCommand\")) \xFE";
 z+="        if tclCommand = Chr(27) then stop\xFE";
 z+="        @session(\"tclCommand\") = tclCommand\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    if fname = \"\" then\xFE";
 z+="        FileList = []\xFE";
 z+="        for each TapeItemID in fList\xFE";
 z+="            if left(TapeItemID, Len(schemeName)) = schemeName Then \xFE";
 z+="                TapeItemID = Mid(TapeItemID, Len(schemeName) + 1)\xFE";
 z+="                TapeItemID = Replace(TapeItemID, \".1.tdump\", \"\")\xFE";
 z+="                TapeItemID = Replace(TapeItemID, \"data_\", \"\")\xFE";
 z+="                FileList[-1] = TapeItemID\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="        if !FileList then stop \"There are no items in your tapefile\"\xFE";
 z+="\xFE";
 z+="        ClearSelect\xFE";
 z+="        if !LoadEverything then\xFE";
 z+="            FileList[-1] = autocreatestring\xFE";
 z+="            FileList[-1] = overwritestring\xFE";
 z+="            filelist = @inputMultiSelect('T-LOAD', 'Select files to t-load', FileList, [], '80%', 'auto', '220px')\xFE";
 z+="\xFE";
 z+="            Locate overwritestring in FileList setting spot then\xFE";
 z+="                override = true\xFE";
 z+="                filelist = delete(filelist, spot)\xFE";
 z+="            end if\xFE";
 z+="            Locate autocreatestring in FileList setting spot then\xFE";
 z+="                if !autocreate Then autocreate = 1\xFE";
 z+="                filelist = delete(filelist, spot)\xFE";
 z+="            end if\xFE";
 z+="            if FileList = \"\" or FileList = Chr(27) then stop\xFE";
 z+="            fileList = Split(fileList, am())\xFE";
 z+="        end if\xFE";
 z+="\xFE";
 z+="        for each fname in fileList\xFE";
 z+="            ddata = \"\"\xFE";
 z+="            useFile = \"\"\xFE";
 z+="            if left(fname, 5) = \"dict_\" then\xFE";
 z+="                ddata = \"dict\"\xFE";
 z+="                fname = mid(fname, 6)\xFE";
 z+="            endif\xFE";
 z+="            if !tload_singlefile(fTapeFile, useFile, schemeName, ddata, fname, autocreate, AskToOverWrite, override, \"\", VerifyOnly, Cypher, lowerall, upperall) then stop @errors\xFE";
 z+="        next\xFE";
 z+="\xFE";
 z+="    else\xFE";
 z+="        if !tload_singlefile(fTapeFile, useFile, schemeName, ddata, fname, autocreate, AskToOverWrite, override, SingleIName, VerifyOnly, Cypher, lowerall, upperall) then stop @errors\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    if tclCommand then @Response.Redirect(@jsbRootExecuteTclCmd(tclCommand)) Else Stop \"Done\"\xFE";
 z+="end program\xFE";
 z+="\xFE";
 z+="function tload_singlefile(byval fTapeFile, byval useFile, byval schemeName, byval ddata, byval fname, byval autocreate, ByVal AskToOverWrite, ByVal override, ByVal SingleIName, ByVal VerifyOnly As Boolean, ByVal Cypher, byval lowerall As Boolean, byval upperall As Boolean)\xFE";
 z+="    \xFE";
 z+="    if lowerall then fname = lcase(fname) \xFE";
 z+="    if upperall then fname = ucase(fname)\xFE";
 z+="    \xFE";
 z+="    if useFile = \"\" Then useFile = fname\xFE";
 z+="    if ddata = \"\" then ddata = \"data\"\xFE";
 z+="    if Right(schemeName, 1) <> '.' Then schemeName := '.'\xFE";
 z+="    \xFE";
 z+="    if left(usefile, len(schemeName)) = schemeName then\xFE";
 z+="       readTapeName = useFile\xFE";
 z+="    elseif left(usefile, 5) = \"data_\" or left(usefile, 5) = \"dict_\" then\xFE";
 z+="        readTapeName = schemeName:useFile\xFE";
 z+="    else\xFE";
 z+="        readTapeName = schemeName:ddata:\"_\":useFile\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    mdhold = \"\"\xFE";
 z+="\xFE";
 z+="    if ddata = \"data\" then\xFE";
 z+="        Read MDHold from fHandle('md'), fname Then\xFE";
 z+="            if lcase(mdhold)<1> = \"ql\" Then delete fhandle('md'), fname else mdhold = \"\"\xFE";
 z+="        end if\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    open ddata, fname to ftmp then\xFE";
 z+="        if autocreate = 2 then clearfile fTmp\xFE";
 z+="    else\xFE";
 z+="        If !autocreate Then\xFE";
 z+="            if msgbox(ddata:\" \":fname:\" does not exist. Create it?\", \"*Yes,No\") <> \"Yes\" Then Return True\xFE";
 z+="        End If\xFE";
 z+="\xFE";
 z+="        * Attempt to put programs in the normal file system\xFE";
 z+="        if system(1) = \"js\" and ddata <> \"dict\" then\xFE";
 z+="            ProgramFile = false\xFE";
 z+="            read dat from fTapeFile, readTapeName:\".1.tdump\" then\xFE";
 z+="                Items = Split(dat, Chr(254):\"#\")\xFE";
 z+="                Item = Items[2]\xFE";
 z+="                Item = Delete(Item, 1)\xFE";
 z+="                Item = am():Trim(LCase(XTS(item)))\xFE";
 z+="                ProgramFile = InStr(Item, am():\" program \") Or InStr(Item, am():\" sub \") Or InStr(Item, am():\" subroutine \") Or InStr(Item, am():\" function \") Or InStr(Item, am():\" func \")\xFE";
 z+="                ProgramFile = ProgramFile Or InStr(Item, am():\"program \") Or InStr(Item,am():\"sub \") Or InStr(Item,am():\"subroutine \") Or InStr(Item, am():\"function \") Or InStr(Item, am():\"func \")\xFE";
 z+="            end if\xFE";
 z+="\xFE";
 z+="            // Place in real file system if appropriate\xFE";
 z+="            if ProgramFile Then ProgramFile = isHTA() Or isPhoneGap()\xFE";
 z+="            if ProgramFile Then \xFE";
 z+="                CreateFile \"./\":FName else Return False\xFE";
 z+="            else\xFE";
 z+="                CreateFile FName else Return False\xFE";
 z+="            end if\xFE";
 z+="        else\xFE";
 z+="            CreateFile FName else Return False\xFE";
 z+="        end if\xFE";
 z+="\xFE";
 z+="        if system(1) = \"js\" then CreateFile \"DICT \":FName else return False\xFE";
 z+="        open ddata, fname to ftmp else return False\xFE";
 z+="    end if\xFE";
 z+="\xFE";
 z+="    difs = []\xFE";
 z+="    Cnt = 0\xFE";
 z+="    notcnt = 0\xFE";
 z+="\xFE";
 z+="    for dumpi = 1 to 99999\xFE";
 z+="        tapeName = readTapeName:\".\":dumpi:\".tdump\"\xFE";
 z+="        read dat from fTapeFile, tapeName else \xFE";
 z+="            if mdhold then write mdhold on fhandle('md'), fname \xFE";
 z+="            @errors = \"I was unable to read '\":tapeName:\"' from your tapefile '\":useFile:\"'\"\xFE";
 z+="            return dumpi > 1\xFE";
 z+="        end if\xFE";
 z+="\xFE";
 z+="        Items = Split(dat, Chr(254):\"#\")\xFE";
 z+="        Header = Items[1]\xFE";
 z+="        Header = Header<1>\xFE";
 z+="        if !InStr(Header, \"BACKUP\") Then Stop \"Backup file currupt - incorrect header: \":Header\xFE";
 z+="\xFE";
 z+="        for ItemI = 2 to UBound(Items)\xFE";
 z+="            Item = Items[ItemI]\xFE";
 z+="            I = InStr(Item, am())\xFE";
 z+="            Id = Left(Item, I-1)\xFE";
 z+="            encoded = left(ID, 2) = \"::\"\xFE";
 z+="            if encoded then id = mid(id, 3)\xFE";
 z+="\xFE";
 z+="            If SingleIName = \"\" Or SingleIName = LCase(ID) Then\xFE";
 z+="                Item = Mid(Item, I+1)\xFE";
 z+="                Item = XTS(item)\xFE";
 z+="                If encoded Then \xFE";
 z+="                    if !Cypher then \xFE";
 z+="                        Cypher = @inputbox(\"Password Encrypted\", \"Enter your cypher\") \xFE";
 z+="                        if !Cypher or Cypher = Chr(27) then stop\xFE";
 z+="                    end if\xFE";
 z+="                    Item = Decode(Item, Cypher)\xFE";
 z+="                end if\xFE";
 z+="\xFE";
 z+="                if VerifyOnly then\xFE";
 z+="                    READ X FROM FTMP, ID THEN \xFE";
 z+="                        cnt = cnt + 1\xFE";
 z+="                        if x <> item then \xFE";
 z+="                            difcnt = difcnt + 1\xFE";
 z+="                            if instr(id, \"'\") then Q = '\"' Else Q = \"'\"\xFE";
 z+="                            print anchorEdit(ddata:' ':fname, id):' different'\xFE";
 z+="\xFE";
 z+="                        else\xFE";
 z+="                            cnt = cnt + 1\xFE";
 z+="                        end if\xFE";
 z+="                    else\xFE";
 z+="                        print ID:\" missing\" \xFE";
 z+="                        difcnt = difcnt + 1\xFE";
 z+="                    end if\xFE";
 z+="                else\xFE";
 z+="                    writeit = true\xFE";
 z+="                    if !override then                                  \xFE";
 z+="                        READ X FROM FTMP, ID THEN \xFE";
 z+="                            If AskToOverWrite Then\xFE";
 z+="                                Ans = MsgBox(\"Overwrite\", ID:\" exists on file, overwrite?\", \"Yes,*No,Yes-All,No-All,Cancel\")\xFE";
 z+="                                If Ans = \"Cancel\" Or Ans = \"\" Then Stop\xFE";
 z+="                                If Ans = \"No\" Or Ans = \"No-All\" Then\xFE";
 z+="                                    notcnt = notcnt + 1\xFE";
 z+="                                    writeit = false\xFE";
 z+="                                end if\xFE";
 z+="                                IF Ans = \"No-All\" Then AskToOverWrite = False\xFE";
 z+="                                If Ans = \"Yes-All\" Then override = True\xFE";
 z+="                            else\xFE";
 z+="                                notcnt = notcnt + 1\xFE";
 z+="                                writeit = false\xFE";
 z+="                            End If\xFE";
 z+="                        end if\xFE";
 z+="                    end if\xFE";
 z+="\xFE";
 z+="                    if writeit then\xFE";
 z+="                        if lowerall then id = lcase(id)\xFE";
 z+="                        if upperall then id = ucase(id)\xFE";
 z+="                        \xFE";
 z+="                        if Left(Item, 1) = \"{\" and Right(Item, 1) = \"}\" Then\xFE";
 z+="                            On Error Goto JTryAgain\xFE";
 z+="                            If True Then\xFE";
 z+="                                X = JSon(item)\xFE";
 z+="                            Else\xFE";
 z+="JTryAgain: \xFE";
 z+="                                On Error Goto simpleWrite\xFE";
 z+="                                X = Replace(Item, am(), crlf()) ;* Need to not do this inside of strings\xFE";
 z+="                                X = JSon(item)\xFE";
 z+="                            End If\xFE";
 z+="                            On Error Goto 0\xFE";
 z+="\xFE";
 z+="                            If X[\"_ItemContent_\"] Then\xFE";
 z+="                                WRITE X[\"_ItemContent_\"] ON FTMP, ID ELSE STOP 'NO WRITE OF ':ID\xFE";
 z+="                            Else\xFE";
 z+="                                WriteJson X ON FTMP, ID ELSE STOP 'NO WRITEJSON OF ':ID:crlf():X\xFE";
 z+="                            End If\xFE";
 z+="                        Else\xFE";
 z+="simpleWrite: \xFE";
 z+="                            On Error Goto 0\xFE";
 z+="                            WRITE ITEM ON FTMP, ID Then ELSE STOP 'NO WRITE OF ':ID\xFE";
 z+="                        End If\xFE";
 z+="                        cnt = cnt + 1\xFE";
 z+="                    end if\xFE";
 z+="                end if\xFE";
 z+="            End If\xFE";
 z+="        next\xFE";
 z+="\xFE";
 z+="        if VerifyOnly then\xFE";
 z+="            print ddata:\" \":useFile:\".\":dumpi:\" (Same: \":cnt:\" - Different:\":difcnt:\")\"\xFE";
 z+="        else if notcnt Then\xFE";
 z+="            print ddata:\" \":useFile:\".\":dumpi:\" (Loaded: \":cnt:\" - Not Loaded:\":notcnt:\")\"\xFE";
 z+="        else\xFE";
 z+="            print ddata:\" \":useFile:\".\":dumpi:\" (Loaded: \":cnt:\" records)\"\xFE";
 z+="        endif\xFE";
 z+="        @Server.Flush\xFE";
 z+="    next\xFE";
 z+="\xFE";
 z+="    if mdhold then write mdhold on fhandle('md'), fname \xFE";
 z+="\xFE";
 z+="    return true\xFE";
 z+=""
window.cached_jsb_tcl["tload"]=z;
var z="Program Touch\xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="\xFE";
 z+="    If !@ParseSelect(@Sentence, \"\", Top, Columns, Dict, Fname, FilterBy, OrderBY, Options, AllItems, F) Then Stop\xFE";
 z+="\xFE";
 z+="    If !AllItems And !FilterBy And !System(11) Then Stop 'Touch TableName<ItemNames | *>'\xFE";
 z+="\xFE";
 z+="    Select LTrim(Top:' '):Join(Columns, \" \") From F Where FilterBy:OrderBY Else Stop @Errors\xFE";
 z+="\xFE";
 z+="    Readnext Id Else Stop\xFE";
 z+="    \xFE";
 z+="    tCnt = 0\xFE";
 z+="    Quiet = Instr(Options, 'I')\xFE";
 z+="    \xFE";
 z+="    For Cnt = 1 To 100000 While Id <> \"\"\xFE";
 z+="        Read Xx From F, Id Then\xFE";
 z+="            delete f, id else msgbox(@errors)\xFE";
 z+="            Write Xx On F, Id Else Stop @Errors\xFE";
 z+="            tCnt += 1\xFE";
 z+="        End Else\xFE";
 z+="            Print Id:\" not on file\"\xFE";
 z+="        End If\xFE";
 z+="        Readnext Id Else Break\xFE";
 z+="    Next\xFE";
 z+="    If tCnt > 1 Then Print tCnt:\" items touched\"\xFE";
 z+="    If tCnt = 1 Then Print \"One item touched\"\xFE";
 z+="    If !tCnt Then Print \"No items touched\"\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["touch"]=z;
window.cached_jsb_tcl["undelete"]="Program UnDelete\xFE    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE\xFE    If !@ParseSelect(@Sentence, \"\", Top, Columns, Dict, Fname, FilterBy, OrderBY, Options, AllItems, F) Then Stop\xFE    If !AllItems And !FilterBy And !System(11) Then Stop 'Touch UnDelete TrashCan <ItemNames | *>'\xFE    Select LTrim(Top:' '):Join(Columns, \" \") From F Where FilterBy:OrderBY Else Stop @Errors\xFE\xFE    Readnext Id Else Stop \"Please select something!\"\xFE    \xFE    For Cnt = 1 To 100000 While Id <> \"\"\xFE        unTrashIt(fName, id)\xFE        print anchorEdit(fname, id)\xFE        ReadNext Id Else Break\xFE    Next\xFE    \xFEEnd Program\xFE";
var z="program unzip\xFE";
 z+="*\xFE";
 z+="*$options aspx, aspxc-\xFE";
 z+="*\xFE";
 z+="*\xFE";
 z+="*  7z -x zip.zip -o.\\wwwroot\xFE";
 z+="*\xFE";
 z+="* This program relies on 7z.exe being n the bin directory\xFE";
 z+="*   see  https://sevenzip.osdn.jp/chm/cmdline/commands/extract.htm\xFE";
 z+="*\xFE";
 z+="    If !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    S = Trim(@Sentence)\xFE";
 z+="    toFile = Trim(Field(S, \"(\", 2))\xFE";
 z+="    toFile = Replace(toFile, \"!\", \"\")\xFE";
 z+="    S = Trim(Field(S, \"(\", 1))\xFE";
 z+="    \xFE";
 z+="    DData = \"\"\xFE";
 z+="    FName = LCase(Field(s, \" \", 2))\xFE";
 z+="    IName = \"\"\xFE";
 z+="    if FName = \"dict\" or FName = \"data\" then\xFE";
 z+="        DData = FName\xFE";
 z+="        FName = LCase(Field(s, \" \", 3))\xFE";
 z+="        IName = LCase(Field(s, \" \", 4))\xFE";
 z+="    else\xFE";
 z+="        IName = LCase(Field(s, \" \", 3))\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if fname = \"\" or IName = \"\" then Stop \"UpZip FName IName (toFile or directory\"\xFE";
 z+="    \xFE";
 z+="    open fname to srcFile else stop @Errors\xFE";
 z+="    if toFile = \"\" Then \xFE";
 z+="        toFile = @Session(\"lastToFile\")\xFE";
 z+="        toFile = InputBox(\"Destination file\", \"To File\", toFile)\xFE";
 z+="        if toFile = \"\" or ToFile = Chr(27) Then Stop\xFE";
 z+="        @Session(\"lastToFile\") = toFile\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    open toFile to dstFile Else stop @Errors\xFE";
 z+="    if field(srcFile, \":\", 1) <> \"dos\" Or field(dstFile, \":\", 1) <> \"dos\" then stop \"I can only unzip from and to DOS files\"\xFE";
 z+="\xFE";
 z+="    srcdir = FilePath(srcFile) \xFE";
 z+="    dstdir = FilePath(dstFile)\xFE";
 z+="\xFE";
 z+="    Cmd = `.\\bin\\7z x `:srcDir:IName:` -y -o`:dstdir:` *`   ;* e - extract l - list\xFE";
 z+="    print Cmd\xFE";
 z+="    \xFE";
 z+="    result = @@dosExecute((cd), Cmd, errs)\xFE";
 z+="    if result then print @monoSpace(Replace(result, am(), crlf()))\xFE";
 z+="    if errs then print @monospace(errs)\xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["unzip"]=z;
window.cached_jsb_tcl["url"]="PROGRAM URL\xFEPRINT @Anchor(@URL, @URL)";
var z="Program View\xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    Dim Help As Array = [\"View TableName <Itemnames> {(options)}\"]\xFE";
 z+="    \xFE";
 z+="    $Include __shell\xFE";
 z+="    \xFE";
 z+="    picExtensions = Split(\"gif,png,bmp,ico,tif,pdf,jpg\", \",\")\xFE";
 z+="    For Each iName As String, ItemI As Integer In INames\xFE";
 z+="        Dim Ext As String = @FieldRight(UCase(iName), \".\")\xFE";
 z+="        Dim HDoc As Boolean = Ext = \"HTM\" Or Ext = \"HTML\"\xFE";
 z+="        \xFE";
 z+="        If Isrestrictedfile(TableName) And System(1) <> \"js\" Then Stop @Url\xFE";
 z+="        \xFE";
 z+="        Read Item From F_file, iName Else\xFE";
 z+="            If Len(@Errors) Then Errors[-1] = @Errors Else Errors[-1] = 'Item ':iName:' not found.'\xFE";
 z+="            Cycle\xFE";
 z+="        End\xFE";
 z+="        \xFE";
 z+="        Loop While True Do\xFE";
 z+="            Cmds = @Jsb_html.submitbtn('btn','EXIT')\xFE";
 z+="            \xFE";
 z+="            R4 = FieldRight(LCase(iName), \".\")\xFE";
 z+="            Locate R4 In picExtensions Then\xFE";
 z+="                If Left(Item, 5) = \"data:\" Then\xFE";
 z+="                    Editor = Image(Item)\xFE";
 z+="                Else\xFE";
 z+="                    Pic64encoded =  Encode(Item, 64)\xFE";
 z+="                    Editor = Image(`data:image/jpeg;base64,`:Pic64encoded)\xFE";
 z+="                End If\xFE";
 z+="                \xFE";
 z+="                Print @(-1):Editor:Cmds:\xFE";
 z+="            Else\xFE";
 z+="                Item = Change(Item, Crlf(), Am())\xFE";
 z+="                Item = Change(Item, Chr(13), Am())\xFE";
 z+="                Item = Change(Item, Chr(10), Am())\xFE";
 z+="                Item = Change(Item, Chr(226):Chr(128):Chr(152), \"'\")\xFE";
 z+="                Item = Change(Item, Chr(226):Chr(128):Chr(153), \"'\")\xFE";
 z+="                Item = Change(Item, Am(), Chr(10))\xFE";
 z+="                Item = Change(Item, Chr(160), Chr(10))\xFE";
 z+="                \xFE";
 z+="                If HDoc Then\xFE";
 z+="                    I = Instr(Item, \"* Category:\")\xFE";
 z+="                    J = Instr(I, Item, \"<\")\xFE";
 z+="                    Item = Mid(Item, J)\xFE";
 z+="                    Loop While Left(Item, 4) = \"<br>\" Do Item = Mid(Item, 5) Repeat\xFE";
 z+="                    \xFE";
 z+="                    Print @(-1):@Html(`<div style=\"width:100%; background: white; color:black; height:100%;\">`):@Rows2(\"40px\", @Html(`<div style=\"width:100%; background: lightgray; height:100%; overflow: hidden;\">`):@Center(Cmds:\" You are viewing \":Fname:\" \":iName):Html('</div>'), \"%\", @Html(\"<br>\":Item)):@Html('</div>'):\xFE";
 z+="                    \xFE";
 z+="                End Else\xFE";
 z+="                    If Instr(LCase(Item[1,1000]), \"program\") Then\xFE";
 z+="                        Cmds = Cmds:@Jsb_html.submitbtn('btn','RUN'):@Jsb_html.submitbtn('btn','DEBUG')\xFE";
 z+="                        If @Isadmin Then Cmds = Cmds:@Jsb_html.submitbtn('btn','COMPILE')\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                    NewItem = []\xFE";
 z+="                    Item = Split(Item, Chr(10))\xFE";
 z+="                    For Each Line, LineI In Item\xFE";
 z+="                        NewItem[-1] = LineI:\" \":Line\xFE";
 z+="                    Next\xFE";
 z+="                    \xFE";
 z+="                    Editor = @Jsb_html.prettyPrint(Join(NewItem, Chr(10)))\xFE";
 z+="                    If @Isadmin Then Cmds = Cmds:@Jsb_html.submitbtn('btn','EDIT')\xFE";
 z+="                    Print @(-1):@Jsb_html.rows2(\"50px\", @Html(`<div style=\"width:100%; background: lightgray; height:100%; overflow: hidden;\">`):@Center(Cmds:\" You are viewing \":Fname:\" \":iName):@Html(\"</div>\"), \"%\", @Html(Editor)):\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="            \xFE";
 z+="            \xFE";
 z+="            @Server.PAUSE\xFE";
 z+="            \xFE";
 z+="            Btn = @Formvar(\"btn\")\xFE";
 z+="            Ta = @FormVar(\"TA\")\xFE";
 z+="            \xFE";
 z+="            Print @(-1):\xFE";
 z+="            *\xFE";
 z+="            Select Case Btn\xFE";
 z+="                Case \"EXIT\"\xFE";
 z+="                    Break\xFE";
 z+="                    \xFE";
 z+="                Case \"RUN\";  Execute iName\xFE";
 z+="                Case \"DEBUG\";  Execute iName:\" (!\"\xFE";
 z+="                Case \"COMPILE\";\xFE";
 z+="                    If Right(UCase(iName), 4) = \".HTM\" Or Right(UCase(iName), 5) = \".HTML\" Or UCase(Fname) = \"HTM\" Then\xFE";
 z+="                        ErrCnt = @ExtractExamples(iName, Item)\xFE";
 z+="                        If ErrCnt = 0 Then\xFE";
 z+="                            Write Item On F_file, iName Else Msg = @Errors; Ans = @MsgBox(\"Error\", Msg, \"*OK\")\xFE";
 z+="                        End If\xFE";
 z+="                    Else\xFE";
 z+="                        Print @(-1):\xFE";
 z+="                        Execute \"BASIC \":Fname:\" \":iName Capturing XMsg\xFE";
 z+="                        P = Instr(XMsg, \"^\")\xFE";
 z+="                        ErrCnt = 1\xFE";
 z+="                        If P Then\xFE";
 z+="                            LineNo = Dcount(XMsg[1, P], Am())\xFE";
 z+="                            Msg = XMsg<LineNo-1>:Crlf():XMsg<LineNo>\xFE";
 z+="                        Else\xFE";
 z+="                            ErrCnt = 0\xFE";
 z+="                        End If\xFE";
 z+="                        \xFE";
 z+="                        If Btn = \"CompileX\" And ErrCnt = 0 Then Print @(-1):\"SUCCESSFUL Compile!\":; Return\xFE";
 z+="                    End If\xFE";
 z+="                    \xFE";
 z+="                Case \"EDIT\"; Execute \"ED \":Fname:\" '\":iName:\"'\"\xFE";
 z+="                Case \"EDITN\"; Execute \"ED \":Fname:\" '\":iName:\"' (N\"\xFE";
 z+="            End Select\xFE";
 z+="            \xFE";
 z+="            Sleep 2\xFE";
 z+="        Repeat\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors Then Print MonoSpace(Join(Errors, Crlf()))\xFE";
 z+="\xFE";
 z+="    If @hasTclParent Or @hasParentProcess Then\xFE";
 z+="        Print @Script(\"if (parent.refreshData) parent.refreshData();\")\xFE";
 z+="        Stop\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    If @ParamVar('fromPage') Then @Response.Redirect(@ParamVar('fromPage'))\xFE";
 z+="    If Len(Errors) Then MsgBox(Replace(@Errors, Am(), Crlf()))\xFE";
 z+="End Program"
window.cached_jsb_tcl["view"]=z;
window.cached_jsb_tcl["what"]="program what\xFEprint @browserType";
var z="program where\xFE";
 z+="    *$options aspx\xFE";
 z+="    \xFE";
 z+="    if !@isAdmin Then Stop \"You are not an administrator\"\xFE";
 z+="    mySID = @UserNo\xFE";
 z+="    Options = field(lcase(@sentence), \"(\", 2)\xFE";
 z+="    showPages = InStr(Options, \"p\")\xFE";
 z+="    Earlier =Val( Field(Options, '-', 2) )\xFE";
 z+="    includeall = InStr(Options, 'i')\xFE";
 z+="    \xFE";
 z+="    for UserI = 0 to @Application.Contents.Count - 1\xFE";
 z+="        oUser = @Application.Contents[Useri]\xFE";
 z+="\xFE";
 z+="        if typeOf(oUser) = \"JSonBasic.clsJsbUser\" then\xFE";
 z+="            oVT = oUser.oVT\xFE";
 z+="            if TypeOf(oVT) = 'JSonBasic.clsVtInternal' then\xFE";
 z+="                htmlBuf = Trim(oUser.oVT.buffer)\xFE";
 z+="                if htmlBuf And !InStr(htmlBuf, `Unknown&nbsp;TCL&nbsp;command:&nbsp;pics&nbsp;favicon.ico`) then\xFE";
 z+="                    oProcess = oUser.oProcess\xFE";
 z+="                    if oUser.mySID <> mySID then\xFE";
 z+="                        print @hr\xFE";
 z+="                        print oUser.mySID:\" \":oProcess.BeginTime:\" \":\xFE";
 z+="                        print \"Tasks: \":oProcess.Tasks()\xFE";
 z+="                        print \"IsAdmin: \":oProcess.IsAdmin\xFE";
 z+="                        if showPages Then print @Div(\"\", @Html(htmlBuf), { style: 'border: solid 2px blue; font-size: small;' })\xFE";
 z+="                    end if\xFE";
 z+="                end if\xFE";
 z+="            end if\xFE";
 z+="        end if\xFE";
 z+="    next\xFE";
 z+="\xFE";
 z+="    For i = now ()-3 to now()\xFE";
 z+="        toDay = theMonth(i)+0:\"_\":theDay(i)+0:\"_\":theYear(i)\xFE";
 z+="        print @HR:H2(Date(i))\xFE";
 z+="        log = Split(fread(`.\\App_Data\\`, \"auditlog_\":toDay:\".txt\"), am())\xFE";
 z+="        read ignoreips from fhandle('ip_database'), 'ignoreips' else ignoreips = []\xFE";
 z+="        for j = 1 to len(log)\xFE";
 z+="            ip = field(log[j], '*', 1)\xFE";
 z+="            \xFE";
 z+="            if left(ip, 3) = \"10.\" then\xFE";
 z+="            \xFE";
 z+="            Elseif includeall then\xFE";
 z+="                print monospace(whereis(ip):' ':log[j])\xFE";
 z+="            \xFE";
 z+="            else locate ip in ignoreips else\xFE";
 z+="                print monospace(whereis(ip):' ':log[j])\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="    Next i"
window.cached_jsb_tcl["where"]=z;
var z="program whereIs\xFE";
 z+="    *$options aspx\xFE";
 z+="\xFE";
 z+="    ItemIds = Split(@Sentence, ' ', 4)\xFE";
 z+="    If Len(ItemIDs) <= 1 then stop 'WhereIs ItemName'\xFE";
 z+="    \xFE";
 z+="    fNames = ['jsb_html', 'jsb_bf', 'jsb_odb', 'jsb_mdl', 'jsb_ctls', 'jsb_tcl']\xFE";
 z+="    fHandles = []\xFE";
 z+="    for each fname in fNames\xFE";
 z+="        f = fhandle('dict', fname)\xFE";
 z+="        fhandles[-1] = f\xFE";
 z+="    next\xFE";
 z+="    \xFE";
 z+="    for ItemI = LBound(ItemIDs) + 1 to UBound(ItemIDs)\xFE";
 z+="        ItemId = ItemIds[ItemI]\xFE";
 z+="        \xFE";
 z+="        for each f, fi in fHandles\xFE";
 z+="            readjson Pdef from f, itemid:'.def' then\xFE";
 z+="                if PDef.SUB_FNAME then\xFE";
 z+="                    print Itemid:\" is in \":PDef.SUB_FNAME:\" at \":anchorEdit(PDef.SUB_FNAME, PDef.SUB_INAME, PDef.SUB_INAME, False, Null, Pdef.SUB_FIRSTLINE):\" line \":Pdef.SUB_FIRSTLINE\xFE";
 z+="                end if\xFE";
 z+="            end if\xFE";
 z+="        next\xFE";
 z+="    next\xFE";
 z+="End Program"
window.cached_jsb_tcl["whereis"]=z;
window.cached_jsb_tcl["which"]="Program Which\xFEPRINT SYSTEM(1)\xFECLEARSELECT";
window.cached_jsb_tcl["who"]="Program Who\xFE    $options aspx, js\xFE    If @IsAuthenticated Then\xFE        Print @Bold(\"UserName: \"):@UserName:\"; \":@Bold(\"Account: \"):@Account:\"; \":\xFE        if !IsMobile() Then Print @Bold(\"Domain: \"):@Userdomain:\"; \":@Bold(\"email: \"):@Email:\xFE        If @IsEmployee Then Print \"; Role: \":@roleDescription:\"; \" Else Print\xFE        Print @jsb_html.Anchor('off', \"Click here to logout\")\xFE\xFE    End Else\xFE        Print \"You are not logged in\"\xFE        Print @jsb_html.Anchor(@Loginurl, \"Click here to login\")\xFE    End\xFE    Clearselect\xFE    ";
window.cached_jsb_tcl["whois"]="Program Whois\xFE    Print Whois(Field(Trim(@Sentence), \" \", 2))\xFEEnd Program\xFE\xFEProgram Whereis\xFE    Arg = Field(Trim(@Sentence), \" \", 2)\xFE    If Count(Arg, \".\") = 3 And Isnum(Field(Arg, \".\", 1)) Then Stop Whereis(Arg)\xFE    Read Cat From Fhandle('md'), Arg Then\xFE        Locate 'cv' In Cat<1> Setting Spot Then\xFE            Ed = Cat<4, Spot>\xFE            If Ed Then Stop anchorEdit(Field(Ed, \" \", 2), Field(Ed, \" \", 3), \"!\", \"\", \"\", Field(ed, \"(\", 2))\xFE        End If\xFE    End If\xFE    \xFEEnd Program\xFE\xFE";
window.cached_jsb_tcl["windowclose"]="program windowClose\xFE    print @script('window.close()'):\xFE    @server.end";
var z="Program Wip\xFE";
 z+="    \xFE";
 z+="    Fname = Trim(lcase(Field(Field(@Sentence, ' ', 2), ' (', 1)))\xFE";
 z+="    Options = LCase(Trim(Field(@Sentence, ' (', 2)))\xFE";
 z+="    Fl = @fHandle(\"\", \"JSB_SelectLists\", True)\xFE";
 z+="    \xFE";
 z+="    if fname = \"n\" || fname = \"e\" then options = fname; fname = \"\"\xFE";
 z+="    \xFE";
 z+="    If Fname Then\xFE";
 z+="        Write Fname On Fl, 'wip_fname' Else Stop @Errors\xFE";
 z+="        Read Wip From Fl, Fname Else Stop @Errors\xFE";
 z+="        Write Wip On Fl, 'wip'\xFE";
 z+="    Else\xFE";
 z+="        Read Fname From Fl, 'wip_fname' Else Stop 'wip savelist-name (options: e)dit or n)ext'\xFE";
 z+="        Read Wip From Fl, 'wip' Else Stop \"Your list is empty\"\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Wip = Split(Wip, am())\xFE";
 z+="    if options = \"n\" Then\xFE";
 z+="        Wip = Delete(Wip, 1)\xFE";
 z+="        \xFE";
 z+="        if !Wip Then \xFE";
 z+="            delete fl, 'wip' else stop @Errors\xFE";
 z+="            stop 'Your are finished!'\xFE";
 z+="        end if\xFE";
 z+="        write wip on fl, 'wip'\xFE";
 z+="    end if\xFE";
 z+="    \xFE";
 z+="    if options = \"e\" then\xFE";
 z+="        id = wip[1]\xFE";
 z+="        chain \"ed \":fname:\" \":id\xFE";
 z+="    else\xFE";
 z+="        \xFE";
 z+="        For Each Id, I In Wip \xFE";
 z+="            if i > 10 then break\xFE";
 z+="            Print anchorEdit(Fname, Id, Id)\xFE";
 z+="        Next\xFE";
 z+="        if i = 10 then print \"...\"\xFE";
 z+="        Print anchorEdit(\"JSB_SelectLists\", \"WIP\", Len(Wip):\" items in JSB_SelectLists WIP\")\xFE";
 z+="    End If\xFE";
 z+="End Program\xFE";
 z+=""
window.cached_jsb_tcl["wip"]=z;
window.cached_jsb_tcl["xor"]="Program XOR\xFE   A = XTD(FIELD(@SENTENCE,' ',2))\xFE   B = XTD(FIELD(@SENTENCE,' ',3))\xFE   PRINT DTX(BITXOR(A, B))\xFE   CLEARSELECT";
window.cached_jsb_tcl["xtd"]="Program XTD\xFE*\xFE* Convert a HEX number to decimal\xFE* \xFE   i = 2\xFE   loop\xFE      A = FIELD(@SENTENCE,' ',I)\xFE   while A do\xFE      PRINT XTD(A):\" \":\xFE      I += 1\xFE   repeat\xFE\xFE   PRINT\xFE   CLEARSELECT";
window.cached_jsb_tcl["xts"]="Program XTS\xFE* Convert a HEX string to characters\xFE* \xFE   S = Field(UCase(Trim(@SENTENCE)),' ', 2)\xFE   if Left(S,2) = \"0X\" Then S = Mid(S, 3)\xFE   S = XTS(S)\xFE   If isValidJson(S) Then Print CJSON(S) Else Print S\xFE   CLEARSELECT";
var z="\xFE";
 z+="Program Zip\xFE";
 z+="    $options aspx, aspxc-\xFE";
 z+="\xFE";
 z+="    // If we have only 1 file and 1 item\xFE";
 z+="    \xFE";
 z+="    If  !IsAdmin() Then Stop \"You are not an administrator\"\xFE";
 z+="    If !@ParseSelect(@Sentence, defaultTop, Top, Columns, dict, fname, FilterBy, OrderBY, Options, AllItems, f) Then Stop \"Zip FileName *\"\xFE";
 z+="    if !FilterBy And !System(11) Then AllItems = True\xFE";
 z+="    \xFE";
 z+="    /*\xFE";
 z+="    print FilterBy:\" \": System(11)\xFE";
 z+="    if !FilterBy then Print \"!Filterby\"\xFE";
 z+="    if !System(11) Then Print \"!System(11)\"\xFE";
 z+="    */\xFE";
 z+="    outputdir = DropRight(@jsbrootdir, `\\`)\xFE";
 z+="    \xFE";
 z+="    if left(fname, 1) = \".\" or left(fname, 1) = `\\` then fname = 'zip'\xFE";
 z+="    \xFE";
 z+="    // Only one item ID given ending in .7z or .zip?  Test for an unzip\xFE";
 z+="    if AllItems then\xFE";
 z+="        // This is a zip up\xFE";
 z+="        if typeoffile(f) <> \"dos\" then stop \"Type of file must be DOS file\"\xFE";
 z+="        path = FilePath(f)\xFE";
 z+="        \xFE";
 z+="        open outputdir to fOutputDir else Stop @Errors\xFE";
 z+="        batchFile = `\xFE";
 z+="                    @echo off\xFE";
 z+="                    rem\xFE";
 z+="                    rem This batch file is used to create sysprog.zip which is used by the jsbWinforms (chrome.exe) version of jsb\xFE";
 z+="                    rem\xFE";
 z+="\xFE";
 z+="                    set baseDirectory=`:path:`\xFE";
 z+="                    set outputfolder=`:outputDir:`\xFE";
 z+="                    set fname=`:fname:`\xFE";
 z+="                    set binDirectory=`:JSBRootDir():`bin\xFE";
 z+="                    set exclusions=-xr!_gsdata_ -xr!*.zip -xr!winforms\xFE";
 z+="                    set flags=-tzip -mmt=off -mx3\xFE";
 z+="                    \xFE";
 z+="                    del %outputfolder%\\%fname%.zip 2> NUL\xFE";
 z+="                    del %outputfolder%\\%fname%.txt 2> NUL\xFE";
 z+="                    \xFE";
 z+="                    rem directory is important for base of 7z archive\xFE";
 z+="                    cd %baseDirectory%\xFE";
 z+="                    %binDirectory%\\7z %flags% a %outputfolder%\\%fname%.zip %exclusions% > %outputfolder%\\%fname%.txt 2>NUL\xFE";
 z+="        `\xFE";
 z+="        \xFE";
 z+="        Loop While InStr(batchFile, crlf():\" \") do batchFile = Replace(batchFile, crlf():\" \", crlf()) repeat\xFE";
 z+="        write batchFile on fOutputDir, fname:'.bat' else stop @errors\xFE";
 z+="\xFE";
 z+="        // ==================================== ZIP THE DIRECTORY ==================================== \xFE";
 z+="        Print \"Zipping up... (\":anchoredit(\".\", fname:'.bat'):\")\"\xFE";
 z+="        @Server.flush\xFE";
 z+="       \xFE";
 z+="        Result = @@dosExecute((outputDir), fname:\".bat\", Errs)\xFE";
 z+="\xFE";
 z+="        If Errs Then Stop Errs\xFE";
 z+="        \xFE";
 z+="        Read logFile From fOutputDir, fname:'.txt' Else Msgbox(@Errors)\xFE";
 z+="        If Instr(logFile, 'Error:') Then Stop Field(logFile, 'Error:', 2)\xFE";
 z+="        \xFE";
 z+="        Chain \"download \":outputdir:\" \":fname:\".zip\"\xFE";
 z+="    Else\xFE";
 z+="        Stop \"Can only ZIP entire directories right now.\"\xFE";
 z+="    \xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="end program\xFE";
 z+=""
window.cached_jsb_tcl["zip"]=z;
var z="*\xFE";
 z+="\xFE";
 z+="* Globals for the LIST/SORT routines\xFE";
 z+="*\xFE";
 z+="   EQU PRIME TO 1                     ;* Header style, ERRMSG #'s\xFE";
 z+="*\xFE";
 z+="   EQU SSVM TO CHAR(251)\xFE";
 z+="*\xFE";
 z+="   EQU DISKBLOCK TO 8000\xFE";
 z+="*\xFE";
 z+="   EQU MEMSIZE TO 8000               ;* Sort(locate) memory needed\xFE";
 z+="   EQU MAXCOLS TO 90\xFE";
 z+="*\xFE";
 z+="* LIST/SORT STYLE\xFE";
 z+="*\xFE";
 z+="   EQU C_EQ TO CHAR(5) ; EQU C_GT TO CHAR(3) ; EQU C_LT TO CHAR(6)\xFE";
 z+="   EQU C_LE TO CHAR(8) ; EQU C_GE TO CHAR(5) ; EQU C_NE TO CHAR(7)\xFE";
 z+="   EQU C_AND TO CHAR(10) ; EQU C_OR TO CHAR(9) ; EQU C_NOT TO CHAR(7)\xFE";
 z+="   EQU C_ONLY TO CHAR(26) ; EQU C_WITH TO CHAR(27)\xFE";
 z+="   EQU C_HEADING TO CHAR(19) ; EQU C_FOOTING TO CHAR(23)\xFE";
 z+="   EQU C_BY TO CHAR(12) ; EQU C_BYDSND TO CHAR(13)\xFE";
 z+="   EQU C_BYEXP TO CHAR(48) ; EQU C_BYEXPDSND TO CHAR(49)\xFE";
 z+="   EQU C_EACH TO CHAR(51) ; EQU C_IDSPP TO CHAR(18)\xFE";
 z+="   EQU C_USING TO CHAR(24) ; EQU C_STR TO CHAR(1)\xFE";
 z+="   EQU C_ID TO CHAR(2) ; EQU C_DICT TO CHAR(20) ; EQU C_DATA TO CHAR(63)\xFE";
 z+="   EQU C_HDRSPP TO CHAR(28) ; EQU C_BREAKON TO CHAR(16)\xFE";
 z+="   EQU C_COLHDRSPP TO CHAR(243) ; EQU C_DBLSPC TO CHAR(21) ; EQU C_DETSPP TO CHAR(17)\xFE";
 z+="   EQU C_GNDTOTAL TO CHAR(201) ; EQU C_LPTR TO CHAR(33) ; EQU C_TOTAL TO CHAR(15)\xFE";
 z+="   EQU C_NOPAGE TO CHAR(30) ; EQU C_TAPE TO CHAR(244)\xFE";
 z+="   EQU C_EOL TO CHAR(245) ; EQU C_THROWAWAY TO CHAR(38)\xFE";
 z+="   EQU C_WITHOUT TO CHAR(39)\xFE";
 z+="*\xFE";
 z+="* Equates for DISPLAYTBL\xFE";
 z+="*\xFE";
 z+="   EQU DIS_ATR TO 1\xFE";
 z+="   EQU DIS_CONVI TO 2\xFE";
 z+="   EQU DIS_CONVO TO 3\xFE";
 z+="   EQU DIS_BRKTXT TO 4\xFE";
 z+="   EQU DIS_BRKVAL TO 5\xFE";
 z+="   EQU DIS_COLWDT TO 6\xFE";
 z+="   EQU DIS_COLJST TO 7\xFE";
 z+="   EQU DIS_TOTTXT TO 8\xFE";
 z+="   EQU DIS_EXP TO 9                   ;* Exploding\xFE";
 z+="   EQU DIS_COLHDR TO 10\xFE";
 z+="*\xFE";
 z+="* Equates for SORTTBL\xFE";
 z+="*\xFE";
 z+="   EQU SRT_ATR TO 1\xFE";
 z+="   EQU SRT_AD TO 2\xFE";
 z+="   EQU SRT_ICONV TO 3\xFE";
 z+="   EQU SRT_OCONV TO 4\xFE";
 z+="   EQU SRT_COLJST TO 5\xFE";
 z+="   EQU SRT_COLWDT TO 6\xFE";
 z+="   EQU SRT_TYPE TO 7\xFE";
 z+="   \xFE";
 z+="*\xFE";
 z+="* Equates for SELECTTBL\xFE";
 z+="*\xFE";
 z+="   EQU SEL_ATR TO 1\xFE";
 z+="   EQU SEL_EACHFLG TO 2\xFE";
 z+="   EQU SEL_CONV TO 3\xFE";
 z+="   EQU SEL_RELCOND TO 4\xFE";
 z+="   EQU SEL_RELARG TO 5\xFE";
 z+="   EQU SEL_SETOP TO 7\xFE";
 z+="*\xFE";
 z+="   COMMON RDSTATE                     ;* AS INT RDSTATE\xFE";
 z+="   COMMON ITEMCNT                     ;* AS LONG ITEMCNT\xFE";
 z+="   COMMON ANDCNT                      ;* AS INT ADDCNT\xFE";
 z+="   COMMON ITEMI                       ;* AS LONG ITEMI\xFE";
 z+="   COMMON VMI                         ;* AS INT VMI\xFE";
 z+="   COMMON VMMAX                       ;* AS INT VMMAX\xFE";
 z+="   COMMON F_FILE                      ;* AS LONG F_FILE\xFE";
 z+="   COMMON F_DICTIONARY                ;* AS LONG F_DICTIONARY\xFE";
 z+="   COMMON F_OUTPUT                    ;* AS LONG F_OUTPUT\xFE";
 z+="*\xFE";
 z+="   COMMON ITEMLIST                    ;* AS HEAP ITEMLIST\xFE";
 z+="   ! SUPRESSES DEFAULT HEADER, COLUMN HEADINGS,, ITEMSLISTED\xFE";
 z+="   COMMON COLHDRSPP                   ;* AS INT COLHDRSPP\xFE";
 z+="   COMMON TOPRINTER                    ;* AS INT TOPRINTER\xFE";
 z+="   ! SUPRESSED DETAIL ON BREAK-ON AND TOTAL\xFE";
 z+="   COMMON DETSPP                      ;* AS INT DETSPP\xFE";
 z+="   ! SUPRESSES DEFAULT HEADER AND ITEMSLISTED\xFE";
 z+="   COMMON HDRSPP                      ;* AS INT HDRSPP\xFE";
 z+="   ! SUPRESSES ITEMID'S\xFE";
 z+="   COMMON GRANDSTR                    ;* AS STRING GRANDSTR\xFE";
 z+="   COMMON EXPLODING                   ;* AS INT EXPLODING\xFE";
 z+="   COMMON DISPLAYTBL\xFE";
 z+="   COMMON TERMS                       ;* AS HEAP TERMS\xFE";
 z+="   COMMON TOKENS                      ;* AS HEAP TOKENS\xFE";
 z+="   COMMON VERB                        ;* AS HEAP VERB\xFE";
 z+="   COMMON ERRORS                      ;* AS HEAP ERRORS\xFE";
 z+="   COMMON MD\xFE";
 z+="   COMMON TERMI                       ;* AS INT TERMI\xFE";
 z+="   COMMON TKSTRS                      ;* AS HEAP TKSTRS\xFE";
 z+="   COMMON TKVALS                      ;* AS HEAP TKVALS\xFE";
 z+="   COMMON F_USINGFILE                 ;* AS LONG F_USINGFILE\xFE";
 z+="   COMMON XUSING                      ;* AS INT XUSING\xFE";
 z+="   COMMON MDX                         ;* AS LONG MDX\xFE";
 z+="   COMMON F_D_FILE                    ;* AS LONG F_D_FILE\xFE";
 z+="   COMMON ITEM\xFE";
 z+="   COMMON ITEMNAMES                   ;* AS HEAP ITEMNAMES\xFE";
 z+="   COMMON HEADER                      ;* AS HEAP HEADER\xFE";
 z+="   COMMON FOOTER                      ;* AS HEAP FOOTER\xFE";
 z+="*\xFE";
 z+="   EQU L$LANG TO ''\xFE";
 z+="   COMMON PICKSELECT ;* AS STRING PICKSELECT\xFE";
 z+="   COMMON ISSORT                      ;* AS INT ISSORT\xFE";
 z+="   COMMON FILEDICTDATA                ;* AS STRING FILEDICTDATA\xFE";
 z+="   COMMON USINGDICTDATA               ;* AS STRING USINGDICTDATA\xFE";
 z+="   COMMON USINGTableName               ;* AS STRING USINGTableName\xFE";
 z+="   COMMON PAGEPAUSE                   ;* AS INT PAGEPAUSE\xFE";
 z+="   COMMON DBLSPC                      ;* AS INT DBLSPC\xFE";
 z+="   COMMON THROWAWAY                   ;* AS HEAP THROWAWAY\xFE";
 z+="   COMMON EXPTBL                      ;* AS STRING EXPTBL\xFE";
 z+="   COMMON SELECTTBL\xFE";
 z+="   COMMON SORTTBL\xFE";
 z+="   COMMON DCOLCNT                     ;* AS INT DCOLCNT\xFE";
 z+="   COMMON SCOLCNT                     ;* AS INT SCOLCNT\xFE";
 z+="   COMMON ECOLCNT                     ;* AS INT ECOLCNT\xFE";
 z+="   COMMON SORTCNT                     ;* AS INT SORTCNT\xFE";
 z+="   COMMON DONEREAD                    ;* AS INT DONEREAD\xFE";
 z+="   COMMON SENTENCE\xFE";
 z+="   COMMON DATASET\xFE";
 z+="   \xFE";
 z+="   COMMON MTRACKINGPAGES, MFOOTLINENO, MPAGENO, MFOOTER, MLINENO, MHEADER, ATBOL, mDoubleSpacing, HEADFOOTB, mLinesOnPage\xFE";
 z+="   \xFE";
 z+="   "
window.cached_jsb_tcl["_vcom"]=z;
var z="* Generic item processing include routine\xFE";
 z+="*\xFE";
 z+="* prefix with:\xFE";
 z+="*    \xFE";
 z+="* \xFE";
 z+="*    Input Variables:\xFE";
 z+="*       DftAllItems:         set to 1 before include to allow all items by default (* allowed)\xFE";
 z+="*       IgnoreFileNotFound:  set to 1 before include to ignored \"file not found\" errors\xFE";
 z+="*       Help:                An Array of help instructions if filename is empty or \"?\"\xFE";
 z+="*\xFE";
 z+="*     File Variables:\xFE";
 z+="*       Dictdata:   \"\" or \"dict\"\xFE";
 z+="*       TableName:  FILE NAME ONLY (NO DICT/DATA CLAUSE) \xFE";
 z+="*       Fname:      FILE NAME WITH DICT/DATA CLAUSE \xFE";
 z+="*       F_file:     Opened file Or Empty\xFE";
 z+="*\xFE";
 z+="*     Item Variables:\xFE";
 z+="*       Inames:   Array of items selected\xFE";
 z+="*\xFE";
 z+="*     Misc Variables:\xFE";
 z+="*       Errors:    Multi-valued list of errors that are automatically printed at end of run\xFE";
 z+="*       FilterBy:  Any filter applied\xFE";
 z+="*       OrderBY:   Any OrderBy applied\xFE";
 z+="*       Options:   a UCase of @Sentence with ! (debug) removed\xFE";
 z+="*       AllItems: All items of the file were selected (*)\xFE";
 z+="* \xFE";
 z+="*       \xFE";
 z+="    Prompt \"\"\xFE";
 z+="    Dim Errors As Array = []\xFE";
 z+="    DftAllItems = DftAllItems ;* Prevent not assigned warning\xFE";
 z+="    * \xFE";
 z+="    * Specific file(s) given? \xFE";
 z+="    * \xFE";
 z+="    Dim DefaultTop As String  = \"\"\xFE";
 z+="    Dim Top As String = \"\"\xFE";
 z+="    Dim Columns As String = \"\"\xFE";
 z+="    Dim Dictdata As String = \"\"\xFE";
 z+="    Dim TableName As String = \"\"\xFE";
 z+="    Dim FilterBy As String = \"\"\xFE";
 z+="    Dim OrderBY As String = \"\"\xFE";
 z+="    Dim AllItems As Boolean = False\xFE";
 z+="    Dim F_file As FileHandle = Nothing\xFE";
 z+="    \xFE";
 z+="    Dim Options As String = \"\"\xFE";
 z+="    Dim FName As String = \"\"\xFE";
 z+="    \xFE";
 z+="    if !Help Then Help = []\xFE";
 z+="    \xFE";
 z+="    If @ParseSelect(@Sentence, defaultTop, Top, Columns, Dictdata, TableName, FilterBy, OrderBY, Options, AllItems, F_file, False, IgnoreFileNotFound) Then\xFE";
 z+="        Fname = LTrim(Dictdata:\" \":TableName)\xFE";
 z+="        \xFE";
 z+="        If Fname = '' Then\xFE";
 z+="            If !IgnoreFileNotFound Then\xFE";
 z+="                If !Help Then Errors[-1] = Field(@Sentence, \" \", 1):' TableName ItemID(s) (Options' Else Errors = Help\xFE";
 z+="            End If\xFE";
 z+="        Else\xFE";
 z+="            If AllItems Or FilterBy = \"*\" Or (FilterBy = \"\" And DftAllItems And !System(11)) Then\xFE";
 z+="                FilterBy = \"\"\xFE";
 z+="                ClearSelect\xFE";
 z+="                Select F_file\xFE";
 z+="            Else\xFE";
 z+="                If FilterBy Then\xFE";
 z+="                    FilterBy = LTrim(RTrim(FilterBy:OrderBY))\xFE";
 z+="                    Select LTrim(Top:' '):Join(Columns, \" \") From F_file Where FilterBy Else Stop @Errors\xFE";
 z+="                End If\xFE";
 z+="            End If\xFE";
 z+="        End If\xFE";
 z+="    Else\xFE";
 z+="        If (TableName = '' Or TableName = '?') And Help Then Errors = Help Else Errors[-1] = @Errors\xFE";
 z+="        Fname = LTrim(Dictdata:\" \":TableName)\xFE";
 z+="    End If\xFE";
 z+="    \xFE";
 z+="    Dim Inames As Array = []\xFE";
 z+="    dim rnIName as string\xFE";
 z+="    Loop\xFE";
 z+="        Readnext rnIName Else Break\xFE";
 z+="    While rnIName # '' Do\xFE";
 z+="        Inames[-1] = rnIName\xFE";
 z+="    Repeat\xFE";
 z+="    \xFE";
 z+="/*\xFE";
 z+="\xFE";
 z+="    Dim IgnoreFileNotFound As Boolean = False\xFE";
 z+="    Dim DftAllItems As Boolean = False\xFE";
 z+="    Dim Help As Array = [\"Some help\"]\xFE";
 z+="    \xFE";
 z+="    $include __shell\xFE";
 z+="    \xFE";
 z+="    For each iName As String, ItemI As Integer In INames\xFE";
 z+="        Dim Ext As String = @FieldRight(UCase(Iname), \".\")\xFE";
 z+="        Dim HDoc As Boolean = Ext = \"HTM\" Or Ext = \"HTML\"\xFE";
 z+="    Next\xFE";
 z+="    \xFE";
 z+="    If Errors Then Print MonoSpace(Join(Errors, crlf()))\xFE";
 z+="*/\xFE";
 z+=""
window.cached_jsb_tcl["__shell"]=z;
}
anonymousFunc()
anonymousFunc = null